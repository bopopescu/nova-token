begin_unit
comment|'# Copyright (c) 2001-2004 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
comment|'# '
nl|'\n'
nl|'\n'
name|'from'
name|'cStringIO'
name|'import'
name|'StringIO'
newline|'\n'
name|'import'
name|'os'
op|','
name|'re'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'python'
name|'import'
name|'text'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'web'
name|'import'
name|'domhelpers'
newline|'\n'
name|'import'
name|'latex'
op|','
name|'tree'
newline|'\n'
nl|'\n'
DECL|variable|spaceRe
name|'spaceRe'
op|'='
name|'re'
op|'.'
name|'compile'
op|'('
string|"'\\s+'"
op|')'
newline|'\n'
nl|'\n'
DECL|function|texiEscape
name|'def'
name|'texiEscape'
op|'('
name|'text'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'return'
name|'spaceRe'
op|'.'
name|'sub'
op|'('
name|'text'
op|','
string|"' '"
op|')'
newline|'\n'
nl|'\n'
DECL|variable|entities
dedent|''
name|'entities'
op|'='
name|'latex'
op|'.'
name|'entities'
op|'.'
name|'copy'
op|'('
op|')'
newline|'\n'
name|'entities'
op|'['
string|"'copy'"
op|']'
op|'='
string|"'@copyright{}'"
newline|'\n'
nl|'\n'
DECL|class|TexiSpitter
name|'class'
name|'TexiSpitter'
op|'('
name|'latex'
op|'.'
name|'BaseLatexSpitter'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|variable|baseLevel
indent|'    '
name|'baseLevel'
op|'='
number|'1'
newline|'\n'
nl|'\n'
DECL|member|writeNodeData
name|'def'
name|'writeNodeData'
op|'('
name|'self'
op|','
name|'node'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'buf'
op|'='
name|'StringIO'
op|'('
op|')'
newline|'\n'
name|'latex'
op|'.'
name|'getLatexText'
op|'('
name|'node'
op|','
name|'self'
op|'.'
name|'writer'
op|','
name|'texiEscape'
op|','
name|'entities'
op|')'
newline|'\n'
nl|'\n'
DECL|member|visitNode_title
dedent|''
name|'def'
name|'visitNode_title'
op|'('
name|'self'
op|','
name|'node'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'writer'
op|'('
string|"'@node '"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'visitNodeDefault'
op|'('
name|'node'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'writer'
op|'('
string|"'\\n'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'writer'
op|'('
string|"'@section '"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'visitNodeDefault'
op|'('
name|'node'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'writer'
op|'('
string|"'\\n'"
op|')'
newline|'\n'
name|'headers'
op|'='
name|'tree'
op|'.'
name|'getHeaders'
op|'('
name|'domhelpers'
op|'.'
name|'getParents'
op|'('
name|'node'
op|')'
op|'['
op|'-'
number|'1'
op|']'
op|')'
newline|'\n'
name|'if'
name|'not'
name|'headers'
op|':'
newline|'\n'
indent|'            '
name|'return'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'writer'
op|'('
string|"'@menu\\n'"
op|')'
newline|'\n'
name|'for'
name|'header'
name|'in'
name|'headers'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'writer'
op|'('
string|"'* %s::\\n'"
op|'%'
name|'domhelpers'
op|'.'
name|'getNodeText'
op|'('
name|'header'
op|')'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'writer'
op|'('
string|"'@end menu\\n'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|visitNode_pre
dedent|''
name|'def'
name|'visitNode_pre'
op|'('
name|'self'
op|','
name|'node'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'writer'
op|'('
string|"'@verbatim\\n'"
op|')'
newline|'\n'
name|'buf'
op|'='
name|'StringIO'
op|'('
op|')'
newline|'\n'
name|'latex'
op|'.'
name|'getLatexText'
op|'('
name|'node'
op|','
name|'buf'
op|'.'
name|'write'
op|','
name|'entities'
op|'='
name|'entities'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'writer'
op|'('
name|'text'
op|'.'
name|'removeLeadingTrailingBlanks'
op|'('
name|'buf'
op|'.'
name|'getvalue'
op|'('
op|')'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'writer'
op|'('
string|"'@end verbatim\\n'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|visitNode_code
dedent|''
name|'def'
name|'visitNode_code'
op|'('
name|'self'
op|','
name|'node'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'fout'
op|'='
name|'StringIO'
op|'('
op|')'
newline|'\n'
name|'latex'
op|'.'
name|'getLatexText'
op|'('
name|'node'
op|','
name|'fout'
op|'.'
name|'write'
op|','
name|'texiEscape'
op|','
name|'entities'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'writer'
op|'('
string|"'@code{'"
op|'+'
name|'fout'
op|'.'
name|'getvalue'
op|'('
op|')'
op|'+'
string|"'}'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|visitNodeHeader
dedent|''
name|'def'
name|'visitNodeHeader'
op|'('
name|'self'
op|','
name|'node'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'writer'
op|'('
string|"'\\n\\n@node '"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'visitNodeDefault'
op|'('
name|'node'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'writer'
op|'('
string|"'\\n'"
op|')'
newline|'\n'
name|'level'
op|'='
op|'('
name|'int'
op|'('
name|'node'
op|'.'
name|'tagName'
op|'['
number|'1'
op|']'
op|')'
op|'-'
number|'2'
op|')'
op|'+'
name|'self'
op|'.'
name|'baseLevel'
newline|'\n'
name|'self'
op|'.'
name|'writer'
op|'('
string|"'\\n\\n@'"
op|'+'
name|'level'
op|'*'
string|"'sub'"
op|'+'
string|"'section '"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'visitNodeDefault'
op|'('
name|'node'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'writer'
op|'('
string|"'\\n'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|visitNode_a_listing
dedent|''
name|'def'
name|'visitNode_a_listing'
op|'('
name|'self'
op|','
name|'node'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'fileName'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'self'
op|'.'
name|'currDir'
op|','
name|'node'
op|'.'
name|'getAttribute'
op|'('
string|"'href'"
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'writer'
op|'('
string|"'@verbatim\\n'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'writer'
op|'('
name|'open'
op|'('
name|'fileName'
op|')'
op|'.'
name|'read'
op|'('
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'writer'
op|'('
string|"'@end verbatim'"
op|')'
newline|'\n'
comment|'# Write a caption for this source listing'
nl|'\n'
nl|'\n'
DECL|member|visitNode_a_href
dedent|''
name|'def'
name|'visitNode_a_href'
op|'('
name|'self'
op|','
name|'node'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'visitNodeDefault'
op|'('
name|'node'
op|')'
newline|'\n'
nl|'\n'
DECL|member|visitNode_a_name
dedent|''
name|'def'
name|'visitNode_a_name'
op|'('
name|'self'
op|','
name|'node'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'visitNodeDefault'
op|'('
name|'node'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'visitNode_h2'
op|'='
name|'visitNode_h3'
op|'='
name|'visitNode_h4'
op|'='
name|'visitNodeHeader'
newline|'\n'
nl|'\n'
DECL|variable|start_dl
name|'start_dl'
op|'='
string|"'@itemize\\n'"
newline|'\n'
DECL|variable|end_dl
name|'end_dl'
op|'='
string|"'@end itemize\\n'"
newline|'\n'
DECL|variable|start_ul
name|'start_ul'
op|'='
string|"'@itemize\\n'"
newline|'\n'
DECL|variable|end_ul
name|'end_ul'
op|'='
string|"'@end itemize\\n'"
newline|'\n'
nl|'\n'
DECL|variable|start_ol
name|'start_ol'
op|'='
string|"'@enumerate\\n'"
newline|'\n'
DECL|variable|end_ol
name|'end_ol'
op|'='
string|"'@end enumerate\\n'"
newline|'\n'
nl|'\n'
DECL|variable|start_li
name|'start_li'
op|'='
string|"'@item\\n'"
newline|'\n'
DECL|variable|end_li
name|'end_li'
op|'='
string|"'\\n'"
newline|'\n'
nl|'\n'
DECL|variable|start_dt
name|'start_dt'
op|'='
string|"'@item\\n'"
newline|'\n'
DECL|variable|end_dt
name|'end_dt'
op|'='
string|"': '"
newline|'\n'
DECL|variable|end_dd
name|'end_dd'
op|'='
string|"'\\n'"
newline|'\n'
nl|'\n'
DECL|variable|start_p
name|'start_p'
op|'='
string|"'\\n\\n'"
newline|'\n'
nl|'\n'
name|'start_strong'
op|'='
name|'start_em'
op|'='
string|"'@emph{'"
newline|'\n'
name|'end_strong'
op|'='
name|'end_em'
op|'='
string|"'}'"
newline|'\n'
nl|'\n'
DECL|variable|start_q
name|'start_q'
op|'='
string|'"``"'
newline|'\n'
DECL|variable|end_q
name|'end_q'
op|'='
string|'"\'\'"'
newline|'\n'
nl|'\n'
DECL|variable|start_span_footnote
name|'start_span_footnote'
op|'='
string|"'@footnote{'"
newline|'\n'
DECL|variable|end_span_footnote
name|'end_span_footnote'
op|'='
string|"'}'"
newline|'\n'
nl|'\n'
DECL|variable|start_div_note
name|'start_div_note'
op|'='
string|"'@quotation\\n@strong{Note:}'"
newline|'\n'
DECL|variable|end_div_note
name|'end_div_note'
op|'='
string|"'@end quotation\\n'"
newline|'\n'
nl|'\n'
DECL|variable|start_th
name|'start_th'
op|'='
string|"'@strong{'"
newline|'\n'
DECL|variable|end_th
name|'end_th'
op|'='
string|"'}'"
newline|'\n'
dedent|''
endmarker|''
end_unit
