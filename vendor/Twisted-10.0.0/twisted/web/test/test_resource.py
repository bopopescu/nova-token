begin_unit
comment|'# Copyright (c) 2009 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
string|'"""\nTests for L{twisted.web.resource}.\n"""'
newline|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'trial'
op|'.'
name|'unittest'
name|'import'
name|'TestCase'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'web'
name|'import'
name|'error'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'web'
op|'.'
name|'http'
name|'import'
name|'NOT_FOUND'
op|','
name|'FORBIDDEN'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'web'
op|'.'
name|'resource'
name|'import'
name|'ErrorPage'
op|','
name|'NoResource'
op|','
name|'ForbiddenResource'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'web'
op|'.'
name|'test'
op|'.'
name|'test_web'
name|'import'
name|'DummyRequest'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|ErrorPageTests
name|'class'
name|'ErrorPageTests'
op|'('
name|'TestCase'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""\n    Tests for L{ErrorPage}, L{NoResource}, and L{ForbiddenResource}.\n    """'
newline|'\n'
nl|'\n'
DECL|variable|errorPage
name|'errorPage'
op|'='
name|'ErrorPage'
newline|'\n'
DECL|variable|noResource
name|'noResource'
op|'='
name|'NoResource'
newline|'\n'
DECL|variable|forbiddenResource
name|'forbiddenResource'
op|'='
name|'ForbiddenResource'
newline|'\n'
nl|'\n'
DECL|member|test_getChild
name|'def'
name|'test_getChild'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        The C{getChild} method of L{ErrorPage} returns the L{ErrorPage} it is\n        called on.\n        """'
newline|'\n'
name|'page'
op|'='
name|'self'
op|'.'
name|'errorPage'
op|'('
number|'321'
op|','
string|'"foo"'
op|','
string|'"bar"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIdentical'
op|'('
name|'page'
op|'.'
name|'getChild'
op|'('
string|'"name"'
op|','
name|'object'
op|'('
op|')'
op|')'
op|','
name|'page'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|_pageRenderingTest
dedent|''
name|'def'
name|'_pageRenderingTest'
op|'('
name|'self'
op|','
name|'page'
op|','
name|'code'
op|','
name|'brief'
op|','
name|'detail'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'request'
op|'='
name|'DummyRequest'
op|'('
op|'['
string|"''"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'page'
op|'.'
name|'render'
op|'('
name|'request'
op|')'
op|','
nl|'\n'
string|'"\\n"'
nl|'\n'
string|'"<html>\\n"'
nl|'\n'
string|'"  <head><title>%s - %s</title></head>\\n"'
nl|'\n'
string|'"  <body>\\n"'
nl|'\n'
string|'"    <h1>%s</h1>\\n"'
nl|'\n'
string|'"    <p>%s</p>\\n"'
nl|'\n'
string|'"  </body>\\n"'
nl|'\n'
string|'"</html>\\n"'
op|'%'
op|'('
name|'code'
op|','
name|'brief'
op|','
name|'brief'
op|','
name|'detail'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'request'
op|'.'
name|'responseCode'
op|','
name|'code'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'request'
op|'.'
name|'outgoingHeaders'
op|','
op|'{'
string|"'content-type'"
op|':'
string|"'text/html'"
op|'}'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|test_errorPageRendering
dedent|''
name|'def'
name|'test_errorPageRendering'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        L{ErrorPage.render} returns a C{str} describing the error defined by\n        the response code and message passed to L{ErrorPage.__init__}.  It also\n        uses that response code to set the response code on the L{Request}\n        passed in.\n        """'
newline|'\n'
name|'code'
op|'='
number|'321'
newline|'\n'
name|'brief'
op|'='
string|'"brief description text"'
newline|'\n'
name|'detail'
op|'='
string|'"much longer text might go here"'
newline|'\n'
name|'page'
op|'='
name|'self'
op|'.'
name|'errorPage'
op|'('
name|'code'
op|','
name|'brief'
op|','
name|'detail'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_pageRenderingTest'
op|'('
name|'page'
op|','
name|'code'
op|','
name|'brief'
op|','
name|'detail'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|test_noResourceRendering
dedent|''
name|'def'
name|'test_noResourceRendering'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        L{NoResource} sets the HTTP I{NOT FOUND} code.\n        """'
newline|'\n'
name|'detail'
op|'='
string|'"long message"'
newline|'\n'
name|'page'
op|'='
name|'self'
op|'.'
name|'noResource'
op|'('
name|'detail'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_pageRenderingTest'
op|'('
name|'page'
op|','
name|'NOT_FOUND'
op|','
string|'"No Such Resource"'
op|','
name|'detail'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|test_forbiddenResourceRendering
dedent|''
name|'def'
name|'test_forbiddenResourceRendering'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        L{ForbiddenResource} sets the HTTP I{FORBIDDEN} code.\n        """'
newline|'\n'
name|'detail'
op|'='
string|'"longer message"'
newline|'\n'
name|'page'
op|'='
name|'self'
op|'.'
name|'forbiddenResource'
op|'('
name|'detail'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_pageRenderingTest'
op|'('
name|'page'
op|','
name|'FORBIDDEN'
op|','
string|'"Forbidden Resource"'
op|','
name|'detail'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
nl|'\n'
DECL|class|DeprecatedErrorPageTests
dedent|''
dedent|''
name|'class'
name|'DeprecatedErrorPageTests'
op|'('
name|'ErrorPageTests'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""\n    Tests for L{error.ErrorPage}, L{error.NoResource}, and\n    L{error.ForbiddenResource}.\n    """'
newline|'\n'
DECL|member|errorPage
name|'def'
name|'errorPage'
op|'('
name|'self'
op|','
op|'*'
name|'args'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'error'
op|'.'
name|'ErrorPage'
op|'('
op|'*'
name|'args'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|noResource
dedent|''
name|'def'
name|'noResource'
op|'('
name|'self'
op|','
op|'*'
name|'args'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'error'
op|'.'
name|'NoResource'
op|'('
op|'*'
name|'args'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|forbiddenResource
dedent|''
name|'def'
name|'forbiddenResource'
op|'('
name|'self'
op|','
op|'*'
name|'args'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'error'
op|'.'
name|'ForbiddenResource'
op|'('
op|'*'
name|'args'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|_assertWarning
dedent|''
name|'def'
name|'_assertWarning'
op|'('
name|'self'
op|','
name|'name'
op|','
name|'offendingFunction'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'warnings'
op|'='
name|'self'
op|'.'
name|'flushWarnings'
op|'('
op|'['
name|'offendingFunction'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'warnings'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'warnings'
op|'['
number|'0'
op|']'
op|'['
string|"'category'"
op|']'
op|','
name|'DeprecationWarning'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'warnings'
op|'['
number|'0'
op|']'
op|'['
string|"'message'"
op|']'
op|','
nl|'\n'
string|"'twisted.web.error.%s is deprecated since Twisted 9.0.  '"
nl|'\n'
string|"'See twisted.web.resource.%s.'"
op|'%'
op|'('
name|'name'
op|','
name|'name'
op|')'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|test_getChild
dedent|''
name|'def'
name|'test_getChild'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        Like L{ErrorPageTests.test_getChild}, but flush the deprecation warning\n        emitted by instantiating L{error.ErrorPage}.\n        """'
newline|'\n'
name|'ErrorPageTests'
op|'.'
name|'test_getChild'
op|'('
name|'self'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_assertWarning'
op|'('
string|"'ErrorPage'"
op|','
name|'self'
op|'.'
name|'errorPage'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|test_errorPageRendering
dedent|''
name|'def'
name|'test_errorPageRendering'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        Like L{ErrorPageTests.test_errorPageRendering}, but flush the\n        deprecation warning emitted by instantiating L{error.ErrorPage}.\n        """'
newline|'\n'
name|'ErrorPageTests'
op|'.'
name|'test_errorPageRendering'
op|'('
name|'self'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_assertWarning'
op|'('
string|"'ErrorPage'"
op|','
name|'self'
op|'.'
name|'errorPage'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|test_noResourceRendering
dedent|''
name|'def'
name|'test_noResourceRendering'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        Like L{ErrorPageTests.test_noResourceRendering}, but flush the\n        deprecation warning emitted by instantiating L{error.NoResource}.\n        """'
newline|'\n'
name|'ErrorPageTests'
op|'.'
name|'test_noResourceRendering'
op|'('
name|'self'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_assertWarning'
op|'('
string|"'NoResource'"
op|','
name|'self'
op|'.'
name|'noResource'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|test_forbiddenResourceRendering
dedent|''
name|'def'
name|'test_forbiddenResourceRendering'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        Like L{ErrorPageTests.test_forbiddenResourceRendering}, but flush the\n        deprecation warning emitted by instantiating\n        L{error.ForbiddenResource}.\n        """'
newline|'\n'
name|'ErrorPageTests'
op|'.'
name|'test_forbiddenResourceRendering'
op|'('
name|'self'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_assertWarning'
op|'('
string|"'ForbiddenResource'"
op|','
name|'self'
op|'.'
name|'forbiddenResource'
op|')'
newline|'\n'
dedent|''
dedent|''
endmarker|''
end_unit
