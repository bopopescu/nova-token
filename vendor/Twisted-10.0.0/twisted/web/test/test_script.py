begin_unit
comment|'# Copyright (c) 2009 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
string|'"""\nTests for L{twisted.web.script}.\n"""'
newline|'\n'
nl|'\n'
name|'import'
name|'os'
newline|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'trial'
op|'.'
name|'unittest'
name|'import'
name|'TestCase'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'web'
op|'.'
name|'http'
name|'import'
name|'NOT_FOUND'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'web'
op|'.'
name|'script'
name|'import'
name|'ResourceScriptDirectory'
op|','
name|'PythonScript'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'web'
op|'.'
name|'test'
op|'.'
name|'_util'
name|'import'
name|'_render'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'web'
op|'.'
name|'test'
op|'.'
name|'test_web'
name|'import'
name|'DummyRequest'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|ResourceScriptDirectoryTests
name|'class'
name|'ResourceScriptDirectoryTests'
op|'('
name|'TestCase'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""\n    Tests for L{ResourceScriptDirectory}.\n    """'
newline|'\n'
DECL|member|test_render
name|'def'
name|'test_render'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        L{ResourceScriptDirectory.render} sets the HTTP response code to I{NOT\n        FOUND}.\n        """'
newline|'\n'
name|'resource'
op|'='
name|'ResourceScriptDirectory'
op|'('
name|'self'
op|'.'
name|'mktemp'
op|'('
op|')'
op|')'
newline|'\n'
name|'request'
op|'='
name|'DummyRequest'
op|'('
op|'['
string|"''"
op|']'
op|')'
newline|'\n'
name|'d'
op|'='
name|'_render'
op|'('
name|'resource'
op|','
name|'request'
op|')'
newline|'\n'
DECL|function|cbRendered
name|'def'
name|'cbRendered'
op|'('
name|'ignored'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'request'
op|'.'
name|'responseCode'
op|','
name|'NOT_FOUND'
op|')'
newline|'\n'
dedent|''
name|'d'
op|'.'
name|'addCallback'
op|'('
name|'cbRendered'
op|')'
newline|'\n'
name|'return'
name|'d'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|test_notFoundChild
dedent|''
name|'def'
name|'test_notFoundChild'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        L{ResourceScriptDirectory.getChild} returns a resource which renders an\n        response with the HTTP I{NOT FOUND} status code if the indicated child\n        does not exist as an entry in the directory used to initialized the\n        L{ResourceScriptDirectory}.\n        """'
newline|'\n'
name|'path'
op|'='
name|'self'
op|'.'
name|'mktemp'
op|'('
op|')'
newline|'\n'
name|'os'
op|'.'
name|'makedirs'
op|'('
name|'path'
op|')'
newline|'\n'
name|'resource'
op|'='
name|'ResourceScriptDirectory'
op|'('
name|'path'
op|')'
newline|'\n'
name|'request'
op|'='
name|'DummyRequest'
op|'('
op|'['
string|"'foo'"
op|']'
op|')'
newline|'\n'
name|'child'
op|'='
name|'resource'
op|'.'
name|'getChild'
op|'('
string|'"foo"'
op|','
name|'request'
op|')'
newline|'\n'
name|'d'
op|'='
name|'_render'
op|'('
name|'child'
op|','
name|'request'
op|')'
newline|'\n'
DECL|function|cbRendered
name|'def'
name|'cbRendered'
op|'('
name|'ignored'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'request'
op|'.'
name|'responseCode'
op|','
name|'NOT_FOUND'
op|')'
newline|'\n'
dedent|''
name|'d'
op|'.'
name|'addCallback'
op|'('
name|'cbRendered'
op|')'
newline|'\n'
name|'return'
name|'d'
newline|'\n'
nl|'\n'
nl|'\n'
nl|'\n'
DECL|class|PythonScriptTests
dedent|''
dedent|''
name|'class'
name|'PythonScriptTests'
op|'('
name|'TestCase'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""\n    Tests for L{PythonScript}.\n    """'
newline|'\n'
DECL|member|test_notFoundRender
name|'def'
name|'test_notFoundRender'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        If the source file a L{PythonScript} is initialized with doesn\'t exist,\n        L{PythonScript.render} sets the HTTP response code to I{NOT FOUND}.\n        """'
newline|'\n'
name|'resource'
op|'='
name|'PythonScript'
op|'('
name|'self'
op|'.'
name|'mktemp'
op|'('
op|')'
op|','
name|'None'
op|')'
newline|'\n'
name|'request'
op|'='
name|'DummyRequest'
op|'('
op|'['
string|"''"
op|']'
op|')'
newline|'\n'
name|'d'
op|'='
name|'_render'
op|'('
name|'resource'
op|','
name|'request'
op|')'
newline|'\n'
DECL|function|cbRendered
name|'def'
name|'cbRendered'
op|'('
name|'ignored'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'request'
op|'.'
name|'responseCode'
op|','
name|'NOT_FOUND'
op|')'
newline|'\n'
dedent|''
name|'d'
op|'.'
name|'addCallback'
op|'('
name|'cbRendered'
op|')'
newline|'\n'
name|'return'
name|'d'
newline|'\n'
dedent|''
dedent|''
endmarker|''
end_unit
