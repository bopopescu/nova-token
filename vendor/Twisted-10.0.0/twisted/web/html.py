begin_unit
nl|'\n'
comment|'# Copyright (c) 2001-2004 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
nl|'\n'
string|'"""I hold HTML generation helpers.\n"""'
newline|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'python'
name|'import'
name|'log'
newline|'\n'
comment|'#t.w imports'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'web'
name|'import'
name|'resource'
newline|'\n'
nl|'\n'
name|'import'
name|'traceback'
op|','
name|'string'
newline|'\n'
nl|'\n'
name|'from'
name|'cStringIO'
name|'import'
name|'StringIO'
newline|'\n'
name|'from'
name|'microdom'
name|'import'
name|'escape'
newline|'\n'
nl|'\n'
DECL|function|PRE
name|'def'
name|'PRE'
op|'('
name|'text'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"Wrap <pre> tags around some text and HTML-escape it."'
newline|'\n'
name|'return'
string|'"<pre>"'
op|'+'
name|'escape'
op|'('
name|'text'
op|')'
op|'+'
string|'"</pre>"'
newline|'\n'
nl|'\n'
DECL|function|UL
dedent|''
name|'def'
name|'UL'
op|'('
name|'lst'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'io'
op|'='
name|'StringIO'
op|'('
op|')'
newline|'\n'
name|'io'
op|'.'
name|'write'
op|'('
string|'"<ul>\\n"'
op|')'
newline|'\n'
name|'for'
name|'el'
name|'in'
name|'lst'
op|':'
newline|'\n'
indent|'        '
name|'io'
op|'.'
name|'write'
op|'('
string|'"<li> %s</li>\\n"'
op|'%'
name|'el'
op|')'
newline|'\n'
dedent|''
name|'io'
op|'.'
name|'write'
op|'('
string|'"</ul>"'
op|')'
newline|'\n'
name|'return'
name|'io'
op|'.'
name|'getvalue'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|function|linkList
dedent|''
name|'def'
name|'linkList'
op|'('
name|'lst'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'io'
op|'='
name|'StringIO'
op|'('
op|')'
newline|'\n'
name|'io'
op|'.'
name|'write'
op|'('
string|'"<ul>\\n"'
op|')'
newline|'\n'
name|'for'
name|'hr'
op|','
name|'el'
name|'in'
name|'lst'
op|':'
newline|'\n'
indent|'        '
name|'io'
op|'.'
name|'write'
op|'('
string|'\'<li> <a href="%s">%s</a></li>\\n\''
op|'%'
op|'('
name|'hr'
op|','
name|'el'
op|')'
op|')'
newline|'\n'
dedent|''
name|'io'
op|'.'
name|'write'
op|'('
string|'"</ul>"'
op|')'
newline|'\n'
name|'return'
name|'io'
op|'.'
name|'getvalue'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|function|output
dedent|''
name|'def'
name|'output'
op|'('
name|'func'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kw'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""output(func, *args, **kw) -> html string\n    Either return the result of a function (which presumably returns an\n    HTML-legal string) or a sparse HTMLized error message and a message\n    in the server log.\n    """'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'func'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kw'
op|')'
newline|'\n'
dedent|''
name|'except'
op|':'
newline|'\n'
indent|'        '
name|'log'
op|'.'
name|'msg'
op|'('
string|'"Error calling %r:"'
op|'%'
op|'('
name|'func'
op|','
op|')'
op|')'
newline|'\n'
name|'log'
op|'.'
name|'err'
op|'('
op|')'
newline|'\n'
name|'return'
name|'PRE'
op|'('
string|'"An error occurred."'
op|')'
newline|'\n'
dedent|''
dedent|''
endmarker|''
end_unit
