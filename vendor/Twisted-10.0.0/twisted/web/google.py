begin_unit
comment|'# Copyright (c) 2001-2004 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
comment|'#'
nl|'\n'
string|'"""\\"I\'m Feeling Lucky\\" with U{Google<http://google.com>}.\n"""'
newline|'\n'
name|'import'
name|'urllib'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'protocol'
op|','
name|'reactor'
op|','
name|'defer'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'web'
name|'import'
name|'http'
newline|'\n'
nl|'\n'
DECL|class|GoogleChecker
name|'class'
name|'GoogleChecker'
op|'('
name|'http'
op|'.'
name|'HTTPClient'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|connectionMade
indent|'    '
name|'def'
name|'connectionMade'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'sendCommand'
op|'('
string|"'GET'"
op|','
name|'self'
op|'.'
name|'factory'
op|'.'
name|'url'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'sendHeader'
op|'('
string|"'Host'"
op|','
name|'self'
op|'.'
name|'factory'
op|'.'
name|'host'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'sendHeader'
op|'('
string|"'User-Agent'"
op|','
name|'self'
op|'.'
name|'factory'
op|'.'
name|'agent'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'endHeaders'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|handleHeader
dedent|''
name|'def'
name|'handleHeader'
op|'('
name|'self'
op|','
name|'key'
op|','
name|'value'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'key'
op|'='
name|'key'
op|'.'
name|'lower'
op|'('
op|')'
newline|'\n'
name|'if'
name|'key'
op|'=='
string|"'location'"
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'factory'
op|'.'
name|'gotLocation'
op|'('
name|'value'
op|')'
newline|'\n'
nl|'\n'
DECL|member|handleStatus
dedent|''
dedent|''
name|'def'
name|'handleStatus'
op|'('
name|'self'
op|','
name|'version'
op|','
name|'status'
op|','
name|'message'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'status'
op|'!='
string|"'302'"
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'factory'
op|'.'
name|'noLocation'
op|'('
name|'ValueError'
op|'('
string|'"bad status"'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|handleEndHeaders
dedent|''
dedent|''
name|'def'
name|'handleEndHeaders'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'factory'
op|'.'
name|'noLocation'
op|'('
name|'ValueError'
op|'('
string|'"no location"'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|handleResponsePart
dedent|''
name|'def'
name|'handleResponsePart'
op|'('
name|'self'
op|','
name|'part'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pass'
newline|'\n'
nl|'\n'
DECL|member|handleResponseEnd
dedent|''
name|'def'
name|'handleResponseEnd'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pass'
newline|'\n'
nl|'\n'
DECL|member|connectionLost
dedent|''
name|'def'
name|'connectionLost'
op|'('
name|'self'
op|','
name|'reason'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'factory'
op|'.'
name|'noLocation'
op|'('
name|'reason'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|GoogleCheckerFactory
dedent|''
dedent|''
name|'class'
name|'GoogleCheckerFactory'
op|'('
name|'protocol'
op|'.'
name|'ClientFactory'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|variable|protocol
indent|'    '
name|'protocol'
op|'='
name|'GoogleChecker'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'words'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'url'
op|'='
op|'('
string|"'/search?q=%s&btnI=%s'"
op|'%'
nl|'\n'
op|'('
name|'urllib'
op|'.'
name|'quote_plus'
op|'('
string|"' '"
op|'.'
name|'join'
op|'('
name|'words'
op|')'
op|')'
op|','
nl|'\n'
name|'urllib'
op|'.'
name|'quote_plus'
op|'('
string|'"I\'m Feeling Lucky"'
op|')'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'agent'
op|'='
string|'"Twisted/GoogleChecker"'
newline|'\n'
name|'self'
op|'.'
name|'host'
op|'='
string|'"www.google.com"'
newline|'\n'
name|'self'
op|'.'
name|'deferred'
op|'='
name|'defer'
op|'.'
name|'Deferred'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|clientConnectionFailed
dedent|''
name|'def'
name|'clientConnectionFailed'
op|'('
name|'self'
op|','
name|'_'
op|','
name|'reason'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'noLocation'
op|'('
name|'reason'
op|')'
newline|'\n'
nl|'\n'
DECL|member|gotLocation
dedent|''
name|'def'
name|'gotLocation'
op|'('
name|'self'
op|','
name|'location'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'deferred'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'deferred'
op|'.'
name|'callback'
op|'('
name|'location'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'deferred'
op|'='
name|'None'
newline|'\n'
nl|'\n'
DECL|member|noLocation
dedent|''
dedent|''
name|'def'
name|'noLocation'
op|'('
name|'self'
op|','
name|'error'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'deferred'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'deferred'
op|'.'
name|'errback'
op|'('
name|'error'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'deferred'
op|'='
name|'None'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|checkGoogle
dedent|''
dedent|''
dedent|''
name|'def'
name|'checkGoogle'
op|'('
name|'words'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Check google for a match.\n\n    @returns: a Deferred which will callback with a URL or errback with a\n        Failure.\n    """'
newline|'\n'
name|'factory'
op|'='
name|'GoogleCheckerFactory'
op|'('
name|'words'
op|')'
newline|'\n'
name|'reactor'
op|'.'
name|'connectTCP'
op|'('
string|"'www.google.com'"
op|','
number|'80'
op|','
name|'factory'
op|')'
newline|'\n'
name|'return'
name|'factory'
op|'.'
name|'deferred'
newline|'\n'
dedent|''
endmarker|''
end_unit
