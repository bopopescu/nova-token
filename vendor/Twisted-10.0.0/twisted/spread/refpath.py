begin_unit
comment|'# Copyright (c) 2001-2009 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
string|'"""\nPath-based references for PB, and other reference-based protocols.\n\nMaintainer: Glyph Lefkowitz\n"""'
newline|'\n'
nl|'\n'
nl|'\n'
name|'from'
name|'copy'
name|'import'
name|'copy'
newline|'\n'
name|'import'
name|'os'
op|','
name|'warnings'
newline|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'python'
name|'import'
name|'log'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'spread'
op|'.'
name|'flavors'
name|'import'
name|'Referenceable'
op|','
name|'Viewable'
newline|'\n'
nl|'\n'
name|'warnings'
op|'.'
name|'warn'
op|'('
nl|'\n'
string|'"twisted.spread.refpath is deprecated since Twisted 9.0."'
op|','
nl|'\n'
name|'category'
op|'='
name|'DeprecationWarning'
op|','
name|'stacklevel'
op|'='
number|'2'
op|')'
newline|'\n'
nl|'\n'
comment|'### "Server"-side objects'
nl|'\n'
nl|'\n'
DECL|class|PathReferenceContext
name|'class'
name|'PathReferenceContext'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'path'
op|','
name|'root'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'metadata'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'path'
op|'='
name|'path'
newline|'\n'
name|'self'
op|'.'
name|'root'
op|'='
name|'root'
newline|'\n'
nl|'\n'
DECL|member|__setitem__
dedent|''
name|'def'
name|'__setitem__'
op|'('
name|'self'
op|','
name|'key'
op|','
name|'item'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'metadata'
op|'['
name|'key'
op|']'
op|'='
name|'item'
newline|'\n'
nl|'\n'
DECL|member|__getitem__
dedent|''
name|'def'
name|'__getitem__'
op|'('
name|'self'
op|','
name|'key'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'metadata'
op|'['
name|'key'
op|']'
newline|'\n'
nl|'\n'
DECL|member|getObject
dedent|''
name|'def'
name|'getObject'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'o'
op|'='
name|'self'
op|'.'
name|'root'
newline|'\n'
name|'for'
name|'p'
name|'in'
name|'self'
op|'.'
name|'path'
op|':'
newline|'\n'
indent|'            '
name|'o'
op|'='
name|'o'
op|'.'
name|'getChild'
op|'('
name|'p'
op|','
name|'self'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'o'
newline|'\n'
nl|'\n'
DECL|class|PathReference
dedent|''
dedent|''
name|'class'
name|'PathReference'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'children'
op|'='
op|'{'
op|'}'
newline|'\n'
DECL|member|getChild
dedent|''
name|'def'
name|'getChild'
op|'('
name|'self'
op|','
name|'child'
op|','
name|'ctx'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'children'
op|'['
name|'child'
op|']'
newline|'\n'
nl|'\n'
DECL|class|PathReferenceDirectory
dedent|''
dedent|''
name|'class'
name|'PathReferenceDirectory'
op|'('
name|'Referenceable'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'root'
op|','
name|'prefix'
op|'='
string|'"remote"'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'root'
op|'='
name|'root'
newline|'\n'
name|'self'
op|'.'
name|'prefix'
op|'='
name|'prefix'
newline|'\n'
DECL|member|remote_callPath
dedent|''
name|'def'
name|'remote_callPath'
op|'('
name|'self'
op|','
name|'path'
op|','
name|'name'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kw'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'ctx'
op|'='
name|'PathReferenceContext'
op|'('
name|'path'
op|','
name|'self'
op|')'
newline|'\n'
name|'obj'
op|'='
name|'ctx'
op|'.'
name|'getObject'
op|'('
op|')'
newline|'\n'
name|'return'
name|'apply'
op|'('
name|'getattr'
op|'('
name|'obj'
op|','
string|'"%s_%s"'
op|'%'
op|'('
name|'self'
op|'.'
name|'prefix'
op|','
name|'name'
op|')'
op|')'
op|','
name|'args'
op|','
name|'kw'
op|')'
newline|'\n'
nl|'\n'
DECL|class|PathReferenceContextDirectory
dedent|''
dedent|''
name|'class'
name|'PathReferenceContextDirectory'
op|'('
name|'Referenceable'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'root'
op|','
name|'prefix'
op|'='
string|'"remote"'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'root'
op|'='
name|'root'
newline|'\n'
name|'self'
op|'.'
name|'prefix'
op|'='
name|'prefix'
newline|'\n'
DECL|member|remote_callPath
dedent|''
name|'def'
name|'remote_callPath'
op|'('
name|'self'
op|','
name|'path'
op|','
name|'name'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kw'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'ctx'
op|'='
name|'PathReferenceContext'
op|'('
name|'path'
op|','
name|'self'
op|')'
newline|'\n'
name|'obj'
op|'='
name|'ctx'
op|'.'
name|'getObject'
op|'('
op|')'
newline|'\n'
name|'return'
name|'apply'
op|'('
name|'getattr'
op|'('
name|'obj'
op|','
string|'"%s_%s"'
op|'%'
op|'('
name|'self'
op|'.'
name|'prefix'
op|','
name|'name'
op|')'
op|')'
op|','
nl|'\n'
op|'('
name|'ctx'
op|','
op|')'
op|'+'
name|'args'
op|','
name|'kw'
op|')'
newline|'\n'
nl|'\n'
DECL|class|PathViewDirectory
dedent|''
dedent|''
name|'class'
name|'PathViewDirectory'
op|'('
name|'Viewable'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'root'
op|','
name|'prefix'
op|'='
string|'"view"'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'root'
op|'='
name|'root'
newline|'\n'
name|'self'
op|'.'
name|'prefix'
op|'='
name|'prefix'
newline|'\n'
DECL|member|view_callPath
dedent|''
name|'def'
name|'view_callPath'
op|'('
name|'self'
op|','
name|'perspective'
op|','
name|'path'
op|','
name|'name'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kw'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'ctx'
op|'='
name|'PathReferenceContext'
op|'('
name|'path'
op|','
name|'self'
op|')'
newline|'\n'
name|'obj'
op|'='
name|'ctx'
op|'.'
name|'getObject'
op|'('
op|')'
newline|'\n'
name|'return'
name|'apply'
op|'('
name|'getattr'
op|'('
name|'obj'
op|','
string|'"%s_%s"'
op|'%'
op|'('
name|'self'
op|'.'
name|'prefix'
op|','
name|'name'
op|')'
op|')'
op|','
nl|'\n'
op|'('
name|'perspective'
op|','
op|')'
op|'+'
name|'args'
op|','
name|'kw'
op|')'
newline|'\n'
nl|'\n'
DECL|class|PathViewContextDirectory
dedent|''
dedent|''
name|'class'
name|'PathViewContextDirectory'
op|'('
name|'Viewable'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'root'
op|','
name|'prefix'
op|'='
string|'"view"'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'root'
op|'='
name|'root'
newline|'\n'
name|'self'
op|'.'
name|'prefix'
op|'='
name|'prefix'
newline|'\n'
DECL|member|view_callPath
dedent|''
name|'def'
name|'view_callPath'
op|'('
name|'self'
op|','
name|'perspective'
op|','
name|'path'
op|','
name|'name'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kw'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'ctx'
op|'='
name|'PathReferenceContext'
op|'('
name|'path'
op|','
name|'self'
op|')'
newline|'\n'
name|'obj'
op|'='
name|'ctx'
op|'.'
name|'getObject'
op|'('
op|')'
newline|'\n'
name|'return'
name|'apply'
op|'('
name|'getattr'
op|'('
name|'obj'
op|','
string|'"%s_%s"'
op|'%'
op|'('
name|'self'
op|'.'
name|'prefix'
op|','
name|'name'
op|')'
op|')'
op|','
nl|'\n'
op|'('
name|'perspective'
op|','
name|'ctx'
op|')'
op|'+'
name|'args'
op|','
name|'kw'
op|')'
newline|'\n'
nl|'\n'
comment|'### "Client"-side objects'
nl|'\n'
nl|'\n'
DECL|class|RemotePathReference
dedent|''
dedent|''
name|'class'
name|'RemotePathReference'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'ref'
op|','
name|'path'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'ref'
op|'='
name|'ref'
newline|'\n'
name|'self'
op|'.'
name|'path'
op|'='
name|'path'
newline|'\n'
nl|'\n'
DECL|member|callRemote
dedent|''
name|'def'
name|'callRemote'
op|'('
name|'self'
op|','
name|'name'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kw'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'apply'
op|'('
name|'self'
op|'.'
name|'ref'
op|'.'
name|'callRemote'
op|','
nl|'\n'
op|'('
string|'"callPath"'
op|','
name|'self'
op|'.'
name|'path'
op|','
name|'name'
op|')'
op|'+'
name|'args'
op|','
name|'kw'
op|')'
newline|'\n'
dedent|''
dedent|''
endmarker|''
end_unit
