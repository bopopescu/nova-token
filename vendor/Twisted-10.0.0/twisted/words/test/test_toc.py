begin_unit
comment|'# Copyright (c) 2001-2009 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'trial'
name|'import'
name|'unittest'
newline|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'words'
op|'.'
name|'protocols'
name|'import'
name|'toc'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'protocol'
op|','
name|'main'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'python'
name|'import'
name|'failure'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'test'
op|'.'
name|'proto_helpers'
name|'import'
name|'StringIOWithoutClosing'
newline|'\n'
nl|'\n'
name|'from'
name|'struct'
name|'import'
name|'pack'
op|','
name|'unpack'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|DummyTOC
name|'class'
name|'DummyTOC'
op|'('
name|'toc'
op|'.'
name|'TOC'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""\n    used to override authentication, now overrides printing.\n    """'
newline|'\n'
DECL|member|_debug
name|'def'
name|'_debug'
op|'('
name|'self'
op|','
name|'data'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pass'
newline|'\n'
DECL|variable|SEQID
dedent|''
dedent|''
name|'SEQID'
op|'='
number|'1001'
newline|'\n'
DECL|function|flap
name|'def'
name|'flap'
op|'('
name|'type'
op|','
name|'data'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'global'
name|'SEQID'
newline|'\n'
name|'send'
op|'='
string|'"*"'
newline|'\n'
name|'send'
op|'='
name|'send'
op|'+'
name|'pack'
op|'('
string|'"!BHH"'
op|','
name|'type'
op|','
name|'SEQID'
op|','
name|'len'
op|'('
name|'data'
op|')'
op|')'
newline|'\n'
name|'send'
op|'='
name|'send'
op|'+'
name|'data'
newline|'\n'
name|'SEQID'
op|'='
name|'SEQID'
op|'+'
number|'1'
newline|'\n'
name|'return'
name|'send'
newline|'\n'
DECL|function|readFlap
dedent|''
name|'def'
name|'readFlap'
op|'('
name|'data'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'if'
name|'data'
op|'=='
string|'""'
op|':'
name|'return'
op|'['
name|'None'
op|','
string|'""'
op|']'
newline|'\n'
name|'null'
op|','
name|'type'
op|','
name|'seqid'
op|','
name|'length'
op|'='
name|'unpack'
op|'('
string|'"!BBHH"'
op|','
name|'data'
op|'['
op|':'
number|'6'
op|']'
op|')'
newline|'\n'
name|'val'
op|'='
name|'data'
op|'['
number|'6'
op|':'
number|'6'
op|'+'
name|'length'
op|']'
newline|'\n'
name|'return'
op|'['
op|'['
name|'type'
op|','
name|'val'
op|']'
op|','
name|'data'
op|'['
number|'6'
op|'+'
name|'length'
op|':'
op|']'
op|']'
newline|'\n'
nl|'\n'
DECL|class|TOCGeneralTestCase
dedent|''
name|'class'
name|'TOCGeneralTestCase'
op|'('
name|'unittest'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""\n    general testing of TOC functions.\n    """'
newline|'\n'
DECL|member|testTOC
name|'def'
name|'testTOC'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'runTest'
op|'('
op|')'
newline|'\n'
DECL|member|runTest
dedent|''
name|'def'
name|'runTest'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'USERS'
op|'='
number|'2'
newline|'\n'
name|'data'
op|'='
name|'range'
op|'('
name|'USERS'
op|')'
newline|'\n'
name|'data'
op|'['
number|'0'
op|']'
op|'='
op|'('
string|'"FLAPON\\r\\n\\r\\n"'
op|','
name|'flap'
op|'('
number|'1'
op|','
string|'"\\000\\000\\000\\001\\000\\001\\000\\004test"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_signon localhost 9999 test 0x100000 english \\"penguin 0.1\\"\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_add_buddy test\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_init_done\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_send_im test \\"hi\\"\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_send_im test2 \\"hello\\"\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_set_away \\"not here\\"\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_set_idle 602\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_set_idle 0\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_set_away\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_evil test norm\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_chat_join 4 \\"Test Chat\\"\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_chat_send 0 \\"hello\\"\\000"'
op|')'
op|','
comment|'#flap(2,"toc_chat_leave 0\\000")) #,\\'
nl|'\n'
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_chat_invite 0 \\"come\\" ooga\\000"'
op|')'
op|','
comment|'#flap(2,"toc_chat_accept 0\\000"),\\'
nl|'\n'
name|'flap'
op|'('
number|'5'
op|','
string|'"\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_chat_whisper 0 ooga \\"boo ga\\"\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_chat_leave 0"'
op|')'
op|','
name|'flap'
op|'('
number|'5'
op|','
string|'"\\000"'
op|')'
op|')'
newline|'\n'
name|'data'
op|'['
number|'1'
op|']'
op|'='
op|'('
string|'"FLAPON\\r\\n\\r\\n"'
op|','
name|'flap'
op|'('
number|'1'
op|','
string|'"\\000\\000\\000\\001\\000\\001\\000\\004ooga"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_signon localhost 9999 ooga 0x100000 english \\"penguin 0.1\\"\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_add_buddy test\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_init_done\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'5'
op|','
string|'"\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'5'
op|','
string|'"\\000"'
op|')'
op|','
comment|'#flap(5,"\\000"),\\'
nl|'\n'
comment|'#flap(5,"\\000"),\\'
nl|'\n'
comment|'#flap(5,"\\000"),\\'
nl|'\n'
name|'flap'
op|'('
number|'5'
op|','
string|'"\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'5'
op|','
string|'"\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'5'
op|','
string|'"\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'5'
op|','
string|'"\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'5'
op|','
string|'"\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'5'
op|','
string|'"\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'5'
op|','
string|'"\\000"'
op|')'
op|','
comment|'#flap(5,"\\000"),\\'
nl|'\n'
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_chat_accept 0\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_chat_send 0 \\"hi test\\"\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'5'
op|','
string|'"\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_chat_leave 0\\000"'
op|')'
op|')'
newline|'\n'
name|'strings'
op|'='
name|'range'
op|'('
name|'USERS'
op|')'
newline|'\n'
name|'for'
name|'i'
name|'in'
name|'strings'
op|':'
newline|'\n'
indent|'            '
name|'strings'
op|'['
name|'i'
op|']'
op|'='
name|'StringIOWithoutClosing'
op|'('
op|')'
newline|'\n'
dedent|''
name|'fac'
op|'='
name|'toc'
op|'.'
name|'TOCFactory'
op|'('
op|')'
newline|'\n'
name|'dummy'
op|'='
name|'range'
op|'('
name|'USERS'
op|')'
newline|'\n'
name|'for'
name|'i'
name|'in'
name|'dummy'
op|':'
newline|'\n'
indent|'            '
name|'dummy'
op|'['
name|'i'
op|']'
op|'='
name|'DummyTOC'
op|'('
op|')'
newline|'\n'
name|'dummy'
op|'['
name|'i'
op|']'
op|'.'
name|'factory'
op|'='
name|'fac'
newline|'\n'
name|'dummy'
op|'['
name|'i'
op|']'
op|'.'
name|'makeConnection'
op|'('
name|'protocol'
op|'.'
name|'FileWrapper'
op|'('
name|'strings'
op|'['
name|'i'
op|']'
op|')'
op|')'
newline|'\n'
dedent|''
name|'while'
name|'sum'
op|'('
name|'map'
op|'('
name|'lambda'
name|'x'
op|':'
name|'x'
op|'=='
op|'('
op|')'
op|','
name|'data'
op|')'
op|')'
op|'!='
name|'USERS'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'i'
name|'in'
name|'range'
op|'('
name|'USERS'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'d'
op|'='
name|'data'
op|'['
name|'i'
op|']'
newline|'\n'
name|'if'
name|'len'
op|'('
name|'d'
op|')'
op|'>'
number|'0'
op|':'
newline|'\n'
indent|'                    '
name|'k'
op|','
name|'data'
op|'['
name|'i'
op|']'
op|'='
name|'d'
op|'['
number|'0'
op|']'
op|','
name|'d'
op|'['
number|'1'
op|':'
op|']'
newline|'\n'
name|'for'
name|'j'
name|'in'
name|'k'
op|':'
newline|'\n'
indent|'                        '
name|'dummy'
op|'['
name|'i'
op|']'
op|'.'
name|'dataReceived'
op|'('
name|'j'
op|')'
comment|'# test by doing a character at a time'
newline|'\n'
dedent|''
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                    '
name|'dummy'
op|'['
name|'i'
op|']'
op|'.'
name|'connectionLost'
op|'('
name|'failure'
op|'.'
name|'Failure'
op|'('
name|'main'
op|'.'
name|'CONNECTION_DONE'
op|')'
op|')'
newline|'\n'
dedent|''
dedent|''
dedent|''
name|'values'
op|'='
name|'range'
op|'('
name|'USERS'
op|')'
newline|'\n'
name|'for'
name|'i'
name|'in'
name|'values'
op|':'
newline|'\n'
indent|'            '
name|'values'
op|'['
name|'i'
op|']'
op|'='
name|'strings'
op|'['
name|'i'
op|']'
op|'.'
name|'getvalue'
op|'('
op|')'
newline|'\n'
dedent|''
name|'flaps'
op|'='
name|'map'
op|'('
name|'lambda'
name|'x'
op|':'
op|'['
op|']'
op|','
name|'range'
op|'('
name|'USERS'
op|')'
op|')'
newline|'\n'
name|'for'
name|'value'
name|'in'
name|'values'
op|':'
newline|'\n'
indent|'            '
name|'i'
op|'='
name|'values'
op|'.'
name|'index'
op|'('
name|'value'
op|')'
newline|'\n'
name|'f'
op|','
name|'value'
op|'='
name|'readFlap'
op|'('
name|'value'
op|')'
newline|'\n'
name|'while'
name|'f'
op|':'
newline|'\n'
indent|'                '
name|'flaps'
op|'['
name|'i'
op|']'
op|'.'
name|'append'
op|'('
name|'f'
op|')'
newline|'\n'
name|'f'
op|','
name|'value'
op|'='
name|'readFlap'
op|'('
name|'value'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'ts'
op|'='
name|'range'
op|'('
name|'USERS'
op|')'
newline|'\n'
name|'for'
name|'t'
name|'in'
name|'ts'
op|':'
newline|'\n'
indent|'            '
name|'ts'
op|'['
name|'t'
op|']'
op|'='
name|'dummy'
op|'['
name|'t'
op|']'
op|'.'
name|'signontime'
newline|'\n'
dedent|''
name|'shouldequal'
op|'='
name|'range'
op|'('
name|'USERS'
op|')'
newline|'\n'
name|'shouldequal'
op|'['
number|'0'
op|']'
op|'='
op|'['
op|'['
number|'1'
op|','
string|'"\\000\\000\\000\\001"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"SIGN_ON:TOC1.0\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"NICK:test\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"CONFIG:\\00"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"UPDATE_BUDDY:test:T:0:%s:0: O\\000"'
op|'%'
name|'ts'
op|'['
number|'0'
op|']'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"IM_IN:test:F:hi\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"ERROR:901:test2\\000"'
op|']'
op|','
comment|'#[2,"UPDATE_BUDDY:test:T:0:%s:0: O\\000"%ts[0]],\\'
nl|'\n'
op|'['
number|'2'
op|','
string|'"UPDATE_BUDDY:test:T:0:%s:0: OU\\000"'
op|'%'
name|'ts'
op|'['
number|'0'
op|']'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"UPDATE_BUDDY:test:T:0:%s:10: OU\\000"'
op|'%'
name|'ts'
op|'['
number|'0'
op|']'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"UPDATE_BUDDY:test:T:0:%s:0: OU\\000"'
op|'%'
name|'ts'
op|'['
number|'0'
op|']'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"UPDATE_BUDDY:test:T:0:%s:0: O\\000"'
op|'%'
name|'ts'
op|'['
number|'0'
op|']'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"EVILED:10:test\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"UPDATE_BUDDY:test:T:10:%s:0: O\\000"'
op|'%'
name|'ts'
op|'['
number|'0'
op|']'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"CHAT_JOIN:0:Test Chat\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"CHAT_UPDATE_BUDDY:0:T:test\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"CHAT_IN:0:test:F:hello\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"CHAT_UPDATE_BUDDY:0:T:ooga\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"CHAT_IN:0:ooga:F:hi test\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"CHAT_LEFT:0\\000"'
op|']'
op|']'
newline|'\n'
name|'shouldequal'
op|'['
number|'1'
op|']'
op|'='
op|'['
op|'['
number|'1'
op|','
string|'"\\000\\000\\000\\001"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"SIGN_ON:TOC1.0\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"NICK:ooga\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"CONFIG:\\000"'
op|']'
op|','
comment|'#[2,"UPDATE_BUDDY:test:T:0:%s:0: O\\000"%ts[0]],\\'
nl|'\n'
op|'['
number|'2'
op|','
string|'"UPDATE_BUDDY:test:T:0:%s:0: OU\\000"'
op|'%'
name|'ts'
op|'['
number|'0'
op|']'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"UPDATE_BUDDY:test:T:0:%s:10: OU\\000"'
op|'%'
name|'ts'
op|'['
number|'0'
op|']'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"UPDATE_BUDDY:test:T:0:%s:0: OU\\000"'
op|'%'
name|'ts'
op|'['
number|'0'
op|']'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"UPDATE_BUDDY:test:T:0:%s:0: O\\000"'
op|'%'
name|'ts'
op|'['
number|'0'
op|']'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"UPDATE_BUDDY:test:T:10:%s:0: O\\000"'
op|'%'
name|'ts'
op|'['
number|'0'
op|']'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"CHAT_INVITE:Test Chat:0:test:come\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"CHAT_JOIN:0:Test Chat\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"CHAT_UPDATE_BUDDY:0:T:test:ooga\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"CHAT_IN:0:ooga:F:hi test\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"CHAT_IN:0:test:T:boo ga\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"CHAT_UPDATE_BUDDY:0:F:test\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"CHAT_LEFT:0\\000"'
op|']'
op|']'
newline|'\n'
name|'if'
name|'flaps'
op|'!='
name|'shouldequal'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'i'
name|'in'
name|'range'
op|'('
name|'len'
op|'('
name|'shouldequal'
op|')'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'for'
name|'j'
name|'in'
name|'range'
op|'('
name|'len'
op|'('
name|'shouldequal'
op|'['
name|'i'
op|']'
op|')'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'if'
name|'shouldequal'
op|'['
name|'i'
op|']'
op|'['
name|'j'
op|']'
op|'!='
name|'flaps'
op|'['
name|'i'
op|']'
op|'['
name|'j'
op|']'
op|':'
newline|'\n'
indent|'                        '
name|'raise'
name|'AssertionError'
op|'('
string|'"GeneralTest Failed!\\nUser %s Line %s\\nactual:%s\\nshould be:%s"'
op|'%'
op|'('
name|'i'
op|','
name|'j'
op|','
name|'flaps'
op|'['
name|'i'
op|']'
op|'['
name|'j'
op|']'
op|','
name|'shouldequal'
op|'['
name|'i'
op|']'
op|'['
name|'j'
op|']'
op|')'
op|')'
newline|'\n'
dedent|''
dedent|''
dedent|''
name|'raise'
name|'AssertionError'
op|'('
string|'"GeneralTest Failed with incorrect lengths!"'
op|')'
newline|'\n'
DECL|class|TOCMultiPacketTestCase
dedent|''
dedent|''
dedent|''
name|'class'
name|'TOCMultiPacketTestCase'
op|'('
name|'unittest'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""\n    i saw this problem when using GAIM.  It only read the flaps onces per dataReceived, and would basically block if it ever received two packets together in one dataReceived.  this tests for that occurance.\n    """'
newline|'\n'
DECL|member|testTOC
name|'def'
name|'testTOC'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'runTest'
op|'('
op|')'
newline|'\n'
DECL|member|runTest
dedent|''
name|'def'
name|'runTest'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'packets'
op|'='
op|'['
string|'"FLAPON\\r\\n\\r\\n"'
op|','
name|'flap'
op|'('
number|'1'
op|','
string|'"\\000\\000\\000\\001\\000\\001\\000\\004test"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_signon null 9999 test 0x100000 english \\"penguin 0.1\\"\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_init_done\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_send_im test hi\\000"'
op|')'
op|']'
newline|'\n'
name|'shouldbe'
op|'='
op|'['
op|'['
number|'1'
op|','
string|'"\\000\\000\\000\\001"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"SIGN_ON:TOC1.0\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"NICK:test\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"CONFIG:\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"IM_IN:test:F:hi\\000"'
op|']'
op|']'
newline|'\n'
name|'data'
op|'='
string|'""'
newline|'\n'
name|'for'
name|'i'
name|'in'
name|'packets'
op|':'
newline|'\n'
indent|'            '
name|'data'
op|'='
name|'data'
op|'+'
name|'i'
newline|'\n'
dedent|''
name|'s'
op|'='
name|'StringIOWithoutClosing'
op|'('
op|')'
newline|'\n'
name|'d'
op|'='
name|'DummyTOC'
op|'('
op|')'
newline|'\n'
name|'fac'
op|'='
name|'toc'
op|'.'
name|'TOCFactory'
op|'('
op|')'
newline|'\n'
name|'d'
op|'.'
name|'factory'
op|'='
name|'fac'
newline|'\n'
name|'d'
op|'.'
name|'makeConnection'
op|'('
name|'protocol'
op|'.'
name|'FileWrapper'
op|'('
name|'s'
op|')'
op|')'
newline|'\n'
name|'d'
op|'.'
name|'dataReceived'
op|'('
name|'data'
op|')'
newline|'\n'
name|'d'
op|'.'
name|'connectionLost'
op|'('
name|'failure'
op|'.'
name|'Failure'
op|'('
name|'main'
op|'.'
name|'CONNECTION_DONE'
op|')'
op|')'
newline|'\n'
name|'value'
op|'='
name|'s'
op|'.'
name|'getvalue'
op|'('
op|')'
newline|'\n'
name|'flaps'
op|'='
op|'['
op|']'
newline|'\n'
name|'f'
op|','
name|'value'
op|'='
name|'readFlap'
op|'('
name|'value'
op|')'
newline|'\n'
name|'while'
name|'f'
op|':'
newline|'\n'
indent|'            '
name|'flaps'
op|'.'
name|'append'
op|'('
name|'f'
op|')'
newline|'\n'
name|'f'
op|','
name|'value'
op|'='
name|'readFlap'
op|'('
name|'value'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'flaps'
op|'!='
name|'shouldbe'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'i'
name|'in'
name|'range'
op|'('
name|'len'
op|'('
name|'flaps'
op|')'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'if'
name|'flaps'
op|'['
name|'i'
op|']'
op|'!='
name|'shouldbe'
op|'['
name|'i'
op|']'
op|':'
name|'raise'
name|'AssertionError'
op|'('
string|'"MultiPacketTest Failed!\\nactual:%s\\nshould be:%s"'
op|'%'
op|'('
name|'flaps'
op|'['
name|'i'
op|']'
op|','
name|'shouldbe'
op|'['
name|'i'
op|']'
op|')'
op|')'
newline|'\n'
dedent|''
name|'raise'
name|'AssertionError'
op|'('
string|'"MultiPacketTest Failed with incorrect length!, printing both lists\\nactual:%s\\nshould be:%s"'
op|'%'
op|'('
name|'flaps'
op|','
name|'shouldbe'
op|')'
op|')'
newline|'\n'
DECL|class|TOCSavedValuesTestCase
dedent|''
dedent|''
dedent|''
name|'class'
name|'TOCSavedValuesTestCase'
op|'('
name|'unittest'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
DECL|member|testTOC
indent|'    '
name|'def'
name|'testTOC'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'runTest'
op|'('
op|')'
newline|'\n'
DECL|member|runTest
dedent|''
name|'def'
name|'runTest'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'password1'
op|'='
name|'toc'
op|'.'
name|'roast'
op|'('
string|'"test pass"'
op|')'
newline|'\n'
name|'password2'
op|'='
name|'toc'
op|'.'
name|'roast'
op|'('
string|'"pass test"'
op|')'
newline|'\n'
name|'beforesend'
op|'='
op|'['
string|'"FLAPON\\r\\n\\r\\n"'
op|','
name|'flap'
op|'('
number|'1'
op|','
string|'"\\000\\000\\000\\001\\000\\001\\000\\004test"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_signon localhost 9999 test %s english \\"penguin 0.1\\"\\000"'
op|'%'
name|'password1'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_init_done\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_set_config \\"{m 4}\\"\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_format_nickname BOOGA\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_format_nickname \\"T E S T\\"\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_change_passwd \\"testpass\\" \\"pass test\\"\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_change_passwd \\"test pass\\" \\"pass test\\"\\000"'
op|')'
op|']'
newline|'\n'
name|'beforeexpect'
op|'='
op|'['
op|'['
number|'1'
op|','
string|'"\\000\\000\\000\\001"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"SIGN_ON:TOC1.0\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"NICK:test\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"CONFIG:\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"ERROR:911\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"ADMIN_NICK_STATUS:0\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"ERROR:911\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"ADMIN_PASSWD_STATUS:0\\000"'
op|']'
op|']'
newline|'\n'
name|'badpasssend'
op|'='
op|'['
string|'"FLAPON\\r\\n\\r\\n"'
op|','
name|'flap'
op|'('
number|'1'
op|','
string|'"\\000\\000\\000\\001\\000\\001\\000\\004test"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_signon localhost 9999 test 0x1000 english \\"penguin 0.1\\"\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_init_done"'
op|')'
op|']'
newline|'\n'
name|'badpassexpect'
op|'='
op|'['
op|'['
number|'1'
op|','
string|'"\\000\\00\\000\\001"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"ERROR:980\\000"'
op|']'
op|']'
newline|'\n'
name|'goodpasssend'
op|'='
op|'['
string|'"FLAPON\\r\\n\\r\\n"'
op|','
name|'flap'
op|'('
number|'1'
op|','
string|'"\\000\\000\\000\\001\\000\\001\\000\\004test"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_signon localhost 9999 test %s english \\"penguin 0.1\\"\\000"'
op|'%'
name|'password2'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_init_done"'
op|')'
op|']'
newline|'\n'
name|'goodpassexpect'
op|'='
op|'['
op|'['
number|'1'
op|','
string|'"\\000\\000\\000\\001"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"SIGN_ON:TOC1.0\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"NICK:T E S T\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"CONFIG:{m 4}\\000"'
op|']'
op|']'
newline|'\n'
name|'fac'
op|'='
name|'toc'
op|'.'
name|'TOCFactory'
op|'('
op|')'
newline|'\n'
name|'d'
op|'='
name|'DummyTOC'
op|'('
op|')'
newline|'\n'
name|'d'
op|'.'
name|'factory'
op|'='
name|'fac'
newline|'\n'
name|'s'
op|'='
name|'StringIOWithoutClosing'
op|'('
op|')'
newline|'\n'
name|'d'
op|'.'
name|'makeConnection'
op|'('
name|'protocol'
op|'.'
name|'FileWrapper'
op|'('
name|'s'
op|')'
op|')'
newline|'\n'
name|'for'
name|'i'
name|'in'
name|'beforesend'
op|':'
newline|'\n'
indent|'            '
name|'d'
op|'.'
name|'dataReceived'
op|'('
name|'i'
op|')'
newline|'\n'
dedent|''
name|'d'
op|'.'
name|'connectionLost'
op|'('
name|'failure'
op|'.'
name|'Failure'
op|'('
name|'main'
op|'.'
name|'CONNECTION_DONE'
op|')'
op|')'
newline|'\n'
name|'v'
op|'='
name|'s'
op|'.'
name|'getvalue'
op|'('
op|')'
newline|'\n'
name|'flaps'
op|'='
op|'['
op|']'
newline|'\n'
name|'f'
op|','
name|'v'
op|'='
name|'readFlap'
op|'('
name|'v'
op|')'
newline|'\n'
name|'while'
name|'f'
op|':'
newline|'\n'
indent|'            '
name|'flaps'
op|'.'
name|'append'
op|'('
name|'f'
op|')'
newline|'\n'
name|'f'
op|','
name|'v'
op|'='
name|'readFlap'
op|'('
name|'v'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'flaps'
op|'!='
name|'beforeexpect'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'i'
name|'in'
name|'range'
op|'('
name|'len'
op|'('
name|'flaps'
op|')'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'if'
name|'flaps'
op|'['
name|'i'
op|']'
op|'!='
name|'beforeexpect'
op|'['
name|'i'
op|']'
op|':'
newline|'\n'
indent|'                    '
name|'raise'
name|'AssertionError'
op|'('
string|'"SavedValuesTest Before Failed!\\nactual:%s\\nshould be:%s"'
op|'%'
op|'('
name|'flaps'
op|'['
name|'i'
op|']'
op|','
name|'beforeexpect'
op|'['
name|'i'
op|']'
op|')'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'raise'
name|'AssertionError'
op|'('
string|'"SavedValuesTest Before Failed with incorrect length!\\nactual:%s\\nshould be:%s"'
op|'%'
op|'('
name|'flaps'
op|','
name|'beforeexpect'
op|')'
op|')'
newline|'\n'
dedent|''
name|'d'
op|'='
name|'DummyTOC'
op|'('
op|')'
newline|'\n'
name|'d'
op|'.'
name|'factory'
op|'='
name|'fac'
newline|'\n'
name|'s'
op|'='
name|'StringIOWithoutClosing'
op|'('
op|')'
newline|'\n'
name|'d'
op|'.'
name|'makeConnection'
op|'('
name|'protocol'
op|'.'
name|'FileWrapper'
op|'('
name|'s'
op|')'
op|')'
newline|'\n'
name|'for'
name|'i'
name|'in'
name|'badpasssend'
op|':'
newline|'\n'
indent|'            '
name|'d'
op|'.'
name|'dataReceived'
op|'('
name|'i'
op|')'
newline|'\n'
dedent|''
name|'d'
op|'.'
name|'connectionLost'
op|'('
name|'failure'
op|'.'
name|'Failure'
op|'('
name|'main'
op|'.'
name|'CONNECTION_DONE'
op|')'
op|')'
newline|'\n'
name|'v'
op|'='
name|'s'
op|'.'
name|'getvalue'
op|'('
op|')'
newline|'\n'
name|'flaps'
op|'='
op|'['
op|']'
newline|'\n'
name|'f'
op|','
name|'v'
op|'='
name|'readFlap'
op|'('
name|'v'
op|')'
newline|'\n'
name|'while'
name|'f'
op|':'
newline|'\n'
indent|'            '
name|'flaps'
op|'.'
name|'append'
op|'('
name|'f'
op|')'
newline|'\n'
name|'f'
op|','
name|'v'
op|'='
name|'readFlap'
op|'('
name|'v'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'flaps'
op|'!='
name|'badpassexpect'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'i'
name|'in'
name|'range'
op|'('
name|'len'
op|'('
name|'flaps'
op|')'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'if'
name|'flaps'
op|'['
name|'i'
op|']'
op|'!='
name|'badpassexpect'
op|'['
name|'i'
op|']'
op|':'
newline|'\n'
indent|'                    '
name|'raise'
name|'AssertionError'
op|'('
string|'"SavedValuesTest BadPass Failed!\\nactual:%s\\nshould be:%s"'
op|'%'
op|'('
name|'flaps'
op|'['
name|'i'
op|']'
op|','
name|'badpassexpect'
op|'['
name|'i'
op|']'
op|')'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'raise'
name|'AssertionError'
op|'('
string|'"SavedValuesTest BadPass Failed with incorrect length!\\nactual:%s\\nshould be:%s"'
op|'%'
op|'('
name|'flaps'
op|','
name|'badpassexpect'
op|')'
op|')'
newline|'\n'
dedent|''
name|'d'
op|'='
name|'DummyTOC'
op|'('
op|')'
newline|'\n'
name|'d'
op|'.'
name|'factory'
op|'='
name|'fac'
newline|'\n'
name|'s'
op|'='
name|'StringIOWithoutClosing'
op|'('
op|')'
newline|'\n'
name|'d'
op|'.'
name|'makeConnection'
op|'('
name|'protocol'
op|'.'
name|'FileWrapper'
op|'('
name|'s'
op|')'
op|')'
newline|'\n'
name|'for'
name|'i'
name|'in'
name|'goodpasssend'
op|':'
newline|'\n'
indent|'            '
name|'d'
op|'.'
name|'dataReceived'
op|'('
name|'i'
op|')'
newline|'\n'
dedent|''
name|'d'
op|'.'
name|'connectionLost'
op|'('
name|'failure'
op|'.'
name|'Failure'
op|'('
name|'main'
op|'.'
name|'CONNECTION_DONE'
op|')'
op|')'
newline|'\n'
name|'v'
op|'='
name|'s'
op|'.'
name|'getvalue'
op|'('
op|')'
newline|'\n'
name|'flaps'
op|'='
op|'['
op|']'
newline|'\n'
name|'f'
op|','
name|'v'
op|'='
name|'readFlap'
op|'('
name|'v'
op|')'
newline|'\n'
name|'while'
name|'f'
op|':'
newline|'\n'
indent|'            '
name|'flaps'
op|'.'
name|'append'
op|'('
name|'f'
op|')'
newline|'\n'
name|'f'
op|','
name|'v'
op|'='
name|'readFlap'
op|'('
name|'v'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'flaps'
op|'!='
name|'goodpassexpect'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'i'
name|'in'
name|'range'
op|'('
name|'len'
op|'('
name|'flaps'
op|')'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'if'
name|'flaps'
op|'['
name|'i'
op|']'
op|'!='
name|'goodpassexpect'
op|'['
name|'i'
op|']'
op|':'
newline|'\n'
indent|'                    '
name|'raise'
name|'AssertionError'
op|'('
string|'"SavedValuesTest GoodPass Failed!\\nactual:%s\\nshould be:%s"'
op|'%'
op|'('
name|'flaps'
op|'['
name|'i'
op|']'
op|','
name|'goodpassexpect'
op|'['
name|'i'
op|']'
op|')'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'raise'
name|'AssertionError'
op|'('
string|'"SavedValuesTest GoodPass Failed with incorrect length!\\nactual:%s\\nshould be:%s"'
op|'%'
op|'('
name|'flaps'
op|','
name|'beforeexpect'
op|')'
op|')'
newline|'\n'
DECL|class|TOCPrivacyTestCase
dedent|''
dedent|''
dedent|''
name|'class'
name|'TOCPrivacyTestCase'
op|'('
name|'unittest'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
DECL|member|runTest
indent|'    '
name|'def'
name|'runTest'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'sends'
op|'='
op|'['
string|'"FLAPON\\r\\n\\r\\n"'
op|','
name|'flap'
op|'('
number|'1'
op|','
string|'"\\000\\000\\000\\001\\000\\001\\000\\004test"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_signon localhost 9999 test 0x00 english penguin\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_init_done\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_add_deny\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_send_im test 1\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_add_deny test\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_send_im test 2\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_add_permit\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_send_im test 3\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_add_permit test\\000"'
op|')'
op|','
name|'flap'
op|'('
number|'2'
op|','
string|'"toc_send_im test 4\\000"'
op|')'
op|']'
newline|'\n'
name|'expect'
op|'='
op|'['
op|'['
number|'1'
op|','
string|'"\\000\\000\\000\\001"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"SIGN_ON:TOC1.0\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"NICK:test\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"CONFIG:\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"IM_IN:test:F:1\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"ERROR:901:test\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"ERROR:901:test\\000"'
op|']'
op|','
op|'['
number|'2'
op|','
string|'"IM_IN:test:F:4\\000"'
op|']'
op|']'
newline|'\n'
name|'d'
op|'='
name|'DummyTOC'
op|'('
op|')'
newline|'\n'
name|'d'
op|'.'
name|'factory'
op|'='
name|'toc'
op|'.'
name|'TOCFactory'
op|'('
op|')'
newline|'\n'
name|'s'
op|'='
name|'StringIOWithoutClosing'
op|'('
op|')'
newline|'\n'
name|'d'
op|'.'
name|'makeConnection'
op|'('
name|'protocol'
op|'.'
name|'FileWrapper'
op|'('
name|'s'
op|')'
op|')'
newline|'\n'
name|'for'
name|'i'
name|'in'
name|'sends'
op|':'
newline|'\n'
indent|'            '
name|'d'
op|'.'
name|'dataReceived'
op|'('
name|'i'
op|')'
newline|'\n'
dedent|''
name|'d'
op|'.'
name|'connectionLost'
op|'('
name|'failure'
op|'.'
name|'Failure'
op|'('
name|'main'
op|'.'
name|'CONNECTION_DONE'
op|')'
op|')'
newline|'\n'
name|'v'
op|'='
name|'s'
op|'.'
name|'getvalue'
op|'('
op|')'
newline|'\n'
name|'flaps'
op|'='
op|'['
op|']'
newline|'\n'
name|'f'
op|','
name|'v'
op|'='
name|'readFlap'
op|'('
name|'v'
op|')'
newline|'\n'
name|'while'
name|'f'
op|':'
newline|'\n'
indent|'            '
name|'flaps'
op|'.'
name|'append'
op|'('
name|'f'
op|')'
newline|'\n'
name|'f'
op|','
name|'v'
op|'='
name|'readFlap'
op|'('
name|'v'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'flaps'
op|'!='
name|'expect'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'i'
name|'in'
name|'range'
op|'('
name|'len'
op|'('
name|'flaps'
op|')'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'if'
name|'flaps'
op|'['
name|'i'
op|']'
op|'!='
name|'expect'
op|'['
name|'i'
op|']'
op|':'
newline|'\n'
indent|'                    '
name|'raise'
name|'AssertionError'
op|'('
string|'"PrivacyTest Before Failed!\\nactual:%s\\nshould be:%s"'
op|'%'
op|'('
name|'flaps'
op|'['
name|'i'
op|']'
op|','
name|'expect'
op|'['
name|'i'
op|']'
op|')'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'raise'
name|'AssertionError'
op|'('
string|'"PrivacyTest Before Failed with incorrect length!\\nactual:%s\\nshould be:%s"'
op|'%'
op|'('
name|'flaps'
op|','
name|'expect'
op|')'
op|')'
newline|'\n'
DECL|variable|testCases
dedent|''
dedent|''
dedent|''
name|'testCases'
op|'='
op|'['
name|'TOCGeneralTestCase'
op|','
name|'TOCMultiPacketTestCase'
op|','
name|'TOCSavedValuesTestCase'
op|','
name|'TOCPrivacyTestCase'
op|']'
newline|'\n'
nl|'\n'
endmarker|''
end_unit
