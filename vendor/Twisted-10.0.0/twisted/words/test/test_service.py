begin_unit
comment|'# Copyright (c) 2009 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
string|'"""\nTests for L{twisted.words.service}.\n"""'
newline|'\n'
nl|'\n'
name|'import'
name|'time'
newline|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'trial'
name|'import'
name|'unittest'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'test'
name|'import'
name|'proto_helpers'
newline|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'cred'
name|'import'
name|'portal'
op|','
name|'credentials'
op|','
name|'checkers'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'words'
name|'import'
name|'ewords'
op|','
name|'service'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'words'
op|'.'
name|'protocols'
name|'import'
name|'irc'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'spread'
name|'import'
name|'pb'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
op|'.'
name|'defer'
name|'import'
name|'Deferred'
op|','
name|'DeferredList'
op|','
name|'maybeDeferred'
op|','
name|'succeed'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
op|'.'
name|'defer'
name|'import'
name|'deferredGenerator'
name|'as'
name|'dG'
op|','
name|'waitForDeferred'
name|'as'
name|'wFD'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'address'
op|','
name|'reactor'
newline|'\n'
nl|'\n'
DECL|class|RealmTestCase
name|'class'
name|'RealmTestCase'
op|'('
name|'unittest'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
DECL|member|_entityCreationTest
indent|'    '
name|'def'
name|'_entityCreationTest'
op|'('
name|'self'
op|','
name|'kind'
op|')'
op|':'
newline|'\n'
comment|'# Kind is "user" or "group"'
nl|'\n'
indent|'        '
name|'realm'
op|'='
name|'service'
op|'.'
name|'InMemoryWordsRealm'
op|'('
string|'"realmname"'
op|')'
newline|'\n'
nl|'\n'
name|'name'
op|'='
string|"u'test'"
op|'+'
name|'kind'
op|'.'
name|'lower'
op|'('
op|')'
newline|'\n'
name|'create'
op|'='
name|'getattr'
op|'('
name|'realm'
op|','
string|"'create'"
op|'+'
name|'kind'
op|'.'
name|'title'
op|'('
op|')'
op|')'
newline|'\n'
name|'get'
op|'='
name|'getattr'
op|'('
name|'realm'
op|','
string|"'get'"
op|'+'
name|'kind'
op|'.'
name|'title'
op|'('
op|')'
op|')'
newline|'\n'
name|'flag'
op|'='
string|"'create'"
op|'+'
name|'kind'
op|'.'
name|'title'
op|'('
op|')'
op|'+'
string|"'OnRequest'"
newline|'\n'
name|'dupExc'
op|'='
name|'getattr'
op|'('
name|'ewords'
op|','
string|"'Duplicate'"
op|'+'
name|'kind'
op|'.'
name|'title'
op|'('
op|')'
op|')'
newline|'\n'
name|'noSuchExc'
op|'='
name|'getattr'
op|'('
name|'ewords'
op|','
string|"'NoSuch'"
op|'+'
name|'kind'
op|'.'
name|'title'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
comment|'# Creating should succeed'
nl|'\n'
name|'d'
op|'='
name|'wFD'
op|'('
name|'create'
op|'('
name|'name'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'d'
newline|'\n'
name|'p'
op|'='
name|'d'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'p'
op|'.'
name|'name'
op|','
name|'name'
op|')'
newline|'\n'
nl|'\n'
comment|'# Creating the same user again should not'
nl|'\n'
name|'d'
op|'='
name|'wFD'
op|'('
name|'create'
op|'('
name|'name'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'d'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'dupExc'
op|','
name|'d'
op|'.'
name|'getResult'
op|')'
newline|'\n'
nl|'\n'
comment|'# Getting a non-existent user should succeed if createUserOnRequest is True'
nl|'\n'
name|'setattr'
op|'('
name|'realm'
op|','
name|'flag'
op|','
name|'True'
op|')'
newline|'\n'
name|'d'
op|'='
name|'wFD'
op|'('
name|'get'
op|'('
string|'u"new"'
op|'+'
name|'kind'
op|'.'
name|'lower'
op|'('
op|')'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'d'
newline|'\n'
name|'p'
op|'='
name|'d'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'p'
op|'.'
name|'name'
op|','
string|'"new"'
op|'+'
name|'kind'
op|'.'
name|'lower'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
comment|'# Getting that user again should return the same object'
nl|'\n'
name|'d'
op|'='
name|'wFD'
op|'('
name|'get'
op|'('
string|'u"new"'
op|'+'
name|'kind'
op|'.'
name|'lower'
op|'('
op|')'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'d'
newline|'\n'
name|'newp'
op|'='
name|'d'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIdentical'
op|'('
name|'p'
op|','
name|'newp'
op|')'
newline|'\n'
nl|'\n'
comment|'# Getting a non-existent user should fail if createUserOnRequest is False'
nl|'\n'
name|'setattr'
op|'('
name|'realm'
op|','
name|'flag'
op|','
name|'False'
op|')'
newline|'\n'
name|'d'
op|'='
name|'wFD'
op|'('
name|'get'
op|'('
string|'u"another"'
op|'+'
name|'kind'
op|'.'
name|'lower'
op|'('
op|')'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'d'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'noSuchExc'
op|','
name|'d'
op|'.'
name|'getResult'
op|')'
newline|'\n'
DECL|variable|_entityCreationTest
dedent|''
name|'_entityCreationTest'
op|'='
name|'dG'
op|'('
name|'_entityCreationTest'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testUserCreation
name|'def'
name|'testUserCreation'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'_entityCreationTest'
op|'('
string|'"User"'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testGroupCreation
dedent|''
name|'def'
name|'testGroupCreation'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'_entityCreationTest'
op|'('
string|'"Group"'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testUserRetrieval
dedent|''
name|'def'
name|'testUserRetrieval'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'realm'
op|'='
name|'service'
op|'.'
name|'InMemoryWordsRealm'
op|'('
string|'"realmname"'
op|')'
newline|'\n'
nl|'\n'
comment|'# Make a user to play around with'
nl|'\n'
name|'d'
op|'='
name|'wFD'
op|'('
name|'realm'
op|'.'
name|'createUser'
op|'('
string|'u"testuser"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'d'
newline|'\n'
name|'user'
op|'='
name|'d'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
comment|'# Make sure getting the user returns the same object'
nl|'\n'
name|'d'
op|'='
name|'wFD'
op|'('
name|'realm'
op|'.'
name|'getUser'
op|'('
string|'u"testuser"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'d'
newline|'\n'
name|'retrieved'
op|'='
name|'d'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIdentical'
op|'('
name|'user'
op|','
name|'retrieved'
op|')'
newline|'\n'
nl|'\n'
comment|'# Make sure looking up the user also returns the same object'
nl|'\n'
name|'d'
op|'='
name|'wFD'
op|'('
name|'realm'
op|'.'
name|'lookupUser'
op|'('
string|'u"testuser"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'d'
newline|'\n'
name|'lookedUp'
op|'='
name|'d'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIdentical'
op|'('
name|'retrieved'
op|','
name|'lookedUp'
op|')'
newline|'\n'
nl|'\n'
comment|'# Make sure looking up a user who does not exist fails'
nl|'\n'
name|'d'
op|'='
name|'wFD'
op|'('
name|'realm'
op|'.'
name|'lookupUser'
op|'('
string|'u"nosuchuser"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'d'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'ewords'
op|'.'
name|'NoSuchUser'
op|','
name|'d'
op|'.'
name|'getResult'
op|')'
newline|'\n'
DECL|variable|testUserRetrieval
dedent|''
name|'testUserRetrieval'
op|'='
name|'dG'
op|'('
name|'testUserRetrieval'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testUserAddition
name|'def'
name|'testUserAddition'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'realm'
op|'='
name|'service'
op|'.'
name|'InMemoryWordsRealm'
op|'('
string|'"realmname"'
op|')'
newline|'\n'
nl|'\n'
comment|'# Create and manually add a user to the realm'
nl|'\n'
name|'p'
op|'='
name|'service'
op|'.'
name|'User'
op|'('
string|'"testuser"'
op|')'
newline|'\n'
name|'d'
op|'='
name|'wFD'
op|'('
name|'realm'
op|'.'
name|'addUser'
op|'('
name|'p'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'d'
newline|'\n'
name|'user'
op|'='
name|'d'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIdentical'
op|'('
name|'p'
op|','
name|'user'
op|')'
newline|'\n'
nl|'\n'
comment|'# Make sure getting that user returns the same object'
nl|'\n'
name|'d'
op|'='
name|'wFD'
op|'('
name|'realm'
op|'.'
name|'getUser'
op|'('
string|'u"testuser"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'d'
newline|'\n'
name|'retrieved'
op|'='
name|'d'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIdentical'
op|'('
name|'user'
op|','
name|'retrieved'
op|')'
newline|'\n'
nl|'\n'
comment|'# Make sure looking up that user returns the same object'
nl|'\n'
name|'d'
op|'='
name|'wFD'
op|'('
name|'realm'
op|'.'
name|'lookupUser'
op|'('
string|'u"testuser"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'d'
newline|'\n'
name|'lookedUp'
op|'='
name|'d'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIdentical'
op|'('
name|'retrieved'
op|','
name|'lookedUp'
op|')'
newline|'\n'
DECL|variable|testUserAddition
dedent|''
name|'testUserAddition'
op|'='
name|'dG'
op|'('
name|'testUserAddition'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testGroupRetrieval
name|'def'
name|'testGroupRetrieval'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'realm'
op|'='
name|'service'
op|'.'
name|'InMemoryWordsRealm'
op|'('
string|'"realmname"'
op|')'
newline|'\n'
nl|'\n'
name|'d'
op|'='
name|'wFD'
op|'('
name|'realm'
op|'.'
name|'createGroup'
op|'('
string|'u"testgroup"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'d'
newline|'\n'
name|'group'
op|'='
name|'d'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'d'
op|'='
name|'wFD'
op|'('
name|'realm'
op|'.'
name|'getGroup'
op|'('
string|'u"testgroup"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'d'
newline|'\n'
name|'retrieved'
op|'='
name|'d'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertIdentical'
op|'('
name|'group'
op|','
name|'retrieved'
op|')'
newline|'\n'
nl|'\n'
name|'d'
op|'='
name|'wFD'
op|'('
name|'realm'
op|'.'
name|'getGroup'
op|'('
string|'u"nosuchgroup"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'d'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'ewords'
op|'.'
name|'NoSuchGroup'
op|','
name|'d'
op|'.'
name|'getResult'
op|')'
newline|'\n'
DECL|variable|testGroupRetrieval
dedent|''
name|'testGroupRetrieval'
op|'='
name|'dG'
op|'('
name|'testGroupRetrieval'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testGroupAddition
name|'def'
name|'testGroupAddition'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'realm'
op|'='
name|'service'
op|'.'
name|'InMemoryWordsRealm'
op|'('
string|'"realmname"'
op|')'
newline|'\n'
nl|'\n'
name|'p'
op|'='
name|'service'
op|'.'
name|'Group'
op|'('
string|'"testgroup"'
op|')'
newline|'\n'
name|'d'
op|'='
name|'wFD'
op|'('
name|'realm'
op|'.'
name|'addGroup'
op|'('
name|'p'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'d'
newline|'\n'
name|'d'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'d'
op|'='
name|'wFD'
op|'('
name|'realm'
op|'.'
name|'getGroup'
op|'('
string|'u"testGroup"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'d'
newline|'\n'
name|'group'
op|'='
name|'d'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertIdentical'
op|'('
name|'p'
op|','
name|'group'
op|')'
newline|'\n'
DECL|variable|testGroupAddition
dedent|''
name|'testGroupAddition'
op|'='
name|'dG'
op|'('
name|'testGroupAddition'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testGroupUsernameCollision
name|'def'
name|'testGroupUsernameCollision'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        Try creating a group with the same name as an existing user and\n        assert that it succeeds, since users and groups should not be in the\n        same namespace and collisions should be impossible.\n        """'
newline|'\n'
name|'realm'
op|'='
name|'service'
op|'.'
name|'InMemoryWordsRealm'
op|'('
string|'"realmname"'
op|')'
newline|'\n'
nl|'\n'
name|'d'
op|'='
name|'wFD'
op|'('
name|'realm'
op|'.'
name|'createUser'
op|'('
string|'u"test"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'d'
newline|'\n'
name|'user'
op|'='
name|'d'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'d'
op|'='
name|'wFD'
op|'('
name|'realm'
op|'.'
name|'createGroup'
op|'('
string|'u"test"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'d'
newline|'\n'
name|'group'
op|'='
name|'d'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
DECL|variable|testGroupUsernameCollision
dedent|''
name|'testGroupUsernameCollision'
op|'='
name|'dG'
op|'('
name|'testGroupUsernameCollision'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testEnumeration
name|'def'
name|'testEnumeration'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'realm'
op|'='
name|'service'
op|'.'
name|'InMemoryWordsRealm'
op|'('
string|'"realmname"'
op|')'
newline|'\n'
name|'d'
op|'='
name|'wFD'
op|'('
name|'realm'
op|'.'
name|'createGroup'
op|'('
string|'u"groupone"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'d'
newline|'\n'
name|'d'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'d'
op|'='
name|'wFD'
op|'('
name|'realm'
op|'.'
name|'createGroup'
op|'('
string|'u"grouptwo"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'d'
newline|'\n'
name|'d'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'groups'
op|'='
name|'wFD'
op|'('
name|'realm'
op|'.'
name|'itergroups'
op|'('
op|')'
op|')'
newline|'\n'
name|'yield'
name|'groups'
newline|'\n'
name|'groups'
op|'='
name|'groups'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'n'
op|'='
op|'['
name|'g'
op|'.'
name|'name'
name|'for'
name|'g'
name|'in'
name|'groups'
op|']'
newline|'\n'
name|'n'
op|'.'
name|'sort'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'n'
op|','
op|'['
string|'"groupone"'
op|','
string|'"grouptwo"'
op|']'
op|')'
newline|'\n'
DECL|variable|testEnumeration
dedent|''
name|'testEnumeration'
op|'='
name|'dG'
op|'('
name|'testEnumeration'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TestGroup
dedent|''
name|'class'
name|'TestGroup'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'name'
op|','
name|'size'
op|','
name|'topic'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'name'
op|'='
name|'name'
newline|'\n'
name|'self'
op|'.'
name|'size'
op|'='
name|'lambda'
op|':'
name|'size'
newline|'\n'
name|'self'
op|'.'
name|'meta'
op|'='
op|'{'
string|"'topic'"
op|':'
name|'topic'
op|'}'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TestUser
dedent|''
dedent|''
name|'class'
name|'TestUser'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'name'
op|','
name|'groups'
op|','
name|'signOn'
op|','
name|'lastMessage'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'name'
op|'='
name|'name'
newline|'\n'
name|'self'
op|'.'
name|'itergroups'
op|'='
name|'lambda'
op|':'
name|'iter'
op|'('
op|'['
name|'TestGroup'
op|'('
name|'g'
op|','
number|'3'
op|','
string|"'Hello'"
op|')'
name|'for'
name|'g'
name|'in'
name|'groups'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'signOn'
op|'='
name|'signOn'
newline|'\n'
name|'self'
op|'.'
name|'lastMessage'
op|'='
name|'lastMessage'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TestPortal
dedent|''
dedent|''
name|'class'
name|'TestPortal'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'logins'
op|'='
op|'['
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|login
dedent|''
name|'def'
name|'login'
op|'('
name|'self'
op|','
name|'credentials'
op|','
name|'mind'
op|','
op|'*'
name|'interfaces'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'d'
op|'='
name|'Deferred'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'logins'
op|'.'
name|'append'
op|'('
op|'('
name|'credentials'
op|','
name|'mind'
op|','
name|'interfaces'
op|','
name|'d'
op|')'
op|')'
newline|'\n'
name|'return'
name|'d'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TestCaseUserAgg
dedent|''
dedent|''
name|'class'
name|'TestCaseUserAgg'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'user'
op|','
name|'realm'
op|','
name|'factory'
op|','
name|'address'
op|'='
name|'address'
op|'.'
name|'IPv4Address'
op|'('
string|"'TCP'"
op|','
string|"'127.0.0.1'"
op|','
number|'54321'
op|')'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'user'
op|'='
name|'user'
newline|'\n'
name|'self'
op|'.'
name|'transport'
op|'='
name|'proto_helpers'
op|'.'
name|'StringTransportWithDisconnection'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'protocol'
op|'='
name|'factory'
op|'.'
name|'buildProtocol'
op|'('
name|'address'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'transport'
op|'.'
name|'protocol'
op|'='
name|'self'
op|'.'
name|'protocol'
newline|'\n'
name|'self'
op|'.'
name|'user'
op|'.'
name|'mind'
op|'='
name|'self'
op|'.'
name|'protocol'
newline|'\n'
name|'self'
op|'.'
name|'protocol'
op|'.'
name|'makeConnection'
op|'('
name|'self'
op|'.'
name|'transport'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|write
dedent|''
name|'def'
name|'write'
op|'('
name|'self'
op|','
name|'stuff'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'isinstance'
op|'('
name|'stuff'
op|','
name|'unicode'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'stuff'
op|'='
name|'stuff'
op|'.'
name|'encode'
op|'('
string|"'utf-8'"
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'protocol'
op|'.'
name|'dataReceived'
op|'('
name|'stuff'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|IRCProtocolTestCase
dedent|''
dedent|''
name|'class'
name|'IRCProtocolTestCase'
op|'('
name|'unittest'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
DECL|variable|STATIC_USERS
indent|'    '
name|'STATIC_USERS'
op|'='
op|'['
nl|'\n'
string|"u'useruser'"
op|','
string|"u'otheruser'"
op|','
string|"u'someguy'"
op|','
string|"u'firstuser'"
op|','
string|"u'username'"
op|','
nl|'\n'
string|"u'userone'"
op|','
string|"u'usertwo'"
op|','
string|"u'userthree'"
op|','
string|"u'someuser'"
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|setUp
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'realm'
op|'='
name|'service'
op|'.'
name|'InMemoryWordsRealm'
op|'('
string|'"realmname"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'checker'
op|'='
name|'checkers'
op|'.'
name|'InMemoryUsernamePasswordDatabaseDontUse'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'portal'
op|'='
name|'portal'
op|'.'
name|'Portal'
op|'('
name|'self'
op|'.'
name|'realm'
op|','
op|'['
name|'self'
op|'.'
name|'checker'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'factory'
op|'='
name|'service'
op|'.'
name|'IRCFactory'
op|'('
name|'self'
op|'.'
name|'realm'
op|','
name|'self'
op|'.'
name|'portal'
op|')'
newline|'\n'
nl|'\n'
name|'c'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'nick'
name|'in'
name|'self'
op|'.'
name|'STATIC_USERS'
op|':'
newline|'\n'
indent|'            '
name|'c'
op|'.'
name|'append'
op|'('
name|'self'
op|'.'
name|'realm'
op|'.'
name|'createUser'
op|'('
name|'nick'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'checker'
op|'.'
name|'addUser'
op|'('
name|'nick'
op|'.'
name|'encode'
op|'('
string|"'ascii'"
op|')'
op|','
name|'nick'
op|'+'
string|'"_password"'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'DeferredList'
op|'('
name|'c'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|_assertGreeting
dedent|''
name|'def'
name|'_assertGreeting'
op|'('
name|'self'
op|','
name|'user'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        The user has been greeted with the four messages that are (usually)\n        considered to start an IRC session.\n        \n        Asserts that the required responses were received.\n        """'
newline|'\n'
comment|'# Make sure we get 1-4 at least'
nl|'\n'
name|'response'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'user'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'['
name|'irc'
op|'.'
name|'RPL_WELCOME'
op|','
name|'irc'
op|'.'
name|'RPL_YOURHOST'
op|','
name|'irc'
op|'.'
name|'RPL_CREATED'
op|','
nl|'\n'
name|'irc'
op|'.'
name|'RPL_MYINFO'
op|']'
newline|'\n'
name|'for'
op|'('
name|'prefix'
op|','
name|'command'
op|','
name|'args'
op|')'
name|'in'
name|'response'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'command'
name|'in'
name|'expected'
op|':'
newline|'\n'
indent|'                '
name|'expected'
op|'.'
name|'remove'
op|'('
name|'command'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'self'
op|'.'
name|'failIf'
op|'('
name|'expected'
op|','
string|'"Missing responses for %r"'
op|'%'
op|'('
name|'expected'
op|','
op|')'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|_login
dedent|''
name|'def'
name|'_login'
op|'('
name|'self'
op|','
name|'user'
op|','
name|'nick'
op|','
name|'password'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'password'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'password'
op|'='
name|'nick'
op|'+'
string|'"_password"'
newline|'\n'
dedent|''
name|'user'
op|'.'
name|'write'
op|'('
string|"'PASS %s\\r\\n'"
op|'%'
op|'('
name|'password'
op|','
op|')'
op|')'
newline|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'NICK %s extrainfo\\r\\n'"
op|'%'
op|'('
name|'nick'
op|','
op|')'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|_loggedInUser
dedent|''
name|'def'
name|'_loggedInUser'
op|'('
name|'self'
op|','
name|'name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'d'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'realm'
op|'.'
name|'lookupUser'
op|'('
name|'name'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'d'
newline|'\n'
name|'user'
op|'='
name|'d'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
name|'agg'
op|'='
name|'TestCaseUserAgg'
op|'('
name|'user'
op|','
name|'self'
op|'.'
name|'realm'
op|','
name|'self'
op|'.'
name|'factory'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_login'
op|'('
name|'agg'
op|','
name|'name'
op|')'
newline|'\n'
name|'yield'
name|'agg'
newline|'\n'
DECL|variable|_loggedInUser
dedent|''
name|'_loggedInUser'
op|'='
name|'dG'
op|'('
name|'_loggedInUser'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|_response
name|'def'
name|'_response'
op|'('
name|'self'
op|','
name|'user'
op|','
name|'messageType'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        Extracts the user\'s response, and returns a list of parsed lines.\n        If messageType is defined, only messages of that type will be returned.\n        """'
newline|'\n'
name|'response'
op|'='
name|'user'
op|'.'
name|'transport'
op|'.'
name|'value'
op|'('
op|')'
op|'.'
name|'splitlines'
op|'('
op|')'
newline|'\n'
name|'user'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
name|'result'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'message'
name|'in'
name|'map'
op|'('
name|'irc'
op|'.'
name|'parsemsg'
op|','
name|'response'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'messageType'
name|'is'
name|'None'
name|'or'
name|'message'
op|'['
number|'1'
op|']'
op|'=='
name|'messageType'
op|':'
newline|'\n'
indent|'                '
name|'result'
op|'.'
name|'append'
op|'('
name|'message'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'return'
name|'result'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testPASSLogin
dedent|''
name|'def'
name|'testPASSLogin'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'user'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'_loggedInUser'
op|'('
string|"u'firstuser'"
op|')'
op|')'
newline|'\n'
name|'yield'
name|'user'
newline|'\n'
name|'user'
op|'='
name|'user'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_assertGreeting'
op|'('
name|'user'
op|')'
newline|'\n'
DECL|variable|testPASSLogin
dedent|''
name|'testPASSLogin'
op|'='
name|'dG'
op|'('
name|'testPASSLogin'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|test_nickServLogin
name|'def'
name|'test_nickServLogin'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        Sending NICK without PASS will prompt the user for their password.\n        When the user sends their password to NickServ, it will respond with a\n        Greeting.\n        """'
newline|'\n'
name|'firstuser'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'realm'
op|'.'
name|'lookupUser'
op|'('
string|"u'firstuser'"
op|')'
op|')'
newline|'\n'
name|'yield'
name|'firstuser'
newline|'\n'
name|'firstuser'
op|'='
name|'firstuser'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'='
name|'TestCaseUserAgg'
op|'('
name|'firstuser'
op|','
name|'self'
op|'.'
name|'realm'
op|','
name|'self'
op|'.'
name|'factory'
op|')'
newline|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'NICK firstuser extrainfo\\r\\n'"
op|')'
newline|'\n'
name|'response'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'user'
op|','
string|"'PRIVMSG'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'len'
op|'('
name|'response'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'0'
op|']'
op|','
name|'service'
op|'.'
name|'NICKSERV'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'PRIVMSG'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'2'
op|']'
op|','
op|'['
string|"'firstuser'"
op|','
string|"'Password?'"
op|']'
op|')'
newline|'\n'
name|'user'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'PRIVMSG nickserv firstuser_password\\r\\n'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_assertGreeting'
op|'('
name|'user'
op|')'
newline|'\n'
DECL|variable|test_nickServLogin
dedent|''
name|'test_nickServLogin'
op|'='
name|'dG'
op|'('
name|'test_nickServLogin'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testFailedLogin
name|'def'
name|'testFailedLogin'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'firstuser'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'realm'
op|'.'
name|'lookupUser'
op|'('
string|"u'firstuser'"
op|')'
op|')'
newline|'\n'
name|'yield'
name|'firstuser'
newline|'\n'
name|'firstuser'
op|'='
name|'firstuser'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'='
name|'TestCaseUserAgg'
op|'('
name|'firstuser'
op|','
name|'self'
op|'.'
name|'realm'
op|','
name|'self'
op|'.'
name|'factory'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_login'
op|'('
name|'user'
op|','
string|'"firstuser"'
op|','
string|'"wrongpass"'
op|')'
newline|'\n'
name|'response'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'user'
op|','
string|'"PRIVMSG"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'len'
op|'('
name|'response'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'2'
op|']'
op|','
op|'['
string|"'firstuser'"
op|','
string|"'Login failed.  Goodbye.'"
op|']'
op|')'
newline|'\n'
DECL|variable|testFailedLogin
dedent|''
name|'testFailedLogin'
op|'='
name|'dG'
op|'('
name|'testFailedLogin'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testLogout
name|'def'
name|'testLogout'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'logout'
op|'='
op|'['
op|']'
newline|'\n'
name|'firstuser'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'realm'
op|'.'
name|'lookupUser'
op|'('
string|"u'firstuser'"
op|')'
op|')'
newline|'\n'
name|'yield'
name|'firstuser'
newline|'\n'
name|'firstuser'
op|'='
name|'firstuser'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'='
name|'TestCaseUserAgg'
op|'('
name|'firstuser'
op|','
name|'self'
op|'.'
name|'realm'
op|','
name|'self'
op|'.'
name|'factory'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_login'
op|'('
name|'user'
op|','
string|'"firstuser"'
op|')'
newline|'\n'
name|'user'
op|'.'
name|'protocol'
op|'.'
name|'logout'
op|'='
name|'lambda'
op|':'
name|'logout'
op|'.'
name|'append'
op|'('
name|'True'
op|')'
newline|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'QUIT\\r\\n'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'logout'
op|','
op|'['
name|'True'
op|']'
op|')'
newline|'\n'
DECL|variable|testLogout
dedent|''
name|'testLogout'
op|'='
name|'dG'
op|'('
name|'testLogout'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testJoin
name|'def'
name|'testJoin'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'firstuser'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'realm'
op|'.'
name|'lookupUser'
op|'('
string|"u'firstuser'"
op|')'
op|')'
newline|'\n'
name|'yield'
name|'firstuser'
newline|'\n'
name|'firstuser'
op|'='
name|'firstuser'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'somechannel'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'realm'
op|'.'
name|'createGroup'
op|'('
string|'u"somechannel"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'somechannel'
newline|'\n'
name|'somechannel'
op|'='
name|'somechannel'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'somechannel'
op|'.'
name|'meta'
op|'['
string|"'topic'"
op|']'
op|'='
string|"'some random topic'"
newline|'\n'
nl|'\n'
comment|'# Bring in one user, make sure he gets into the channel sanely'
nl|'\n'
name|'user'
op|'='
name|'TestCaseUserAgg'
op|'('
name|'firstuser'
op|','
name|'self'
op|'.'
name|'realm'
op|','
name|'self'
op|'.'
name|'factory'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_login'
op|'('
name|'user'
op|','
string|'"firstuser"'
op|')'
newline|'\n'
name|'user'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'JOIN #somechannel\\r\\n'"
op|')'
newline|'\n'
nl|'\n'
name|'response'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'user'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'len'
op|'('
name|'response'
op|')'
op|','
number|'5'
op|')'
newline|'\n'
nl|'\n'
comment|'# Join message'
nl|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'0'
op|']'
op|','
string|"'firstuser!firstuser@realmname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'JOIN'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'2'
op|']'
op|','
op|'['
string|"'#somechannel'"
op|']'
op|')'
newline|'\n'
nl|'\n'
comment|'# User list'
nl|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'1'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'353'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'2'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'366'"
op|')'
newline|'\n'
nl|'\n'
comment|'# Topic (or lack thereof, as the case may be)'
nl|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'3'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'332'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'4'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'333'"
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
comment|'# Hook up another client!  It is a CHAT SYSTEM!!!!!!!'
nl|'\n'
name|'other'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'_loggedInUser'
op|'('
string|"u'otheruser'"
op|')'
op|')'
newline|'\n'
name|'yield'
name|'other'
newline|'\n'
name|'other'
op|'='
name|'other'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'other'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
name|'user'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
name|'other'
op|'.'
name|'write'
op|'('
string|"'JOIN #somechannel\\r\\n'"
op|')'
newline|'\n'
nl|'\n'
comment|'# At this point, both users should be in the channel'
nl|'\n'
name|'response'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'other'
op|')'
newline|'\n'
nl|'\n'
name|'event'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'user'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'len'
op|'('
name|'event'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'event'
op|'['
number|'0'
op|']'
op|'['
number|'0'
op|']'
op|','
string|"'otheruser!otheruser@realmname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'event'
op|'['
number|'0'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'JOIN'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'event'
op|'['
number|'0'
op|']'
op|'['
number|'2'
op|']'
op|','
op|'['
string|"'#somechannel'"
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'1'
op|']'
op|'['
number|'0'
op|']'
op|','
string|"'realmname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'1'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'353'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'1'
op|']'
op|'['
number|'2'
op|']'
op|','
op|'['
string|"'otheruser'"
op|','
string|"'='"
op|','
string|"'#somechannel'"
op|','
string|"'firstuser otheruser'"
op|']'
op|')'
newline|'\n'
DECL|variable|testJoin
dedent|''
name|'testJoin'
op|'='
name|'dG'
op|'('
name|'testJoin'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|test_joinTopicless
name|'def'
name|'test_joinTopicless'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        When a user joins a group without a topic, no topic information is\n        sent to that user.\n        """'
newline|'\n'
name|'firstuser'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'realm'
op|'.'
name|'lookupUser'
op|'('
string|"u'firstuser'"
op|')'
op|')'
newline|'\n'
name|'yield'
name|'firstuser'
newline|'\n'
name|'firstuser'
op|'='
name|'firstuser'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'somechannel'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'realm'
op|'.'
name|'createGroup'
op|'('
string|'u"somechannel"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'somechannel'
newline|'\n'
name|'somechannel'
op|'='
name|'somechannel'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
comment|'# Bring in one user, make sure he gets into the channel sanely'
nl|'\n'
name|'user'
op|'='
name|'TestCaseUserAgg'
op|'('
name|'firstuser'
op|','
name|'self'
op|'.'
name|'realm'
op|','
name|'self'
op|'.'
name|'factory'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_login'
op|'('
name|'user'
op|','
string|'"firstuser"'
op|')'
newline|'\n'
name|'user'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'JOIN #somechannel\\r\\n'"
op|')'
newline|'\n'
nl|'\n'
name|'response'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'user'
op|')'
newline|'\n'
name|'responseCodes'
op|'='
op|'['
name|'r'
op|'['
number|'1'
op|']'
name|'for'
name|'r'
name|'in'
name|'response'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertNotIn'
op|'('
string|"'332'"
op|','
name|'responseCodes'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertNotIn'
op|'('
string|"'333'"
op|','
name|'responseCodes'
op|')'
newline|'\n'
DECL|variable|test_joinTopicless
dedent|''
name|'test_joinTopicless'
op|'='
name|'dG'
op|'('
name|'test_joinTopicless'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testLeave
name|'def'
name|'testLeave'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'user'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'_loggedInUser'
op|'('
string|"u'useruser'"
op|')'
op|')'
newline|'\n'
name|'yield'
name|'user'
newline|'\n'
name|'user'
op|'='
name|'user'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'somechannel'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'realm'
op|'.'
name|'createGroup'
op|'('
string|'u"somechannel"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'somechannel'
newline|'\n'
name|'somechannel'
op|'='
name|'somechannel'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'JOIN #somechannel\\r\\n'"
op|')'
newline|'\n'
name|'user'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'other'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'_loggedInUser'
op|'('
string|"u'otheruser'"
op|')'
op|')'
newline|'\n'
name|'yield'
name|'other'
newline|'\n'
name|'other'
op|'='
name|'other'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'other'
op|'.'
name|'write'
op|'('
string|"'JOIN #somechannel\\r\\n'"
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
name|'other'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'PART #somechannel\\r\\n'"
op|')'
newline|'\n'
nl|'\n'
name|'response'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'user'
op|')'
newline|'\n'
name|'event'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'other'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'len'
op|'('
name|'response'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'0'
op|']'
op|','
string|"'useruser!useruser@realmname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'PART'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'2'
op|']'
op|','
op|'['
string|"'#somechannel'"
op|','
string|"'leaving'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|','
name|'event'
op|')'
newline|'\n'
nl|'\n'
comment|'# Now again, with a part message'
nl|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'JOIN #somechannel\\r\\n'"
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
name|'other'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'PART #somechannel :goodbye stupidheads\\r\\n'"
op|')'
newline|'\n'
nl|'\n'
name|'response'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'user'
op|')'
newline|'\n'
name|'event'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'other'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'len'
op|'('
name|'response'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'0'
op|']'
op|','
string|"'useruser!useruser@realmname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'PART'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'2'
op|']'
op|','
op|'['
string|"'#somechannel'"
op|','
string|"'goodbye stupidheads'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|','
name|'event'
op|')'
newline|'\n'
DECL|variable|testLeave
dedent|''
name|'testLeave'
op|'='
name|'dG'
op|'('
name|'testLeave'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testGetTopic
name|'def'
name|'testGetTopic'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'user'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'_loggedInUser'
op|'('
string|"u'useruser'"
op|')'
op|')'
newline|'\n'
name|'yield'
name|'user'
newline|'\n'
name|'user'
op|'='
name|'user'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'group'
op|'='
name|'service'
op|'.'
name|'Group'
op|'('
string|'"somechannel"'
op|')'
newline|'\n'
name|'group'
op|'.'
name|'meta'
op|'['
string|'"topic"'
op|']'
op|'='
string|'"This is a test topic."'
newline|'\n'
name|'group'
op|'.'
name|'meta'
op|'['
string|'"topic_author"'
op|']'
op|'='
string|'"some_fellow"'
newline|'\n'
name|'group'
op|'.'
name|'meta'
op|'['
string|'"topic_date"'
op|']'
op|'='
number|'77777777'
newline|'\n'
nl|'\n'
name|'add'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'realm'
op|'.'
name|'addGroup'
op|'('
name|'group'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'add'
newline|'\n'
name|'add'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|'"JOIN #somechannel\\r\\n"'
op|')'
newline|'\n'
nl|'\n'
name|'response'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'user'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'3'
op|']'
op|'['
number|'0'
op|']'
op|','
string|"'realmname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'3'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'332'"
op|')'
newline|'\n'
nl|'\n'
comment|'# XXX Sigh.  irc.parsemsg() is not as correct as one might hope.'
nl|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'3'
op|']'
op|'['
number|'2'
op|']'
op|','
op|'['
string|"'useruser'"
op|','
string|"'#somechannel'"
op|','
string|"'This is a test topic.'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'4'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'333'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'4'
op|']'
op|'['
number|'2'
op|']'
op|','
op|'['
string|"'useruser'"
op|','
string|"'#somechannel'"
op|','
string|"'some_fellow'"
op|','
string|"'77777777'"
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'TOPIC #somechannel\\r\\n'"
op|')'
newline|'\n'
nl|'\n'
name|'response'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'user'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'332'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'2'
op|']'
op|','
op|'['
string|"'useruser'"
op|','
string|"'#somechannel'"
op|','
string|"'This is a test topic.'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'1'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'333'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'1'
op|']'
op|'['
number|'2'
op|']'
op|','
op|'['
string|"'useruser'"
op|','
string|"'#somechannel'"
op|','
string|"'some_fellow'"
op|','
string|"'77777777'"
op|']'
op|')'
newline|'\n'
DECL|variable|testGetTopic
dedent|''
name|'testGetTopic'
op|'='
name|'dG'
op|'('
name|'testGetTopic'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testSetTopic
name|'def'
name|'testSetTopic'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'user'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'_loggedInUser'
op|'('
string|"u'useruser'"
op|')'
op|')'
newline|'\n'
name|'yield'
name|'user'
newline|'\n'
name|'user'
op|'='
name|'user'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'add'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'realm'
op|'.'
name|'createGroup'
op|'('
string|'u"somechannel"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'add'
newline|'\n'
name|'somechannel'
op|'='
name|'add'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|'"JOIN #somechannel\\r\\n"'
op|')'
newline|'\n'
nl|'\n'
name|'other'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'_loggedInUser'
op|'('
string|"u'otheruser'"
op|')'
op|')'
newline|'\n'
name|'yield'
name|'other'
newline|'\n'
name|'other'
op|'='
name|'other'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'other'
op|'.'
name|'write'
op|'('
string|'"JOIN #somechannel\\r\\n"'
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
name|'other'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'other'
op|'.'
name|'write'
op|'('
string|"'TOPIC #somechannel :This is the new topic.\\r\\n'"
op|')'
newline|'\n'
nl|'\n'
name|'response'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'other'
op|')'
newline|'\n'
name|'event'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'user'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|','
name|'event'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'0'
op|']'
op|','
string|"'otheruser!otheruser@realmname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'TOPIC'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'2'
op|']'
op|','
op|'['
string|"'#somechannel'"
op|','
string|"'This is the new topic.'"
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'other'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'somechannel'
op|'.'
name|'meta'
op|'['
string|"'topic_date'"
op|']'
op|'='
number|'12345'
newline|'\n'
name|'other'
op|'.'
name|'write'
op|'('
string|"'TOPIC #somechannel\\r\\n'"
op|')'
newline|'\n'
nl|'\n'
name|'response'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'other'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'332'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'2'
op|']'
op|','
op|'['
string|"'otheruser'"
op|','
string|"'#somechannel'"
op|','
string|"'This is the new topic.'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'1'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'333'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'1'
op|']'
op|'['
number|'2'
op|']'
op|','
op|'['
string|"'otheruser'"
op|','
string|"'#somechannel'"
op|','
string|"'otheruser'"
op|','
string|"'12345'"
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'other'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
name|'other'
op|'.'
name|'write'
op|'('
string|"'TOPIC #asdlkjasd\\r\\n'"
op|')'
newline|'\n'
nl|'\n'
name|'response'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'other'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'403'"
op|')'
newline|'\n'
DECL|variable|testSetTopic
dedent|''
name|'testSetTopic'
op|'='
name|'dG'
op|'('
name|'testSetTopic'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testGroupMessage
name|'def'
name|'testGroupMessage'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'user'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'_loggedInUser'
op|'('
string|"u'useruser'"
op|')'
op|')'
newline|'\n'
name|'yield'
name|'user'
newline|'\n'
name|'user'
op|'='
name|'user'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'add'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'realm'
op|'.'
name|'createGroup'
op|'('
string|'u"somechannel"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'add'
newline|'\n'
name|'somechannel'
op|'='
name|'add'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|'"JOIN #somechannel\\r\\n"'
op|')'
newline|'\n'
nl|'\n'
name|'other'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'_loggedInUser'
op|'('
string|"u'otheruser'"
op|')'
op|')'
newline|'\n'
name|'yield'
name|'other'
newline|'\n'
name|'other'
op|'='
name|'other'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'other'
op|'.'
name|'write'
op|'('
string|'"JOIN #somechannel\\r\\n"'
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
name|'other'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'PRIVMSG #somechannel :Hello, world.\\r\\n'"
op|')'
newline|'\n'
nl|'\n'
name|'response'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'user'
op|')'
newline|'\n'
name|'event'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'other'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'failIf'
op|'('
name|'response'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'len'
op|'('
name|'event'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'event'
op|'['
number|'0'
op|']'
op|'['
number|'0'
op|']'
op|','
string|"'useruser!useruser@realmname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'event'
op|'['
number|'0'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'PRIVMSG'"
op|','
op|'-'
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'event'
op|'['
number|'0'
op|']'
op|'['
number|'2'
op|']'
op|','
op|'['
string|"'#somechannel'"
op|','
string|"'Hello, world.'"
op|']'
op|')'
newline|'\n'
DECL|variable|testGroupMessage
dedent|''
name|'testGroupMessage'
op|'='
name|'dG'
op|'('
name|'testGroupMessage'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testPrivateMessage
name|'def'
name|'testPrivateMessage'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'user'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'_loggedInUser'
op|'('
string|"u'useruser'"
op|')'
op|')'
newline|'\n'
name|'yield'
name|'user'
newline|'\n'
name|'user'
op|'='
name|'user'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'other'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'_loggedInUser'
op|'('
string|"u'otheruser'"
op|')'
op|')'
newline|'\n'
name|'yield'
name|'other'
newline|'\n'
name|'other'
op|'='
name|'other'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
name|'other'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'PRIVMSG otheruser :Hello, monkey.\\r\\n'"
op|')'
newline|'\n'
nl|'\n'
name|'response'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'user'
op|')'
newline|'\n'
name|'event'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'other'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'failIf'
op|'('
name|'response'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'len'
op|'('
name|'event'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'event'
op|'['
number|'0'
op|']'
op|'['
number|'0'
op|']'
op|','
string|"'useruser!useruser@realmname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'event'
op|'['
number|'0'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'PRIVMSG'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'event'
op|'['
number|'0'
op|']'
op|'['
number|'2'
op|']'
op|','
op|'['
string|"'otheruser'"
op|','
string|"'Hello, monkey.'"
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'PRIVMSG nousernamedthis :Hello, monkey.\\r\\n'"
op|')'
newline|'\n'
nl|'\n'
name|'response'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'user'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'len'
op|'('
name|'response'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'0'
op|']'
op|','
string|"'realmname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'401'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'2'
op|']'
op|','
op|'['
string|"'useruser'"
op|','
string|"'nousernamedthis'"
op|','
string|"'No such nick/channel.'"
op|']'
op|')'
newline|'\n'
DECL|variable|testPrivateMessage
dedent|''
name|'testPrivateMessage'
op|'='
name|'dG'
op|'('
name|'testPrivateMessage'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testOper
name|'def'
name|'testOper'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'user'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'_loggedInUser'
op|'('
string|"u'useruser'"
op|')'
op|')'
newline|'\n'
name|'yield'
name|'user'
newline|'\n'
name|'user'
op|'='
name|'user'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'OPER user pass\\r\\n'"
op|')'
newline|'\n'
name|'response'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'user'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'len'
op|'('
name|'response'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'491'"
op|')'
newline|'\n'
DECL|variable|testOper
dedent|''
name|'testOper'
op|'='
name|'dG'
op|'('
name|'testOper'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testGetUserMode
name|'def'
name|'testGetUserMode'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'user'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'_loggedInUser'
op|'('
string|"u'useruser'"
op|')'
op|')'
newline|'\n'
name|'yield'
name|'user'
newline|'\n'
name|'user'
op|'='
name|'user'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'MODE useruser\\r\\n'"
op|')'
newline|'\n'
nl|'\n'
name|'response'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'user'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'len'
op|'('
name|'response'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'0'
op|']'
op|','
string|"'realmname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'221'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'2'
op|']'
op|','
op|'['
string|"'useruser'"
op|','
string|"'+'"
op|']'
op|')'
newline|'\n'
DECL|variable|testGetUserMode
dedent|''
name|'testGetUserMode'
op|'='
name|'dG'
op|'('
name|'testGetUserMode'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testSetUserMode
name|'def'
name|'testSetUserMode'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'user'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'_loggedInUser'
op|'('
string|"u'useruser'"
op|')'
op|')'
newline|'\n'
name|'yield'
name|'user'
newline|'\n'
name|'user'
op|'='
name|'user'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'MODE useruser +abcd\\r\\n'"
op|')'
newline|'\n'
nl|'\n'
name|'response'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'user'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'len'
op|'('
name|'response'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'472'"
op|')'
newline|'\n'
DECL|variable|testSetUserMode
dedent|''
name|'testSetUserMode'
op|'='
name|'dG'
op|'('
name|'testSetUserMode'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testGetGroupMode
name|'def'
name|'testGetGroupMode'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'user'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'_loggedInUser'
op|'('
string|"u'useruser'"
op|')'
op|')'
newline|'\n'
name|'yield'
name|'user'
newline|'\n'
name|'user'
op|'='
name|'user'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'add'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'realm'
op|'.'
name|'createGroup'
op|'('
string|'u"somechannel"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'add'
newline|'\n'
name|'somechannel'
op|'='
name|'add'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'JOIN #somechannel\\r\\n'"
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'MODE #somechannel\\r\\n'"
op|')'
newline|'\n'
nl|'\n'
name|'response'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'user'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'len'
op|'('
name|'response'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'324'"
op|')'
newline|'\n'
DECL|variable|testGetGroupMode
dedent|''
name|'testGetGroupMode'
op|'='
name|'dG'
op|'('
name|'testGetGroupMode'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testSetGroupMode
name|'def'
name|'testSetGroupMode'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'user'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'_loggedInUser'
op|'('
string|"u'useruser'"
op|')'
op|')'
newline|'\n'
name|'yield'
name|'user'
newline|'\n'
name|'user'
op|'='
name|'user'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'group'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'realm'
op|'.'
name|'createGroup'
op|'('
string|'u"groupname"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'group'
newline|'\n'
name|'group'
op|'='
name|'group'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'JOIN #groupname\\r\\n'"
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'MODE #groupname +abcd\\r\\n'"
op|')'
newline|'\n'
nl|'\n'
name|'response'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'user'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'len'
op|'('
name|'response'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'response'
op|'['
number|'0'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'472'"
op|')'
newline|'\n'
DECL|variable|testSetGroupMode
dedent|''
name|'testSetGroupMode'
op|'='
name|'dG'
op|'('
name|'testSetGroupMode'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testWho
name|'def'
name|'testWho'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'group'
op|'='
name|'service'
op|'.'
name|'Group'
op|'('
string|"'groupname'"
op|')'
newline|'\n'
name|'add'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'realm'
op|'.'
name|'addGroup'
op|'('
name|'group'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'add'
newline|'\n'
name|'add'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'users'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'nick'
name|'in'
string|"u'userone'"
op|','
string|"u'usertwo'"
op|','
string|"u'userthree'"
op|':'
newline|'\n'
indent|'            '
name|'u'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'_loggedInUser'
op|'('
name|'nick'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'u'
newline|'\n'
name|'u'
op|'='
name|'u'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
name|'users'
op|'.'
name|'append'
op|'('
name|'u'
op|')'
newline|'\n'
name|'users'
op|'['
op|'-'
number|'1'
op|']'
op|'.'
name|'write'
op|'('
string|"'JOIN #groupname\\r\\n'"
op|')'
newline|'\n'
dedent|''
name|'for'
name|'user'
name|'in'
name|'users'
op|':'
newline|'\n'
indent|'            '
name|'user'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'users'
op|'['
number|'0'
op|']'
op|'.'
name|'write'
op|'('
string|"'WHO #groupname\\r\\n'"
op|')'
newline|'\n'
nl|'\n'
name|'r'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'users'
op|'['
number|'0'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'failIf'
op|'('
name|'self'
op|'.'
name|'_response'
op|'('
name|'users'
op|'['
number|'1'
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'failIf'
op|'('
name|'self'
op|'.'
name|'_response'
op|'('
name|'users'
op|'['
number|'2'
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'wantusers'
op|'='
op|'['
string|"'userone'"
op|','
string|"'usertwo'"
op|','
string|"'userthree'"
op|']'
newline|'\n'
name|'for'
op|'('
name|'prefix'
op|','
name|'code'
op|','
name|'stuff'
op|')'
name|'in'
name|'r'
op|'['
op|':'
op|'-'
number|'1'
op|']'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'prefix'
op|','
string|"'realmname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'code'
op|','
string|"'352'"
op|')'
newline|'\n'
nl|'\n'
op|'('
name|'myname'
op|','
name|'group'
op|','
name|'theirname'
op|','
name|'theirhost'
op|','
name|'theirserver'
op|','
name|'theirnick'
op|','
name|'flag'
op|','
name|'extra'
op|')'
op|'='
name|'stuff'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'myname'
op|','
string|"'userone'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'group'
op|','
string|"'#groupname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'failUnless'
op|'('
name|'theirname'
name|'in'
name|'wantusers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'theirhost'
op|','
string|"'realmname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'theirserver'
op|','
string|"'realmname'"
op|')'
newline|'\n'
name|'wantusers'
op|'.'
name|'remove'
op|'('
name|'theirnick'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'flag'
op|','
string|"'H'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'extra'
op|','
string|"'0 '"
op|'+'
name|'theirnick'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'failIf'
op|'('
name|'wantusers'
op|')'
newline|'\n'
nl|'\n'
name|'prefix'
op|','
name|'code'
op|','
name|'stuff'
op|'='
name|'r'
op|'['
op|'-'
number|'1'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'prefix'
op|','
string|"'realmname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'code'
op|','
string|"'315'"
op|')'
newline|'\n'
name|'myname'
op|','
name|'channel'
op|','
name|'extra'
op|'='
name|'stuff'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'myname'
op|','
string|"'userone'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'channel'
op|','
string|"'#groupname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'extra'
op|','
string|"'End of /WHO list.'"
op|')'
newline|'\n'
DECL|variable|testWho
dedent|''
name|'testWho'
op|'='
name|'dG'
op|'('
name|'testWho'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testList
name|'def'
name|'testList'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'user'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'_loggedInUser'
op|'('
string|'u"someuser"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'user'
newline|'\n'
name|'user'
op|'='
name|'user'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
name|'user'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'somegroup'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'realm'
op|'.'
name|'createGroup'
op|'('
string|'u"somegroup"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'somegroup'
newline|'\n'
name|'somegroup'
op|'='
name|'somegroup'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
name|'somegroup'
op|'.'
name|'size'
op|'='
name|'lambda'
op|':'
name|'succeed'
op|'('
number|'17'
op|')'
newline|'\n'
name|'somegroup'
op|'.'
name|'meta'
op|'['
string|"'topic'"
op|']'
op|'='
string|"'this is the topic woo'"
newline|'\n'
nl|'\n'
comment|'# Test one group'
nl|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'LIST #somegroup\\r\\n'"
op|')'
newline|'\n'
nl|'\n'
name|'r'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'user'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'len'
op|'('
name|'r'
op|')'
op|','
number|'2'
op|')'
newline|'\n'
name|'resp'
op|','
name|'end'
op|'='
name|'r'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'resp'
op|'['
number|'0'
op|']'
op|','
string|"'realmname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'resp'
op|'['
number|'1'
op|']'
op|','
string|"'322'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'resp'
op|'['
number|'2'
op|']'
op|'['
number|'0'
op|']'
op|','
string|"'someuser'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'resp'
op|'['
number|'2'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'somegroup'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'resp'
op|'['
number|'2'
op|']'
op|'['
number|'2'
op|']'
op|','
string|"'17'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'resp'
op|'['
number|'2'
op|']'
op|'['
number|'3'
op|']'
op|','
string|"'this is the topic woo'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'end'
op|'['
number|'0'
op|']'
op|','
string|"'realmname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'end'
op|'['
number|'1'
op|']'
op|','
string|"'323'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'end'
op|'['
number|'2'
op|']'
op|'['
number|'0'
op|']'
op|','
string|"'someuser'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'end'
op|'['
number|'2'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'End of /LIST'"
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
comment|'# Test all groups'
nl|'\n'
nl|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'LIST\\r\\n'"
op|')'
newline|'\n'
name|'r'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'user'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'len'
op|'('
name|'r'
op|')'
op|','
number|'2'
op|')'
newline|'\n'
nl|'\n'
name|'fg1'
op|','
name|'end'
op|'='
name|'r'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'fg1'
op|'['
number|'1'
op|']'
op|','
string|"'322'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'fg1'
op|'['
number|'2'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'somegroup'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'fg1'
op|'['
number|'2'
op|']'
op|'['
number|'2'
op|']'
op|','
string|"'17'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'fg1'
op|'['
number|'2'
op|']'
op|'['
number|'3'
op|']'
op|','
string|"'this is the topic woo'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'end'
op|'['
number|'1'
op|']'
op|','
string|"'323'"
op|')'
newline|'\n'
DECL|variable|testList
dedent|''
name|'testList'
op|'='
name|'dG'
op|'('
name|'testList'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testWhois
name|'def'
name|'testWhois'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'user'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'_loggedInUser'
op|'('
string|"u'someguy'"
op|')'
op|')'
newline|'\n'
name|'yield'
name|'user'
newline|'\n'
name|'user'
op|'='
name|'user'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'otherguy'
op|'='
name|'service'
op|'.'
name|'User'
op|'('
string|'"otherguy"'
op|')'
newline|'\n'
name|'otherguy'
op|'.'
name|'itergroups'
op|'='
name|'lambda'
op|':'
name|'iter'
op|'('
op|'['
nl|'\n'
name|'service'
op|'.'
name|'Group'
op|'('
string|"'groupA'"
op|')'
op|','
nl|'\n'
name|'service'
op|'.'
name|'Group'
op|'('
string|"'groupB'"
op|')'
op|']'
op|')'
newline|'\n'
name|'otherguy'
op|'.'
name|'signOn'
op|'='
number|'10'
newline|'\n'
name|'otherguy'
op|'.'
name|'lastMessage'
op|'='
name|'time'
op|'.'
name|'time'
op|'('
op|')'
op|'-'
number|'15'
newline|'\n'
nl|'\n'
name|'add'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'realm'
op|'.'
name|'addUser'
op|'('
name|'otherguy'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'add'
newline|'\n'
name|'add'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'user'
op|'.'
name|'transport'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
name|'user'
op|'.'
name|'write'
op|'('
string|"'WHOIS otherguy\\r\\n'"
op|')'
newline|'\n'
name|'r'
op|'='
name|'self'
op|'.'
name|'_response'
op|'('
name|'user'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'len'
op|'('
name|'r'
op|')'
op|','
number|'5'
op|')'
newline|'\n'
name|'wuser'
op|','
name|'wserver'
op|','
name|'idle'
op|','
name|'channels'
op|','
name|'end'
op|'='
name|'r'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'wuser'
op|'['
number|'0'
op|']'
op|','
string|"'realmname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'wuser'
op|'['
number|'1'
op|']'
op|','
string|"'311'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'wuser'
op|'['
number|'2'
op|']'
op|'['
number|'0'
op|']'
op|','
string|"'someguy'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'wuser'
op|'['
number|'2'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'otherguy'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'wuser'
op|'['
number|'2'
op|']'
op|'['
number|'2'
op|']'
op|','
string|"'otherguy'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'wuser'
op|'['
number|'2'
op|']'
op|'['
number|'3'
op|']'
op|','
string|"'realmname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'wuser'
op|'['
number|'2'
op|']'
op|'['
number|'4'
op|']'
op|','
string|"'*'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'wuser'
op|'['
number|'2'
op|']'
op|'['
number|'5'
op|']'
op|','
string|"'otherguy'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'wserver'
op|'['
number|'0'
op|']'
op|','
string|"'realmname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'wserver'
op|'['
number|'1'
op|']'
op|','
string|"'312'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'wserver'
op|'['
number|'2'
op|']'
op|'['
number|'0'
op|']'
op|','
string|"'someguy'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'wserver'
op|'['
number|'2'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'otherguy'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'wserver'
op|'['
number|'2'
op|']'
op|'['
number|'2'
op|']'
op|','
string|"'realmname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'wserver'
op|'['
number|'2'
op|']'
op|'['
number|'3'
op|']'
op|','
string|"'Hi mom!'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'idle'
op|'['
number|'0'
op|']'
op|','
string|"'realmname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'idle'
op|'['
number|'1'
op|']'
op|','
string|"'317'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'idle'
op|'['
number|'2'
op|']'
op|'['
number|'0'
op|']'
op|','
string|"'someguy'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'idle'
op|'['
number|'2'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'otherguy'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'idle'
op|'['
number|'2'
op|']'
op|'['
number|'2'
op|']'
op|','
string|"'15'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'idle'
op|'['
number|'2'
op|']'
op|'['
number|'3'
op|']'
op|','
string|"'10'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'idle'
op|'['
number|'2'
op|']'
op|'['
number|'4'
op|']'
op|','
string|'"seconds idle, signon time"'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'channels'
op|'['
number|'0'
op|']'
op|','
string|"'realmname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'channels'
op|'['
number|'1'
op|']'
op|','
string|"'319'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'channels'
op|'['
number|'2'
op|']'
op|'['
number|'0'
op|']'
op|','
string|"'someguy'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'channels'
op|'['
number|'2'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'otherguy'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'channels'
op|'['
number|'2'
op|']'
op|'['
number|'2'
op|']'
op|','
string|"'#groupA #groupB'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'end'
op|'['
number|'0'
op|']'
op|','
string|"'realmname'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'end'
op|'['
number|'1'
op|']'
op|','
string|"'318'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'end'
op|'['
number|'2'
op|']'
op|'['
number|'0'
op|']'
op|','
string|"'someguy'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'end'
op|'['
number|'2'
op|']'
op|'['
number|'1'
op|']'
op|','
string|"'otherguy'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'end'
op|'['
number|'2'
op|']'
op|'['
number|'2'
op|']'
op|','
string|"'End of WHOIS list.'"
op|')'
newline|'\n'
DECL|variable|testWhois
dedent|''
name|'testWhois'
op|'='
name|'dG'
op|'('
name|'testWhois'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TestMind
dedent|''
name|'class'
name|'TestMind'
op|'('
name|'service'
op|'.'
name|'PBMind'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'*'
name|'a'
op|','
op|'**'
name|'kw'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'joins'
op|'='
op|'['
op|']'
newline|'\n'
name|'self'
op|'.'
name|'parts'
op|'='
op|'['
op|']'
newline|'\n'
name|'self'
op|'.'
name|'messages'
op|'='
op|'['
op|']'
newline|'\n'
name|'self'
op|'.'
name|'meta'
op|'='
op|'['
op|']'
newline|'\n'
nl|'\n'
DECL|member|remote_userJoined
dedent|''
name|'def'
name|'remote_userJoined'
op|'('
name|'self'
op|','
name|'user'
op|','
name|'group'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'joins'
op|'.'
name|'append'
op|'('
op|'('
name|'user'
op|','
name|'group'
op|')'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|remote_userLeft
dedent|''
name|'def'
name|'remote_userLeft'
op|'('
name|'self'
op|','
name|'user'
op|','
name|'group'
op|','
name|'reason'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'parts'
op|'.'
name|'append'
op|'('
op|'('
name|'user'
op|','
name|'group'
op|','
name|'reason'
op|')'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|remote_receive
dedent|''
name|'def'
name|'remote_receive'
op|'('
name|'self'
op|','
name|'sender'
op|','
name|'recipient'
op|','
name|'message'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'messages'
op|'.'
name|'append'
op|'('
op|'('
name|'sender'
op|','
name|'recipient'
op|','
name|'message'
op|')'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|remote_groupMetaUpdate
dedent|''
name|'def'
name|'remote_groupMetaUpdate'
op|'('
name|'self'
op|','
name|'group'
op|','
name|'meta'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'meta'
op|'.'
name|'append'
op|'('
op|'('
name|'group'
op|','
name|'meta'
op|')'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'pb'
op|'.'
name|'setUnjellyableForClass'
op|'('
name|'TestMind'
op|','
name|'service'
op|'.'
name|'PBMindReference'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|PBProtocolTestCase
name|'class'
name|'PBProtocolTestCase'
op|'('
name|'unittest'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'realm'
op|'='
name|'service'
op|'.'
name|'InMemoryWordsRealm'
op|'('
string|'"realmname"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'checker'
op|'='
name|'checkers'
op|'.'
name|'InMemoryUsernamePasswordDatabaseDontUse'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'portal'
op|'='
name|'portal'
op|'.'
name|'Portal'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'realm'
op|','
op|'['
name|'self'
op|'.'
name|'checker'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'serverFactory'
op|'='
name|'pb'
op|'.'
name|'PBServerFactory'
op|'('
name|'self'
op|'.'
name|'portal'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'serverFactory'
op|'.'
name|'protocol'
op|'='
name|'self'
op|'.'
name|'_protocolFactory'
newline|'\n'
name|'self'
op|'.'
name|'serverFactory'
op|'.'
name|'unsafeTracebacks'
op|'='
name|'True'
newline|'\n'
name|'self'
op|'.'
name|'clientFactory'
op|'='
name|'pb'
op|'.'
name|'PBClientFactory'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'clientFactory'
op|'.'
name|'unsafeTracebacks'
op|'='
name|'True'
newline|'\n'
name|'self'
op|'.'
name|'serverPort'
op|'='
name|'reactor'
op|'.'
name|'listenTCP'
op|'('
number|'0'
op|','
name|'self'
op|'.'
name|'serverFactory'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'clientConn'
op|'='
name|'reactor'
op|'.'
name|'connectTCP'
op|'('
nl|'\n'
string|"'127.0.0.1'"
op|','
nl|'\n'
name|'self'
op|'.'
name|'serverPort'
op|'.'
name|'getHost'
op|'('
op|')'
op|'.'
name|'port'
op|','
nl|'\n'
name|'self'
op|'.'
name|'clientFactory'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|_protocolFactory
dedent|''
name|'def'
name|'_protocolFactory'
op|'('
name|'self'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kw'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_serverProtocol'
op|'='
name|'pb'
op|'.'
name|'Broker'
op|'('
number|'0'
op|')'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'_serverProtocol'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|tearDown
dedent|''
name|'def'
name|'tearDown'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'d3'
op|'='
name|'Deferred'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_serverProtocol'
op|'.'
name|'notifyOnDisconnect'
op|'('
name|'lambda'
op|':'
name|'d3'
op|'.'
name|'callback'
op|'('
name|'None'
op|')'
op|')'
newline|'\n'
name|'return'
name|'DeferredList'
op|'('
op|'['
nl|'\n'
name|'maybeDeferred'
op|'('
name|'self'
op|'.'
name|'serverPort'
op|'.'
name|'stopListening'
op|')'
op|','
nl|'\n'
name|'maybeDeferred'
op|'('
name|'self'
op|'.'
name|'clientConn'
op|'.'
name|'disconnect'
op|')'
op|','
name|'d3'
op|']'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|_loggedInAvatar
dedent|''
name|'def'
name|'_loggedInAvatar'
op|'('
name|'self'
op|','
name|'name'
op|','
name|'password'
op|','
name|'mind'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'creds'
op|'='
name|'credentials'
op|'.'
name|'UsernamePassword'
op|'('
name|'name'
op|','
name|'password'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'checker'
op|'.'
name|'addUser'
op|'('
name|'name'
op|'.'
name|'encode'
op|'('
string|"'ascii'"
op|')'
op|','
name|'password'
op|')'
newline|'\n'
name|'d'
op|'='
name|'self'
op|'.'
name|'realm'
op|'.'
name|'createUser'
op|'('
name|'name'
op|')'
newline|'\n'
name|'d'
op|'.'
name|'addCallback'
op|'('
name|'lambda'
name|'ign'
op|':'
name|'self'
op|'.'
name|'clientFactory'
op|'.'
name|'login'
op|'('
name|'creds'
op|','
name|'mind'
op|')'
op|')'
newline|'\n'
name|'return'
name|'d'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testGroups
dedent|''
name|'def'
name|'testGroups'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'mindone'
op|'='
name|'TestMind'
op|'('
op|')'
newline|'\n'
name|'one'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'_loggedInAvatar'
op|'('
string|'u"one"'
op|','
string|'"p1"'
op|','
name|'mindone'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'one'
newline|'\n'
name|'one'
op|'='
name|'one'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'mindtwo'
op|'='
name|'TestMind'
op|'('
op|')'
newline|'\n'
name|'two'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'_loggedInAvatar'
op|'('
string|'u"two"'
op|','
string|'"p2"'
op|','
name|'mindtwo'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'two'
newline|'\n'
name|'two'
op|'='
name|'two'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'add'
op|'='
name|'wFD'
op|'('
name|'self'
op|'.'
name|'realm'
op|'.'
name|'createGroup'
op|'('
string|'u"foobar"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'add'
newline|'\n'
name|'add'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'groupone'
op|'='
name|'wFD'
op|'('
name|'one'
op|'.'
name|'join'
op|'('
string|'u"foobar"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'groupone'
newline|'\n'
name|'groupone'
op|'='
name|'groupone'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'grouptwo'
op|'='
name|'wFD'
op|'('
name|'two'
op|'.'
name|'join'
op|'('
string|'u"foobar"'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'grouptwo'
newline|'\n'
name|'grouptwo'
op|'='
name|'grouptwo'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'msg'
op|'='
name|'wFD'
op|'('
name|'groupone'
op|'.'
name|'send'
op|'('
op|'{'
string|'"text"'
op|':'
string|'"hello, monkeys"'
op|'}'
op|')'
op|')'
newline|'\n'
name|'yield'
name|'msg'
newline|'\n'
name|'msg'
op|'='
name|'msg'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'leave'
op|'='
name|'wFD'
op|'('
name|'groupone'
op|'.'
name|'leave'
op|'('
op|')'
op|')'
newline|'\n'
name|'yield'
name|'leave'
newline|'\n'
name|'leave'
op|'='
name|'leave'
op|'.'
name|'getResult'
op|'('
op|')'
newline|'\n'
DECL|variable|testGroups
dedent|''
name|'testGroups'
op|'='
name|'dG'
op|'('
name|'testGroups'
op|')'
newline|'\n'
dedent|''
endmarker|''
end_unit
