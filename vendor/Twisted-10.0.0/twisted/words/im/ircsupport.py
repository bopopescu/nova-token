begin_unit
comment|'# Copyright (c) 2001-2009 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
nl|'\n'
string|'"""IRC support for Instance Messenger."""'
newline|'\n'
nl|'\n'
name|'import'
name|'string'
newline|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'words'
op|'.'
name|'protocols'
name|'import'
name|'irc'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'words'
op|'.'
name|'im'
op|'.'
name|'locals'
name|'import'
name|'ONLINE'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'defer'
op|','
name|'reactor'
op|','
name|'protocol'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
op|'.'
name|'defer'
name|'import'
name|'succeed'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'words'
op|'.'
name|'im'
name|'import'
name|'basesupport'
op|','
name|'interfaces'
op|','
name|'locals'
newline|'\n'
name|'from'
name|'zope'
op|'.'
name|'interface'
name|'import'
name|'implements'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|IRCPerson
name|'class'
name|'IRCPerson'
op|'('
name|'basesupport'
op|'.'
name|'AbstractPerson'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|imperson_whois
indent|'    '
name|'def'
name|'imperson_whois'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'account'
op|'.'
name|'client'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'locals'
op|'.'
name|'OfflineError'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'account'
op|'.'
name|'client'
op|'.'
name|'sendLine'
op|'('
string|'"WHOIS %s"'
op|'%'
name|'self'
op|'.'
name|'name'
op|')'
newline|'\n'
nl|'\n'
comment|'### interface impl'
nl|'\n'
nl|'\n'
DECL|member|isOnline
dedent|''
name|'def'
name|'isOnline'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'ONLINE'
newline|'\n'
nl|'\n'
DECL|member|getStatus
dedent|''
name|'def'
name|'getStatus'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'ONLINE'
newline|'\n'
nl|'\n'
DECL|member|setStatus
dedent|''
name|'def'
name|'setStatus'
op|'('
name|'self'
op|','
name|'status'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'status'
op|'='
name|'status'
newline|'\n'
name|'self'
op|'.'
name|'chat'
op|'.'
name|'getContactsList'
op|'('
op|')'
op|'.'
name|'setContactStatus'
op|'('
name|'self'
op|')'
newline|'\n'
nl|'\n'
DECL|member|sendMessage
dedent|''
name|'def'
name|'sendMessage'
op|'('
name|'self'
op|','
name|'text'
op|','
name|'meta'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'account'
op|'.'
name|'client'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'locals'
op|'.'
name|'OfflineError'
newline|'\n'
dedent|''
name|'for'
name|'line'
name|'in'
name|'string'
op|'.'
name|'split'
op|'('
name|'text'
op|','
string|"'\\n'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'meta'
name|'and'
name|'meta'
op|'.'
name|'get'
op|'('
string|'"style"'
op|','
name|'None'
op|')'
op|'=='
string|'"emote"'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'account'
op|'.'
name|'client'
op|'.'
name|'ctcpMakeQuery'
op|'('
name|'self'
op|'.'
name|'name'
op|','
op|'['
op|'('
string|"'ACTION'"
op|','
name|'line'
op|')'
op|']'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'account'
op|'.'
name|'client'
op|'.'
name|'msg'
op|'('
name|'self'
op|'.'
name|'name'
op|','
name|'line'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'return'
name|'succeed'
op|'('
name|'text'
op|')'
newline|'\n'
nl|'\n'
DECL|class|IRCGroup
dedent|''
dedent|''
name|'class'
name|'IRCGroup'
op|'('
name|'basesupport'
op|'.'
name|'AbstractGroup'
op|')'
op|':'
newline|'\n'
nl|'\n'
indent|'    '
name|'implements'
op|'('
name|'interfaces'
op|'.'
name|'IGroup'
op|')'
newline|'\n'
nl|'\n'
DECL|member|imgroup_testAction
name|'def'
name|'imgroup_testAction'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pass'
newline|'\n'
nl|'\n'
DECL|member|imtarget_kick
dedent|''
name|'def'
name|'imtarget_kick'
op|'('
name|'self'
op|','
name|'target'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'account'
op|'.'
name|'client'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'locals'
op|'.'
name|'OfflineError'
newline|'\n'
dedent|''
name|'reason'
op|'='
string|'"for great justice!"'
newline|'\n'
name|'self'
op|'.'
name|'account'
op|'.'
name|'client'
op|'.'
name|'sendLine'
op|'('
string|'"KICK #%s %s :%s"'
op|'%'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'name'
op|','
name|'target'
op|'.'
name|'name'
op|','
name|'reason'
op|')'
op|')'
newline|'\n'
nl|'\n'
comment|'### Interface Implementation'
nl|'\n'
nl|'\n'
DECL|member|setTopic
dedent|''
name|'def'
name|'setTopic'
op|'('
name|'self'
op|','
name|'topic'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'account'
op|'.'
name|'client'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'locals'
op|'.'
name|'OfflineError'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'account'
op|'.'
name|'client'
op|'.'
name|'topic'
op|'('
name|'self'
op|'.'
name|'name'
op|','
name|'topic'
op|')'
newline|'\n'
nl|'\n'
DECL|member|sendGroupMessage
dedent|''
name|'def'
name|'sendGroupMessage'
op|'('
name|'self'
op|','
name|'text'
op|','
name|'meta'
op|'='
op|'{'
op|'}'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'account'
op|'.'
name|'client'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'locals'
op|'.'
name|'OfflineError'
newline|'\n'
dedent|''
name|'if'
name|'meta'
name|'and'
name|'meta'
op|'.'
name|'get'
op|'('
string|'"style"'
op|','
name|'None'
op|')'
op|'=='
string|'"emote"'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'account'
op|'.'
name|'client'
op|'.'
name|'me'
op|'('
name|'self'
op|'.'
name|'name'
op|','
name|'text'
op|')'
newline|'\n'
name|'return'
name|'succeed'
op|'('
name|'text'
op|')'
newline|'\n'
comment|"#standard shmandard, clients don't support plain escaped newlines!"
nl|'\n'
dedent|''
name|'for'
name|'line'
name|'in'
name|'string'
op|'.'
name|'split'
op|'('
name|'text'
op|','
string|"'\\n'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'account'
op|'.'
name|'client'
op|'.'
name|'say'
op|'('
name|'self'
op|'.'
name|'name'
op|','
name|'line'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'succeed'
op|'('
name|'text'
op|')'
newline|'\n'
nl|'\n'
DECL|member|leave
dedent|''
name|'def'
name|'leave'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'account'
op|'.'
name|'client'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'locals'
op|'.'
name|'OfflineError'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'account'
op|'.'
name|'client'
op|'.'
name|'leave'
op|'('
name|'self'
op|'.'
name|'name'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'account'
op|'.'
name|'client'
op|'.'
name|'getGroupConversation'
op|'('
name|'self'
op|'.'
name|'name'
op|','
number|'1'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|IRCProto
dedent|''
dedent|''
name|'class'
name|'IRCProto'
op|'('
name|'basesupport'
op|'.'
name|'AbstractClientMixin'
op|','
name|'irc'
op|'.'
name|'IRCClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'account'
op|','
name|'chatui'
op|','
name|'logonDeferred'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'basesupport'
op|'.'
name|'AbstractClientMixin'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'account'
op|','
name|'chatui'
op|','
nl|'\n'
name|'logonDeferred'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_namreplies'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'_ingroups'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'_groups'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'_topics'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
DECL|member|getGroupConversation
dedent|''
name|'def'
name|'getGroupConversation'
op|'('
name|'self'
op|','
name|'name'
op|','
name|'hide'
op|'='
number|'0'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'name'
op|'='
name|'string'
op|'.'
name|'lower'
op|'('
name|'name'
op|')'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'chat'
op|'.'
name|'getGroupConversation'
op|'('
name|'self'
op|'.'
name|'chat'
op|'.'
name|'getGroup'
op|'('
name|'name'
op|','
name|'self'
op|')'
op|','
nl|'\n'
name|'stayHidden'
op|'='
name|'hide'
op|')'
newline|'\n'
nl|'\n'
DECL|member|getPerson
dedent|''
name|'def'
name|'getPerson'
op|'('
name|'self'
op|','
name|'name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'chat'
op|'.'
name|'getPerson'
op|'('
name|'name'
op|','
name|'self'
op|')'
newline|'\n'
nl|'\n'
DECL|member|connectionMade
dedent|''
name|'def'
name|'connectionMade'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# XXX: Why do I duplicate code in IRCClient.register?'
nl|'\n'
indent|'        '
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'self'
op|'.'
name|'account'
op|'.'
name|'password'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'sendLine'
op|'('
string|'"PASS :%s"'
op|'%'
name|'self'
op|'.'
name|'account'
op|'.'
name|'password'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'setNick'
op|'('
name|'self'
op|'.'
name|'account'
op|'.'
name|'username'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'sendLine'
op|'('
string|'"USER %s foo bar :Twisted-IM user"'
op|'%'
op|'('
name|'self'
op|'.'
name|'nickname'
op|','
op|')'
op|')'
newline|'\n'
name|'for'
name|'channel'
name|'in'
name|'self'
op|'.'
name|'account'
op|'.'
name|'channels'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'joinGroup'
op|'('
name|'channel'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'account'
op|'.'
name|'_isOnline'
op|'='
number|'1'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'_logonDeferred'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'_logonDeferred'
op|'.'
name|'callback'
op|'('
name|'self'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'chat'
op|'.'
name|'getContactsList'
op|'('
op|')'
newline|'\n'
dedent|''
name|'except'
op|':'
newline|'\n'
indent|'            '
name|'import'
name|'traceback'
newline|'\n'
name|'traceback'
op|'.'
name|'print_exc'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|setNick
dedent|''
dedent|''
name|'def'
name|'setNick'
op|'('
name|'self'
op|','
name|'nick'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'name'
op|'='
name|'nick'
newline|'\n'
name|'self'
op|'.'
name|'accountName'
op|'='
string|'"%s (IRC)"'
op|'%'
name|'nick'
newline|'\n'
name|'irc'
op|'.'
name|'IRCClient'
op|'.'
name|'setNick'
op|'('
name|'self'
op|','
name|'nick'
op|')'
newline|'\n'
nl|'\n'
DECL|member|kickedFrom
dedent|''
name|'def'
name|'kickedFrom'
op|'('
name|'self'
op|','
name|'channel'
op|','
name|'kicker'
op|','
name|'message'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        Called when I am kicked from a channel.\n        """'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'chat'
op|'.'
name|'getGroupConversation'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'chat'
op|'.'
name|'getGroup'
op|'('
name|'channel'
op|'['
number|'1'
op|':'
op|']'
op|','
name|'self'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
nl|'\n'
DECL|member|userKicked
dedent|''
name|'def'
name|'userKicked'
op|'('
name|'self'
op|','
name|'kickee'
op|','
name|'channel'
op|','
name|'kicker'
op|','
name|'message'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pass'
newline|'\n'
nl|'\n'
DECL|member|noticed
dedent|''
name|'def'
name|'noticed'
op|'('
name|'self'
op|','
name|'username'
op|','
name|'channel'
op|','
name|'message'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'privmsg'
op|'('
name|'username'
op|','
name|'channel'
op|','
name|'message'
op|','
op|'{'
string|'"dontAutoRespond"'
op|':'
number|'1'
op|'}'
op|')'
newline|'\n'
nl|'\n'
DECL|member|privmsg
dedent|''
name|'def'
name|'privmsg'
op|'('
name|'self'
op|','
name|'username'
op|','
name|'channel'
op|','
name|'message'
op|','
name|'metadata'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'metadata'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'metadata'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
name|'username'
op|'='
name|'string'
op|'.'
name|'split'
op|'('
name|'username'
op|','
string|"'!'"
op|','
number|'1'
op|')'
op|'['
number|'0'
op|']'
newline|'\n'
name|'if'
name|'username'
op|'=='
name|'self'
op|'.'
name|'name'
op|':'
name|'return'
newline|'\n'
name|'if'
name|'channel'
op|'['
number|'0'
op|']'
op|'=='
string|"'#'"
op|':'
newline|'\n'
indent|'            '
name|'group'
op|'='
name|'channel'
op|'['
number|'1'
op|':'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'getGroupConversation'
op|'('
name|'group'
op|')'
op|'.'
name|'showGroupMessage'
op|'('
name|'username'
op|','
name|'message'
op|','
name|'metadata'
op|')'
newline|'\n'
name|'return'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'chat'
op|'.'
name|'getConversation'
op|'('
name|'self'
op|'.'
name|'getPerson'
op|'('
name|'username'
op|')'
op|')'
op|'.'
name|'showMessage'
op|'('
name|'message'
op|','
name|'metadata'
op|')'
newline|'\n'
nl|'\n'
DECL|member|action
dedent|''
name|'def'
name|'action'
op|'('
name|'self'
op|','
name|'username'
op|','
name|'channel'
op|','
name|'emote'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'username'
op|'='
name|'string'
op|'.'
name|'split'
op|'('
name|'username'
op|','
string|"'!'"
op|','
number|'1'
op|')'
op|'['
number|'0'
op|']'
newline|'\n'
name|'if'
name|'username'
op|'=='
name|'self'
op|'.'
name|'name'
op|':'
name|'return'
newline|'\n'
name|'meta'
op|'='
op|'{'
string|"'style'"
op|':'
string|"'emote'"
op|'}'
newline|'\n'
name|'if'
name|'channel'
op|'['
number|'0'
op|']'
op|'=='
string|"'#'"
op|':'
newline|'\n'
indent|'            '
name|'group'
op|'='
name|'channel'
op|'['
number|'1'
op|':'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'getGroupConversation'
op|'('
name|'group'
op|')'
op|'.'
name|'showGroupMessage'
op|'('
name|'username'
op|','
name|'emote'
op|','
name|'meta'
op|')'
newline|'\n'
name|'return'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'chat'
op|'.'
name|'getConversation'
op|'('
name|'self'
op|'.'
name|'getPerson'
op|'('
name|'username'
op|')'
op|')'
op|'.'
name|'showMessage'
op|'('
name|'emote'
op|','
name|'meta'
op|')'
newline|'\n'
nl|'\n'
DECL|member|irc_RPL_NAMREPLY
dedent|''
name|'def'
name|'irc_RPL_NAMREPLY'
op|'('
name|'self'
op|','
name|'prefix'
op|','
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        RPL_NAMREPLY\n        >> NAMES #bnl\n        << :Arlington.VA.US.Undernet.Org 353 z3p = #bnl :pSwede Dan-- SkOyg AG\n        """'
newline|'\n'
name|'group'
op|'='
name|'string'
op|'.'
name|'lower'
op|'('
name|'params'
op|'['
number|'2'
op|']'
op|'['
number|'1'
op|':'
op|']'
op|')'
newline|'\n'
name|'users'
op|'='
name|'string'
op|'.'
name|'split'
op|'('
name|'params'
op|'['
number|'3'
op|']'
op|')'
newline|'\n'
name|'for'
name|'ui'
name|'in'
name|'range'
op|'('
name|'len'
op|'('
name|'users'
op|')'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'while'
name|'users'
op|'['
name|'ui'
op|']'
op|'['
number|'0'
op|']'
name|'in'
op|'['
string|'"@"'
op|','
string|'"+"'
op|']'
op|':'
comment|'# channel modes'
newline|'\n'
indent|'                '
name|'users'
op|'['
name|'ui'
op|']'
op|'='
name|'users'
op|'['
name|'ui'
op|']'
op|'['
number|'1'
op|':'
op|']'
newline|'\n'
dedent|''
dedent|''
name|'if'
name|'not'
name|'self'
op|'.'
name|'_namreplies'
op|'.'
name|'has_key'
op|'('
name|'group'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'_namreplies'
op|'['
name|'group'
op|']'
op|'='
op|'['
op|']'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'_namreplies'
op|'['
name|'group'
op|']'
op|'.'
name|'extend'
op|'('
name|'users'
op|')'
newline|'\n'
name|'for'
name|'nickname'
name|'in'
name|'users'
op|':'
newline|'\n'
indent|'                '
name|'try'
op|':'
newline|'\n'
indent|'                    '
name|'self'
op|'.'
name|'_ingroups'
op|'['
name|'nickname'
op|']'
op|'.'
name|'append'
op|'('
name|'group'
op|')'
newline|'\n'
dedent|''
name|'except'
op|':'
newline|'\n'
indent|'                    '
name|'self'
op|'.'
name|'_ingroups'
op|'['
name|'nickname'
op|']'
op|'='
op|'['
name|'group'
op|']'
newline|'\n'
nl|'\n'
DECL|member|irc_RPL_ENDOFNAMES
dedent|''
dedent|''
dedent|''
name|'def'
name|'irc_RPL_ENDOFNAMES'
op|'('
name|'self'
op|','
name|'prefix'
op|','
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'group'
op|'='
name|'params'
op|'['
number|'1'
op|']'
op|'['
number|'1'
op|':'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'getGroupConversation'
op|'('
name|'group'
op|')'
op|'.'
name|'setGroupMembers'
op|'('
name|'self'
op|'.'
name|'_namreplies'
op|'['
name|'string'
op|'.'
name|'lower'
op|'('
name|'group'
op|')'
op|']'
op|')'
newline|'\n'
name|'del'
name|'self'
op|'.'
name|'_namreplies'
op|'['
name|'string'
op|'.'
name|'lower'
op|'('
name|'group'
op|')'
op|']'
newline|'\n'
nl|'\n'
DECL|member|irc_RPL_TOPIC
dedent|''
name|'def'
name|'irc_RPL_TOPIC'
op|'('
name|'self'
op|','
name|'prefix'
op|','
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_topics'
op|'['
name|'params'
op|'['
number|'1'
op|']'
op|'['
number|'1'
op|':'
op|']'
op|']'
op|'='
name|'params'
op|'['
number|'2'
op|']'
newline|'\n'
nl|'\n'
DECL|member|irc_333
dedent|''
name|'def'
name|'irc_333'
op|'('
name|'self'
op|','
name|'prefix'
op|','
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'group'
op|'='
name|'params'
op|'['
number|'1'
op|']'
op|'['
number|'1'
op|':'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'getGroupConversation'
op|'('
name|'group'
op|')'
op|'.'
name|'setTopic'
op|'('
name|'self'
op|'.'
name|'_topics'
op|'['
name|'group'
op|']'
op|','
name|'params'
op|'['
number|'2'
op|']'
op|')'
newline|'\n'
name|'del'
name|'self'
op|'.'
name|'_topics'
op|'['
name|'group'
op|']'
newline|'\n'
nl|'\n'
DECL|member|irc_TOPIC
dedent|''
name|'def'
name|'irc_TOPIC'
op|'('
name|'self'
op|','
name|'prefix'
op|','
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'nickname'
op|'='
name|'string'
op|'.'
name|'split'
op|'('
name|'prefix'
op|','
string|'"!"'
op|')'
op|'['
number|'0'
op|']'
newline|'\n'
name|'group'
op|'='
name|'params'
op|'['
number|'0'
op|']'
op|'['
number|'1'
op|':'
op|']'
newline|'\n'
name|'topic'
op|'='
name|'params'
op|'['
number|'1'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'getGroupConversation'
op|'('
name|'group'
op|')'
op|'.'
name|'setTopic'
op|'('
name|'topic'
op|','
name|'nickname'
op|')'
newline|'\n'
nl|'\n'
DECL|member|irc_JOIN
dedent|''
name|'def'
name|'irc_JOIN'
op|'('
name|'self'
op|','
name|'prefix'
op|','
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'nickname'
op|'='
name|'string'
op|'.'
name|'split'
op|'('
name|'prefix'
op|','
string|'"!"'
op|')'
op|'['
number|'0'
op|']'
newline|'\n'
name|'group'
op|'='
name|'string'
op|'.'
name|'lower'
op|'('
name|'params'
op|'['
number|'0'
op|']'
op|'['
number|'1'
op|':'
op|']'
op|')'
newline|'\n'
name|'if'
name|'nickname'
op|'!='
name|'self'
op|'.'
name|'nickname'
op|':'
newline|'\n'
indent|'            '
name|'try'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'_ingroups'
op|'['
name|'nickname'
op|']'
op|'.'
name|'append'
op|'('
name|'group'
op|')'
newline|'\n'
dedent|''
name|'except'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'_ingroups'
op|'['
name|'nickname'
op|']'
op|'='
op|'['
name|'group'
op|']'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'getGroupConversation'
op|'('
name|'group'
op|')'
op|'.'
name|'memberJoined'
op|'('
name|'nickname'
op|')'
newline|'\n'
nl|'\n'
DECL|member|irc_PART
dedent|''
dedent|''
name|'def'
name|'irc_PART'
op|'('
name|'self'
op|','
name|'prefix'
op|','
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'nickname'
op|'='
name|'string'
op|'.'
name|'split'
op|'('
name|'prefix'
op|','
string|'"!"'
op|')'
op|'['
number|'0'
op|']'
newline|'\n'
name|'group'
op|'='
name|'string'
op|'.'
name|'lower'
op|'('
name|'params'
op|'['
number|'0'
op|']'
op|'['
number|'1'
op|':'
op|']'
op|')'
newline|'\n'
name|'if'
name|'nickname'
op|'!='
name|'self'
op|'.'
name|'nickname'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'group'
name|'in'
name|'self'
op|'.'
name|'_ingroups'
op|'['
name|'nickname'
op|']'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'_ingroups'
op|'['
name|'nickname'
op|']'
op|'.'
name|'remove'
op|'('
name|'group'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'getGroupConversation'
op|'('
name|'group'
op|')'
op|'.'
name|'memberLeft'
op|'('
name|'nickname'
op|')'
newline|'\n'
nl|'\n'
DECL|member|irc_QUIT
dedent|''
dedent|''
dedent|''
name|'def'
name|'irc_QUIT'
op|'('
name|'self'
op|','
name|'prefix'
op|','
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'nickname'
op|'='
name|'string'
op|'.'
name|'split'
op|'('
name|'prefix'
op|','
string|'"!"'
op|')'
op|'['
number|'0'
op|']'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'_ingroups'
op|'.'
name|'has_key'
op|'('
name|'nickname'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'group'
name|'in'
name|'self'
op|'.'
name|'_ingroups'
op|'['
name|'nickname'
op|']'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'getGroupConversation'
op|'('
name|'group'
op|')'
op|'.'
name|'memberLeft'
op|'('
name|'nickname'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'_ingroups'
op|'['
name|'nickname'
op|']'
op|'='
op|'['
op|']'
newline|'\n'
nl|'\n'
DECL|member|irc_NICK
dedent|''
dedent|''
name|'def'
name|'irc_NICK'
op|'('
name|'self'
op|','
name|'prefix'
op|','
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'fromNick'
op|'='
name|'string'
op|'.'
name|'split'
op|'('
name|'prefix'
op|','
string|'"!"'
op|')'
op|'['
number|'0'
op|']'
newline|'\n'
name|'toNick'
op|'='
name|'params'
op|'['
number|'0'
op|']'
newline|'\n'
name|'if'
name|'not'
name|'self'
op|'.'
name|'_ingroups'
op|'.'
name|'has_key'
op|'('
name|'fromNick'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
newline|'\n'
dedent|''
name|'for'
name|'group'
name|'in'
name|'self'
op|'.'
name|'_ingroups'
op|'['
name|'fromNick'
op|']'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'getGroupConversation'
op|'('
name|'group'
op|')'
op|'.'
name|'memberChangedNick'
op|'('
name|'fromNick'
op|','
name|'toNick'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'_ingroups'
op|'['
name|'toNick'
op|']'
op|'='
name|'self'
op|'.'
name|'_ingroups'
op|'['
name|'fromNick'
op|']'
newline|'\n'
name|'del'
name|'self'
op|'.'
name|'_ingroups'
op|'['
name|'fromNick'
op|']'
newline|'\n'
nl|'\n'
DECL|member|irc_unknown
dedent|''
name|'def'
name|'irc_unknown'
op|'('
name|'self'
op|','
name|'prefix'
op|','
name|'command'
op|','
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pass'
newline|'\n'
nl|'\n'
comment|'# GTKIM calls'
nl|'\n'
DECL|member|joinGroup
dedent|''
name|'def'
name|'joinGroup'
op|'('
name|'self'
op|','
name|'name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'join'
op|'('
name|'name'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'getGroupConversation'
op|'('
name|'name'
op|')'
newline|'\n'
nl|'\n'
DECL|class|IRCAccount
dedent|''
dedent|''
name|'class'
name|'IRCAccount'
op|'('
name|'basesupport'
op|'.'
name|'AbstractAccount'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'implements'
op|'('
name|'interfaces'
op|'.'
name|'IAccount'
op|')'
newline|'\n'
DECL|variable|gatewayType
name|'gatewayType'
op|'='
string|'"IRC"'
newline|'\n'
nl|'\n'
DECL|variable|_groupFactory
name|'_groupFactory'
op|'='
name|'IRCGroup'
newline|'\n'
DECL|variable|_personFactory
name|'_personFactory'
op|'='
name|'IRCPerson'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'accountName'
op|','
name|'autoLogin'
op|','
name|'username'
op|','
name|'password'
op|','
name|'host'
op|','
name|'port'
op|','
nl|'\n'
name|'channels'
op|'='
string|"''"
op|')'
op|':'
newline|'\n'
indent|'        '
name|'basesupport'
op|'.'
name|'AbstractAccount'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'accountName'
op|','
name|'autoLogin'
op|','
nl|'\n'
name|'username'
op|','
name|'password'
op|','
name|'host'
op|','
name|'port'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'channels'
op|'='
name|'map'
op|'('
name|'string'
op|'.'
name|'strip'
op|','
name|'string'
op|'.'
name|'split'
op|'('
name|'channels'
op|','
string|"','"
op|')'
op|')'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'channels'
op|'=='
op|'['
string|"''"
op|']'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'channels'
op|'='
op|'['
op|']'
newline|'\n'
nl|'\n'
DECL|member|_startLogOn
dedent|''
dedent|''
name|'def'
name|'_startLogOn'
op|'('
name|'self'
op|','
name|'chatui'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'logonDeferred'
op|'='
name|'defer'
op|'.'
name|'Deferred'
op|'('
op|')'
newline|'\n'
name|'cc'
op|'='
name|'protocol'
op|'.'
name|'ClientCreator'
op|'('
name|'reactor'
op|','
name|'IRCProto'
op|','
name|'self'
op|','
name|'chatui'
op|','
nl|'\n'
name|'logonDeferred'
op|')'
newline|'\n'
name|'d'
op|'='
name|'cc'
op|'.'
name|'connectTCP'
op|'('
name|'self'
op|'.'
name|'host'
op|','
name|'self'
op|'.'
name|'port'
op|')'
newline|'\n'
name|'d'
op|'.'
name|'addErrback'
op|'('
name|'logonDeferred'
op|'.'
name|'errback'
op|')'
newline|'\n'
name|'return'
name|'logonDeferred'
newline|'\n'
dedent|''
dedent|''
endmarker|''
end_unit
