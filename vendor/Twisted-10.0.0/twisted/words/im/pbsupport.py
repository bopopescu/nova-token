begin_unit
comment|'# Copyright (c) 2001-2004 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
nl|'\n'
string|'"""L{twisted.words} support for Instance Messenger."""'
newline|'\n'
nl|'\n'
name|'from'
name|'__future__'
name|'import'
name|'nested_scopes'
newline|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'defer'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'error'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'python'
name|'import'
name|'log'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'python'
op|'.'
name|'failure'
name|'import'
name|'Failure'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'spread'
name|'import'
name|'pb'
newline|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'words'
op|'.'
name|'im'
op|'.'
name|'locals'
name|'import'
name|'ONLINE'
op|','
name|'OFFLINE'
op|','
name|'AWAY'
newline|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'words'
op|'.'
name|'im'
name|'import'
name|'basesupport'
op|','
name|'interfaces'
newline|'\n'
name|'from'
name|'zope'
op|'.'
name|'interface'
name|'import'
name|'implements'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TwistedWordsPerson
name|'class'
name|'TwistedWordsPerson'
op|'('
name|'basesupport'
op|'.'
name|'AbstractPerson'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""I a facade for a person you can talk to through a twisted.words service.\n    """'
newline|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'name'
op|','
name|'wordsAccount'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'basesupport'
op|'.'
name|'AbstractPerson'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'name'
op|','
name|'wordsAccount'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'status'
op|'='
name|'OFFLINE'
newline|'\n'
nl|'\n'
DECL|member|isOnline
dedent|''
name|'def'
name|'isOnline'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
op|'('
op|'('
name|'self'
op|'.'
name|'status'
op|'=='
name|'ONLINE'
op|')'
name|'or'
nl|'\n'
op|'('
name|'self'
op|'.'
name|'status'
op|'=='
name|'AWAY'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|getStatus
dedent|''
name|'def'
name|'getStatus'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'status'
newline|'\n'
nl|'\n'
DECL|member|sendMessage
dedent|''
name|'def'
name|'sendMessage'
op|'('
name|'self'
op|','
name|'text'
op|','
name|'metadata'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Return a deferred...\n        """'
newline|'\n'
name|'if'
name|'metadata'
op|':'
newline|'\n'
indent|'            '
name|'d'
op|'='
name|'self'
op|'.'
name|'account'
op|'.'
name|'client'
op|'.'
name|'perspective'
op|'.'
name|'directMessage'
op|'('
name|'self'
op|'.'
name|'name'
op|','
nl|'\n'
name|'text'
op|','
name|'metadata'
op|')'
newline|'\n'
name|'d'
op|'.'
name|'addErrback'
op|'('
name|'self'
op|'.'
name|'metadataFailed'
op|','
string|'"* "'
op|'+'
name|'text'
op|')'
newline|'\n'
name|'return'
name|'d'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'account'
op|'.'
name|'client'
op|'.'
name|'perspective'
op|'.'
name|'callRemote'
op|'('
string|"'directMessage'"
op|','
name|'self'
op|'.'
name|'name'
op|','
name|'text'
op|')'
newline|'\n'
nl|'\n'
DECL|member|metadataFailed
dedent|''
dedent|''
name|'def'
name|'metadataFailed'
op|'('
name|'self'
op|','
name|'result'
op|','
name|'text'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|'"result:"'
op|','
name|'result'
op|','
string|'"text:"'
op|','
name|'text'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'account'
op|'.'
name|'client'
op|'.'
name|'perspective'
op|'.'
name|'directMessage'
op|'('
name|'self'
op|'.'
name|'name'
op|','
name|'text'
op|')'
newline|'\n'
nl|'\n'
DECL|member|setStatus
dedent|''
name|'def'
name|'setStatus'
op|'('
name|'self'
op|','
name|'status'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'status'
op|'='
name|'status'
newline|'\n'
name|'self'
op|'.'
name|'chat'
op|'.'
name|'getContactsList'
op|'('
op|')'
op|'.'
name|'setContactStatus'
op|'('
name|'self'
op|')'
newline|'\n'
nl|'\n'
DECL|class|TwistedWordsGroup
dedent|''
dedent|''
name|'class'
name|'TwistedWordsGroup'
op|'('
name|'basesupport'
op|'.'
name|'AbstractGroup'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'implements'
op|'('
name|'interfaces'
op|'.'
name|'IGroup'
op|')'
newline|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'name'
op|','
name|'wordsClient'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'basesupport'
op|'.'
name|'AbstractGroup'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'name'
op|','
name|'wordsClient'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'joined'
op|'='
number|'0'
newline|'\n'
nl|'\n'
DECL|member|sendGroupMessage
dedent|''
name|'def'
name|'sendGroupMessage'
op|'('
name|'self'
op|','
name|'text'
op|','
name|'metadata'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Return a deferred.\n        """'
newline|'\n'
comment|'#for backwards compatibility with older twisted.words servers.'
nl|'\n'
name|'if'
name|'metadata'
op|':'
newline|'\n'
indent|'            '
name|'d'
op|'='
name|'self'
op|'.'
name|'account'
op|'.'
name|'client'
op|'.'
name|'perspective'
op|'.'
name|'callRemote'
op|'('
nl|'\n'
string|"'groupMessage'"
op|','
name|'self'
op|'.'
name|'name'
op|','
name|'text'
op|','
name|'metadata'
op|')'
newline|'\n'
name|'d'
op|'.'
name|'addErrback'
op|'('
name|'self'
op|'.'
name|'metadataFailed'
op|','
string|'"* "'
op|'+'
name|'text'
op|')'
newline|'\n'
name|'return'
name|'d'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'account'
op|'.'
name|'client'
op|'.'
name|'perspective'
op|'.'
name|'callRemote'
op|'('
string|"'groupMessage'"
op|','
nl|'\n'
name|'self'
op|'.'
name|'name'
op|','
name|'text'
op|')'
newline|'\n'
nl|'\n'
DECL|member|setTopic
dedent|''
dedent|''
name|'def'
name|'setTopic'
op|'('
name|'self'
op|','
name|'text'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'account'
op|'.'
name|'client'
op|'.'
name|'perspective'
op|'.'
name|'callRemote'
op|'('
nl|'\n'
string|"'setGroupMetadata'"
op|','
nl|'\n'
op|'{'
string|"'topic'"
op|':'
name|'text'
op|','
string|"'topic_author'"
op|':'
name|'self'
op|'.'
name|'client'
op|'.'
name|'name'
op|'}'
op|','
nl|'\n'
name|'self'
op|'.'
name|'name'
op|')'
newline|'\n'
nl|'\n'
DECL|member|metadataFailed
dedent|''
name|'def'
name|'metadataFailed'
op|'('
name|'self'
op|','
name|'result'
op|','
name|'text'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|'"result:"'
op|','
name|'result'
op|','
string|'"text:"'
op|','
name|'text'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'account'
op|'.'
name|'client'
op|'.'
name|'perspective'
op|'.'
name|'callRemote'
op|'('
string|"'groupMessage'"
op|','
nl|'\n'
name|'self'
op|'.'
name|'name'
op|','
name|'text'
op|')'
newline|'\n'
nl|'\n'
DECL|member|joining
dedent|''
name|'def'
name|'joining'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'joined'
op|'='
number|'1'
newline|'\n'
nl|'\n'
DECL|member|leaving
dedent|''
name|'def'
name|'leaving'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'joined'
op|'='
number|'0'
newline|'\n'
nl|'\n'
DECL|member|leave
dedent|''
name|'def'
name|'leave'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'account'
op|'.'
name|'client'
op|'.'
name|'perspective'
op|'.'
name|'callRemote'
op|'('
string|"'leaveGroup'"
op|','
nl|'\n'
name|'self'
op|'.'
name|'name'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
nl|'\n'
DECL|class|TwistedWordsClient
dedent|''
dedent|''
name|'class'
name|'TwistedWordsClient'
op|'('
name|'pb'
op|'.'
name|'Referenceable'
op|','
name|'basesupport'
op|'.'
name|'AbstractClientMixin'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""In some cases, this acts as an Account, since it a source of text\n    messages (multiple Words instances may be on a single PB connection)\n    """'
newline|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'acct'
op|','
name|'serviceName'
op|','
name|'perspectiveName'
op|','
name|'chatui'
op|','
nl|'\n'
name|'_logonDeferred'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'accountName'
op|'='
string|'"%s (%s:%s)"'
op|'%'
op|'('
name|'acct'
op|'.'
name|'accountName'
op|','
name|'serviceName'
op|','
name|'perspectiveName'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'name'
op|'='
name|'perspectiveName'
newline|'\n'
name|'print'
string|'"HELLO I AM A PB SERVICE"'
op|','
name|'serviceName'
op|','
name|'perspectiveName'
newline|'\n'
name|'self'
op|'.'
name|'chat'
op|'='
name|'chatui'
newline|'\n'
name|'self'
op|'.'
name|'account'
op|'='
name|'acct'
newline|'\n'
name|'self'
op|'.'
name|'_logonDeferred'
op|'='
name|'_logonDeferred'
newline|'\n'
nl|'\n'
DECL|member|getPerson
dedent|''
name|'def'
name|'getPerson'
op|'('
name|'self'
op|','
name|'name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'chat'
op|'.'
name|'getPerson'
op|'('
name|'name'
op|','
name|'self'
op|')'
newline|'\n'
nl|'\n'
DECL|member|getGroup
dedent|''
name|'def'
name|'getGroup'
op|'('
name|'self'
op|','
name|'name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'chat'
op|'.'
name|'getGroup'
op|'('
name|'name'
op|','
name|'self'
op|')'
newline|'\n'
nl|'\n'
DECL|member|getGroupConversation
dedent|''
name|'def'
name|'getGroupConversation'
op|'('
name|'self'
op|','
name|'name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'chat'
op|'.'
name|'getGroupConversation'
op|'('
name|'self'
op|'.'
name|'getGroup'
op|'('
name|'name'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|addContact
dedent|''
name|'def'
name|'addContact'
op|'('
name|'self'
op|','
name|'name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'perspective'
op|'.'
name|'callRemote'
op|'('
string|"'addContact'"
op|','
name|'name'
op|')'
newline|'\n'
nl|'\n'
DECL|member|remote_receiveGroupMembers
dedent|''
name|'def'
name|'remote_receiveGroupMembers'
op|'('
name|'self'
op|','
name|'names'
op|','
name|'group'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|"'received group members:'"
op|','
name|'names'
op|','
name|'group'
newline|'\n'
name|'self'
op|'.'
name|'getGroupConversation'
op|'('
name|'group'
op|')'
op|'.'
name|'setGroupMembers'
op|'('
name|'names'
op|')'
newline|'\n'
nl|'\n'
DECL|member|remote_receiveGroupMessage
dedent|''
name|'def'
name|'remote_receiveGroupMessage'
op|'('
name|'self'
op|','
name|'sender'
op|','
name|'group'
op|','
name|'message'
op|','
name|'metadata'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|"'received a group message'"
op|','
name|'sender'
op|','
name|'group'
op|','
name|'message'
op|','
name|'metadata'
newline|'\n'
name|'self'
op|'.'
name|'getGroupConversation'
op|'('
name|'group'
op|')'
op|'.'
name|'showGroupMessage'
op|'('
name|'sender'
op|','
name|'message'
op|','
name|'metadata'
op|')'
newline|'\n'
nl|'\n'
DECL|member|remote_memberJoined
dedent|''
name|'def'
name|'remote_memberJoined'
op|'('
name|'self'
op|','
name|'member'
op|','
name|'group'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|"'member joined'"
op|','
name|'member'
op|','
name|'group'
newline|'\n'
name|'self'
op|'.'
name|'getGroupConversation'
op|'('
name|'group'
op|')'
op|'.'
name|'memberJoined'
op|'('
name|'member'
op|')'
newline|'\n'
nl|'\n'
DECL|member|remote_memberLeft
dedent|''
name|'def'
name|'remote_memberLeft'
op|'('
name|'self'
op|','
name|'member'
op|','
name|'group'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|"'member left'"
newline|'\n'
name|'self'
op|'.'
name|'getGroupConversation'
op|'('
name|'group'
op|')'
op|'.'
name|'memberLeft'
op|'('
name|'member'
op|')'
newline|'\n'
nl|'\n'
DECL|member|remote_notifyStatusChanged
dedent|''
name|'def'
name|'remote_notifyStatusChanged'
op|'('
name|'self'
op|','
name|'name'
op|','
name|'status'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'chat'
op|'.'
name|'getPerson'
op|'('
name|'name'
op|','
name|'self'
op|')'
op|'.'
name|'setStatus'
op|'('
name|'status'
op|')'
newline|'\n'
nl|'\n'
DECL|member|remote_receiveDirectMessage
dedent|''
name|'def'
name|'remote_receiveDirectMessage'
op|'('
name|'self'
op|','
name|'name'
op|','
name|'message'
op|','
name|'metadata'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'chat'
op|'.'
name|'getConversation'
op|'('
name|'self'
op|'.'
name|'chat'
op|'.'
name|'getPerson'
op|'('
name|'name'
op|','
name|'self'
op|')'
op|')'
op|'.'
name|'showMessage'
op|'('
name|'message'
op|','
name|'metadata'
op|')'
newline|'\n'
nl|'\n'
DECL|member|remote_receiveContactList
dedent|''
name|'def'
name|'remote_receiveContactList'
op|'('
name|'self'
op|','
name|'clist'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'for'
name|'name'
op|','
name|'status'
name|'in'
name|'clist'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'chat'
op|'.'
name|'getPerson'
op|'('
name|'name'
op|','
name|'self'
op|')'
op|'.'
name|'setStatus'
op|'('
name|'status'
op|')'
newline|'\n'
nl|'\n'
DECL|member|remote_setGroupMetadata
dedent|''
dedent|''
name|'def'
name|'remote_setGroupMetadata'
op|'('
name|'self'
op|','
name|'dict_'
op|','
name|'groupName'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'dict_'
op|'.'
name|'has_key'
op|'('
string|'"topic"'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'getGroupConversation'
op|'('
name|'groupName'
op|')'
op|'.'
name|'setTopic'
op|'('
name|'dict_'
op|'['
string|'"topic"'
op|']'
op|','
name|'dict_'
op|'.'
name|'get'
op|'('
string|'"topic_author"'
op|','
name|'None'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|joinGroup
dedent|''
dedent|''
name|'def'
name|'joinGroup'
op|'('
name|'self'
op|','
name|'name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'getGroup'
op|'('
name|'name'
op|')'
op|'.'
name|'joining'
op|'('
op|')'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'perspective'
op|'.'
name|'callRemote'
op|'('
string|"'joinGroup'"
op|','
name|'name'
op|')'
op|'.'
name|'addCallback'
op|'('
name|'self'
op|'.'
name|'_cbGroupJoined'
op|','
name|'name'
op|')'
newline|'\n'
nl|'\n'
DECL|member|leaveGroup
dedent|''
name|'def'
name|'leaveGroup'
op|'('
name|'self'
op|','
name|'name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'getGroup'
op|'('
name|'name'
op|')'
op|'.'
name|'leaving'
op|'('
op|')'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'perspective'
op|'.'
name|'callRemote'
op|'('
string|"'leaveGroup'"
op|','
name|'name'
op|')'
op|'.'
name|'addCallback'
op|'('
name|'self'
op|'.'
name|'_cbGroupLeft'
op|','
name|'name'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_cbGroupJoined
dedent|''
name|'def'
name|'_cbGroupJoined'
op|'('
name|'self'
op|','
name|'result'
op|','
name|'name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'groupConv'
op|'='
name|'self'
op|'.'
name|'chat'
op|'.'
name|'getGroupConversation'
op|'('
name|'self'
op|'.'
name|'getGroup'
op|'('
name|'name'
op|')'
op|')'
newline|'\n'
name|'groupConv'
op|'.'
name|'showGroupMessage'
op|'('
string|'"sys"'
op|','
string|'"you joined"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'perspective'
op|'.'
name|'callRemote'
op|'('
string|"'getGroupMembers'"
op|','
name|'name'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_cbGroupLeft
dedent|''
name|'def'
name|'_cbGroupLeft'
op|'('
name|'self'
op|','
name|'result'
op|','
name|'name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|"'left'"
op|','
name|'name'
newline|'\n'
name|'groupConv'
op|'='
name|'self'
op|'.'
name|'chat'
op|'.'
name|'getGroupConversation'
op|'('
name|'self'
op|'.'
name|'getGroup'
op|'('
name|'name'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'groupConv'
op|'.'
name|'showGroupMessage'
op|'('
string|'"sys"'
op|','
string|'"you left"'
op|')'
newline|'\n'
nl|'\n'
DECL|member|connected
dedent|''
name|'def'
name|'connected'
op|'('
name|'self'
op|','
name|'perspective'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|"'Connected Words Client!'"
op|','
name|'perspective'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'_logonDeferred'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'_logonDeferred'
op|'.'
name|'callback'
op|'('
name|'self'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'perspective'
op|'='
name|'perspective'
newline|'\n'
name|'self'
op|'.'
name|'chat'
op|'.'
name|'getContactsList'
op|'('
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|variable|pbFrontEnds
dedent|''
dedent|''
name|'pbFrontEnds'
op|'='
op|'{'
nl|'\n'
string|'"twisted.words"'
op|':'
name|'TwistedWordsClient'
op|','
nl|'\n'
string|'"twisted.reality"'
op|':'
name|'None'
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|PBAccount
name|'class'
name|'PBAccount'
op|'('
name|'basesupport'
op|'.'
name|'AbstractAccount'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'implements'
op|'('
name|'interfaces'
op|'.'
name|'IAccount'
op|')'
newline|'\n'
DECL|variable|gatewayType
name|'gatewayType'
op|'='
string|'"PB"'
newline|'\n'
DECL|variable|_groupFactory
name|'_groupFactory'
op|'='
name|'TwistedWordsGroup'
newline|'\n'
DECL|variable|_personFactory
name|'_personFactory'
op|'='
name|'TwistedWordsPerson'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'accountName'
op|','
name|'autoLogin'
op|','
name|'username'
op|','
name|'password'
op|','
name|'host'
op|','
name|'port'
op|','
nl|'\n'
name|'services'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        @param username: The name of your PB Identity.\n        @type username: string\n        """'
newline|'\n'
name|'basesupport'
op|'.'
name|'AbstractAccount'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'accountName'
op|','
name|'autoLogin'
op|','
nl|'\n'
name|'username'
op|','
name|'password'
op|','
name|'host'
op|','
name|'port'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'services'
op|'='
op|'['
op|']'
newline|'\n'
name|'if'
name|'not'
name|'services'
op|':'
newline|'\n'
indent|'            '
name|'services'
op|'='
op|'['
op|'('
string|"'twisted.words'"
op|','
string|"'twisted.words'"
op|','
name|'username'
op|')'
op|']'
newline|'\n'
dedent|''
name|'for'
name|'serviceType'
op|','
name|'serviceName'
op|','
name|'perspectiveName'
name|'in'
name|'services'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'services'
op|'.'
name|'append'
op|'('
op|'['
name|'pbFrontEnds'
op|'['
name|'serviceType'
op|']'
op|','
name|'serviceName'
op|','
nl|'\n'
name|'perspectiveName'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|logOn
dedent|''
dedent|''
name|'def'
name|'logOn'
op|'('
name|'self'
op|','
name|'chatui'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        @returns: this breaks with L{interfaces.IAccount}\n        @returntype: DeferredList of L{interfaces.IClient}s\n        """'
newline|'\n'
comment|"# Overriding basesupport's implementation on account of the"
nl|'\n'
comment|'# fact that _startLogOn tends to return a deferredList rather'
nl|'\n'
comment|'# than a simple Deferred, and we need to do registerAccountClient.'
nl|'\n'
name|'if'
op|'('
name|'not'
name|'self'
op|'.'
name|'_isConnecting'
op|')'
name|'and'
op|'('
name|'not'
name|'self'
op|'.'
name|'_isOnline'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'_isConnecting'
op|'='
number|'1'
newline|'\n'
name|'d'
op|'='
name|'self'
op|'.'
name|'_startLogOn'
op|'('
name|'chatui'
op|')'
newline|'\n'
name|'d'
op|'.'
name|'addErrback'
op|'('
name|'self'
op|'.'
name|'_loginFailed'
op|')'
newline|'\n'
DECL|function|registerMany
name|'def'
name|'registerMany'
op|'('
name|'results'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'for'
name|'success'
op|','
name|'result'
name|'in'
name|'results'
op|':'
newline|'\n'
indent|'                    '
name|'if'
name|'success'
op|':'
newline|'\n'
indent|'                        '
name|'chatui'
op|'.'
name|'registerAccountClient'
op|'('
name|'result'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_cb_logOn'
op|'('
name|'result'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                        '
name|'log'
op|'.'
name|'err'
op|'('
name|'result'
op|')'
newline|'\n'
dedent|''
dedent|''
dedent|''
name|'d'
op|'.'
name|'addCallback'
op|'('
name|'registerMany'
op|')'
newline|'\n'
name|'return'
name|'d'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'error'
op|'.'
name|'ConnectionError'
op|'('
string|'"Connection in progress"'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|_startLogOn
dedent|''
dedent|''
name|'def'
name|'_startLogOn'
op|'('
name|'self'
op|','
name|'chatui'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|"'Connecting...'"
op|','
newline|'\n'
name|'d'
op|'='
name|'pb'
op|'.'
name|'getObjectAt'
op|'('
name|'self'
op|'.'
name|'host'
op|','
name|'self'
op|'.'
name|'port'
op|')'
newline|'\n'
name|'d'
op|'.'
name|'addCallbacks'
op|'('
name|'self'
op|'.'
name|'_cbConnected'
op|','
name|'self'
op|'.'
name|'_ebConnected'
op|','
nl|'\n'
name|'callbackArgs'
op|'='
op|'('
name|'chatui'
op|','
op|')'
op|')'
newline|'\n'
name|'return'
name|'d'
newline|'\n'
nl|'\n'
DECL|member|_cbConnected
dedent|''
name|'def'
name|'_cbConnected'
op|'('
name|'self'
op|','
name|'root'
op|','
name|'chatui'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|"'Connected!'"
newline|'\n'
name|'print'
string|"'Identifying...'"
op|','
newline|'\n'
name|'d'
op|'='
name|'pb'
op|'.'
name|'authIdentity'
op|'('
name|'root'
op|','
name|'self'
op|'.'
name|'username'
op|','
name|'self'
op|'.'
name|'password'
op|')'
newline|'\n'
name|'d'
op|'.'
name|'addCallbacks'
op|'('
name|'self'
op|'.'
name|'_cbIdent'
op|','
name|'self'
op|'.'
name|'_ebConnected'
op|','
nl|'\n'
name|'callbackArgs'
op|'='
op|'('
name|'chatui'
op|','
op|')'
op|')'
newline|'\n'
name|'return'
name|'d'
newline|'\n'
nl|'\n'
DECL|member|_cbIdent
dedent|''
name|'def'
name|'_cbIdent'
op|'('
name|'self'
op|','
name|'ident'
op|','
name|'chatui'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'not'
name|'ident'
op|':'
newline|'\n'
indent|'            '
name|'print'
string|"'falsely identified.'"
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'_ebConnected'
op|'('
name|'Failure'
op|'('
name|'Exception'
op|'('
string|'"username or password incorrect"'
op|')'
op|')'
op|')'
newline|'\n'
dedent|''
name|'print'
string|"'Identified!'"
newline|'\n'
name|'dl'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'handlerClass'
op|','
name|'sname'
op|','
name|'pname'
name|'in'
name|'self'
op|'.'
name|'services'
op|':'
newline|'\n'
indent|'            '
name|'d'
op|'='
name|'defer'
op|'.'
name|'Deferred'
op|'('
op|')'
newline|'\n'
name|'dl'
op|'.'
name|'append'
op|'('
name|'d'
op|')'
newline|'\n'
name|'handler'
op|'='
name|'handlerClass'
op|'('
name|'self'
op|','
name|'sname'
op|','
name|'pname'
op|','
name|'chatui'
op|','
name|'d'
op|')'
newline|'\n'
name|'ident'
op|'.'
name|'callRemote'
op|'('
string|"'attach'"
op|','
name|'sname'
op|','
name|'pname'
op|','
name|'handler'
op|')'
op|'.'
name|'addCallback'
op|'('
name|'handler'
op|'.'
name|'connected'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'defer'
op|'.'
name|'DeferredList'
op|'('
name|'dl'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_ebConnected
dedent|''
name|'def'
name|'_ebConnected'
op|'('
name|'self'
op|','
name|'error'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|"'Not connected.'"
newline|'\n'
name|'return'
name|'error'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
endmarker|''
end_unit
