begin_unit
name|'from'
name|'twisted'
op|'.'
name|'trial'
name|'import'
name|'unittest'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'defer'
newline|'\n'
nl|'\n'
comment|'# Used in test_tests.TestUnhandledDeferred'
nl|'\n'
nl|'\n'
DECL|class|TestBleeding
name|'class'
name|'TestBleeding'
op|'('
name|'unittest'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""This test creates an unhandled Deferred and leaves it in a cycle.\n    \n    The Deferred is left in a cycle so that the garbage collector won\'t pick it\n    up immediately.  We were having some problems where unhandled Deferreds in\n    one test were failing random other tests. (See #1507, #1213)\n    """'
newline|'\n'
DECL|member|test_unhandledDeferred
name|'def'
name|'test_unhandledDeferred'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'try'
op|':'
newline|'\n'
indent|'            '
number|'1'
op|'/'
number|'0'
newline|'\n'
dedent|''
name|'except'
name|'ZeroDivisionError'
op|':'
newline|'\n'
indent|'            '
name|'f'
op|'='
name|'defer'
op|'.'
name|'fail'
op|'('
op|')'
newline|'\n'
comment|"# these two lines create the cycle. don't remove them"
nl|'\n'
dedent|''
name|'l'
op|'='
op|'['
name|'f'
op|']'
newline|'\n'
name|'l'
op|'.'
name|'append'
op|'('
name|'l'
op|')'
newline|'\n'
dedent|''
dedent|''
endmarker|''
end_unit
