begin_unit
comment|'# Copyright (c) 2001-2008 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'defer'
op|','
name|'protocol'
op|','
name|'reactor'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'conch'
name|'import'
name|'error'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'conch'
op|'.'
name|'ssh'
name|'import'
name|'transport'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'python'
name|'import'
name|'log'
newline|'\n'
nl|'\n'
nl|'\n'
nl|'\n'
DECL|class|SSHClientFactory
name|'class'
name|'SSHClientFactory'
op|'('
name|'protocol'
op|'.'
name|'ClientFactory'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'d'
op|','
name|'options'
op|','
name|'verifyHostKey'
op|','
name|'userAuthObject'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'d'
op|'='
name|'d'
newline|'\n'
name|'self'
op|'.'
name|'options'
op|'='
name|'options'
newline|'\n'
name|'self'
op|'.'
name|'verifyHostKey'
op|'='
name|'verifyHostKey'
newline|'\n'
name|'self'
op|'.'
name|'userAuthObject'
op|'='
name|'userAuthObject'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|clientConnectionLost
dedent|''
name|'def'
name|'clientConnectionLost'
op|'('
name|'self'
op|','
name|'connector'
op|','
name|'reason'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'options'
op|'['
string|"'reconnect'"
op|']'
op|':'
newline|'\n'
indent|'            '
name|'connector'
op|'.'
name|'connect'
op|'('
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|clientConnectionFailed
dedent|''
dedent|''
name|'def'
name|'clientConnectionFailed'
op|'('
name|'self'
op|','
name|'connector'
op|','
name|'reason'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'d'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'return'
newline|'\n'
dedent|''
name|'d'
op|','
name|'self'
op|'.'
name|'d'
op|'='
name|'self'
op|'.'
name|'d'
op|','
name|'None'
newline|'\n'
name|'d'
op|'.'
name|'errback'
op|'('
name|'reason'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|buildProtocol
dedent|''
name|'def'
name|'buildProtocol'
op|'('
name|'self'
op|','
name|'addr'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'trans'
op|'='
name|'SSHClientTransport'
op|'('
name|'self'
op|')'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'options'
op|'['
string|"'ciphers'"
op|']'
op|':'
newline|'\n'
indent|'            '
name|'trans'
op|'.'
name|'supportedCiphers'
op|'='
name|'self'
op|'.'
name|'options'
op|'['
string|"'ciphers'"
op|']'
newline|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'options'
op|'['
string|"'macs'"
op|']'
op|':'
newline|'\n'
indent|'            '
name|'trans'
op|'.'
name|'supportedMACs'
op|'='
name|'self'
op|'.'
name|'options'
op|'['
string|"'macs'"
op|']'
newline|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'options'
op|'['
string|"'compress'"
op|']'
op|':'
newline|'\n'
indent|'            '
name|'trans'
op|'.'
name|'supportedCompressions'
op|'['
number|'0'
op|':'
number|'1'
op|']'
op|'='
op|'['
string|"'zlib'"
op|']'
newline|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'options'
op|'['
string|"'host-key-algorithms'"
op|']'
op|':'
newline|'\n'
indent|'            '
name|'trans'
op|'.'
name|'supportedPublicKeys'
op|'='
name|'self'
op|'.'
name|'options'
op|'['
string|"'host-key-algorithms'"
op|']'
newline|'\n'
dedent|''
name|'return'
name|'trans'
newline|'\n'
nl|'\n'
nl|'\n'
nl|'\n'
DECL|class|SSHClientTransport
dedent|''
dedent|''
name|'class'
name|'SSHClientTransport'
op|'('
name|'transport'
op|'.'
name|'SSHClientTransport'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'factory'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'factory'
op|'='
name|'factory'
newline|'\n'
name|'self'
op|'.'
name|'unixServer'
op|'='
name|'None'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|connectionLost
dedent|''
name|'def'
name|'connectionLost'
op|'('
name|'self'
op|','
name|'reason'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'unixServer'
op|':'
newline|'\n'
indent|'            '
name|'d'
op|'='
name|'self'
op|'.'
name|'unixServer'
op|'.'
name|'stopListening'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'unixServer'
op|'='
name|'None'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'d'
op|'='
name|'defer'
op|'.'
name|'succeed'
op|'('
name|'None'
op|')'
newline|'\n'
dedent|''
name|'d'
op|'.'
name|'addCallback'
op|'('
name|'lambda'
name|'x'
op|':'
nl|'\n'
name|'transport'
op|'.'
name|'SSHClientTransport'
op|'.'
name|'connectionLost'
op|'('
name|'self'
op|','
name|'reason'
op|')'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|receiveError
dedent|''
name|'def'
name|'receiveError'
op|'('
name|'self'
op|','
name|'code'
op|','
name|'desc'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'factory'
op|'.'
name|'d'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'return'
newline|'\n'
dedent|''
name|'d'
op|','
name|'self'
op|'.'
name|'factory'
op|'.'
name|'d'
op|'='
name|'self'
op|'.'
name|'factory'
op|'.'
name|'d'
op|','
name|'None'
newline|'\n'
name|'d'
op|'.'
name|'errback'
op|'('
name|'error'
op|'.'
name|'ConchError'
op|'('
name|'desc'
op|','
name|'code'
op|')'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|sendDisconnect
dedent|''
name|'def'
name|'sendDisconnect'
op|'('
name|'self'
op|','
name|'code'
op|','
name|'reason'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'factory'
op|'.'
name|'d'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'return'
newline|'\n'
dedent|''
name|'d'
op|','
name|'self'
op|'.'
name|'factory'
op|'.'
name|'d'
op|'='
name|'self'
op|'.'
name|'factory'
op|'.'
name|'d'
op|','
name|'None'
newline|'\n'
name|'transport'
op|'.'
name|'SSHClientTransport'
op|'.'
name|'sendDisconnect'
op|'('
name|'self'
op|','
name|'code'
op|','
name|'reason'
op|')'
newline|'\n'
name|'d'
op|'.'
name|'errback'
op|'('
name|'error'
op|'.'
name|'ConchError'
op|'('
name|'reason'
op|','
name|'code'
op|')'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|receiveDebug
dedent|''
name|'def'
name|'receiveDebug'
op|'('
name|'self'
op|','
name|'alwaysDisplay'
op|','
name|'message'
op|','
name|'lang'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'log'
op|'.'
name|'msg'
op|'('
string|"'Received Debug Message: %s'"
op|'%'
name|'message'
op|')'
newline|'\n'
name|'if'
name|'alwaysDisplay'
op|':'
comment|'# XXX what should happen here?'
newline|'\n'
indent|'            '
name|'print'
name|'message'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|verifyHostKey
dedent|''
dedent|''
name|'def'
name|'verifyHostKey'
op|'('
name|'self'
op|','
name|'pubKey'
op|','
name|'fingerprint'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'factory'
op|'.'
name|'verifyHostKey'
op|'('
name|'self'
op|','
name|'self'
op|'.'
name|'transport'
op|'.'
name|'getPeer'
op|'('
op|')'
op|'.'
name|'host'
op|','
name|'pubKey'
op|','
nl|'\n'
name|'fingerprint'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|setService
dedent|''
name|'def'
name|'setService'
op|'('
name|'self'
op|','
name|'service'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'log'
op|'.'
name|'msg'
op|'('
string|"'setting client server to %s'"
op|'%'
name|'service'
op|')'
newline|'\n'
name|'transport'
op|'.'
name|'SSHClientTransport'
op|'.'
name|'setService'
op|'('
name|'self'
op|','
name|'service'
op|')'
newline|'\n'
name|'if'
name|'service'
op|'.'
name|'name'
op|'!='
string|"'ssh-userauth'"
name|'and'
name|'self'
op|'.'
name|'factory'
op|'.'
name|'d'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'d'
op|','
name|'self'
op|'.'
name|'factory'
op|'.'
name|'d'
op|'='
name|'self'
op|'.'
name|'factory'
op|'.'
name|'d'
op|','
name|'None'
newline|'\n'
name|'d'
op|'.'
name|'callback'
op|'('
name|'None'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|connectionSecure
dedent|''
dedent|''
name|'def'
name|'connectionSecure'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'requestService'
op|'('
name|'self'
op|'.'
name|'factory'
op|'.'
name|'userAuthObject'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
nl|'\n'
DECL|function|connect
dedent|''
dedent|''
name|'def'
name|'connect'
op|'('
name|'host'
op|','
name|'port'
op|','
name|'options'
op|','
name|'verifyHostKey'
op|','
name|'userAuthObject'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'d'
op|'='
name|'defer'
op|'.'
name|'Deferred'
op|'('
op|')'
newline|'\n'
name|'factory'
op|'='
name|'SSHClientFactory'
op|'('
name|'d'
op|','
name|'options'
op|','
name|'verifyHostKey'
op|','
name|'userAuthObject'
op|')'
newline|'\n'
name|'reactor'
op|'.'
name|'connectTCP'
op|'('
name|'host'
op|','
name|'port'
op|','
name|'factory'
op|')'
newline|'\n'
name|'return'
name|'d'
newline|'\n'
dedent|''
endmarker|''
end_unit
