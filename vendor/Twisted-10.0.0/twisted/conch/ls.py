begin_unit
comment|'# -*- test-case-name: twisted.conch.test.test_cftp -*-'
nl|'\n'
comment|'# Copyright (c) 2001-2008 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
name|'import'
name|'array'
newline|'\n'
name|'import'
name|'stat'
newline|'\n'
nl|'\n'
name|'from'
name|'time'
name|'import'
name|'time'
op|','
name|'strftime'
op|','
name|'localtime'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|lsLine
name|'def'
name|'lsLine'
op|'('
name|'name'
op|','
name|'s'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'mode'
op|'='
name|'s'
op|'.'
name|'st_mode'
newline|'\n'
name|'perms'
op|'='
name|'array'
op|'.'
name|'array'
op|'('
string|"'c'"
op|','
string|"'-'"
op|'*'
number|'10'
op|')'
newline|'\n'
name|'ft'
op|'='
name|'stat'
op|'.'
name|'S_IFMT'
op|'('
name|'mode'
op|')'
newline|'\n'
name|'if'
name|'stat'
op|'.'
name|'S_ISDIR'
op|'('
name|'ft'
op|')'
op|':'
name|'perms'
op|'['
number|'0'
op|']'
op|'='
string|"'d'"
newline|'\n'
name|'elif'
name|'stat'
op|'.'
name|'S_ISCHR'
op|'('
name|'ft'
op|')'
op|':'
name|'perms'
op|'['
number|'0'
op|']'
op|'='
string|"'c'"
newline|'\n'
name|'elif'
name|'stat'
op|'.'
name|'S_ISBLK'
op|'('
name|'ft'
op|')'
op|':'
name|'perms'
op|'['
number|'0'
op|']'
op|'='
string|"'b'"
newline|'\n'
name|'elif'
name|'stat'
op|'.'
name|'S_ISREG'
op|'('
name|'ft'
op|')'
op|':'
name|'perms'
op|'['
number|'0'
op|']'
op|'='
string|"'-'"
newline|'\n'
name|'elif'
name|'stat'
op|'.'
name|'S_ISFIFO'
op|'('
name|'ft'
op|')'
op|':'
name|'perms'
op|'['
number|'0'
op|']'
op|'='
string|"'f'"
newline|'\n'
name|'elif'
name|'stat'
op|'.'
name|'S_ISLNK'
op|'('
name|'ft'
op|')'
op|':'
name|'perms'
op|'['
number|'0'
op|']'
op|'='
string|"'l'"
newline|'\n'
name|'elif'
name|'stat'
op|'.'
name|'S_ISSOCK'
op|'('
name|'ft'
op|')'
op|':'
name|'perms'
op|'['
number|'0'
op|']'
op|'='
string|"'s'"
newline|'\n'
name|'else'
op|':'
name|'perms'
op|'['
number|'0'
op|']'
op|'='
string|"'!'"
newline|'\n'
comment|'# user'
nl|'\n'
name|'if'
name|'mode'
op|'&'
name|'stat'
op|'.'
name|'S_IRUSR'
op|':'
name|'perms'
op|'['
number|'1'
op|']'
op|'='
string|"'r'"
newline|'\n'
name|'if'
name|'mode'
op|'&'
name|'stat'
op|'.'
name|'S_IWUSR'
op|':'
name|'perms'
op|'['
number|'2'
op|']'
op|'='
string|"'w'"
newline|'\n'
name|'if'
name|'mode'
op|'&'
name|'stat'
op|'.'
name|'S_IXUSR'
op|':'
name|'perms'
op|'['
number|'3'
op|']'
op|'='
string|"'x'"
newline|'\n'
comment|'# group'
nl|'\n'
name|'if'
name|'mode'
op|'&'
name|'stat'
op|'.'
name|'S_IRGRP'
op|':'
name|'perms'
op|'['
number|'4'
op|']'
op|'='
string|"'r'"
newline|'\n'
name|'if'
name|'mode'
op|'&'
name|'stat'
op|'.'
name|'S_IWGRP'
op|':'
name|'perms'
op|'['
number|'5'
op|']'
op|'='
string|"'w'"
newline|'\n'
name|'if'
name|'mode'
op|'&'
name|'stat'
op|'.'
name|'S_IXGRP'
op|':'
name|'perms'
op|'['
number|'6'
op|']'
op|'='
string|"'x'"
newline|'\n'
comment|'# other'
nl|'\n'
name|'if'
name|'mode'
op|'&'
name|'stat'
op|'.'
name|'S_IROTH'
op|':'
name|'perms'
op|'['
number|'7'
op|']'
op|'='
string|"'r'"
newline|'\n'
name|'if'
name|'mode'
op|'&'
name|'stat'
op|'.'
name|'S_IWOTH'
op|':'
name|'perms'
op|'['
number|'8'
op|']'
op|'='
string|"'w'"
newline|'\n'
name|'if'
name|'mode'
op|'&'
name|'stat'
op|'.'
name|'S_IXOTH'
op|':'
name|'perms'
op|'['
number|'9'
op|']'
op|'='
string|"'x'"
newline|'\n'
comment|'# suid/sgid'
nl|'\n'
name|'if'
name|'mode'
op|'&'
name|'stat'
op|'.'
name|'S_ISUID'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'perms'
op|'['
number|'3'
op|']'
op|'=='
string|"'x'"
op|':'
name|'perms'
op|'['
number|'3'
op|']'
op|'='
string|"'s'"
newline|'\n'
name|'else'
op|':'
name|'perms'
op|'['
number|'3'
op|']'
op|'='
string|"'S'"
newline|'\n'
dedent|''
name|'if'
name|'mode'
op|'&'
name|'stat'
op|'.'
name|'S_ISGID'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'perms'
op|'['
number|'6'
op|']'
op|'=='
string|"'x'"
op|':'
name|'perms'
op|'['
number|'6'
op|']'
op|'='
string|"'s'"
newline|'\n'
name|'else'
op|':'
name|'perms'
op|'['
number|'6'
op|']'
op|'='
string|"'S'"
newline|'\n'
dedent|''
name|'l'
op|'='
name|'perms'
op|'.'
name|'tostring'
op|'('
op|')'
newline|'\n'
name|'l'
op|'+='
name|'str'
op|'('
name|'s'
op|'.'
name|'st_nlink'
op|')'
op|'.'
name|'rjust'
op|'('
number|'5'
op|')'
op|'+'
string|"' '"
newline|'\n'
name|'un'
op|'='
name|'str'
op|'('
name|'s'
op|'.'
name|'st_uid'
op|')'
newline|'\n'
name|'l'
op|'+='
name|'un'
op|'.'
name|'ljust'
op|'('
number|'9'
op|')'
newline|'\n'
name|'gr'
op|'='
name|'str'
op|'('
name|'s'
op|'.'
name|'st_gid'
op|')'
newline|'\n'
name|'l'
op|'+='
name|'gr'
op|'.'
name|'ljust'
op|'('
number|'9'
op|')'
newline|'\n'
name|'sz'
op|'='
name|'str'
op|'('
name|'s'
op|'.'
name|'st_size'
op|')'
newline|'\n'
name|'l'
op|'+='
name|'sz'
op|'.'
name|'rjust'
op|'('
number|'8'
op|')'
newline|'\n'
name|'l'
op|'+='
string|"' '"
newline|'\n'
name|'sixmo'
op|'='
number|'60'
op|'*'
number|'60'
op|'*'
number|'24'
op|'*'
number|'7'
op|'*'
number|'26'
newline|'\n'
name|'if'
name|'s'
op|'.'
name|'st_mtime'
op|'+'
name|'sixmo'
op|'<'
name|'time'
op|'('
op|')'
op|':'
comment|'# last edited more than 6mo ago'
newline|'\n'
indent|'        '
name|'l'
op|'+='
name|'strftime'
op|'('
string|'"%b %d  %Y "'
op|','
name|'localtime'
op|'('
name|'s'
op|'.'
name|'st_mtime'
op|')'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'        '
name|'l'
op|'+='
name|'strftime'
op|'('
string|'"%b %d %H:%M "'
op|','
name|'localtime'
op|'('
name|'s'
op|'.'
name|'st_mtime'
op|')'
op|')'
newline|'\n'
dedent|''
name|'l'
op|'+='
name|'name'
newline|'\n'
name|'return'
name|'l'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|variable|__all__
dedent|''
name|'__all__'
op|'='
op|'['
string|"'lsLine'"
op|']'
newline|'\n'
endmarker|''
end_unit
