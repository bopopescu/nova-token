begin_unit
comment|'# -*- test-case-name: twisted.conch.test.test_conch -*-'
nl|'\n'
name|'from'
name|'interfaces'
name|'import'
name|'IConchUser'
newline|'\n'
name|'from'
name|'error'
name|'import'
name|'ConchError'
newline|'\n'
name|'from'
name|'ssh'
op|'.'
name|'connection'
name|'import'
name|'OPEN_UNKNOWN_CHANNEL_TYPE'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'python'
name|'import'
name|'log'
newline|'\n'
name|'from'
name|'zope'
name|'import'
name|'interface'
newline|'\n'
nl|'\n'
DECL|class|ConchUser
name|'class'
name|'ConchUser'
op|':'
newline|'\n'
indent|'    '
name|'interface'
op|'.'
name|'implements'
op|'('
name|'IConchUser'
op|')'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'channelLookup'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'subsystemLookup'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
DECL|member|lookupChannel
dedent|''
name|'def'
name|'lookupChannel'
op|'('
name|'self'
op|','
name|'channelType'
op|','
name|'windowSize'
op|','
name|'maxPacket'
op|','
name|'data'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'klass'
op|'='
name|'self'
op|'.'
name|'channelLookup'
op|'.'
name|'get'
op|'('
name|'channelType'
op|','
name|'None'
op|')'
newline|'\n'
name|'if'
name|'not'
name|'klass'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'ConchError'
op|'('
name|'OPEN_UNKNOWN_CHANNEL_TYPE'
op|','
string|'"unknown channel"'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'klass'
op|'('
name|'remoteWindow'
op|'='
name|'windowSize'
op|','
nl|'\n'
name|'remoteMaxPacket'
op|'='
name|'maxPacket'
op|','
nl|'\n'
name|'data'
op|'='
name|'data'
op|','
name|'avatar'
op|'='
name|'self'
op|')'
newline|'\n'
nl|'\n'
DECL|member|lookupSubsystem
dedent|''
dedent|''
name|'def'
name|'lookupSubsystem'
op|'('
name|'self'
op|','
name|'subsystem'
op|','
name|'data'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'log'
op|'.'
name|'msg'
op|'('
name|'repr'
op|'('
name|'self'
op|'.'
name|'subsystemLookup'
op|')'
op|')'
newline|'\n'
name|'klass'
op|'='
name|'self'
op|'.'
name|'subsystemLookup'
op|'.'
name|'get'
op|'('
name|'subsystem'
op|','
name|'None'
op|')'
newline|'\n'
name|'if'
name|'not'
name|'klass'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'False'
newline|'\n'
dedent|''
name|'return'
name|'klass'
op|'('
name|'data'
op|','
name|'avatar'
op|'='
name|'self'
op|')'
newline|'\n'
nl|'\n'
DECL|member|gotGlobalRequest
dedent|''
name|'def'
name|'gotGlobalRequest'
op|'('
name|'self'
op|','
name|'requestType'
op|','
name|'data'
op|')'
op|':'
newline|'\n'
comment|'# XXX should this use method dispatch?'
nl|'\n'
indent|'        '
name|'requestType'
op|'='
name|'requestType'
op|'.'
name|'replace'
op|'('
string|"'-'"
op|','
string|"'_'"
op|')'
newline|'\n'
name|'f'
op|'='
name|'getattr'
op|'('
name|'self'
op|','
string|'"global_%s"'
op|'%'
name|'requestType'
op|','
name|'None'
op|')'
newline|'\n'
name|'if'
name|'not'
name|'f'
op|':'
newline|'\n'
indent|'            '
name|'return'
number|'0'
newline|'\n'
dedent|''
name|'return'
name|'f'
op|'('
name|'data'
op|')'
newline|'\n'
dedent|''
dedent|''
endmarker|''
end_unit
