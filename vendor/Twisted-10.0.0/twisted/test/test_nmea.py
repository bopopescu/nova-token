begin_unit
comment|'# Copyright (c) 2001-2004 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
nl|'\n'
string|'"""Test cases for the NMEA GPS protocol"""'
newline|'\n'
nl|'\n'
name|'import'
name|'StringIO'
newline|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'trial'
name|'import'
name|'unittest'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'reactor'
op|','
name|'protocol'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'python'
name|'import'
name|'reflect'
newline|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'protocols'
op|'.'
name|'gps'
name|'import'
name|'nmea'
newline|'\n'
nl|'\n'
DECL|class|StringIOWithNoClose
name|'class'
name|'StringIOWithNoClose'
op|'('
name|'StringIO'
op|'.'
name|'StringIO'
op|')'
op|':'
newline|'\n'
DECL|member|close
indent|'    '
name|'def'
name|'close'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pass'
newline|'\n'
nl|'\n'
DECL|class|ResultHarvester
dedent|''
dedent|''
name|'class'
name|'ResultHarvester'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'results'
op|'='
op|'['
op|']'
newline|'\n'
nl|'\n'
DECL|member|__call__
dedent|''
name|'def'
name|'__call__'
op|'('
name|'self'
op|','
op|'*'
name|'args'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'results'
op|'.'
name|'append'
op|'('
name|'args'
op|')'
newline|'\n'
nl|'\n'
DECL|member|performTest
dedent|''
name|'def'
name|'performTest'
op|'('
name|'self'
op|','
name|'function'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'l'
op|'='
name|'len'
op|'('
name|'self'
op|'.'
name|'results'
op|')'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'function'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'Exception'
op|','
name|'e'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'results'
op|'.'
name|'append'
op|'('
name|'e'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'l'
op|'=='
name|'len'
op|'('
name|'self'
op|'.'
name|'results'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'results'
op|'.'
name|'append'
op|'('
name|'NotImplementedError'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|class|NMEATester
dedent|''
dedent|''
dedent|''
name|'class'
name|'NMEATester'
op|'('
name|'nmea'
op|'.'
name|'NMEAReceiver'
op|')'
op|':'
newline|'\n'
DECL|variable|ignore_invalid_sentence
indent|'    '
name|'ignore_invalid_sentence'
op|'='
number|'0'
newline|'\n'
DECL|variable|ignore_checksum_mismatch
name|'ignore_checksum_mismatch'
op|'='
number|'0'
newline|'\n'
DECL|variable|ignore_unknown_sentencetypes
name|'ignore_unknown_sentencetypes'
op|'='
number|'0'
newline|'\n'
DECL|variable|convert_dates_before_y2k
name|'convert_dates_before_y2k'
op|'='
number|'1'
newline|'\n'
nl|'\n'
DECL|member|connectionMade
name|'def'
name|'connectionMade'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'resultHarvester'
op|'='
name|'ResultHarvester'
op|'('
op|')'
newline|'\n'
name|'for'
name|'fn'
name|'in'
name|'reflect'
op|'.'
name|'prefixedMethodNames'
op|'('
name|'self'
op|'.'
name|'__class__'
op|','
string|"'decode_'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'setattr'
op|'('
name|'self'
op|','
string|"'handle_'"
op|'+'
name|'fn'
op|','
name|'self'
op|'.'
name|'resultHarvester'
op|')'
newline|'\n'
nl|'\n'
DECL|class|NMEAReceiverTestCase
dedent|''
dedent|''
dedent|''
name|'class'
name|'NMEAReceiverTestCase'
op|'('
name|'unittest'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
DECL|variable|messages
indent|'    '
name|'messages'
op|'='
op|'('
nl|'\n'
comment|'# fix - signal acquired'
nl|'\n'
string|'"$GPGGA,231713.0,3910.413,N,07641.994,W,1,05,1.35,00044,M,-033,M,,*69"'
op|','
nl|'\n'
comment|'# fix - signal not acquired'
nl|'\n'
string|'"$GPGGA,235947.000,0000.0000,N,00000.0000,E,0,00,0.0,0.0,M,,,,0000*00"'
op|','
nl|'\n'
comment|'# junk'
nl|'\n'
string|'"lkjasdfkl!@#(*$!@(*#(ASDkfjasdfLMASDCVKAW!@#($)!(@#)(*"'
op|','
nl|'\n'
comment|'# fix - signal acquired (invalid checksum)'
nl|'\n'
string|'"$GPGGA,231713.0,3910.413,N,07641.994,W,1,05,1.35,00044,M,-033,M,,*68"'
op|','
nl|'\n'
comment|'# invalid sentence'
nl|'\n'
string|'"$GPGGX,231713.0,3910.413,N,07641.994,W,1,05,1.35,00044,M,-033,M,,*68"'
op|','
nl|'\n'
comment|'# position acquired'
nl|'\n'
string|'"$GPGLL,4250.5589,S,14718.5084,E,092204.999,A*2D"'
op|','
nl|'\n'
comment|'# position not acquired'
nl|'\n'
string|'"$GPGLL,0000.0000,N,00000.0000,E,235947.000,V*2D"'
op|','
nl|'\n'
comment|'# active satellites (no fix)'
nl|'\n'
string|'"$GPGSA,A,1,,,,,,,,,,,,,0.0,0.0,0.0*30"'
op|','
nl|'\n'
comment|'# active satellites'
nl|'\n'
string|'"$GPGSA,A,3,01,20,19,13,,,,,,,,,40.4,24.4,32.2*0A"'
op|','
nl|'\n'
comment|'# positiontime (no fix)'
nl|'\n'
string|'"$GPRMC,235947.000,V,0000.0000,N,00000.0000,E,,,041299,,*1D"'
op|','
nl|'\n'
comment|'# positiontime'
nl|'\n'
string|'"$GPRMC,092204.999,A,4250.5589,S,14718.5084,E,0.00,89.68,211200,,*25"'
op|','
nl|'\n'
comment|'# course over ground (no fix - not implemented)'
nl|'\n'
string|'"$GPVTG,,T,,M,,N,,K*4E"'
op|','
nl|'\n'
comment|'# course over ground (not implemented)'
nl|'\n'
string|'"$GPVTG,89.68,T,,M,0.00,N,0.0,K*5F"'
op|','
nl|'\n'
op|')'
newline|'\n'
DECL|variable|results
name|'results'
op|'='
op|'('
nl|'\n'
op|'('
number|'83833.0'
op|','
number|'39.17355'
op|','
op|'-'
number|'76.6999'
op|','
name|'nmea'
op|'.'
name|'POSFIX_SPS'
op|','
number|'5'
op|','
number|'1.35'
op|','
op|'('
number|'44.0'
op|','
string|"'M'"
op|')'
op|','
op|'('
op|'-'
number|'33.0'
op|','
string|"'M'"
op|')'
op|','
name|'None'
op|')'
op|','
nl|'\n'
op|'('
number|'86387.0'
op|','
number|'0.0'
op|','
number|'0.0'
op|','
number|'0'
op|','
number|'0'
op|','
number|'0.0'
op|','
op|'('
number|'0.0'
op|','
string|"'M'"
op|')'
op|','
name|'None'
op|','
name|'None'
op|')'
op|','
nl|'\n'
name|'nmea'
op|'.'
name|'InvalidSentence'
op|'('
op|')'
op|','
nl|'\n'
name|'nmea'
op|'.'
name|'InvalidChecksum'
op|'('
op|')'
op|','
nl|'\n'
name|'nmea'
op|'.'
name|'InvalidSentence'
op|'('
op|')'
op|','
nl|'\n'
op|'('
op|'-'
number|'42.842648333333337'
op|','
number|'147.30847333333332'
op|','
number|'33724.999000000003'
op|','
number|'1'
op|')'
op|','
nl|'\n'
op|'('
number|'0.0'
op|','
number|'0.0'
op|','
number|'86387.0'
op|','
number|'0'
op|')'
op|','
nl|'\n'
op|'('
op|'('
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|')'
op|','
op|'('
name|'nmea'
op|'.'
name|'MODE_AUTO'
op|','
name|'nmea'
op|'.'
name|'MODE_NOFIX'
op|')'
op|','
number|'0.0'
op|','
number|'0.0'
op|','
number|'0.0'
op|')'
op|','
nl|'\n'
op|'('
op|'('
number|'1'
op|','
number|'20'
op|','
number|'19'
op|','
number|'13'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|')'
op|','
op|'('
name|'nmea'
op|'.'
name|'MODE_AUTO'
op|','
name|'nmea'
op|'.'
name|'MODE_3D'
op|')'
op|','
number|'40.4'
op|','
number|'24.4'
op|','
number|'32.2'
op|')'
op|','
nl|'\n'
op|'('
number|'0.0'
op|','
number|'0.0'
op|','
name|'None'
op|','
name|'None'
op|','
number|'86387.0'
op|','
op|'('
number|'1999'
op|','
number|'12'
op|','
number|'4'
op|')'
op|','
name|'None'
op|')'
op|','
nl|'\n'
op|'('
op|'-'
number|'42.842648333333337'
op|','
number|'147.30847333333332'
op|','
number|'0.0'
op|','
number|'89.68'
op|','
number|'33724.999'
op|','
op|'('
number|'2000'
op|','
number|'12'
op|','
number|'21'
op|')'
op|','
name|'None'
op|')'
op|','
nl|'\n'
name|'NotImplementedError'
op|'('
op|')'
op|','
nl|'\n'
name|'NotImplementedError'
op|'('
op|')'
op|','
nl|'\n'
op|')'
newline|'\n'
DECL|member|testGPSMessages
name|'def'
name|'testGPSMessages'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'dummy'
op|'='
name|'NMEATester'
op|'('
op|')'
newline|'\n'
name|'dummy'
op|'.'
name|'makeConnection'
op|'('
name|'protocol'
op|'.'
name|'FileWrapper'
op|'('
name|'StringIOWithNoClose'
op|'('
op|')'
op|')'
op|')'
newline|'\n'
name|'for'
name|'line'
name|'in'
name|'self'
op|'.'
name|'messages'
op|':'
newline|'\n'
indent|'            '
name|'dummy'
op|'.'
name|'resultHarvester'
op|'.'
name|'performTest'
op|'('
name|'dummy'
op|'.'
name|'lineReceived'
op|','
name|'line'
op|')'
newline|'\n'
DECL|function|munge
dedent|''
name|'def'
name|'munge'
op|'('
name|'myTuple'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'type'
op|'('
name|'myTuple'
op|')'
op|'!='
name|'type'
op|'('
op|'('
op|')'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'return'
newline|'\n'
dedent|''
name|'newTuple'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'v'
name|'in'
name|'myTuple'
op|':'
newline|'\n'
indent|'                '
name|'if'
name|'type'
op|'('
name|'v'
op|')'
op|'=='
name|'type'
op|'('
number|'1.1'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'v'
op|'='
name|'float'
op|'('
name|'int'
op|'('
name|'v'
op|'*'
number|'10000.0'
op|')'
op|')'
op|'*'
number|'0.0001'
newline|'\n'
dedent|''
name|'newTuple'
op|'.'
name|'append'
op|'('
name|'v'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'tuple'
op|'('
name|'newTuple'
op|')'
newline|'\n'
dedent|''
name|'for'
op|'('
name|'message'
op|','
name|'expectedResult'
op|','
name|'actualResult'
op|')'
name|'in'
name|'zip'
op|'('
name|'self'
op|'.'
name|'messages'
op|','
name|'self'
op|'.'
name|'results'
op|','
name|'dummy'
op|'.'
name|'resultHarvester'
op|'.'
name|'results'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'expectedResult'
op|'='
name|'munge'
op|'('
name|'expectedResult'
op|')'
newline|'\n'
name|'actualResult'
op|'='
name|'munge'
op|'('
name|'actualResult'
op|')'
newline|'\n'
name|'if'
name|'isinstance'
op|'('
name|'expectedResult'
op|','
name|'Exception'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'if'
name|'isinstance'
op|'('
name|'actualResult'
op|','
name|'Exception'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'self'
op|'.'
name|'failUnlessEqual'
op|'('
name|'expectedResult'
op|'.'
name|'__class__'
op|','
name|'actualResult'
op|'.'
name|'__class__'
op|','
string|'"\\nInput:\\n%s\\nExpected:\\n%s.%s\\nResults:\\n%s.%s\\n"'
op|'%'
op|'('
name|'message'
op|','
name|'expectedResult'
op|'.'
name|'__class__'
op|'.'
name|'__module__'
op|','
name|'expectedResult'
op|'.'
name|'__class__'
op|'.'
name|'__name__'
op|','
name|'actualResult'
op|'.'
name|'__class__'
op|'.'
name|'__module__'
op|','
name|'actualResult'
op|'.'
name|'__class__'
op|'.'
name|'__name__'
op|')'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                    '
name|'self'
op|'.'
name|'failUnlessEqual'
op|'('
number|'1'
op|','
number|'0'
op|','
string|'"\\nInput:\\n%s\\nExpected:\\n%s.%s\\nResults:\\n%r\\n"'
op|'%'
op|'('
name|'message'
op|','
name|'expectedResult'
op|'.'
name|'__class__'
op|'.'
name|'__module__'
op|','
name|'expectedResult'
op|'.'
name|'__class__'
op|'.'
name|'__name__'
op|','
name|'actualResult'
op|')'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'              '
name|'self'
op|'.'
name|'failUnlessEqual'
op|'('
name|'expectedResult'
op|','
name|'actualResult'
op|','
string|'"\\nInput:\\n%s\\nExpected: %r\\nResults: %r\\n"'
op|'%'
op|'('
name|'message'
op|','
name|'expectedResult'
op|','
name|'actualResult'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|variable|testCases
dedent|''
dedent|''
dedent|''
dedent|''
name|'testCases'
op|'='
op|'['
name|'NMEAReceiverTestCase'
op|']'
newline|'\n'
endmarker|''
end_unit
