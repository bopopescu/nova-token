begin_unit
nl|'\n'
comment|'# Copyright (c) 2001-2007 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
string|'"""\nTest cases for timeoutqueue module.\n"""'
newline|'\n'
nl|'\n'
name|'import'
name|'time'
newline|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'python'
name|'import'
name|'timeoutqueue'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'trial'
name|'import'
name|'unittest'
op|','
name|'util'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'reactor'
op|','
name|'interfaces'
newline|'\n'
nl|'\n'
DECL|variable|timeoutqueueSuppression
name|'timeoutqueueSuppression'
op|'='
name|'util'
op|'.'
name|'suppress'
op|'('
nl|'\n'
DECL|variable|message
name|'message'
op|'='
string|'"timeoutqueue is deprecated since Twisted 8.0"'
op|','
nl|'\n'
DECL|variable|category
name|'category'
op|'='
name|'DeprecationWarning'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TimeoutQueueTest
name|'class'
name|'TimeoutQueueTest'
op|'('
name|'unittest'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""\n    Test L{timeoutqueue.TimeoutQueue} class.\n    """'
newline|'\n'
nl|'\n'
DECL|member|tearDown
name|'def'
name|'tearDown'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'del'
name|'self'
op|'.'
name|'q'
newline|'\n'
nl|'\n'
DECL|member|put
dedent|''
name|'def'
name|'put'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'time'
op|'.'
name|'sleep'
op|'('
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'q'
op|'.'
name|'put'
op|'('
number|'1'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_timeout
dedent|''
name|'def'
name|'test_timeout'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'q'
op|'='
name|'self'
op|'.'
name|'q'
op|'='
name|'timeoutqueue'
op|'.'
name|'TimeoutQueue'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'q'
op|'.'
name|'wait'
op|'('
number|'1'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'timeoutqueue'
op|'.'
name|'TimedOut'
op|':'
newline|'\n'
indent|'            '
name|'pass'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'fail'
op|'('
string|'"Didn\'t time out"'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'test_timeout'
op|'.'
name|'suppress'
op|'='
op|'['
name|'timeoutqueueSuppression'
op|']'
newline|'\n'
nl|'\n'
DECL|member|test_get
name|'def'
name|'test_get'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'q'
op|'='
name|'self'
op|'.'
name|'q'
op|'='
name|'timeoutqueue'
op|'.'
name|'TimeoutQueue'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'start'
op|'='
name|'time'
op|'.'
name|'time'
op|'('
op|')'
newline|'\n'
name|'threading'
op|'.'
name|'Thread'
op|'('
name|'target'
op|'='
name|'self'
op|'.'
name|'put'
op|')'
op|'.'
name|'start'
op|'('
op|')'
newline|'\n'
name|'q'
op|'.'
name|'wait'
op|'('
number|'1.5'
op|')'
newline|'\n'
name|'assert'
name|'time'
op|'.'
name|'time'
op|'('
op|')'
op|'-'
name|'start'
op|'<'
number|'2'
newline|'\n'
nl|'\n'
name|'result'
op|'='
name|'q'
op|'.'
name|'get'
op|'('
number|'0'
op|')'
newline|'\n'
name|'if'
name|'result'
op|'!='
number|'1'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'fail'
op|'('
string|'"Didn\'t get item we put in"'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'test_get'
op|'.'
name|'suppress'
op|'='
op|'['
name|'timeoutqueueSuppression'
op|']'
newline|'\n'
nl|'\n'
DECL|member|test_deprecation
name|'def'
name|'test_deprecation'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        Test that L{timeoutqueue.TimeoutQueue} prints a warning message.\n        """'
newline|'\n'
DECL|function|createQueue
name|'def'
name|'createQueue'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'timeoutqueue'
op|'.'
name|'TimeoutQueue'
op|'('
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'q'
op|'='
name|'self'
op|'.'
name|'assertWarns'
op|'('
nl|'\n'
name|'DeprecationWarning'
op|','
nl|'\n'
string|'"timeoutqueue is deprecated since Twisted 8.0"'
op|','
nl|'\n'
name|'__file__'
op|','
nl|'\n'
name|'createQueue'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'interfaces'
op|'.'
name|'IReactorThreads'
op|'('
name|'reactor'
op|','
name|'None'
op|')'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'        '
name|'test_get'
op|'.'
name|'skip'
op|'='
string|'"No thread support, no way to test putting during a blocked get"'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'        '
name|'global'
name|'threading'
newline|'\n'
name|'import'
name|'threading'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
endmarker|''
end_unit
