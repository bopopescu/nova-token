begin_unit
nl|'\n'
comment|'# Copyright (c) 2001-2004 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'ssl'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'python'
op|'.'
name|'util'
name|'import'
name|'sibpath'
newline|'\n'
nl|'\n'
name|'from'
name|'OpenSSL'
name|'import'
name|'SSL'
newline|'\n'
nl|'\n'
DECL|class|ClientTLSContext
name|'class'
name|'ClientTLSContext'
op|'('
name|'ssl'
op|'.'
name|'ClientContextFactory'
op|')'
op|':'
newline|'\n'
DECL|variable|isClient
indent|'    '
name|'isClient'
op|'='
number|'1'
newline|'\n'
DECL|member|getContext
name|'def'
name|'getContext'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'SSL'
op|'.'
name|'Context'
op|'('
name|'SSL'
op|'.'
name|'TLSv1_METHOD'
op|')'
newline|'\n'
nl|'\n'
DECL|class|ServerTLSContext
dedent|''
dedent|''
name|'class'
name|'ServerTLSContext'
op|':'
newline|'\n'
DECL|variable|isClient
indent|'    '
name|'isClient'
op|'='
number|'0'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'filename'
op|'='
name|'sibpath'
op|'('
name|'__file__'
op|','
string|"'server.pem'"
op|')'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'filename'
op|'='
name|'filename'
newline|'\n'
nl|'\n'
DECL|member|getContext
dedent|''
name|'def'
name|'getContext'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'ctx'
op|'='
name|'SSL'
op|'.'
name|'Context'
op|'('
name|'SSL'
op|'.'
name|'TLSv1_METHOD'
op|')'
newline|'\n'
name|'ctx'
op|'.'
name|'use_certificate_file'
op|'('
name|'self'
op|'.'
name|'filename'
op|')'
newline|'\n'
name|'ctx'
op|'.'
name|'use_privatekey_file'
op|'('
name|'self'
op|'.'
name|'filename'
op|')'
newline|'\n'
name|'return'
name|'ctx'
newline|'\n'
dedent|''
dedent|''
endmarker|''
end_unit
