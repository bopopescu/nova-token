begin_unit
comment|'# -*- test-case-name: twisted.test.test_twistd -*-'
nl|'\n'
comment|'# Copyright (c) 2001-2008 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'python'
name|'import'
name|'log'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'application'
name|'import'
name|'app'
op|','
name|'service'
op|','
name|'internet'
newline|'\n'
name|'from'
name|'twisted'
name|'import'
name|'copyright'
newline|'\n'
name|'import'
name|'sys'
op|','
name|'os'
newline|'\n'
nl|'\n'
nl|'\n'
nl|'\n'
DECL|class|ServerOptions
name|'class'
name|'ServerOptions'
op|'('
name|'app'
op|'.'
name|'ServerOptions'
op|')'
op|':'
newline|'\n'
DECL|variable|synopsis
indent|'    '
name|'synopsis'
op|'='
string|'"Usage: twistd [options]"'
newline|'\n'
nl|'\n'
DECL|variable|optFlags
name|'optFlags'
op|'='
op|'['
op|'['
string|"'nodaemon'"
op|','
string|"'n'"
op|','
string|'"(for backwards compatability)."'
op|']'
op|','
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
DECL|member|opt_version
name|'def'
name|'opt_version'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Print version information and exit.\n        """'
newline|'\n'
name|'print'
string|"'twistd (the Twisted Windows runner) %s'"
op|'%'
name|'copyright'
op|'.'
name|'version'
newline|'\n'
name|'print'
name|'copyright'
op|'.'
name|'copyright'
newline|'\n'
name|'sys'
op|'.'
name|'exit'
op|'('
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
nl|'\n'
DECL|class|WindowsApplicationRunner
dedent|''
dedent|''
name|'class'
name|'WindowsApplicationRunner'
op|'('
name|'app'
op|'.'
name|'ApplicationRunner'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""\n    An ApplicationRunner which avoids unix-specific things. No\n    forking, no PID files, no privileges.\n    """'
newline|'\n'
nl|'\n'
DECL|member|preApplication
name|'def'
name|'preApplication'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        Do pre-application-creation setup.\n        """'
newline|'\n'
name|'self'
op|'.'
name|'oldstdout'
op|'='
name|'sys'
op|'.'
name|'stdout'
newline|'\n'
name|'self'
op|'.'
name|'oldstderr'
op|'='
name|'sys'
op|'.'
name|'stderr'
newline|'\n'
name|'os'
op|'.'
name|'chdir'
op|'('
name|'self'
op|'.'
name|'config'
op|'['
string|"'rundir'"
op|']'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|postApplication
dedent|''
name|'def'
name|'postApplication'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        Start the application and run the reactor.\n        """'
newline|'\n'
name|'service'
op|'.'
name|'IService'
op|'('
name|'self'
op|'.'
name|'application'
op|')'
op|'.'
name|'privilegedStartService'
op|'('
op|')'
newline|'\n'
name|'app'
op|'.'
name|'startApplication'
op|'('
name|'self'
op|'.'
name|'application'
op|','
name|'not'
name|'self'
op|'.'
name|'config'
op|'['
string|"'no_save'"
op|']'
op|')'
newline|'\n'
name|'app'
op|'.'
name|'startApplication'
op|'('
name|'internet'
op|'.'
name|'TimerService'
op|'('
number|'0.1'
op|','
name|'lambda'
op|':'
name|'None'
op|')'
op|','
number|'0'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'startReactor'
op|'('
name|'None'
op|','
name|'self'
op|'.'
name|'oldstdout'
op|','
name|'self'
op|'.'
name|'oldstderr'
op|')'
newline|'\n'
name|'log'
op|'.'
name|'msg'
op|'('
string|'"Server Shut Down."'
op|')'
newline|'\n'
dedent|''
dedent|''
endmarker|''
end_unit
