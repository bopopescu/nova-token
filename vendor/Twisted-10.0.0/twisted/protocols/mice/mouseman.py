begin_unit
comment|'# Copyright (c) 2001-2004 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
comment|'#'
nl|'\n'
string|'"""Logictech MouseMan serial protocol.\n\nhttp://www.softnco.demon.co.uk/SerialMouse.txt\n"""'
newline|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'protocol'
newline|'\n'
nl|'\n'
DECL|class|MouseMan
name|'class'
name|'MouseMan'
op|'('
name|'protocol'
op|'.'
name|'Protocol'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""\n\n    Parser for Logitech MouseMan serial mouse protocol (compatible\n    with Microsoft Serial Mouse).\n\n    """'
newline|'\n'
nl|'\n'
DECL|variable|state
name|'state'
op|'='
string|"'initial'"
newline|'\n'
nl|'\n'
DECL|variable|leftbutton
name|'leftbutton'
op|'='
name|'None'
newline|'\n'
DECL|variable|rightbutton
name|'rightbutton'
op|'='
name|'None'
newline|'\n'
DECL|variable|middlebutton
name|'middlebutton'
op|'='
name|'None'
newline|'\n'
nl|'\n'
DECL|variable|leftold
name|'leftold'
op|'='
name|'None'
newline|'\n'
DECL|variable|rightold
name|'rightold'
op|'='
name|'None'
newline|'\n'
DECL|variable|middleold
name|'middleold'
op|'='
name|'None'
newline|'\n'
nl|'\n'
DECL|variable|horiz
name|'horiz'
op|'='
name|'None'
newline|'\n'
DECL|variable|vert
name|'vert'
op|'='
name|'None'
newline|'\n'
DECL|variable|horizold
name|'horizold'
op|'='
name|'None'
newline|'\n'
DECL|variable|vertold
name|'vertold'
op|'='
name|'None'
newline|'\n'
nl|'\n'
DECL|member|down_left
name|'def'
name|'down_left'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pass'
newline|'\n'
nl|'\n'
DECL|member|up_left
dedent|''
name|'def'
name|'up_left'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pass'
newline|'\n'
nl|'\n'
DECL|member|down_middle
dedent|''
name|'def'
name|'down_middle'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pass'
newline|'\n'
nl|'\n'
DECL|member|up_middle
dedent|''
name|'def'
name|'up_middle'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pass'
newline|'\n'
nl|'\n'
DECL|member|down_right
dedent|''
name|'def'
name|'down_right'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pass'
newline|'\n'
nl|'\n'
DECL|member|up_right
dedent|''
name|'def'
name|'up_right'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pass'
newline|'\n'
nl|'\n'
DECL|member|move
dedent|''
name|'def'
name|'move'
op|'('
name|'self'
op|','
name|'x'
op|','
name|'y'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pass'
newline|'\n'
nl|'\n'
DECL|variable|horiz
dedent|''
name|'horiz'
op|'='
name|'None'
newline|'\n'
DECL|variable|vert
name|'vert'
op|'='
name|'None'
newline|'\n'
nl|'\n'
DECL|member|state_initial
name|'def'
name|'state_initial'
op|'('
name|'self'
op|','
name|'byte'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'byte'
op|'&'
number|'1'
op|'<<'
number|'6'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'word1'
op|'='
name|'byte'
newline|'\n'
name|'self'
op|'.'
name|'leftbutton'
op|'='
name|'byte'
op|'&'
number|'1'
op|'<<'
number|'5'
newline|'\n'
name|'self'
op|'.'
name|'rightbutton'
op|'='
name|'byte'
op|'&'
number|'1'
op|'<<'
number|'4'
newline|'\n'
name|'return'
string|"'horiz'"
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'return'
string|"'initial'"
newline|'\n'
nl|'\n'
DECL|member|state_horiz
dedent|''
dedent|''
name|'def'
name|'state_horiz'
op|'('
name|'self'
op|','
name|'byte'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'byte'
op|'&'
number|'1'
op|'<<'
number|'6'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'state_initial'
op|'('
name|'byte'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'x'
op|'='
op|'('
name|'self'
op|'.'
name|'word1'
op|'&'
number|'0x03'
op|')'
op|'<<'
number|'6'
op|'|'
op|'('
name|'byte'
op|'&'
number|'0x3f'
op|')'
newline|'\n'
name|'if'
name|'x'
op|'>='
number|'128'
op|':'
newline|'\n'
indent|'                '
name|'x'
op|'='
op|'-'
number|'256'
op|'+'
name|'x'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'horiz'
op|'='
name|'x'
newline|'\n'
name|'return'
string|"'vert'"
newline|'\n'
nl|'\n'
DECL|member|state_vert
dedent|''
dedent|''
name|'def'
name|'state_vert'
op|'('
name|'self'
op|','
name|'byte'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'byte'
op|'&'
number|'1'
op|'<<'
number|'6'
op|':'
newline|'\n'
comment|'# short packet'
nl|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'state_initial'
op|'('
name|'byte'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'x'
op|'='
op|'('
name|'self'
op|'.'
name|'word1'
op|'&'
number|'0x0c'
op|')'
op|'<<'
number|'4'
op|'|'
op|'('
name|'byte'
op|'&'
number|'0x3f'
op|')'
newline|'\n'
name|'if'
name|'x'
op|'>='
number|'128'
op|':'
newline|'\n'
indent|'                '
name|'x'
op|'='
op|'-'
number|'256'
op|'+'
name|'x'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'vert'
op|'='
name|'x'
newline|'\n'
name|'self'
op|'.'
name|'snapshot'
op|'('
op|')'
newline|'\n'
name|'return'
string|"'maybemiddle'"
newline|'\n'
nl|'\n'
DECL|member|state_maybemiddle
dedent|''
dedent|''
name|'def'
name|'state_maybemiddle'
op|'('
name|'self'
op|','
name|'byte'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'byte'
op|'&'
number|'1'
op|'<<'
number|'6'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'snapshot'
op|'('
op|')'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'state_initial'
op|'('
name|'byte'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'middlebutton'
op|'='
name|'byte'
op|'&'
number|'1'
op|'<<'
number|'5'
newline|'\n'
name|'self'
op|'.'
name|'snapshot'
op|'('
op|')'
newline|'\n'
name|'return'
string|"'initial'"
newline|'\n'
nl|'\n'
DECL|member|snapshot
dedent|''
dedent|''
name|'def'
name|'snapshot'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'leftbutton'
name|'and'
name|'not'
name|'self'
op|'.'
name|'leftold'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'down_left'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'leftold'
op|'='
number|'1'
newline|'\n'
dedent|''
name|'if'
name|'not'
name|'self'
op|'.'
name|'leftbutton'
name|'and'
name|'self'
op|'.'
name|'leftold'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'up_left'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'leftold'
op|'='
number|'0'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'middlebutton'
name|'and'
name|'not'
name|'self'
op|'.'
name|'middleold'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'down_middle'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'middleold'
op|'='
number|'1'
newline|'\n'
dedent|''
name|'if'
name|'not'
name|'self'
op|'.'
name|'middlebutton'
name|'and'
name|'self'
op|'.'
name|'middleold'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'up_middle'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'middleold'
op|'='
number|'0'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'rightbutton'
name|'and'
name|'not'
name|'self'
op|'.'
name|'rightold'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'down_right'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'rightold'
op|'='
number|'1'
newline|'\n'
dedent|''
name|'if'
name|'not'
name|'self'
op|'.'
name|'rightbutton'
name|'and'
name|'self'
op|'.'
name|'rightold'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'up_right'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'rightold'
op|'='
number|'0'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'horiz'
name|'or'
name|'self'
op|'.'
name|'vert'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'move'
op|'('
name|'self'
op|'.'
name|'horiz'
op|','
name|'self'
op|'.'
name|'vert'
op|')'
newline|'\n'
nl|'\n'
DECL|member|dataReceived
dedent|''
dedent|''
name|'def'
name|'dataReceived'
op|'('
name|'self'
op|','
name|'data'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'for'
name|'c'
name|'in'
name|'data'
op|':'
newline|'\n'
indent|'            '
name|'byte'
op|'='
name|'ord'
op|'('
name|'c'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'state'
op|'='
name|'getattr'
op|'('
name|'self'
op|','
string|"'state_'"
op|'+'
name|'self'
op|'.'
name|'state'
op|')'
op|'('
name|'byte'
op|')'
newline|'\n'
dedent|''
dedent|''
dedent|''
endmarker|''
end_unit
