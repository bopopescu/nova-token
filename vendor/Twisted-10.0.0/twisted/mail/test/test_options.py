begin_unit
comment|'# Copyright (c) 2008 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
string|'"""\nTests for L{twisted.mail.tap}.\n"""'
newline|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'trial'
op|'.'
name|'unittest'
name|'import'
name|'TestCase'
newline|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'python'
op|'.'
name|'usage'
name|'import'
name|'UsageError'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'mail'
op|'.'
name|'tap'
name|'import'
name|'Options'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|OptionsTestCase
name|'class'
name|'OptionsTestCase'
op|'('
name|'TestCase'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""\n    Tests for the command line option parser used for C{twistd mail}.\n    """'
newline|'\n'
DECL|member|setUp
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'aliasFilename'
op|'='
name|'self'
op|'.'
name|'mktemp'
op|'('
op|')'
newline|'\n'
name|'aliasFile'
op|'='
name|'file'
op|'('
name|'self'
op|'.'
name|'aliasFilename'
op|','
string|"'w'"
op|')'
newline|'\n'
name|'aliasFile'
op|'.'
name|'write'
op|'('
string|"'someuser:\\tdifferentuser\\n'"
op|')'
newline|'\n'
name|'aliasFile'
op|'.'
name|'close'
op|'('
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testAliasesWithoutDomain
dedent|''
name|'def'
name|'testAliasesWithoutDomain'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        Test that adding an aliases(5) file before adding a domain raises a\n        UsageError.\n        """'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
nl|'\n'
name|'UsageError'
op|','
nl|'\n'
name|'Options'
op|'('
op|')'
op|'.'
name|'parseOptions'
op|','
nl|'\n'
op|'['
string|"'--aliases'"
op|','
name|'self'
op|'.'
name|'aliasFilename'
op|']'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|member|testAliases
dedent|''
name|'def'
name|'testAliases'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        Test that adding an aliases(5) file to an IAliasableDomain at least\n        doesn\'t raise an unhandled exception.\n        """'
newline|'\n'
name|'Options'
op|'('
op|')'
op|'.'
name|'parseOptions'
op|'('
op|'['
nl|'\n'
string|"'--maildirdbmdomain'"
op|','
string|"'example.com=example.com'"
op|','
nl|'\n'
string|"'--aliases'"
op|','
name|'self'
op|'.'
name|'aliasFilename'
op|']'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
endmarker|''
end_unit
