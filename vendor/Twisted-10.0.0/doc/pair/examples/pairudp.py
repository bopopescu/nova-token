begin_unit
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'reactor'
op|','
name|'protocol'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'pair'
name|'import'
name|'ethernet'
op|','
name|'rawudp'
op|','
name|'ip'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'pair'
name|'import'
name|'tuntap'
newline|'\n'
nl|'\n'
DECL|class|MyProto
name|'class'
name|'MyProto'
op|'('
name|'protocol'
op|'.'
name|'DatagramProtocol'
op|')'
op|':'
newline|'\n'
DECL|member|datagramReceived
indent|'    '
name|'def'
name|'datagramReceived'
op|'('
name|'self'
op|','
op|'*'
name|'a'
op|','
op|'**'
name|'kw'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
name|'a'
op|','
name|'kw'
newline|'\n'
nl|'\n'
DECL|variable|p_udp
dedent|''
dedent|''
name|'p_udp'
op|'='
name|'rawudp'
op|'.'
name|'RawUDPProtocol'
op|'('
op|')'
newline|'\n'
name|'p_udp'
op|'.'
name|'addProto'
op|'('
number|'42'
op|','
name|'MyProto'
op|'('
op|')'
op|')'
newline|'\n'
DECL|variable|p_ip
name|'p_ip'
op|'='
name|'ip'
op|'.'
name|'IPProtocol'
op|'('
op|')'
newline|'\n'
name|'p_ip'
op|'.'
name|'addProto'
op|'('
number|'17'
op|','
name|'p_udp'
op|')'
newline|'\n'
DECL|variable|p_eth
name|'p_eth'
op|'='
name|'ethernet'
op|'.'
name|'EthernetProtocol'
op|'('
op|')'
newline|'\n'
name|'p_eth'
op|'.'
name|'addProto'
op|'('
number|'0x800'
op|','
name|'p_ip'
op|')'
newline|'\n'
nl|'\n'
name|'reactor'
op|'.'
name|'listenWith'
op|'('
name|'tuntap'
op|'.'
name|'TuntapPort'
op|','
nl|'\n'
name|'interface'
op|'='
string|"'tap0'"
op|','
name|'proto'
op|'='
name|'p_eth'
op|','
name|'reactor'
op|'='
name|'reactor'
op|')'
newline|'\n'
name|'reactor'
op|'.'
name|'run'
op|'('
op|')'
newline|'\n'
endmarker|''
end_unit
