begin_unit
comment|'#! /usr/bin/python'
nl|'\n'
nl|'\n'
name|'from'
name|'slides'
name|'import'
name|'Lecture'
op|','
name|'NumSlide'
op|','
name|'Slide'
op|','
name|'Bullet'
op|','
name|'SubBullet'
op|','
name|'PRE'
op|','
name|'URL'
newline|'\n'
nl|'\n'
DECL|class|Raw
name|'class'
name|'Raw'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'title'
op|','
name|'html'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'title'
op|'='
name|'title'
newline|'\n'
name|'self'
op|'.'
name|'html'
op|'='
name|'html'
newline|'\n'
DECL|member|toHTML
dedent|''
name|'def'
name|'toHTML'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'html'
newline|'\n'
nl|'\n'
DECL|class|HTML
dedent|''
dedent|''
name|'class'
name|'HTML'
op|'('
name|'Raw'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'html'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'html'
op|'='
name|'html'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'server_lore'
op|'='
string|'"""<div class="py-listing">\n<pre><span class="py-src-keyword">class</span> <span class="py-src-identifier">ServerObject</span><span class="py-src-op">(</span><span class="py-src-parameter">pb</span><span class="py-src-op">.</span><span class="py-src-parameter">Referenceable</span><span class="py-src-op">)</span><span class="py-src-op">:</span><span class="py-src-newline"></span>\n<span class="py-src-indent">    </span><span class="py-src-keyword">def</span> <span class="py-src-identifier">remote_add</span><span class="py-src-op">(</span><span class="py-src-parameter">self</span><span class="py-src-op">,</span> <span class="py-src-parameter">one</span><span class="py-src-op">,</span> <span class="py-src-parameter">two</span><span class="py-src-op">)</span><span class="py-src-op">:</span><span class="py-src-newline">\n</span><span class="py-src-indent">        </span><span class="py-src-variable">answer</span> <span class="py-src-op">=</span> <span class="py-src-variable">one</span> <span class="py-src-op">+</span> <span class="py-src-variable">two</span><span class="py-src-newline">\n</span>        <span class="py-src-keyword">print</span> <span class="py-src-string">&quot;returning result:&quot;</span><span class="py-src-op">,</span> <span class="py-src-variable">answer</span><span class="py-src-newline">\n</span>        <span class="py-src-keyword">return</span> <span class="py-src-variable">answer</span><span class="py-src-endmarker"></span></pre>\n<div class="py-caption">Server Code</div>\n</div>\n"""'
newline|'\n'
nl|'\n'
name|'client_lore'
op|'='
string|'"""<div class="py-listing"><pre>\n<span class="py-src-nl"></span>    <span class="py-src-dedent"></span><span class="py-src-keyword">def</span> <span class="py-src-identifier">got_RemoteReference</span><span class="py-src-op">(</span><span class="py-src-parameter">remoteref</span><span class="py-src-op">)</span><span class="py-src-op">:</span><span class="py-src-newline">\n</span>        <span class="py-src-keyword">print</span> <span class="py-src-string">&quot;asking it to add&quot;</span><span class="py-src-newline">\n</span>        <span class="py-src-variable">deferred</span> <span class="py-src-op">=</span> <span class="py-src-variable">remoteref</span><span class="py-src-op">.</span><span class="py-src-variable">callRemote</span><span class="py-src-op">(</span><span class="py-src-string">&quot;add&quot;</span><span class="py-src-op">,</span> <span class="py-src-number">1</span><span class="py-src-op">,</span> <span class="py-src-number">2</span><span class="py-src-op">)</span><span class="py-src-newline">\n</span>        <span class="py-src-variable">deferred</span><span class="py-src-op">.</span><span class="py-src-variable">addCallbacks</span><span class="py-src-op">(</span><span class="py-src-variable">add_done</span><span class="py-src-op">,</span> <span class="py-src-variable">err</span><span class="py-src-op">)</span><span class="py-src-newline">\n</span>        <span class="py-src-comment"># this Deferred fires when the method call is complete\n</span>    <span class="py-src-dedent"></span><span class="py-src-keyword">def</span> <span class="py-src-identifier">add_done</span><span class="py-src-op">(</span><span class="py-src-parameter">result</span><span class="py-src-op">)</span><span class="py-src-op">:</span><span class="py-src-newline">\n</span><span class="py-src-indent">        </span><span class="py-src-keyword">print</span> <span class="py-src-string">&quot;addition complete, result is&quot;</span><span class="py-src-op">,</span> <span class="py-src-variable">result</span><span class="py-src-newline">\n</span><span class="py-src-endmarker"></span></pre><div class="py-caption">Client Code</div></div>\n"""'
newline|'\n'
nl|'\n'
nl|'\n'
comment|'# title graphic: PB peanut butter jar, "Twist(ed)" on lid'
nl|'\n'
DECL|variable|lecture
name|'lecture'
op|'='
name|'Lecture'
op|'('
nl|'\n'
string|'"Perspective Broker: Translucent RPC in Twisted"'
op|','
nl|'\n'
comment|'# intro'
nl|'\n'
name|'Raw'
op|'('
string|'"Title"'
op|','
string|'"""\n    <h1>Perspective Broker: Translucent RPC in Twisted</h1>\n    <h2>PyCon 2003</h2>\n    <h2>Brian Warner &lt; warner @ lothar . com &gt; </h2>\n    """'
op|')'
op|','
nl|'\n'
nl|'\n'
name|'Slide'
op|'('
string|'"Introduction"'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Overview/definition of RPC"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"What is Perspective Broker?"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"How do I use it?"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Security Issues"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Future Directions"'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
nl|'\n'
name|'Slide'
op|'('
string|'"Remote Procedure Calls"'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Action at a distance: separate processes, safely telling each other what to do"'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"Separate memory spaces"'
op|')'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"Usually on different machines"'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Frequently called RMI these days: Remote Method Invocation"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Three basic parts: Addressing, Serialization, Waiting"'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
nl|'\n'
name|'Slide'
op|'('
string|'"Addressing"'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"What program are you talking to?"'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"hostname, port number"'
op|')'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"Some systems use other namespaces: sunrpc"'
op|')'
nl|'\n'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Which object in that program?"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Which method do you want to run?"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Related issues"'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"How do you know what the arguments are?"'
op|')'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"(do you care?)"'
op|')'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"How do you know what methods are available?"'
op|')'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"(do you care?)"'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
nl|'\n'
name|'Slide'
op|'('
string|'"Serialization"'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"What happens to the arguments you send in?"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"What happens to the results that are returned?"'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"Representation differences: endianness, word length"'
op|')'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"Dealing with user-defined types"'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"How to deal with references"'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'Slide'
op|'('
string|'"The Waiting (is the hardest part)"'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Asynchronous: results come later, or not at all"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Need to do other work while waiting"'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
nl|'\n'
name|'Slide'
op|'('
string|'"Whither Translucence?"'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Not \'Transparent\': don\'t pretend remote objects are really local"'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"CORBA (in C) does this, makes remote calls look like local calls"'
op|')'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"makes it hard to deal with the async nature of RPC"'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Not \'Opaque\': make it easy to deal with the differences"'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"Including extra failure modes, delayed results"'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
nl|'\n'
name|'Bullet'
op|'('
string|'"Exceptions and Deferreds to the rescue"'
op|')'
op|')'
op|','
nl|'\n'
nl|'\n'
name|'Slide'
op|'('
string|'"Other RPC protocols"'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"HTML"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"XML-RPC"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"CORBA"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"when you control both ends of the wire, use PB"'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
nl|'\n'
name|'Raw'
op|'('
string|'"Where does PB fit?"'
op|','
nl|'\n'
string|'"""<h2>PB sits on top of <span class=\\"py-src-identifier\\">twisted.internet</span></h2>\n        <img src=\\"twisted-overview.png\\" />\n        """'
op|')'
op|','
nl|'\n'
nl|'\n'
name|'Slide'
op|'('
string|'"pb.RemoteReference"'
op|','
nl|'\n'
name|'Bullet'
op|'('
name|'HTML'
op|'('
string|'"<span class=\\"py-src-identifier\\">pb.Referenceable</span>: Object which can be accessed by remote systems."'
op|')'
op|','
nl|'\n'
name|'SubBullet'
op|'('
name|'HTML'
op|'('
string|'"Defines methods like <span class=\\"py-src-identifier\\">remote_foo</span> and <span class=\\"py-src-identifier\\">remote_bar</span> which can be invoked remotely."'
op|')'
op|')'
op|','
nl|'\n'
name|'SubBullet'
op|'('
name|'HTML'
op|'('
string|'"Methods without the <span class=\\"py-src-identifier\\">remote_</span> prefix are local-only."'
op|')'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
name|'HTML'
op|'('
string|'"<span class=\\"py-src-identifier\\">pb.RemoteReference</span>: Used by distant program to invoke methods."'
op|')'
op|','
nl|'\n'
name|'SubBullet'
op|'('
name|'HTML'
op|'('
string|'"Offers <span class=\\"py-src-identifier\\">.callRemote()</span> to trigger remote method on a corresponding <span class=\\"py-src-identifier\\">pb.Referenceable</span>."'
op|')'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
nl|'\n'
name|'Raw'
op|'('
string|'"Sample code"'
op|','
nl|'\n'
string|'"<h2>Sample Code</h2>"'
op|'+'
name|'server_lore'
op|'+'
name|'client_lore'
op|')'
op|','
nl|'\n'
comment|'#Slide("Simple Demo"),'
nl|'\n'
comment|'# "better demo: manhole, or reactor running in another thread"'
nl|'\n'
nl|'\n'
comment|'#build up from callRemote?'
nl|'\n'
name|'Slide'
op|'('
string|'"What happens to those arguments?"'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Basic structures should travel transparently"'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"Actually quite difficult in some languages"'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Object graph should remain the same"'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"Serialization context"'
op|')'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"(same issues as Pickle)"'
op|')'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Instances of user-defined classes require more care"'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"User-controlled unjellying"'
op|')'
op|','
op|')'
nl|'\n'
op|')'
op|','
nl|'\n'
nl|'\n'
comment|'#serialization (skip banana)'
nl|'\n'
name|'Slide'
op|'('
string|'"40% More Sandwich Puns Than The Leading Brand"'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"twisted.spread: python package holding other modules"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"PB: remote method invocation"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Jelly: mid-level object serialization"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Banana: low-level serialization of s-expressions"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Taster: security context, decides what may be received"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Marmalade: like Jelly, but involves XML, so it\'s bitter"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"better than the competition"'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"CORBA: few or no sandwich puns"'
op|')'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"XML-RPC: barely pronounceable"'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
nl|'\n'
name|'Slide'
op|'('
string|'"Jellying objects"'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"\'Jellying\' vs \'Unjellying\'"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Immutable objects are copied whole"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Mutable objects get reference IDs to insure shared references remain shared"'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"(within the same Jellying context)"'
op|')'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
nl|'\n'
name|'Slide'
op|'('
string|'"Jellying instances"'
op|','
nl|'\n'
name|'Bullet'
op|'('
name|'HTML'
op|'('
string|'"User classes inherit from one of the <span class=\\"py-src-identifier\\">pb.flavor</span> classes"'
op|')'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
name|'HTML'
op|'('
string|'"<span class=\\"py-src-identifier\\">pb.Referenceable</span>: methods can be called remotely"'
op|')'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
name|'HTML'
op|'('
string|'"<span class=\\"py-src-identifier\\">pb.Copyable</span>: contents are selectively copied"'
op|')'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
name|'HTML'
op|'('
string|'"<span class=\\"py-src-identifier\\">pb.Cacheable</span>: contents are copied and kept up to date"'
op|')'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
name|'HTML'
op|'('
string|'"Classes define <span class=\\"py-src-identifier\\">.getStateToCopy</span> and other methods to restrict exported state"'
op|')'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
nl|'\n'
name|'Slide'
op|'('
string|'"pb.Copyable example"'
op|','
nl|'\n'
name|'PRE'
op|'('
string|'"""class SenderPond(FrogPond, pb.Copyable):\n    def getStateToCopy(self):\n        d = self.__dict__.copy()\n        d[\'frogsAndToads\'] = d[\'numFrogs\'] + d[\'numToads\']\n        del d[\'numFrogs\']\n        del d[\'numToads\']\n        return d\n\nclass ReceiverPond(pb.RemoteCopy):\n    def setCopyableState(self, state):\n        self.__dict__ = state\n        self.localCount = 12\n    def count(self):\n        return self.frogsAndToads\n\npb.setUnjellyableForClass(SenderPond, ReceiverPond)\n"""'
op|')'
op|')'
op|','
nl|'\n'
nl|'\n'
name|'Slide'
op|'('
string|'"Secure Unjellying"'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Pickle has security problems"'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"Pickle will import any module the sender requests."'
op|')'
op|','
nl|'\n'
name|'SubBullet'
op|'('
name|'HTML'
op|'('
string|'"2.3 gave up, removed safety checks like <span class=\\"py-src-identifier\\">__safe_for_unpickling__</span> ."'
op|')'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Jelly attempts to be safe in the face of hostile clients"'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"All classes rejected by default"'
op|')'
op|','
nl|'\n'
name|'SubBullet'
op|'('
name|'HTML'
op|'('
string|'"<span class=\\"py-src-identifier\\">registerUnjellyable()</span> used to accept safe ones"'
op|')'
op|')'
op|','
nl|'\n'
name|'SubBullet'
op|'('
name|'HTML'
op|'('
string|'"Registered classes define <span class=\\"py-src-identifier\\">.setCopyableState</span> and others to process remote state"'
op|')'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Must mark (by subclassing) to transmit"'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
nl|'\n'
name|'Slide'
op|'('
string|'"Transformation of references in transit"'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"All referenced objects get turned into their counterparts as they go over the wire"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"References are followed recursively"'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"Sending a reference to a tree of objects will cause the whole thing to be transferred"'
op|')'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"(subject to security restrictions)"'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
name|'HTML'
op|'('
string|'"<span class=\\"py-src-identifier\\">pb.flavors</span> get reference ids"'
op|')'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"They are recognized when they return, transformed into the original reference"'
op|')'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"Reference ids are scoped to the connection"'
op|')'
op|','
nl|'\n'
name|'SubBullet'
op|'('
string|'"One side-effect: no \'third party\' references"'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
nl|'\n'
name|'Slide'
op|'('
string|'"Perspectives: pb.cred and the Identity/Service model"'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"A layer to provide common authentication services to Twisted applications"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
name|'HTML'
op|'('
string|'"<span class=\\"py-src-identifier\\">Identity</span>: named user accounts with passwords"'
op|')'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
name|'HTML'
op|'('
string|'"<span class=\\"py-src-identifier\\">Service</span>: something a user can request access to"'
op|')'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
name|'HTML'
op|'('
string|'"<span class=\\"py-src-identifier\\">Perspective</span>: user accessing a service"'
op|')'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
name|'HTML'
op|'('
string|'"<span class=\\"py-src-identifier\\">pb.Perspective</span>: first object, a <span class=\\"py-src-identifier\\">pb.Referenceable</span> used to access everything else"'
op|')'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
comment|'#picture would help'
nl|'\n'
nl|'\n'
name|'Slide'
op|'('
string|'"Future directions"'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Other language bindings: Java, elisp, Haskell, Scheme, JavaScript, OCaml"'
op|')'
op|','
nl|'\n'
comment|'# donovan is doing the JavaScript port'
nl|'\n'
name|'Bullet'
op|'('
string|'"Other transports: UDP, Airhook"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Componentization"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Performance improvements: C extension for Jelly"'
op|')'
op|','
nl|'\n'
name|'Bullet'
op|'('
string|'"Refactor addressing model: PB URLs"'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
nl|'\n'
name|'Slide'
op|'('
string|'"Questions"'
op|','
name|'Bullet'
op|'('
string|'"???"'
op|')'
op|')'
op|','
nl|'\n'
nl|'\n'
op|')'
newline|'\n'
nl|'\n'
name|'lecture'
op|'.'
name|'renderHTML'
op|'('
string|'"slides"'
op|','
string|'"slide-%02d.html"'
op|','
name|'css'
op|'='
string|'"stylesheet.css"'
op|')'
newline|'\n'
nl|'\n'
endmarker|''
end_unit
