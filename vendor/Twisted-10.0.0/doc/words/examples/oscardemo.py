begin_unit
comment|'#!/usr/bin/env python'
nl|'\n'
nl|'\n'
comment|'# Copyright (c) 2009 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'words'
op|'.'
name|'protocols'
name|'import'
name|'oscar'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'protocol'
op|','
name|'reactor'
newline|'\n'
name|'import'
name|'getpass'
newline|'\n'
nl|'\n'
DECL|variable|SN
name|'SN'
op|'='
name|'raw_input'
op|'('
string|"'Username: '"
op|')'
comment|'# replace this with a screenname'
newline|'\n'
DECL|variable|PASS
name|'PASS'
op|'='
name|'getpass'
op|'.'
name|'getpass'
op|'('
string|"'Password: '"
op|')'
comment|'# replace this with a password'
newline|'\n'
name|'if'
name|'SN'
op|'['
number|'0'
op|']'
op|'.'
name|'isdigit'
op|'('
op|')'
op|':'
newline|'\n'
DECL|variable|icqMode
indent|'    '
name|'icqMode'
op|'='
number|'1'
newline|'\n'
DECL|variable|hostport
name|'hostport'
op|'='
op|'('
string|"'login.icq.com'"
op|','
number|'5238'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
DECL|variable|hostport
indent|'    '
name|'hostport'
op|'='
op|'('
string|"'login.oscar.aol.com'"
op|','
number|'5190'
op|')'
newline|'\n'
DECL|variable|icqMode
name|'icqMode'
op|'='
number|'0'
newline|'\n'
nl|'\n'
DECL|class|B
dedent|''
name|'class'
name|'B'
op|'('
name|'oscar'
op|'.'
name|'BOSConnection'
op|')'
op|':'
newline|'\n'
DECL|variable|capabilities
indent|'    '
name|'capabilities'
op|'='
op|'['
name|'oscar'
op|'.'
name|'CAP_CHAT'
op|']'
newline|'\n'
DECL|member|initDone
name|'def'
name|'initDone'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'requestSelfInfo'
op|'('
op|')'
op|'.'
name|'addCallback'
op|'('
name|'self'
op|'.'
name|'gotSelfInfo'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'requestSSI'
op|'('
op|')'
op|'.'
name|'addCallback'
op|'('
name|'self'
op|'.'
name|'gotBuddyList'
op|')'
newline|'\n'
DECL|member|gotSelfInfo
dedent|''
name|'def'
name|'gotSelfInfo'
op|'('
name|'self'
op|','
name|'user'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
name|'user'
op|'.'
name|'__dict__'
newline|'\n'
name|'self'
op|'.'
name|'name'
op|'='
name|'user'
op|'.'
name|'name'
newline|'\n'
DECL|member|gotBuddyList
dedent|''
name|'def'
name|'gotBuddyList'
op|'('
name|'self'
op|','
name|'l'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
name|'l'
newline|'\n'
name|'self'
op|'.'
name|'activateSSI'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'setProfile'
op|'('
string|'"""this is a test of the current twisted.oscar code.<br>\ncurrent features:<br>\n* send me a message, and you should get it back.<br>\n* invite me to a chat room.  i\'ll repeat what people say.  say \'leave\' and i\'ll go.<br>\n* also, i hang out in \'%s Chat\'.  join that, i\'ll repeat what you say there.<br>\n* try warning me.  just try it.<br>\n<br>\nif any of those features don\'t work, tell paul (Z3Penguin).  thanks."""'
op|'%'
name|'SN'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'setIdleTime'
op|'('
number|'0'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'clientReady'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'createChat'
op|'('
string|"'%s Chat'"
op|'%'
name|'SN'
op|')'
op|'.'
name|'addCallback'
op|'('
name|'self'
op|'.'
name|'createdRoom'
op|')'
newline|'\n'
DECL|function|createdRoom
dedent|''
name|'def'
name|'createdRoom'
op|'('
name|'self'
op|','
op|'('
name|'exchange'
op|','
name|'fullName'
op|','
name|'instance'
op|')'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|"'created room'"
op|','
name|'exchange'
op|','
name|'fullName'
op|','
name|'instance'
newline|'\n'
name|'self'
op|'.'
name|'joinChat'
op|'('
name|'exchange'
op|','
name|'fullName'
op|','
name|'instance'
op|')'
op|'.'
name|'addCallback'
op|'('
name|'self'
op|'.'
name|'chatJoined'
op|')'
newline|'\n'
DECL|function|updateBuddy
dedent|''
name|'def'
name|'updateBuddy'
op|'('
name|'self'
op|','
name|'user'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
name|'user'
newline|'\n'
DECL|function|offlineBuddy
dedent|''
name|'def'
name|'offlineBuddy'
op|'('
name|'self'
op|','
name|'user'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|"'offline'"
op|','
name|'user'
op|'.'
name|'name'
newline|'\n'
DECL|function|receiveMessage
dedent|''
name|'def'
name|'receiveMessage'
op|'('
name|'self'
op|','
name|'user'
op|','
name|'multiparts'
op|','
name|'flags'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
name|'user'
op|'.'
name|'name'
op|','
name|'multiparts'
op|','
name|'flags'
newline|'\n'
name|'self'
op|'.'
name|'getAway'
op|'('
name|'user'
op|'.'
name|'name'
op|')'
op|'.'
name|'addCallback'
op|'('
name|'self'
op|'.'
name|'gotAway'
op|','
name|'user'
op|'.'
name|'name'
op|')'
newline|'\n'
name|'if'
name|'multiparts'
op|'['
number|'0'
op|']'
op|'['
number|'0'
op|']'
op|'.'
name|'find'
op|'('
string|"'away'"
op|')'
op|'!='
op|'-'
number|'1'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'setAway'
op|'('
string|"'I am away from my computer right now.'"
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'multiparts'
op|'['
number|'0'
op|']'
op|'['
number|'0'
op|']'
op|'.'
name|'find'
op|'('
string|"'back'"
op|')'
op|'!='
op|'-'
number|'1'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'setAway'
op|'('
name|'None'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'awayMessage'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'sendMessage'
op|'('
name|'user'
op|'.'
name|'name'
op|','
string|'\'<html><font color="#0000ff">\''
op|'+'
name|'self'
op|'.'
name|'awayMessage'
op|','
name|'autoResponse'
op|'='
number|'1'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'lastUser'
op|'='
name|'user'
op|'.'
name|'name'
newline|'\n'
name|'self'
op|'.'
name|'sendMessage'
op|'('
name|'user'
op|'.'
name|'name'
op|','
name|'multiparts'
op|','
name|'wantAck'
op|'='
number|'1'
op|','
name|'autoResponse'
op|'='
op|'('
name|'self'
op|'.'
name|'awayMessage'
op|'!='
name|'None'
op|')'
op|')'
op|'.'
name|'addCallback'
op|'('
name|'self'
op|'.'
name|'messageAck'
op|')'
newline|'\n'
DECL|function|messageAck
dedent|''
dedent|''
name|'def'
name|'messageAck'
op|'('
name|'self'
op|','
op|'('
name|'username'
op|','
name|'message'
op|')'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|"'message sent to %s acked'"
op|'%'
name|'username'
newline|'\n'
DECL|function|gotAway
dedent|''
name|'def'
name|'gotAway'
op|'('
name|'self'
op|','
name|'away'
op|','
name|'user'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'away'
op|'!='
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'print'
string|"'got away for'"
op|','
name|'user'
op|','
string|"':'"
op|','
name|'away'
newline|'\n'
DECL|function|receiveWarning
dedent|''
dedent|''
name|'def'
name|'receiveWarning'
op|'('
name|'self'
op|','
name|'newLevel'
op|','
name|'user'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|"'got warning from'"
op|','
name|'hasattr'
op|'('
name|'user'
op|','
string|"'name'"
op|')'
name|'and'
name|'user'
op|'.'
name|'name'
name|'or'
name|'None'
newline|'\n'
name|'print'
string|"'new warning level'"
op|','
name|'newLevel'
newline|'\n'
name|'if'
name|'not'
name|'user'
op|':'
newline|'\n'
comment|'#username = self.lastUser'
nl|'\n'
indent|'            '
name|'return'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'username'
op|'='
name|'user'
op|'.'
name|'name'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'warnUser'
op|'('
name|'username'
op|')'
op|'.'
name|'addCallback'
op|'('
name|'self'
op|'.'
name|'warnedUser'
op|','
name|'username'
op|')'
newline|'\n'
DECL|function|warnedUser
dedent|''
name|'def'
name|'warnedUser'
op|'('
name|'self'
op|','
name|'oldLevel'
op|','
name|'newLevel'
op|','
name|'username'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'sendMessage'
op|'('
name|'username'
op|','
string|"'muahaha :-p'"
op|')'
newline|'\n'
DECL|function|receiveChatInvite
dedent|''
name|'def'
name|'receiveChatInvite'
op|'('
name|'self'
op|','
name|'user'
op|','
name|'message'
op|','
name|'exchange'
op|','
name|'fullName'
op|','
name|'instance'
op|','
name|'shortName'
op|','
name|'inviteTime'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'print'
string|"'chat invite from'"
op|','
name|'user'
op|'.'
name|'name'
op|','
string|"'for room'"
op|','
name|'shortName'
op|','
string|"'with message:'"
op|','
name|'message'
newline|'\n'
name|'self'
op|'.'
name|'joinChat'
op|'('
name|'exchange'
op|','
name|'fullName'
op|','
name|'instance'
op|')'
op|'.'
name|'addCallback'
op|'('
name|'self'
op|'.'
name|'chatJoined'
op|')'
newline|'\n'
DECL|function|chatJoined
dedent|''
name|'def'
name|'chatJoined'
op|'('
name|'self'
op|','
name|'chat'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|"'joined chat room'"
op|','
name|'chat'
op|'.'
name|'name'
newline|'\n'
name|'print'
string|"'members:'"
op|','
name|'map'
op|'('
name|'lambda'
name|'x'
op|':'
name|'x'
op|'.'
name|'name'
op|','
name|'chat'
op|'.'
name|'members'
op|')'
newline|'\n'
DECL|function|chatReceiveMessage
dedent|''
name|'def'
name|'chatReceiveMessage'
op|'('
name|'self'
op|','
name|'chat'
op|','
name|'user'
op|','
name|'message'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|"'message to'"
op|','
name|'chat'
op|'.'
name|'name'
op|','
string|"'from'"
op|','
name|'user'
op|'.'
name|'name'
op|','
string|"':'"
op|','
name|'message'
newline|'\n'
name|'if'
name|'user'
op|'.'
name|'name'
op|'!='
name|'self'
op|'.'
name|'name'
op|':'
name|'chat'
op|'.'
name|'sendMessage'
op|'('
name|'user'
op|'.'
name|'name'
op|'+'
string|"': '"
op|'+'
name|'message'
op|')'
newline|'\n'
name|'if'
name|'message'
op|'.'
name|'find'
op|'('
string|"'leave'"
op|')'
op|'!='
op|'-'
number|'1'
name|'and'
name|'chat'
op|'.'
name|'name'
op|'!='
string|"'%s Chat'"
op|'%'
name|'SN'
op|':'
name|'chat'
op|'.'
name|'leaveChat'
op|'('
op|')'
newline|'\n'
DECL|function|chatMemberJoined
dedent|''
name|'def'
name|'chatMemberJoined'
op|'('
name|'self'
op|','
name|'chat'
op|','
name|'member'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
name|'member'
op|'.'
name|'name'
op|','
string|"'joined'"
op|','
name|'chat'
op|'.'
name|'name'
newline|'\n'
DECL|function|chatMemberLeft
dedent|''
name|'def'
name|'chatMemberLeft'
op|'('
name|'self'
op|','
name|'chat'
op|','
name|'member'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
name|'member'
op|'.'
name|'name'
op|','
string|"'left'"
op|','
name|'chat'
op|'.'
name|'name'
newline|'\n'
name|'print'
string|"'current members'"
op|','
name|'map'
op|'('
name|'lambda'
name|'x'
op|':'
name|'x'
op|'.'
name|'name'
op|','
name|'chat'
op|'.'
name|'members'
op|')'
newline|'\n'
name|'if'
name|'chat'
op|'.'
name|'name'
op|'!='
string|'"%s Chat"'
op|'%'
name|'SN'
name|'and'
name|'len'
op|'('
name|'chat'
op|'.'
name|'members'
op|')'
op|'=='
number|'1'
op|':'
newline|'\n'
indent|'            '
name|'print'
string|"'leaving'"
op|','
name|'chat'
op|'.'
name|'name'
newline|'\n'
name|'chat'
op|'.'
name|'leaveChat'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|class|OA
dedent|''
dedent|''
dedent|''
name|'class'
name|'OA'
op|'('
name|'oscar'
op|'.'
name|'OscarAuthenticator'
op|')'
op|':'
newline|'\n'
DECL|variable|BOSClass
indent|'   '
name|'BOSClass'
op|'='
name|'B'
newline|'\n'
nl|'\n'
dedent|''
name|'protocol'
op|'.'
name|'ClientCreator'
op|'('
name|'reactor'
op|','
name|'OA'
op|','
name|'SN'
op|','
name|'PASS'
op|','
name|'icq'
op|'='
name|'icqMode'
op|')'
op|'.'
name|'connectTCP'
op|'('
op|'*'
name|'hostport'
op|')'
newline|'\n'
name|'reactor'
op|'.'
name|'run'
op|'('
op|')'
newline|'\n'
endmarker|''
end_unit
