begin_unit
comment|'# Copyright (c) 2009 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
comment|'# Originally written by Darryl Vandorp'
nl|'\n'
comment|'# http://randomthoughts.vandorp.ca/'
nl|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'words'
op|'.'
name|'protocols'
op|'.'
name|'jabber'
name|'import'
name|'client'
op|','
name|'jid'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'words'
op|'.'
name|'xish'
name|'import'
name|'domish'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'reactor'
newline|'\n'
nl|'\n'
DECL|function|authd
name|'def'
name|'authd'
op|'('
name|'xmlstream'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'print'
string|'"authenticated"'
newline|'\n'
nl|'\n'
name|'presence'
op|'='
name|'domish'
op|'.'
name|'Element'
op|'('
op|'('
string|"'jabber:client'"
op|','
string|"'presence'"
op|')'
op|')'
newline|'\n'
name|'xmlstream'
op|'.'
name|'send'
op|'('
name|'presence'
op|')'
newline|'\n'
nl|'\n'
name|'xmlstream'
op|'.'
name|'addObserver'
op|'('
string|"'/message'"
op|','
name|'debug'
op|')'
newline|'\n'
name|'xmlstream'
op|'.'
name|'addObserver'
op|'('
string|"'/presence'"
op|','
name|'debug'
op|')'
newline|'\n'
name|'xmlstream'
op|'.'
name|'addObserver'
op|'('
string|"'/iq'"
op|','
name|'debug'
op|')'
newline|'\n'
nl|'\n'
DECL|function|debug
dedent|''
name|'def'
name|'debug'
op|'('
name|'elem'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'print'
name|'elem'
op|'.'
name|'toXml'
op|'('
op|')'
op|'.'
name|'encode'
op|'('
string|"'utf-8'"
op|')'
newline|'\n'
name|'print'
string|'"="'
op|'*'
number|'20'
newline|'\n'
nl|'\n'
DECL|variable|myJid
dedent|''
name|'myJid'
op|'='
name|'jid'
op|'.'
name|'JID'
op|'('
string|"'username@server.jabber/twisted_words'"
op|')'
newline|'\n'
DECL|variable|factory
name|'factory'
op|'='
name|'client'
op|'.'
name|'basicClientFactory'
op|'('
name|'myJid'
op|','
string|"'password'"
op|')'
newline|'\n'
name|'factory'
op|'.'
name|'addBootstrap'
op|'('
string|"'//event/stream/authd'"
op|','
name|'authd'
op|')'
newline|'\n'
name|'reactor'
op|'.'
name|'connectTCP'
op|'('
string|"'server.jabber'"
op|','
number|'5222'
op|','
name|'factory'
op|')'
newline|'\n'
name|'reactor'
op|'.'
name|'run'
op|'('
op|')'
newline|'\n'
endmarker|''
end_unit
