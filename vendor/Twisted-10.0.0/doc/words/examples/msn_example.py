begin_unit
comment|'#!/usr/bin/env python'
nl|'\n'
nl|'\n'
comment|'# Copyright (c) 2001-2009 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
comment|'# Twisted Imports'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'reactor'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
op|'.'
name|'protocol'
name|'import'
name|'ClientFactory'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'words'
op|'.'
name|'protocols'
name|'import'
name|'msn'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'python'
name|'import'
name|'log'
newline|'\n'
nl|'\n'
comment|'# System Imports'
nl|'\n'
name|'import'
name|'sys'
op|','
name|'getpass'
newline|'\n'
nl|'\n'
string|'"""\nThis example connects to the MSN chat service and\nprints out information about all the users on your\ncontact list (both online and offline).\n\nThe main aim of this example is to demonstrate\nthe connection process.\n\n@author Samuel Jordan\n"""'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|_createNotificationFac
name|'def'
name|'_createNotificationFac'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
name|'fac'
op|'='
name|'msn'
op|'.'
name|'NotificationFactory'
op|'('
op|')'
newline|'\n'
name|'fac'
op|'.'
name|'userHandle'
op|'='
name|'USER_HANDLE'
newline|'\n'
name|'fac'
op|'.'
name|'password'
op|'='
name|'PASSWORD'
newline|'\n'
name|'fac'
op|'.'
name|'protocol'
op|'='
name|'Notification'
newline|'\n'
name|'return'
name|'fac'
newline|'\n'
nl|'\n'
DECL|class|Dispatch
dedent|''
name|'class'
name|'Dispatch'
op|'('
name|'msn'
op|'.'
name|'DispatchClient'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'msn'
op|'.'
name|'DispatchClient'
op|'.'
name|'__init__'
op|'('
name|'self'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'userHandle'
op|'='
name|'USER_HANDLE'
newline|'\n'
nl|'\n'
DECL|member|gotNotificationReferral
dedent|''
name|'def'
name|'gotNotificationReferral'
op|'('
name|'self'
op|','
name|'host'
op|','
name|'port'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'transport'
op|'.'
name|'loseConnection'
op|'('
op|')'
newline|'\n'
name|'reactor'
op|'.'
name|'connectTCP'
op|'('
name|'host'
op|','
name|'port'
op|','
name|'_createNotificationFac'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|class|Notification
dedent|''
dedent|''
name|'class'
name|'Notification'
op|'('
name|'msn'
op|'.'
name|'NotificationClient'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|loginFailure
indent|'    '
name|'def'
name|'loginFailure'
op|'('
name|'self'
op|','
name|'message'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|"'Login failure:'"
op|','
name|'message'
newline|'\n'
nl|'\n'
DECL|member|listSynchronized
dedent|''
name|'def'
name|'listSynchronized'
op|'('
name|'self'
op|','
op|'*'
name|'args'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'contactList'
op|'='
name|'self'
op|'.'
name|'factory'
op|'.'
name|'contacts'
newline|'\n'
name|'print'
string|"'Contact list has been synchronized, number of contacts = %s'"
op|'%'
name|'len'
op|'('
name|'contactList'
op|'.'
name|'getContacts'
op|'('
op|')'
op|')'
newline|'\n'
name|'for'
name|'contact'
name|'in'
name|'contactList'
op|'.'
name|'getContacts'
op|'('
op|')'
op|'.'
name|'values'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'print'
string|"'Contact: %s'"
op|'%'
op|'('
name|'contact'
op|'.'
name|'screenName'
op|','
op|')'
newline|'\n'
name|'print'
string|"'    email: %s'"
op|'%'
op|'('
name|'contact'
op|'.'
name|'userHandle'
op|','
op|')'
newline|'\n'
name|'print'
string|"'   groups:'"
newline|'\n'
name|'for'
name|'group'
name|'in'
name|'contact'
op|'.'
name|'groups'
op|':'
newline|'\n'
indent|'                '
name|'print'
string|"'      - %s'"
op|'%'
name|'contactList'
op|'.'
name|'groups'
op|'['
name|'group'
op|']'
newline|'\n'
dedent|''
name|'print'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
dedent|''
name|'if'
name|'__name__'
op|'=='
string|"'__main__'"
op|':'
newline|'\n'
DECL|variable|USER_HANDLE
indent|'    '
name|'USER_HANDLE'
op|'='
name|'raw_input'
op|'('
string|'"Email (passport): "'
op|')'
newline|'\n'
DECL|variable|PASSWORD
name|'PASSWORD'
op|'='
name|'getpass'
op|'.'
name|'getpass'
op|'('
op|')'
newline|'\n'
name|'log'
op|'.'
name|'startLogging'
op|'('
name|'sys'
op|'.'
name|'stdout'
op|')'
newline|'\n'
DECL|variable|_dummy_fac
name|'_dummy_fac'
op|'='
name|'ClientFactory'
op|'('
op|')'
newline|'\n'
name|'_dummy_fac'
op|'.'
name|'protocol'
op|'='
name|'Dispatch'
newline|'\n'
name|'reactor'
op|'.'
name|'connectTCP'
op|'('
string|"'messenger.hotmail.com'"
op|','
number|'1863'
op|','
name|'_dummy_fac'
op|')'
newline|'\n'
name|'reactor'
op|'.'
name|'run'
op|'('
op|')'
newline|'\n'
dedent|''
endmarker|''
end_unit
