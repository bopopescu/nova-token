begin_unit
string|'"""Example of an XML-RPC server in Twisted.\n\nTo run the server, just run this file ("python xmlrpc.py").\n\nAn example session (assuming the server is running)::\n    \n    >>> import xmlrpclib\n    >>> s = xmlrpclib.Server(\'http://localhost:7080/\')\n    >>> s.echo("lala")\n    [\'lala\']\n    >>> s.echo("lala", 1)\n    [\'lala\', 1]\n    >>> s.echo("lala", 4)\n    [\'lala\', 4]\n    >>> s.echo("lala", 4, 3.4)\n    [\'lala\', 4, 3.3999999999999999]\n    >>> s.echo("lala", 4, [1, 2])\n    [\'lala\', 4, [1, 2]]\n\n"""'
newline|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'web'
name|'import'
name|'xmlrpc'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'defer'
newline|'\n'
nl|'\n'
comment|'# This module is standard in Python 2.2, otherwise get it from'
nl|'\n'
comment|'#   http://www.pythonware.com/products/xmlrpc/'
nl|'\n'
name|'import'
name|'xmlrpclib'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|Echoer
name|'class'
name|'Echoer'
op|'('
name|'xmlrpc'
op|'.'
name|'XMLRPC'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""An example object to be published.\n    \n    Has five methods accessable by XML-RPC, \'echo\', \'hello\', \'defer\',\n    \'defer_fail\' and \'fail.\n    """'
newline|'\n'
nl|'\n'
DECL|member|xmlrpc_echo
name|'def'
name|'xmlrpc_echo'
op|'('
name|'self'
op|','
op|'*'
name|'args'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Return all passed args."""'
newline|'\n'
name|'return'
name|'args'
newline|'\n'
nl|'\n'
DECL|member|xmlrpc_hello
dedent|''
name|'def'
name|'xmlrpc_hello'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Return \'hello, world\'."""'
newline|'\n'
name|'return'
string|"'hello, world!'"
newline|'\n'
nl|'\n'
DECL|member|xmlrpc_defer
dedent|''
name|'def'
name|'xmlrpc_defer'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Show how xmlrpc methods can return Deferred."""'
newline|'\n'
name|'return'
name|'defer'
op|'.'
name|'succeed'
op|'('
string|'"hello"'
op|')'
newline|'\n'
nl|'\n'
DECL|member|xmlrpc_defer_fail
dedent|''
name|'def'
name|'xmlrpc_defer_fail'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Show how xmlrpc methods can return failed Deferred."""'
newline|'\n'
name|'return'
name|'defer'
op|'.'
name|'fail'
op|'('
number|'12'
op|')'
newline|'\n'
nl|'\n'
DECL|member|xmlrpc_fail
dedent|''
name|'def'
name|'xmlrpc_fail'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Show how we can return a failure code."""'
newline|'\n'
name|'return'
name|'xmlrpclib'
op|'.'
name|'Fault'
op|'('
number|'7'
op|','
string|'"Out of cheese."'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|main
dedent|''
dedent|''
name|'def'
name|'main'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'reactor'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'web'
name|'import'
name|'server'
newline|'\n'
name|'r'
op|'='
name|'Echoer'
op|'('
op|')'
newline|'\n'
name|'reactor'
op|'.'
name|'listenTCP'
op|'('
number|'7080'
op|','
name|'server'
op|'.'
name|'Site'
op|'('
name|'r'
op|')'
op|')'
newline|'\n'
name|'reactor'
op|'.'
name|'run'
op|'('
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
dedent|''
name|'if'
name|'__name__'
op|'=='
string|"'__main__'"
op|':'
newline|'\n'
indent|'    '
name|'main'
op|'('
op|')'
newline|'\n'
dedent|''
endmarker|''
end_unit
