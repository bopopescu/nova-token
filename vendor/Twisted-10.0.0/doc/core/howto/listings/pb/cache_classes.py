begin_unit
comment|'#!/usr/bin/env python'
nl|'\n'
nl|'\n'
comment|'# Copyright (c) 2009 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'spread'
name|'import'
name|'pb'
newline|'\n'
nl|'\n'
DECL|class|MasterDuckPond
name|'class'
name|'MasterDuckPond'
op|'('
name|'pb'
op|'.'
name|'Cacheable'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'ducks'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'observers'
op|'='
op|'['
op|']'
newline|'\n'
name|'self'
op|'.'
name|'ducks'
op|'='
name|'ducks'
newline|'\n'
DECL|member|count
dedent|''
name|'def'
name|'count'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|'"I have [%d] ducks"'
op|'%'
name|'len'
op|'('
name|'self'
op|'.'
name|'ducks'
op|')'
newline|'\n'
DECL|member|addDuck
dedent|''
name|'def'
name|'addDuck'
op|'('
name|'self'
op|','
name|'duck'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'ducks'
op|'.'
name|'append'
op|'('
name|'duck'
op|')'
newline|'\n'
name|'for'
name|'o'
name|'in'
name|'self'
op|'.'
name|'observers'
op|':'
name|'o'
op|'.'
name|'callRemote'
op|'('
string|"'addDuck'"
op|','
name|'duck'
op|')'
newline|'\n'
DECL|member|removeDuck
dedent|''
name|'def'
name|'removeDuck'
op|'('
name|'self'
op|','
name|'duck'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'ducks'
op|'.'
name|'remove'
op|'('
name|'duck'
op|')'
newline|'\n'
name|'for'
name|'o'
name|'in'
name|'self'
op|'.'
name|'observers'
op|':'
name|'o'
op|'.'
name|'callRemote'
op|'('
string|"'removeDuck'"
op|','
name|'duck'
op|')'
newline|'\n'
DECL|member|getStateToCacheAndObserveFor
dedent|''
name|'def'
name|'getStateToCacheAndObserveFor'
op|'('
name|'self'
op|','
name|'perspective'
op|','
name|'observer'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'observers'
op|'.'
name|'append'
op|'('
name|'observer'
op|')'
newline|'\n'
comment|'# you should ignore pb.Cacheable-specific state, like self.observers'
nl|'\n'
name|'return'
name|'self'
op|'.'
name|'ducks'
comment|'# in this case, just a list of ducks'
newline|'\n'
DECL|member|stoppedObserving
dedent|''
name|'def'
name|'stoppedObserving'
op|'('
name|'self'
op|','
name|'perspective'
op|','
name|'observer'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'observers'
op|'.'
name|'remove'
op|'('
name|'observer'
op|')'
newline|'\n'
nl|'\n'
DECL|class|SlaveDuckPond
dedent|''
dedent|''
name|'class'
name|'SlaveDuckPond'
op|'('
name|'pb'
op|'.'
name|'RemoteCache'
op|')'
op|':'
newline|'\n'
comment|'# This is a cache of a remote MasterDuckPond'
nl|'\n'
DECL|member|count
indent|'    '
name|'def'
name|'count'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'len'
op|'('
name|'self'
op|'.'
name|'cacheducks'
op|')'
newline|'\n'
DECL|member|getDucks
dedent|''
name|'def'
name|'getDucks'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'cacheducks'
newline|'\n'
DECL|member|setCopyableState
dedent|''
name|'def'
name|'setCopyableState'
op|'('
name|'self'
op|','
name|'state'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|'" cache - sitting, er, setting ducks"'
newline|'\n'
name|'self'
op|'.'
name|'cacheducks'
op|'='
name|'state'
newline|'\n'
DECL|member|observe_addDuck
dedent|''
name|'def'
name|'observe_addDuck'
op|'('
name|'self'
op|','
name|'newDuck'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|'" cache - addDuck"'
newline|'\n'
name|'self'
op|'.'
name|'cacheducks'
op|'.'
name|'append'
op|'('
name|'newDuck'
op|')'
newline|'\n'
DECL|member|observe_removeDuck
dedent|''
name|'def'
name|'observe_removeDuck'
op|'('
name|'self'
op|','
name|'deadDuck'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|'" cache - removeDuck"'
newline|'\n'
name|'self'
op|'.'
name|'cacheducks'
op|'.'
name|'remove'
op|'('
name|'deadDuck'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'pb'
op|'.'
name|'setUnjellyableForClass'
op|'('
name|'MasterDuckPond'
op|','
name|'SlaveDuckPond'
op|')'
newline|'\n'
endmarker|''
end_unit
