begin_unit
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'protocol'
op|','
name|'utils'
op|','
name|'reactor'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'python'
name|'import'
name|'failure'
newline|'\n'
name|'from'
name|'cStringIO'
name|'import'
name|'StringIO'
newline|'\n'
nl|'\n'
DECL|class|FortuneQuoter
name|'class'
name|'FortuneQuoter'
op|'('
name|'protocol'
op|'.'
name|'Protocol'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|variable|fortune
indent|'    '
name|'fortune'
op|'='
string|"'/usr/games/fortune'"
newline|'\n'
nl|'\n'
DECL|member|connectionMade
name|'def'
name|'connectionMade'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'output'
op|'='
name|'utils'
op|'.'
name|'getProcessOutput'
op|'('
name|'self'
op|'.'
name|'fortune'
op|')'
newline|'\n'
name|'output'
op|'.'
name|'addCallbacks'
op|'('
name|'self'
op|'.'
name|'writeResponse'
op|','
name|'self'
op|'.'
name|'noResponse'
op|')'
newline|'\n'
nl|'\n'
DECL|member|writeResponse
dedent|''
name|'def'
name|'writeResponse'
op|'('
name|'self'
op|','
name|'resp'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'transport'
op|'.'
name|'write'
op|'('
name|'resp'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'transport'
op|'.'
name|'loseConnection'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|noResponse
dedent|''
name|'def'
name|'noResponse'
op|'('
name|'self'
op|','
name|'err'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'transport'
op|'.'
name|'loseConnection'
op|'('
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
dedent|''
dedent|''
name|'if'
name|'__name__'
op|'=='
string|"'__main__'"
op|':'
newline|'\n'
DECL|variable|f
indent|'    '
name|'f'
op|'='
name|'protocol'
op|'.'
name|'Factory'
op|'('
op|')'
newline|'\n'
name|'f'
op|'.'
name|'protocol'
op|'='
name|'FortuneQuoter'
newline|'\n'
name|'reactor'
op|'.'
name|'listenTCP'
op|'('
number|'10999'
op|','
name|'f'
op|')'
newline|'\n'
name|'reactor'
op|'.'
name|'run'
op|'('
op|')'
newline|'\n'
dedent|''
endmarker|''
end_unit
