begin_unit
comment|'#!/usr/bin/env python'
nl|'\n'
nl|'\n'
comment|'# Copyright (c) 2009 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'defer'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'python'
name|'import'
name|'failure'
op|','
name|'util'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|Counter
name|'class'
name|'Counter'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|variable|num
indent|'    '
name|'num'
op|'='
number|'0'
newline|'\n'
DECL|variable|let
name|'let'
op|'='
string|"'a'"
newline|'\n'
nl|'\n'
DECL|member|incrLet
name|'def'
name|'incrLet'
op|'('
name|'cls'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'cls'
op|'.'
name|'let'
op|'='
name|'chr'
op|'('
name|'ord'
op|'('
name|'cls'
op|'.'
name|'let'
op|')'
op|'+'
number|'1'
op|')'
newline|'\n'
DECL|variable|incrLet
dedent|''
name|'incrLet'
op|'='
name|'classmethod'
op|'('
name|'incrLet'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|handleFailure
dedent|''
name|'def'
name|'handleFailure'
op|'('
name|'f'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'print'
string|'"errback"'
newline|'\n'
name|'print'
string|'"we got an exception: %s"'
op|'%'
op|'('
name|'f'
op|'.'
name|'getTraceback'
op|'('
op|')'
op|','
op|')'
newline|'\n'
name|'return'
name|'f'
newline|'\n'
nl|'\n'
DECL|function|subCb_B
dedent|''
name|'def'
name|'subCb_B'
op|'('
name|'result'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'print'
string|'"sub-callback %s"'
op|'%'
op|'('
name|'Counter'
op|'.'
name|'let'
op|','
op|')'
newline|'\n'
name|'Counter'
op|'.'
name|'incrLet'
op|'('
op|')'
newline|'\n'
name|'s'
op|'='
string|'" beautiful!"'
newline|'\n'
name|'print'
string|'"\\tadding %r to result"'
op|'%'
op|'('
name|'s'
op|','
op|')'
newline|'\n'
name|'result'
op|'+='
name|'s'
newline|'\n'
name|'return'
name|'result'
newline|'\n'
nl|'\n'
DECL|function|subCb_A
dedent|''
name|'def'
name|'subCb_A'
op|'('
name|'result'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'print'
string|'"sub-callback %s"'
op|'%'
op|'('
name|'Counter'
op|'.'
name|'let'
op|','
op|')'
newline|'\n'
name|'Counter'
op|'.'
name|'incrLet'
op|'('
op|')'
newline|'\n'
name|'s'
op|'='
string|'" are "'
newline|'\n'
name|'print'
string|'"\\tadding %r to result"'
op|'%'
op|'('
name|'s'
op|','
op|')'
newline|'\n'
name|'result'
op|'+='
name|'s'
newline|'\n'
name|'return'
name|'result'
newline|'\n'
nl|'\n'
DECL|function|mainCb_1
dedent|''
name|'def'
name|'mainCb_1'
op|'('
name|'result'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'Counter'
op|'.'
name|'num'
op|'+='
number|'1'
newline|'\n'
name|'print'
string|'"callback %s"'
op|'%'
op|'('
name|'Counter'
op|'.'
name|'num'
op|','
op|')'
newline|'\n'
name|'print'
string|'"\\tgot result: %s"'
op|'%'
op|'('
name|'result'
op|','
op|')'
newline|'\n'
name|'result'
op|'+='
string|'" Deferreds "'
newline|'\n'
nl|'\n'
name|'d'
op|'='
name|'defer'
op|'.'
name|'Deferred'
op|'('
op|')'
op|'.'
name|'addCallback'
op|'('
name|'subCb_A'
nl|'\n'
op|')'
op|'.'
name|'addCallback'
op|'('
name|'subCb_B'
op|')'
newline|'\n'
name|'d'
op|'.'
name|'callback'
op|'('
name|'result'
op|')'
newline|'\n'
name|'return'
name|'d'
newline|'\n'
nl|'\n'
DECL|function|mainCb_2
dedent|''
name|'def'
name|'mainCb_2'
op|'('
name|'result'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'Counter'
op|'.'
name|'num'
op|'+='
number|'1'
newline|'\n'
name|'print'
string|'"callback %s"'
op|'%'
op|'('
name|'Counter'
op|'.'
name|'num'
op|','
op|')'
newline|'\n'
name|'print'
string|'"\\tgot result: %s"'
op|'%'
op|'('
name|'result'
op|','
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|deferredExample
dedent|''
name|'def'
name|'deferredExample'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
name|'d'
op|'='
name|'defer'
op|'.'
name|'Deferred'
op|'('
op|')'
op|'.'
name|'addCallback'
op|'('
name|'mainCb_1'
nl|'\n'
op|')'
op|'.'
name|'addCallback'
op|'('
name|'mainCb_2'
op|')'
newline|'\n'
nl|'\n'
name|'d'
op|'.'
name|'callback'
op|'('
string|'"I hope you\'ll agree: "'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
dedent|''
name|'if'
name|'__name__'
op|'=='
string|"'__main__'"
op|':'
newline|'\n'
indent|'    '
name|'deferredExample'
op|'('
op|')'
newline|'\n'
nl|'\n'
dedent|''
endmarker|''
end_unit
