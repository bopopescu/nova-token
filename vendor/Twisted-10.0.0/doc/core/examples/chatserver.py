begin_unit
string|'"""The most basic chat protocol possible.\n\nrun me with twistd -y chatserver.py, and then connect with multiple\ntelnet clients to port 1025\n"""'
newline|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'protocols'
name|'import'
name|'basic'
newline|'\n'
nl|'\n'
nl|'\n'
nl|'\n'
DECL|class|MyChat
name|'class'
name|'MyChat'
op|'('
name|'basic'
op|'.'
name|'LineReceiver'
op|')'
op|':'
newline|'\n'
DECL|member|connectionMade
indent|'    '
name|'def'
name|'connectionMade'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|'"Got new client!"'
newline|'\n'
name|'self'
op|'.'
name|'factory'
op|'.'
name|'clients'
op|'.'
name|'append'
op|'('
name|'self'
op|')'
newline|'\n'
nl|'\n'
DECL|member|connectionLost
dedent|''
name|'def'
name|'connectionLost'
op|'('
name|'self'
op|','
name|'reason'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|'"Lost a client!"'
newline|'\n'
name|'self'
op|'.'
name|'factory'
op|'.'
name|'clients'
op|'.'
name|'remove'
op|'('
name|'self'
op|')'
newline|'\n'
nl|'\n'
DECL|member|lineReceived
dedent|''
name|'def'
name|'lineReceived'
op|'('
name|'self'
op|','
name|'line'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'print'
string|'"received"'
op|','
name|'repr'
op|'('
name|'line'
op|')'
newline|'\n'
name|'for'
name|'c'
name|'in'
name|'self'
op|'.'
name|'factory'
op|'.'
name|'clients'
op|':'
newline|'\n'
indent|'            '
name|'c'
op|'.'
name|'message'
op|'('
name|'line'
op|')'
newline|'\n'
nl|'\n'
DECL|member|message
dedent|''
dedent|''
name|'def'
name|'message'
op|'('
name|'self'
op|','
name|'message'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'transport'
op|'.'
name|'write'
op|'('
name|'message'
op|'+'
string|"'\\n'"
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
dedent|''
dedent|''
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'protocol'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'application'
name|'import'
name|'service'
op|','
name|'internet'
newline|'\n'
nl|'\n'
DECL|variable|factory
name|'factory'
op|'='
name|'protocol'
op|'.'
name|'ServerFactory'
op|'('
op|')'
newline|'\n'
name|'factory'
op|'.'
name|'protocol'
op|'='
name|'MyChat'
newline|'\n'
name|'factory'
op|'.'
name|'clients'
op|'='
op|'['
op|']'
newline|'\n'
nl|'\n'
DECL|variable|application
name|'application'
op|'='
name|'service'
op|'.'
name|'Application'
op|'('
string|'"chatserver"'
op|')'
newline|'\n'
name|'internet'
op|'.'
name|'TCPServer'
op|'('
number|'1025'
op|','
name|'factory'
op|')'
op|'.'
name|'setServiceParent'
op|'('
name|'application'
op|')'
newline|'\n'
endmarker|''
end_unit
