begin_unit
comment|'# Copyright (c) 2001-2004 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
nl|'\n'
comment|'# import needed classes/functions from Cocoa'
nl|'\n'
name|'from'
name|'Foundation'
name|'import'
op|'*'
newline|'\n'
name|'from'
name|'AppKit'
name|'import'
op|'*'
newline|'\n'
nl|'\n'
comment|'# import Nib loading functionality from AppKit'
nl|'\n'
name|'from'
name|'PyObjCTools'
name|'import'
name|'NibClassBuilder'
op|','
name|'AppHelper'
newline|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'_threadedselect'
newline|'\n'
name|'_threadedselect'
op|'.'
name|'install'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'reactor'
op|','
name|'protocol'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'web'
name|'import'
name|'http'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'python'
name|'import'
name|'log'
newline|'\n'
name|'import'
name|'sys'
op|','
name|'urlparse'
newline|'\n'
nl|'\n'
comment|'# create ObjC classes as defined in MainMenu.nib'
nl|'\n'
name|'NibClassBuilder'
op|'.'
name|'extractClasses'
op|'('
string|'"MainMenu"'
op|')'
newline|'\n'
DECL|class|TwistzillaClient
name|'class'
name|'TwistzillaClient'
op|'('
name|'http'
op|'.'
name|'HTTPClient'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'delegate'
op|','
name|'urls'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'urls'
op|'='
name|'urls'
newline|'\n'
name|'self'
op|'.'
name|'delegate'
op|'='
name|'delegate'
newline|'\n'
nl|'\n'
DECL|member|connectionMade
dedent|''
name|'def'
name|'connectionMade'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'sendCommand'
op|'('
string|"'GET'"
op|','
name|'str'
op|'('
name|'self'
op|'.'
name|'urls'
op|'['
number|'2'
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'sendHeader'
op|'('
string|"'Host'"
op|','
string|"'%s:%d'"
op|'%'
op|'('
name|'self'
op|'.'
name|'urls'
op|'['
number|'0'
op|']'
op|','
name|'self'
op|'.'
name|'urls'
op|'['
number|'1'
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'sendHeader'
op|'('
string|"'User-Agent'"
op|','
string|"'CocoaTwistzilla'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'endHeaders'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|handleResponse
dedent|''
name|'def'
name|'handleResponse'
op|'('
name|'self'
op|','
name|'data'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'delegate'
op|'.'
name|'gotResponse_'
op|'('
name|'data'
op|')'
newline|'\n'
nl|'\n'
DECL|class|MyAppDelegate
dedent|''
dedent|''
name|'class'
name|'MyAppDelegate'
op|'('
name|'NibClassBuilder'
op|'.'
name|'AutoBaseClass'
op|')'
op|':'
newline|'\n'
DECL|member|gotResponse_
indent|'    '
name|'def'
name|'gotResponse_'
op|'('
name|'self'
op|','
name|'html'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'s'
op|'='
name|'self'
op|'.'
name|'resultTextField'
op|'.'
name|'textStorage'
op|'('
op|')'
newline|'\n'
name|'s'
op|'.'
name|'replaceCharactersInRange_withString_'
op|'('
op|'('
number|'0'
op|','
name|'s'
op|'.'
name|'length'
op|'('
op|')'
op|')'
op|','
name|'html'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'progressIndicator'
op|'.'
name|'stopAnimation_'
op|'('
name|'self'
op|')'
newline|'\n'
nl|'\n'
DECL|member|doTwistzillaFetch_
dedent|''
name|'def'
name|'doTwistzillaFetch_'
op|'('
name|'self'
op|','
name|'sender'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'s'
op|'='
name|'self'
op|'.'
name|'resultTextField'
op|'.'
name|'textStorage'
op|'('
op|')'
newline|'\n'
name|'s'
op|'.'
name|'deleteCharactersInRange_'
op|'('
op|'('
number|'0'
op|','
name|'s'
op|'.'
name|'length'
op|'('
op|')'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'progressIndicator'
op|'.'
name|'startAnimation_'
op|'('
name|'self'
op|')'
newline|'\n'
name|'u'
op|'='
name|'urlparse'
op|'.'
name|'urlparse'
op|'('
name|'self'
op|'.'
name|'messageTextField'
op|'.'
name|'stringValue'
op|'('
op|')'
op|')'
newline|'\n'
name|'pos'
op|'='
name|'u'
op|'['
number|'1'
op|']'
op|'.'
name|'find'
op|'('
string|"':'"
op|')'
newline|'\n'
name|'if'
name|'pos'
op|'=='
op|'-'
number|'1'
op|':'
newline|'\n'
indent|'            '
name|'host'
op|','
name|'port'
op|'='
name|'u'
op|'['
number|'1'
op|']'
op|','
number|'80'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'host'
op|','
name|'port'
op|'='
name|'u'
op|'['
number|'1'
op|']'
op|'['
op|':'
name|'pos'
op|']'
op|','
name|'int'
op|'('
name|'u'
op|'['
number|'1'
op|']'
op|'['
name|'pos'
op|'+'
number|'1'
op|':'
op|']'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'u'
op|'['
number|'2'
op|']'
op|'=='
string|"''"
op|':'
newline|'\n'
indent|'            '
name|'fname'
op|'='
string|"'/'"
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'fname'
op|'='
name|'u'
op|'['
number|'2'
op|']'
newline|'\n'
dedent|''
name|'host'
op|'='
name|'host'
op|'.'
name|'encode'
op|'('
string|"'utf8'"
op|')'
newline|'\n'
name|'fname'
op|'='
name|'fname'
op|'.'
name|'encode'
op|'('
string|"'utf8'"
op|')'
newline|'\n'
name|'protocol'
op|'.'
name|'ClientCreator'
op|'('
name|'reactor'
op|','
name|'TwistzillaClient'
op|','
name|'self'
op|','
op|'('
name|'host'
op|','
name|'port'
op|','
name|'fname'
op|')'
op|')'
op|'.'
name|'connectTCP'
op|'('
name|'host'
op|','
name|'port'
op|')'
op|'.'
name|'addErrback'
op|'('
name|'lambda'
name|'f'
op|':'
name|'self'
op|'.'
name|'gotResponse_'
op|'('
name|'f'
op|'.'
name|'getBriefTraceback'
op|'('
op|')'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|applicationDidFinishLaunching_
dedent|''
name|'def'
name|'applicationDidFinishLaunching_'
op|'('
name|'self'
op|','
name|'aNotification'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        Invoked by NSApplication once the app is done launching and\n        immediately before the first pass through the main event\n        loop.\n        """'
newline|'\n'
name|'self'
op|'.'
name|'messageTextField'
op|'.'
name|'setStringValue_'
op|'('
string|'"http://www.twistedmatrix.com/"'
op|')'
newline|'\n'
name|'reactor'
op|'.'
name|'interleave'
op|'('
name|'AppHelper'
op|'.'
name|'callAfter'
op|')'
newline|'\n'
nl|'\n'
DECL|member|applicationShouldTerminate_
dedent|''
name|'def'
name|'applicationShouldTerminate_'
op|'('
name|'self'
op|','
name|'sender'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'reactor'
op|'.'
name|'running'
op|':'
newline|'\n'
indent|'            '
name|'reactor'
op|'.'
name|'addSystemEventTrigger'
op|'('
nl|'\n'
string|"'after'"
op|','
string|"'shutdown'"
op|','
name|'AppHelper'
op|'.'
name|'stopEventLoop'
op|')'
newline|'\n'
name|'reactor'
op|'.'
name|'stop'
op|'('
op|')'
newline|'\n'
name|'return'
name|'False'
newline|'\n'
dedent|''
name|'return'
name|'True'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'if'
name|'__name__'
op|'=='
string|"'__main__'"
op|':'
newline|'\n'
indent|'    '
name|'log'
op|'.'
name|'startLogging'
op|'('
name|'sys'
op|'.'
name|'stdout'
op|')'
newline|'\n'
name|'AppHelper'
op|'.'
name|'runEventLoop'
op|'('
op|')'
newline|'\n'
dedent|''
endmarker|''
end_unit
