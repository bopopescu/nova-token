begin_unit
nl|'\n'
comment|'# Copyright (c) 2001-2004 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
nl|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'reactor'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'spread'
name|'import'
name|'pb'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'cred'
op|'.'
name|'credentials'
name|'import'
name|'UsernamePassword'
newline|'\n'
nl|'\n'
name|'from'
name|'pbecho'
name|'import'
name|'DefinedError'
newline|'\n'
nl|'\n'
DECL|function|success
name|'def'
name|'success'
op|'('
name|'message'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'print'
string|'"Message received:"'
op|','
name|'message'
newline|'\n'
comment|'# reactor.stop()'
nl|'\n'
nl|'\n'
DECL|function|failure
dedent|''
name|'def'
name|'failure'
op|'('
name|'error'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'t'
op|'='
name|'error'
op|'.'
name|'trap'
op|'('
name|'DefinedError'
op|')'
newline|'\n'
name|'print'
string|'"error received:"'
op|','
name|'t'
newline|'\n'
name|'reactor'
op|'.'
name|'stop'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|function|connected
dedent|''
name|'def'
name|'connected'
op|'('
name|'perspective'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'perspective'
op|'.'
name|'callRemote'
op|'('
string|"'echo'"
op|','
string|'"hello world"'
op|')'
op|'.'
name|'addCallbacks'
op|'('
name|'success'
op|','
name|'failure'
op|')'
newline|'\n'
name|'perspective'
op|'.'
name|'callRemote'
op|'('
string|"'error'"
op|')'
op|'.'
name|'addCallbacks'
op|'('
name|'success'
op|','
name|'failure'
op|')'
newline|'\n'
name|'print'
string|'"connected."'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|variable|factory
dedent|''
name|'factory'
op|'='
name|'pb'
op|'.'
name|'PBClientFactory'
op|'('
op|')'
newline|'\n'
name|'reactor'
op|'.'
name|'connectTCP'
op|'('
string|'"localhost"'
op|','
name|'pb'
op|'.'
name|'portno'
op|','
name|'factory'
op|')'
newline|'\n'
name|'factory'
op|'.'
name|'login'
op|'('
nl|'\n'
name|'UsernamePassword'
op|'('
string|'"guest"'
op|','
string|'"guest"'
op|')'
op|')'
op|'.'
name|'addCallbacks'
op|'('
name|'connected'
op|','
name|'failure'
op|')'
newline|'\n'
nl|'\n'
name|'reactor'
op|'.'
name|'run'
op|'('
op|')'
newline|'\n'
endmarker|''
end_unit
