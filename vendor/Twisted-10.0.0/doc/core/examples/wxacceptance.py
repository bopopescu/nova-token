begin_unit
comment|'# Copyright (c) 2001-2006 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
string|'"""\nAcceptance tests for wxreactor.\n\nPlease test on Linux, Win32 and OS X:\n1. Startup event is called at startup.\n2. Scheduled event is called after 2 seconds.\n3. Shutdown takes 3 seconds, both when quiting from menu and when closing\n   window (e.g. Alt-F4 in metacity). This tests reactor.stop() and\n   wxApp.ExitEventLoop().\n4. \'hello, world\' continues to be printed even when modal dialog is open\n   (use dialog menu item), when menus are held down, when window is being\n   dragged.\n"""'
newline|'\n'
nl|'\n'
name|'import'
name|'sys'
op|','
name|'time'
newline|'\n'
nl|'\n'
name|'try'
op|':'
newline|'\n'
indent|'    '
name|'from'
name|'wx'
name|'import'
name|'Frame'
name|'as'
name|'wxFrame'
op|','
name|'DefaultPosition'
name|'as'
name|'wxDefaultPosition'
op|','
name|'Size'
name|'as'
name|'wxSize'
op|','
name|'Menu'
name|'as'
name|'wxMenu'
op|','
name|'MenuBar'
name|'as'
name|'wxMenuBar'
op|','
name|'EVT_MENU'
op|','
name|'MessageDialog'
name|'as'
name|'wxMessageDialog'
op|','
name|'App'
name|'as'
name|'wxApp'
newline|'\n'
dedent|''
name|'except'
name|'ImportError'
op|','
name|'e'
op|':'
newline|'\n'
indent|'    '
name|'from'
name|'wxPython'
op|'.'
name|'wx'
name|'import'
op|'*'
newline|'\n'
nl|'\n'
dedent|''
name|'from'
name|'twisted'
op|'.'
name|'python'
name|'import'
name|'log'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'wxreactor'
newline|'\n'
name|'wxreactor'
op|'.'
name|'install'
op|'('
op|')'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'internet'
name|'import'
name|'reactor'
op|','
name|'defer'
newline|'\n'
nl|'\n'
nl|'\n'
comment|'# set up so that "hello, world" is printed continously'
nl|'\n'
DECL|variable|dc
name|'dc'
op|'='
name|'None'
newline|'\n'
DECL|function|helloWorld
name|'def'
name|'helloWorld'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
name|'global'
name|'dc'
newline|'\n'
name|'print'
string|'"hello, world"'
op|','
name|'time'
op|'.'
name|'time'
op|'('
op|')'
newline|'\n'
name|'dc'
op|'='
name|'reactor'
op|'.'
name|'callLater'
op|'('
number|'0.1'
op|','
name|'helloWorld'
op|')'
newline|'\n'
DECL|variable|dc
dedent|''
name|'dc'
op|'='
name|'reactor'
op|'.'
name|'callLater'
op|'('
number|'0.1'
op|','
name|'helloWorld'
op|')'
newline|'\n'
nl|'\n'
DECL|function|twoSecondsPassed
name|'def'
name|'twoSecondsPassed'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
name|'print'
string|'"two seconds passed"'
newline|'\n'
nl|'\n'
DECL|function|printer
dedent|''
name|'def'
name|'printer'
op|'('
name|'s'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'print'
name|'s'
newline|'\n'
nl|'\n'
DECL|function|shutdown
dedent|''
name|'def'
name|'shutdown'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
name|'print'
string|'"shutting down in 3 seconds"'
newline|'\n'
name|'if'
name|'dc'
op|'.'
name|'active'
op|'('
op|')'
op|':'
newline|'\n'
indent|'        '
name|'dc'
op|'.'
name|'cancel'
op|'('
op|')'
newline|'\n'
dedent|''
name|'reactor'
op|'.'
name|'callLater'
op|'('
number|'1'
op|','
name|'printer'
op|','
string|'"2..."'
op|')'
newline|'\n'
name|'reactor'
op|'.'
name|'callLater'
op|'('
number|'2'
op|','
name|'printer'
op|','
string|'"1..."'
op|')'
newline|'\n'
name|'reactor'
op|'.'
name|'callLater'
op|'('
number|'3'
op|','
name|'printer'
op|','
string|'"0..."'
op|')'
newline|'\n'
name|'d'
op|'='
name|'defer'
op|'.'
name|'Deferred'
op|'('
op|')'
newline|'\n'
name|'reactor'
op|'.'
name|'callLater'
op|'('
number|'3'
op|','
name|'d'
op|'.'
name|'callback'
op|','
number|'1'
op|')'
newline|'\n'
name|'return'
name|'d'
newline|'\n'
nl|'\n'
DECL|function|startup
dedent|''
name|'def'
name|'startup'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
name|'print'
string|'"Start up event!"'
newline|'\n'
nl|'\n'
dedent|''
name|'reactor'
op|'.'
name|'callLater'
op|'('
number|'2'
op|','
name|'twoSecondsPassed'
op|')'
newline|'\n'
name|'reactor'
op|'.'
name|'addSystemEventTrigger'
op|'('
string|'"after"'
op|','
string|'"startup"'
op|','
name|'startup'
op|')'
newline|'\n'
name|'reactor'
op|'.'
name|'addSystemEventTrigger'
op|'('
string|'"before"'
op|','
string|'"shutdown"'
op|','
name|'shutdown'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|variable|ID_EXIT
name|'ID_EXIT'
op|'='
number|'101'
newline|'\n'
DECL|variable|ID_DIALOG
name|'ID_DIALOG'
op|'='
number|'102'
newline|'\n'
nl|'\n'
DECL|class|MyFrame
name|'class'
name|'MyFrame'
op|'('
name|'wxFrame'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'parent'
op|','
name|'ID'
op|','
name|'title'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'wxFrame'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'parent'
op|','
name|'ID'
op|','
name|'title'
op|','
name|'wxDefaultPosition'
op|','
name|'wxSize'
op|'('
number|'300'
op|','
number|'200'
op|')'
op|')'
newline|'\n'
name|'menu'
op|'='
name|'wxMenu'
op|'('
op|')'
newline|'\n'
name|'menu'
op|'.'
name|'Append'
op|'('
name|'ID_DIALOG'
op|','
string|'"D&ialog"'
op|','
string|'"Show dialog"'
op|')'
newline|'\n'
name|'menu'
op|'.'
name|'Append'
op|'('
name|'ID_EXIT'
op|','
string|'"E&xit"'
op|','
string|'"Terminate the program"'
op|')'
newline|'\n'
name|'menuBar'
op|'='
name|'wxMenuBar'
op|'('
op|')'
newline|'\n'
name|'menuBar'
op|'.'
name|'Append'
op|'('
name|'menu'
op|','
string|'"&File"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'SetMenuBar'
op|'('
name|'menuBar'
op|')'
newline|'\n'
name|'EVT_MENU'
op|'('
name|'self'
op|','
name|'ID_EXIT'
op|','
name|'self'
op|'.'
name|'DoExit'
op|')'
newline|'\n'
name|'EVT_MENU'
op|'('
name|'self'
op|','
name|'ID_DIALOG'
op|','
name|'self'
op|'.'
name|'DoDialog'
op|')'
newline|'\n'
comment|'# you really ought to do this instead of reactor.stop() in'
nl|'\n'
comment|"# DoExit, but for the sake of testing we'll let closing the"
nl|'\n'
comment|'# window shutdown wx without reactor.stop(), to make sure that'
nl|'\n'
comment|'# still does the right thing.'
nl|'\n'
comment|'#EVT_CLOSE(self, lambda evt: reactor.stop())'
nl|'\n'
nl|'\n'
DECL|member|DoDialog
dedent|''
name|'def'
name|'DoDialog'
op|'('
name|'self'
op|','
name|'event'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'dl'
op|'='
name|'wxMessageDialog'
op|'('
name|'self'
op|','
string|'"Check terminal to see if messages are still being "'
nl|'\n'
string|'"printed by Twisted."'
op|')'
newline|'\n'
name|'dl'
op|'.'
name|'ShowModal'
op|'('
op|')'
newline|'\n'
name|'dl'
op|'.'
name|'Destroy'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|DoExit
dedent|''
name|'def'
name|'DoExit'
op|'('
name|'self'
op|','
name|'event'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'reactor'
op|'.'
name|'stop'
op|'('
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|MyApp
dedent|''
dedent|''
name|'class'
name|'MyApp'
op|'('
name|'wxApp'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|OnInit
indent|'    '
name|'def'
name|'OnInit'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'frame'
op|'='
name|'MyFrame'
op|'('
name|'None'
op|','
op|'-'
number|'1'
op|','
string|'"Hello, world"'
op|')'
newline|'\n'
name|'frame'
op|'.'
name|'Show'
op|'('
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'SetTopWindow'
op|'('
name|'frame'
op|')'
newline|'\n'
name|'return'
name|'True'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|demo
dedent|''
dedent|''
name|'def'
name|'demo'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
name|'log'
op|'.'
name|'startLogging'
op|'('
name|'sys'
op|'.'
name|'stdout'
op|')'
newline|'\n'
name|'app'
op|'='
name|'MyApp'
op|'('
number|'0'
op|')'
newline|'\n'
name|'reactor'
op|'.'
name|'registerWxApp'
op|'('
name|'app'
op|')'
newline|'\n'
name|'reactor'
op|'.'
name|'run'
op|'('
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
dedent|''
name|'if'
name|'__name__'
op|'=='
string|"'__main__'"
op|':'
newline|'\n'
indent|'    '
name|'demo'
op|'('
op|')'
newline|'\n'
dedent|''
endmarker|''
end_unit
