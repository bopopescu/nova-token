begin_unit
comment|'#!/usr/bin/env python'
nl|'\n'
nl|'\n'
comment|'# Copyright (c) 2001-2009 Twisted Matrix Laboratories.'
nl|'\n'
comment|'# See LICENSE for details.'
nl|'\n'
nl|'\n'
string|'"""\nDistutils installer for Twisted.\n"""'
newline|'\n'
nl|'\n'
name|'try'
op|':'
newline|'\n'
comment|'# Load setuptools, to build a specific source package'
nl|'\n'
indent|'    '
name|'import'
name|'setuptools'
newline|'\n'
dedent|''
name|'except'
name|'ImportError'
op|':'
newline|'\n'
indent|'    '
name|'pass'
newline|'\n'
nl|'\n'
dedent|''
name|'import'
name|'sys'
op|','
name|'os'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|getExtensions
name|'def'
name|'getExtensions'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""\n    Get all extensions from core and all subprojects.\n    """'
newline|'\n'
name|'extensions'
op|'='
op|'['
op|']'
newline|'\n'
nl|'\n'
name|'if'
name|'not'
name|'sys'
op|'.'
name|'platform'
op|'.'
name|'startswith'
op|'('
string|"'java'"
op|')'
op|':'
newline|'\n'
indent|'        '
name|'for'
name|'dir'
name|'in'
name|'os'
op|'.'
name|'listdir'
op|'('
string|'"twisted"'
op|')'
op|'+'
op|'['
string|'""'
op|']'
op|':'
newline|'\n'
indent|'            '
name|'topfiles'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
string|'"twisted"'
op|','
name|'dir'
op|','
string|'"topfiles"'
op|')'
newline|'\n'
name|'if'
name|'os'
op|'.'
name|'path'
op|'.'
name|'isdir'
op|'('
name|'topfiles'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'ns'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'setup_py'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'topfiles'
op|','
string|'"setup.py"'
op|')'
newline|'\n'
name|'execfile'
op|'('
name|'setup_py'
op|','
name|'ns'
op|','
name|'ns'
op|')'
newline|'\n'
name|'if'
string|'"extensions"'
name|'in'
name|'ns'
op|':'
newline|'\n'
indent|'                    '
name|'extensions'
op|'.'
name|'extend'
op|'('
name|'ns'
op|'['
string|'"extensions"'
op|']'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
dedent|''
dedent|''
name|'return'
name|'extensions'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|main
dedent|''
name|'def'
name|'main'
op|'('
name|'args'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""\n    Invoke twisted.python.dist with the appropriate metadata about the\n    Twisted package.\n    """'
newline|'\n'
name|'if'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
string|"'twisted'"
op|')'
op|':'
newline|'\n'
indent|'        '
name|'sys'
op|'.'
name|'path'
op|'.'
name|'insert'
op|'('
number|'0'
op|','
string|"'.'"
op|')'
newline|'\n'
dedent|''
name|'from'
name|'twisted'
name|'import'
name|'copyright'
newline|'\n'
name|'from'
name|'twisted'
op|'.'
name|'python'
op|'.'
name|'dist'
name|'import'
name|'getDataFiles'
op|','
name|'getScripts'
op|','
name|'getPackages'
op|','
name|'setup'
newline|'\n'
nl|'\n'
comment|'# "" is included because core scripts are directly in bin/'
nl|'\n'
name|'projects'
op|'='
op|'['
string|"''"
op|']'
op|'+'
op|'['
name|'x'
name|'for'
name|'x'
name|'in'
name|'os'
op|'.'
name|'listdir'
op|'('
string|"'bin'"
op|')'
nl|'\n'
name|'if'
name|'os'
op|'.'
name|'path'
op|'.'
name|'isdir'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
string|'"bin"'
op|','
name|'x'
op|')'
op|')'
nl|'\n'
name|'and'
name|'not'
name|'x'
op|'.'
name|'startswith'
op|'('
string|'"."'
op|')'
op|']'
newline|'\n'
name|'scripts'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'i'
name|'in'
name|'projects'
op|':'
newline|'\n'
indent|'        '
name|'scripts'
op|'.'
name|'extend'
op|'('
name|'getScripts'
op|'('
name|'i'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'setup_args'
op|'='
name|'dict'
op|'('
nl|'\n'
comment|'# metadata'
nl|'\n'
name|'name'
op|'='
string|'"Twisted"'
op|','
nl|'\n'
name|'version'
op|'='
name|'copyright'
op|'.'
name|'version'
op|','
nl|'\n'
name|'description'
op|'='
string|'"An asynchronous networking framework written in "'
nl|'\n'
string|'"Python"'
op|','
nl|'\n'
name|'author'
op|'='
string|'"Twisted Matrix Laboratories"'
op|','
nl|'\n'
name|'author_email'
op|'='
string|'"twisted-python@twistedmatrix.com"'
op|','
nl|'\n'
name|'maintainer'
op|'='
string|'"Glyph Lefkowitz"'
op|','
nl|'\n'
name|'maintainer_email'
op|'='
string|'"glyph@twistedmatrix.com"'
op|','
nl|'\n'
name|'url'
op|'='
string|'"http://twistedmatrix.com/"'
op|','
nl|'\n'
name|'license'
op|'='
string|'"MIT"'
op|','
nl|'\n'
name|'long_description'
op|'='
string|'"""\\\nAn extensible framework for Python programming, with special focus\non event-based network programming and multiprotocol integration.\n"""'
op|','
nl|'\n'
DECL|variable|packages
name|'packages'
op|'='
name|'getPackages'
op|'('
string|"'twisted'"
op|')'
op|','
nl|'\n'
DECL|variable|conditionalExtensions
name|'conditionalExtensions'
op|'='
name|'getExtensions'
op|'('
op|')'
op|','
nl|'\n'
DECL|variable|scripts
name|'scripts'
op|'='
name|'scripts'
op|','
nl|'\n'
DECL|variable|data_files
name|'data_files'
op|'='
name|'getDataFiles'
op|'('
string|"'twisted'"
op|')'
op|','
nl|'\n'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
string|"'setuptools'"
name|'in'
name|'sys'
op|'.'
name|'modules'
op|':'
newline|'\n'
indent|'        '
name|'from'
name|'pkg_resources'
name|'import'
name|'parse_requirements'
newline|'\n'
DECL|variable|requirements
name|'requirements'
op|'='
op|'['
string|'"zope.interface"'
op|']'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'list'
op|'('
name|'parse_requirements'
op|'('
name|'requirements'
op|')'
op|')'
newline|'\n'
dedent|''
name|'except'
op|':'
newline|'\n'
indent|'            '
name|'print'
string|'"""You seem to be running a very old version of setuptools.\nThis version of setuptools has a bug parsing dependencies, so automatic\ndependency resolution is disabled.\n"""'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'setup_args'
op|'['
string|"'install_requires'"
op|']'
op|'='
name|'requirements'
newline|'\n'
dedent|''
name|'setup_args'
op|'['
string|"'include_package_data'"
op|']'
op|'='
name|'True'
newline|'\n'
name|'setup_args'
op|'['
string|"'zip_safe'"
op|']'
op|'='
name|'False'
newline|'\n'
dedent|''
name|'setup'
op|'('
op|'**'
name|'setup_args'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
dedent|''
name|'if'
name|'__name__'
op|'=='
string|'"__main__"'
op|':'
newline|'\n'
indent|'    '
name|'try'
op|':'
newline|'\n'
indent|'        '
name|'main'
op|'('
name|'sys'
op|'.'
name|'argv'
op|'['
number|'1'
op|':'
op|']'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'KeyboardInterrupt'
op|':'
newline|'\n'
indent|'        '
name|'sys'
op|'.'
name|'exit'
op|'('
number|'1'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
endmarker|''
end_unit
