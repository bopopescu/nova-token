begin_unit
comment|'# Copyright (c) 2006,2007 Mitch Garnaat http://garnaat.org/'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# Permission is hereby granted, free of charge, to any person obtaining a'
nl|'\n'
comment|'# copy of this software and associated documentation files (the'
nl|'\n'
comment|'# "Software"), to deal in the Software without restriction, including'
nl|'\n'
comment|'# without limitation the rights to use, copy, modify, merge, publish, dis-'
nl|'\n'
comment|'# tribute, sublicense, and/or sell copies of the Software, and to permit'
nl|'\n'
comment|'# persons to whom the Software is furnished to do so, subject to the fol-'
nl|'\n'
comment|'# lowing conditions:'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# The above copyright notice and this permission notice shall be included'
nl|'\n'
comment|'# in all copies or substantial portions of the Software.'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS'
nl|'\n'
comment|'# OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABIL-'
nl|'\n'
comment|'# ITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT'
nl|'\n'
comment|'# SHALL THE AUTHOR BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, '
nl|'\n'
comment|'# WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,'
nl|'\n'
comment|'# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS'
nl|'\n'
comment|'# IN THE SOFTWARE.'
nl|'\n'
nl|'\n'
DECL|class|Question
name|'class'
name|'Question'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
nl|'\n'
indent|'    '
name|'QUESTION_XML_TEMPLATE'
op|'='
string|'"""<Question><QuestionIdentifier>%s</QuestionIdentifier>%s<IsRequired>%s</IsRequired>%s%s</Question>"""'
newline|'\n'
name|'DISPLAY_NAME_XML_TEMPLATE'
op|'='
string|'"""<DisplayName>%s</DisplayName>"""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'identifier'
op|','
name|'content'
op|','
name|'answer_spec'
op|','
name|'is_required'
op|'='
name|'False'
op|','
name|'display_name'
op|'='
name|'None'
op|')'
op|':'
comment|"#amount=0.0, currency_code='USD'):"
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'identifier'
op|'='
name|'identifier'
newline|'\n'
name|'self'
op|'.'
name|'content'
op|'='
name|'content'
newline|'\n'
name|'self'
op|'.'
name|'answer_spec'
op|'='
name|'answer_spec'
newline|'\n'
name|'self'
op|'.'
name|'is_required'
op|'='
name|'is_required'
newline|'\n'
name|'self'
op|'.'
name|'display_name'
op|'='
name|'display_name'
newline|'\n'
nl|'\n'
DECL|member|get_as_params
dedent|''
name|'def'
name|'get_as_params'
op|'('
name|'self'
op|','
name|'label'
op|'='
string|"'Question'"
op|','
name|'identifier'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
nl|'\n'
indent|'        '
name|'if'
name|'identifier'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'ValueError'
op|'('
string|'"identifier (QuestionIdentifier) is required per MTurk spec."'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'return'
op|'{'
name|'label'
op|':'
name|'self'
op|'.'
name|'get_as_xml'
op|'('
op|')'
op|'}'
newline|'\n'
nl|'\n'
DECL|member|get_as_xml
dedent|''
name|'def'
name|'get_as_xml'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# add the display name if required'
nl|'\n'
indent|'        '
name|'display_name_xml'
op|'='
string|"''"
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'display_name'
op|':'
newline|'\n'
indent|'            '
name|'display_name_xml'
op|'='
name|'self'
op|'.'
name|'DISPLAY_NAME_XML_TEMPLATE'
op|'%'
op|'('
name|'self'
op|'.'
name|'display_name'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'ret'
op|'='
name|'Question'
op|'.'
name|'QUESTION_XML_TEMPLATE'
op|'%'
op|'('
name|'self'
op|'.'
name|'identifier'
op|','
nl|'\n'
name|'display_name_xml'
op|','
nl|'\n'
name|'str'
op|'('
name|'self'
op|'.'
name|'is_required'
op|')'
op|'.'
name|'lower'
op|'('
op|')'
op|','
nl|'\n'
name|'self'
op|'.'
name|'content'
op|'.'
name|'get_as_xml'
op|'('
op|')'
op|','
nl|'\n'
name|'self'
op|'.'
name|'answer_spec'
op|'.'
name|'get_as_xml'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'return'
name|'ret'
newline|'\n'
nl|'\n'
DECL|class|ExternalQuestion
dedent|''
dedent|''
name|'class'
name|'ExternalQuestion'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|variable|EXTERNAL_QUESTIONFORM_SCHEMA_LOCATION
indent|'    '
name|'EXTERNAL_QUESTIONFORM_SCHEMA_LOCATION'
op|'='
string|'"http://mechanicalturk.amazonaws.com/AWSMechanicalTurkDataSchemas/2006-07-14/ExternalQuestion.xsd"'
newline|'\n'
name|'EXTERNAL_QUESTION_XML_TEMPLATE'
op|'='
string|'"""<ExternalQuestion xmlns="%s"><ExternalURL>%s</ExternalURL><FrameHeight>%s</FrameHeight></ExternalQuestion>"""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'external_url'
op|','
name|'frame_height'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'external_url'
op|'='
name|'external_url'
newline|'\n'
name|'self'
op|'.'
name|'frame_height'
op|'='
name|'frame_height'
newline|'\n'
nl|'\n'
DECL|member|get_as_params
dedent|''
name|'def'
name|'get_as_params'
op|'('
name|'self'
op|','
name|'label'
op|'='
string|"'ExternalQuestion'"
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
op|'{'
name|'label'
op|':'
name|'self'
op|'.'
name|'get_as_xml'
op|'('
op|')'
op|'}'
newline|'\n'
nl|'\n'
DECL|member|get_as_xml
dedent|''
name|'def'
name|'get_as_xml'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'ret'
op|'='
name|'ExternalQuestion'
op|'.'
name|'EXTERNAL_QUESTION_XML_TEMPLATE'
op|'%'
op|'('
name|'ExternalQuestion'
op|'.'
name|'EXTERNAL_QUESTIONFORM_SCHEMA_LOCATION'
op|','
nl|'\n'
name|'self'
op|'.'
name|'external_url'
op|','
nl|'\n'
name|'self'
op|'.'
name|'frame_height'
op|')'
newline|'\n'
name|'return'
name|'ret'
newline|'\n'
nl|'\n'
DECL|class|OrderedContent
dedent|''
dedent|''
name|'class'
name|'OrderedContent'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'items'
op|'='
op|'['
op|']'
newline|'\n'
nl|'\n'
DECL|member|append
dedent|''
name|'def'
name|'append'
op|'('
name|'self'
op|','
name|'field'
op|','
name|'value'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"Expects field type and value"'
newline|'\n'
name|'self'
op|'.'
name|'items'
op|'.'
name|'append'
op|'('
op|'('
name|'field'
op|','
name|'value'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|get_binary_xml
dedent|''
name|'def'
name|'get_binary_xml'
op|'('
name|'self'
op|','
name|'field'
op|','
name|'value'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
string|'"""\n<Binary>\n  <MimeType>\n    <Type>%s</Type>\n    <SubType>%s</SubType>\n  </MimeType>\n  <DataURL>%s</DataURL>\n  <AltText>%s</AltText>\n</Binary>"""'
op|'%'
op|'('
name|'value'
op|'['
string|"'type'"
op|']'
op|','
nl|'\n'
name|'value'
op|'['
string|"'subtype'"
op|']'
op|','
nl|'\n'
name|'value'
op|'['
string|"'dataurl'"
op|']'
op|','
nl|'\n'
name|'value'
op|'['
string|"'alttext'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|function|get_application_xml
dedent|''
name|'def'
name|'get_application_xml'
op|'('
name|'self'
op|','
name|'field'
op|','
name|'value'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'raise'
name|'NotImplementedError'
op|'('
string|'"Application question content is not yet supported."'
op|')'
newline|'\n'
nl|'\n'
DECL|function|get_as_xml
dedent|''
name|'def'
name|'get_as_xml'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'default_handler'
op|'='
name|'lambda'
name|'f'
op|','
name|'v'
op|':'
string|"'<%s>%s</%s>'"
op|'%'
op|'('
name|'f'
op|','
name|'v'
op|','
name|'f'
op|')'
newline|'\n'
name|'bulleted_list_handler'
op|'='
name|'lambda'
name|'_'
op|','
name|'list'
op|':'
string|"'<List>%s</List>'"
op|'%'
string|"''"
op|'.'
name|'join'
op|'('
op|'['
op|'('
string|"'<ListItem>%s</ListItem>'"
op|'%'
name|'item'
op|')'
name|'for'
name|'item'
name|'in'
name|'list'
op|']'
op|')'
newline|'\n'
name|'formatted_content_handler'
op|'='
name|'lambda'
name|'_'
op|','
name|'content'
op|':'
string|'"<FormattedContent><![CDATA[%s]]></FormattedContent>"'
op|'%'
name|'content'
newline|'\n'
name|'application_handler'
op|'='
name|'self'
op|'.'
name|'get_application_xml'
newline|'\n'
name|'binary_handler'
op|'='
name|'self'
op|'.'
name|'get_binary_xml'
newline|'\n'
nl|'\n'
name|'children'
op|'='
string|"''"
newline|'\n'
name|'for'
op|'('
name|'field'
op|','
name|'value'
op|')'
name|'in'
name|'self'
op|'.'
name|'items'
op|':'
newline|'\n'
indent|'            '
name|'handler'
op|'='
name|'default_handler'
newline|'\n'
name|'if'
name|'field'
op|'=='
string|"'List'"
op|':'
newline|'\n'
indent|'                '
name|'handler'
op|'='
name|'bulleted_list_handler'
newline|'\n'
dedent|''
name|'elif'
name|'field'
op|'=='
string|"'Application'"
op|':'
newline|'\n'
indent|'                '
name|'handler'
op|'='
name|'application_handler'
newline|'\n'
dedent|''
name|'elif'
name|'field'
op|'=='
string|"'Binary'"
op|':'
newline|'\n'
indent|'                '
name|'handler'
op|'='
name|'binary_handler'
newline|'\n'
dedent|''
name|'elif'
name|'field'
op|'=='
string|"'FormattedContent'"
op|':'
newline|'\n'
indent|'                '
name|'handler'
op|'='
name|'formatted_content_handler'
newline|'\n'
dedent|''
name|'children'
op|'='
name|'children'
op|'+'
name|'handler'
op|'('
name|'field'
op|','
name|'value'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'return'
name|'children'
newline|'\n'
nl|'\n'
DECL|class|Overview
dedent|''
dedent|''
name|'class'
name|'Overview'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'OVERVIEW_XML_TEMPLATE'
op|'='
string|'"""<Overview>%s</Overview>"""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'ordered_content'
op|'='
name|'OrderedContent'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|append
dedent|''
name|'def'
name|'append'
op|'('
name|'self'
op|','
name|'field'
op|','
name|'value'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'ordered_content'
op|'.'
name|'append'
op|'('
name|'field'
op|','
name|'value'
op|')'
newline|'\n'
nl|'\n'
DECL|member|get_as_params
dedent|''
name|'def'
name|'get_as_params'
op|'('
name|'self'
op|','
name|'label'
op|'='
string|"'Overview'"
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
op|'{'
name|'label'
op|':'
name|'self'
op|'.'
name|'get_as_xml'
op|'('
op|')'
op|'}'
newline|'\n'
nl|'\n'
DECL|member|get_as_xml
dedent|''
name|'def'
name|'get_as_xml'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'ret'
op|'='
name|'Overview'
op|'.'
name|'OVERVIEW_XML_TEMPLATE'
op|'%'
op|'('
name|'self'
op|'.'
name|'ordered_content'
op|'.'
name|'get_as_xml'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'return'
name|'ret'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|QuestionForm
dedent|''
dedent|''
name|'class'
name|'QuestionForm'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|variable|QUESTIONFORM_SCHEMA_LOCATION
indent|'    '
name|'QUESTIONFORM_SCHEMA_LOCATION'
op|'='
string|'"http://mechanicalturk.amazonaws.com/AWSMechanicalTurkDataSchemas/2005-10-01/QuestionForm.xsd"'
newline|'\n'
name|'QUESTIONFORM_XML_TEMPLATE'
op|'='
string|'"""<QuestionForm xmlns="%s">%s</QuestionForm>"""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'items'
op|'='
op|'['
op|']'
newline|'\n'
nl|'\n'
DECL|member|append
dedent|''
name|'def'
name|'append'
op|'('
name|'self'
op|','
name|'item'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"Expects field type and value"'
newline|'\n'
name|'self'
op|'.'
name|'items'
op|'.'
name|'append'
op|'('
name|'item'
op|')'
newline|'\n'
nl|'\n'
DECL|member|get_as_xml
dedent|''
name|'def'
name|'get_as_xml'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'xml'
op|'='
string|"''"
newline|'\n'
name|'for'
name|'item'
name|'in'
name|'self'
op|'.'
name|'items'
op|':'
newline|'\n'
indent|'            '
name|'xml'
op|'='
name|'xml'
op|'+'
name|'item'
op|'.'
name|'get_as_xml'
op|'('
op|')'
newline|'\n'
dedent|''
name|'return'
name|'QuestionForm'
op|'.'
name|'QUESTIONFORM_XML_TEMPLATE'
op|'%'
op|'('
name|'QuestionForm'
op|'.'
name|'QUESTIONFORM_SCHEMA_LOCATION'
op|','
name|'xml'
op|')'
newline|'\n'
nl|'\n'
DECL|class|QuestionContent
dedent|''
dedent|''
name|'class'
name|'QuestionContent'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'QUESTIONCONTENT_XML_TEMPLATE'
op|'='
string|'"""<QuestionContent>%s</QuestionContent>"""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'ordered_content'
op|'='
name|'OrderedContent'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|append
dedent|''
name|'def'
name|'append'
op|'('
name|'self'
op|','
name|'field'
op|','
name|'value'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'ordered_content'
op|'.'
name|'append'
op|'('
name|'field'
op|','
name|'value'
op|')'
newline|'\n'
nl|'\n'
DECL|member|get_as_xml
dedent|''
name|'def'
name|'get_as_xml'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'ret'
op|'='
name|'QuestionContent'
op|'.'
name|'QUESTIONCONTENT_XML_TEMPLATE'
op|'%'
op|'('
name|'self'
op|'.'
name|'ordered_content'
op|'.'
name|'get_as_xml'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'return'
name|'ret'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|AnswerSpecification
dedent|''
dedent|''
name|'class'
name|'AnswerSpecification'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
nl|'\n'
indent|'    '
name|'ANSWERSPECIFICATION_XML_TEMPLATE'
op|'='
string|'"""<AnswerSpecification>%s</AnswerSpecification>"""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'spec'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'spec'
op|'='
name|'spec'
newline|'\n'
DECL|member|get_as_xml
dedent|''
name|'def'
name|'get_as_xml'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'values'
op|'='
op|'('
op|')'
comment|'# TODO'
newline|'\n'
name|'return'
name|'AnswerSpecification'
op|'.'
name|'ANSWERSPECIFICATION_XML_TEMPLATE'
op|'%'
name|'self'
op|'.'
name|'spec'
op|'.'
name|'get_as_xml'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|class|FreeTextAnswer
dedent|''
dedent|''
name|'class'
name|'FreeTextAnswer'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
nl|'\n'
indent|'    '
name|'FREETEXTANSWER_XML_TEMPLATE'
op|'='
string|'"""<FreeTextAnswer>%s%s</FreeTextAnswer>"""'
comment|'# (constraints, default)'
newline|'\n'
name|'FREETEXTANSWER_CONSTRAINTS_XML_TEMPLATE'
op|'='
string|'"""<Constraints>%s%s%s</Constraints>"""'
comment|'# (is_numeric_xml, length_xml, regex_xml)'
newline|'\n'
name|'FREETEXTANSWER_LENGTH_XML_TEMPLATE'
op|'='
string|'"""<Length %s %s />"""'
comment|'# (min_length_attr, max_length_attr)'
newline|'\n'
name|'FREETEXTANSWER_ISNUMERIC_XML_TEMPLATE'
op|'='
string|'"""<IsNumeric %s %s />"""'
comment|'# (min_value_attr, max_value_attr)'
newline|'\n'
name|'FREETEXTANSWER_DEFAULTTEXT_XML_TEMPLATE'
op|'='
string|'"""<DefaultText>%s</DefaultText>"""'
comment|'# (default)'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'default'
op|'='
name|'None'
op|','
name|'min_length'
op|'='
name|'None'
op|','
name|'max_length'
op|'='
name|'None'
op|','
name|'is_numeric'
op|'='
name|'False'
op|','
name|'min_value'
op|'='
name|'None'
op|','
name|'max_value'
op|'='
name|'None'
op|','
name|'format_regex'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'default'
op|'='
name|'default'
newline|'\n'
name|'self'
op|'.'
name|'min_length'
op|'='
name|'min_length'
newline|'\n'
name|'self'
op|'.'
name|'max_length'
op|'='
name|'max_length'
newline|'\n'
name|'self'
op|'.'
name|'is_numeric'
op|'='
name|'is_numeric'
newline|'\n'
name|'self'
op|'.'
name|'min_value'
op|'='
name|'min_value'
newline|'\n'
name|'self'
op|'.'
name|'max_value'
op|'='
name|'max_value'
newline|'\n'
name|'self'
op|'.'
name|'format_regex'
op|'='
name|'format_regex'
newline|'\n'
nl|'\n'
DECL|member|get_as_xml
dedent|''
name|'def'
name|'get_as_xml'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'is_numeric_xml'
op|'='
string|'""'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'is_numeric'
op|':'
newline|'\n'
indent|'            '
name|'min_value_attr'
op|'='
string|'""'
newline|'\n'
name|'max_value_attr'
op|'='
string|'""'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'min_value'
op|':'
newline|'\n'
indent|'                '
name|'min_value_attr'
op|'='
string|'"""minValue="%d" """'
op|'%'
name|'self'
op|'.'
name|'min_value'
newline|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'max_value'
op|':'
newline|'\n'
indent|'                '
name|'max_value_attr'
op|'='
string|'"""maxValue="%d" """'
op|'%'
name|'self'
op|'.'
name|'max_value'
newline|'\n'
dedent|''
name|'is_numeric_xml'
op|'='
name|'FreeTextAnswer'
op|'.'
name|'FREETEXTANSWER_ISNUMERIC_XML_TEMPLATE'
op|'%'
op|'('
name|'min_value_attr'
op|','
name|'max_value_attr'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'length_xml'
op|'='
string|'""'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'min_length'
name|'or'
name|'self'
op|'.'
name|'max_length'
op|':'
newline|'\n'
indent|'            '
name|'min_length_attr'
op|'='
string|'""'
newline|'\n'
name|'max_length_attr'
op|'='
string|'""'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'min_length'
op|':'
newline|'\n'
indent|'                '
name|'min_length_attr'
op|'='
string|'"""minLength="%d" """'
newline|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'max_length'
op|':'
newline|'\n'
indent|'                '
name|'max_length_attr'
op|'='
string|'"""maxLength="%d" """'
newline|'\n'
dedent|''
name|'length_xml'
op|'='
name|'FreeTextAnswer'
op|'.'
name|'FREETEXTANSWER_LENGTH_XML_TEMPLATE'
op|'%'
op|'('
name|'min_length_attr'
op|','
name|'max_length_attr'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'regex_xml'
op|'='
string|'""'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'format_regex'
op|':'
newline|'\n'
indent|'            '
name|'format_regex_attribs'
op|'='
string|'\'\'\'regex="%s"\'\'\''
op|'%'
name|'self'
op|'.'
name|'format_regex'
op|'['
string|"'regex'"
op|']'
newline|'\n'
nl|'\n'
name|'error_text'
op|'='
name|'self'
op|'.'
name|'format_regex'
op|'.'
name|'get'
op|'('
string|"'error_text'"
op|','
name|'None'
op|')'
newline|'\n'
name|'if'
name|'error_text'
op|':'
newline|'\n'
indent|'                '
name|'format_regex_attribs'
op|'+='
string|'\' errorText="%s"\''
op|'%'
name|'error_text'
newline|'\n'
nl|'\n'
dedent|''
name|'flags'
op|'='
name|'self'
op|'.'
name|'format_regex'
op|'.'
name|'get'
op|'('
string|"'flags'"
op|','
name|'None'
op|')'
newline|'\n'
name|'if'
name|'flags'
op|':'
newline|'\n'
indent|'                '
name|'format_regex_attribs'
op|'+='
string|'\' flags="%s"\''
op|'%'
name|'flags'
newline|'\n'
nl|'\n'
dedent|''
name|'regex_xml'
op|'='
string|'"""<AnswerFormatRegex %s/>"""'
op|'%'
name|'format_regex_attribs'
newline|'\n'
nl|'\n'
dedent|''
name|'constraints_xml'
op|'='
string|'""'
newline|'\n'
name|'if'
name|'is_numeric_xml'
name|'or'
name|'length_xml'
name|'or'
name|'regex_xml'
op|':'
newline|'\n'
indent|'            '
name|'constraints_xml'
op|'='
name|'FreeTextAnswer'
op|'.'
name|'FREETEXTANSWER_CONSTRAINTS_XML_TEMPLATE'
op|'%'
op|'('
name|'is_numeric_xml'
op|','
name|'length_xml'
op|','
name|'regex_xml'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'default_xml'
op|'='
string|'""'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'default'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'default_xml'
op|'='
name|'FreeTextAnswer'
op|'.'
name|'FREETEXTANSWER_DEFAULTTEXT_XML_TEMPLATE'
op|'%'
name|'self'
op|'.'
name|'default'
newline|'\n'
nl|'\n'
dedent|''
name|'return'
name|'FreeTextAnswer'
op|'.'
name|'FREETEXTANSWER_XML_TEMPLATE'
op|'%'
op|'('
name|'constraints_xml'
op|','
name|'default_xml'
op|')'
newline|'\n'
nl|'\n'
DECL|class|FileUploadAnswer
dedent|''
dedent|''
name|'class'
name|'FileUploadAnswer'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'FILEUPLOADANSWER_XML_TEMLPATE'
op|'='
string|'"""<FileUploadAnswer><MinFileSizeInBytes>%d</MinFileSizeInBytes><MaxFileSizeInBytes>%d</MaxFileSizeInBytes></FileUploadAnswer>"""'
comment|'# (min, max)'
newline|'\n'
DECL|variable|DEFAULT_MIN_SIZE
name|'DEFAULT_MIN_SIZE'
op|'='
number|'1024'
comment|'# 1K (completely arbitrary!)'
newline|'\n'
DECL|variable|DEFAULT_MAX_SIZE
name|'DEFAULT_MAX_SIZE'
op|'='
number|'5'
op|'*'
number|'1024'
op|'*'
number|'1024'
comment|'# 5MB (completely arbitrary!)'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'min'
op|'='
name|'None'
op|','
name|'max'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'min'
op|'='
name|'min'
newline|'\n'
name|'self'
op|'.'
name|'max'
op|'='
name|'max'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'min'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'min'
op|'='
name|'FileUploadAnswer'
op|'.'
name|'DEFAULT_MIN_SIZE'
newline|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'max'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'max'
op|'='
name|'FileUploadAnswer'
op|'.'
name|'DEFAULT_MAX_SIZE'
newline|'\n'
nl|'\n'
DECL|member|get_as_xml
dedent|''
dedent|''
name|'def'
name|'get_as_xml'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'FileUploadAnswer'
op|'.'
name|'FILEUPLOADANSWER_XML_TEMLPATE'
op|'%'
op|'('
name|'self'
op|'.'
name|'min'
op|','
name|'self'
op|'.'
name|'max'
op|')'
newline|'\n'
nl|'\n'
DECL|class|SelectionAnswer
dedent|''
dedent|''
name|'class'
name|'SelectionAnswer'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""\n    A class to generate SelectionAnswer XML data structures.\n    Does not yet implement Binary selection options.\n    """'
newline|'\n'
name|'SELECTIONANSWER_XML_TEMPLATE'
op|'='
string|'"""<SelectionAnswer>%s%s<Selections>%s</Selections></SelectionAnswer>"""'
comment|'# % (count_xml, style_xml, selections_xml)'
newline|'\n'
name|'SELECTION_XML_TEMPLATE'
op|'='
string|'"""<Selection><SelectionIdentifier>%s</SelectionIdentifier>%s</Selection>"""'
comment|'# (identifier, value_xml)'
newline|'\n'
name|'SELECTION_VALUE_XML_TEMPLATE'
op|'='
string|'"""<%s>%s</%s>"""'
comment|'# (type, value, type)'
newline|'\n'
name|'STYLE_XML_TEMPLATE'
op|'='
string|'"""<StyleSuggestion>%s</StyleSuggestion>"""'
comment|'# (style)'
newline|'\n'
name|'MIN_SELECTION_COUNT_XML_TEMPLATE'
op|'='
string|'"""<MinSelectionCount>%s</MinSelectionCount>"""'
comment|'# count'
newline|'\n'
name|'MAX_SELECTION_COUNT_XML_TEMPLATE'
op|'='
string|'"""<MaxSelectionCount>%s</MaxSelectionCount>"""'
comment|'# count'
newline|'\n'
DECL|variable|ACCEPTED_STYLES
name|'ACCEPTED_STYLES'
op|'='
op|'['
string|"'radiobutton'"
op|','
string|"'dropdown'"
op|','
string|"'checkbox'"
op|','
string|"'list'"
op|','
string|"'combobox'"
op|','
string|"'multichooser'"
op|']'
newline|'\n'
DECL|variable|OTHER_SELECTION_ELEMENT_NAME
name|'OTHER_SELECTION_ELEMENT_NAME'
op|'='
string|"'OtherSelection'"
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'min'
op|'='
number|'1'
op|','
name|'max'
op|'='
number|'1'
op|','
name|'style'
op|'='
name|'None'
op|','
name|'selections'
op|'='
name|'None'
op|','
name|'type'
op|'='
string|"'text'"
op|','
name|'other'
op|'='
name|'False'
op|')'
op|':'
newline|'\n'
nl|'\n'
indent|'        '
name|'if'
name|'style'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'style'
name|'in'
name|'SelectionAnswer'
op|'.'
name|'ACCEPTED_STYLES'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'style_suggestion'
op|'='
name|'style'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'raise'
name|'ValueError'
op|'('
string|'"style \'%s\' not recognized; should be one of %s"'
op|'%'
op|'('
name|'style'
op|','
string|"', '"
op|'.'
name|'join'
op|'('
name|'SelectionAnswer'
op|'.'
name|'ACCEPTED_STYLES'
op|')'
op|')'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'style_suggestion'
op|'='
name|'None'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'selections'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'ValueError'
op|'('
string|'"SelectionAnswer.__init__(): selections must be a non-empty list of (content, identifier) tuples"'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'selections'
op|'='
name|'selections'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'min_selections'
op|'='
name|'min'
newline|'\n'
name|'self'
op|'.'
name|'max_selections'
op|'='
name|'max'
newline|'\n'
nl|'\n'
name|'assert'
name|'len'
op|'('
name|'selections'
op|')'
op|'>='
name|'self'
op|'.'
name|'min_selections'
op|','
string|'"# of selections is less than minimum of %d"'
op|'%'
name|'self'
op|'.'
name|'min_selections'
newline|'\n'
comment|'#assert len(selections) <= self.max_selections, "# of selections exceeds maximum of %d" % self.max_selections'
nl|'\n'
nl|'\n'
name|'self'
op|'.'
name|'type'
op|'='
name|'type'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'other'
op|'='
name|'other'
newline|'\n'
nl|'\n'
DECL|member|get_as_xml
dedent|''
name|'def'
name|'get_as_xml'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'type'
op|'=='
string|"'text'"
op|':'
newline|'\n'
indent|'            '
name|'TYPE_TAG'
op|'='
string|'"Text"'
newline|'\n'
dedent|''
name|'elif'
name|'self'
op|'.'
name|'type'
op|'=='
string|"'binary'"
op|':'
newline|'\n'
indent|'            '
name|'TYPE_TAG'
op|'='
string|'"Binary"'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'ValueError'
op|'('
string|'"illegal type: %s; must be either \'text\' or \'binary\'"'
op|'%'
name|'str'
op|'('
name|'self'
op|'.'
name|'type'
op|')'
op|')'
newline|'\n'
nl|'\n'
comment|'# build list of <Selection> elements'
nl|'\n'
dedent|''
name|'selections_xml'
op|'='
string|'""'
newline|'\n'
name|'for'
name|'tpl'
name|'in'
name|'self'
op|'.'
name|'selections'
op|':'
newline|'\n'
indent|'            '
name|'value_xml'
op|'='
name|'SelectionAnswer'
op|'.'
name|'SELECTION_VALUE_XML_TEMPLATE'
op|'%'
op|'('
name|'TYPE_TAG'
op|','
name|'tpl'
op|'['
number|'0'
op|']'
op|','
name|'TYPE_TAG'
op|')'
newline|'\n'
name|'selection_xml'
op|'='
name|'SelectionAnswer'
op|'.'
name|'SELECTION_XML_TEMPLATE'
op|'%'
op|'('
name|'tpl'
op|'['
number|'1'
op|']'
op|','
name|'value_xml'
op|')'
newline|'\n'
name|'selections_xml'
op|'+='
name|'selection_xml'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'other'
op|':'
newline|'\n'
comment|'# add OtherSelection element as xml if available'
nl|'\n'
indent|'            '
name|'if'
name|'hasattr'
op|'('
name|'self'
op|'.'
name|'other'
op|','
string|"'get_as_xml'"
op|')'
op|':'
newline|'\n'
indent|'                '
name|'assert'
name|'type'
op|'('
name|'self'
op|'.'
name|'other'
op|')'
op|'=='
name|'FreeTextAnswer'
op|','
string|"'OtherSelection can only be a FreeTextAnswer'"
newline|'\n'
name|'selections_xml'
op|'+='
name|'self'
op|'.'
name|'other'
op|'.'
name|'get_as_xml'
op|'('
op|')'
op|'.'
name|'replace'
op|'('
string|"'FreeTextAnswer'"
op|','
string|"'OtherSelection'"
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'selections_xml'
op|'+='
string|'"<OtherSelection />"'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'if'
name|'self'
op|'.'
name|'style_suggestion'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'style_xml'
op|'='
name|'SelectionAnswer'
op|'.'
name|'STYLE_XML_TEMPLATE'
op|'%'
name|'self'
op|'.'
name|'style_suggestion'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'style_xml'
op|'='
string|'""'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'style_suggestion'
op|'!='
string|"'radiobutton'"
op|':'
newline|'\n'
indent|'            '
name|'count_xml'
op|'='
name|'SelectionAnswer'
op|'.'
name|'MIN_SELECTION_COUNT_XML_TEMPLATE'
op|'%'
name|'self'
op|'.'
name|'min_selections'
newline|'\n'
name|'count_xml'
op|'+='
name|'SelectionAnswer'
op|'.'
name|'MAX_SELECTION_COUNT_XML_TEMPLATE'
op|'%'
name|'self'
op|'.'
name|'max_selections'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'count_xml'
op|'='
string|'""'
newline|'\n'
nl|'\n'
dedent|''
name|'ret'
op|'='
name|'SelectionAnswer'
op|'.'
name|'SELECTIONANSWER_XML_TEMPLATE'
op|'%'
op|'('
name|'count_xml'
op|','
name|'style_xml'
op|','
name|'selections_xml'
op|')'
newline|'\n'
nl|'\n'
comment|'# return XML'
nl|'\n'
name|'return'
name|'ret'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
endmarker|''
end_unit
