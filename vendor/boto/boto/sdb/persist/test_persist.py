begin_unit
name|'from'
name|'boto'
op|'.'
name|'sdb'
op|'.'
name|'persist'
op|'.'
name|'object'
name|'import'
name|'SDBObject'
newline|'\n'
name|'from'
name|'boto'
op|'.'
name|'sdb'
op|'.'
name|'persist'
op|'.'
name|'property'
name|'import'
name|'StringProperty'
op|','
name|'PositiveIntegerProperty'
op|','
name|'IntegerProperty'
newline|'\n'
name|'from'
name|'boto'
op|'.'
name|'sdb'
op|'.'
name|'persist'
op|'.'
name|'property'
name|'import'
name|'BooleanProperty'
op|','
name|'DateTimeProperty'
op|','
name|'S3KeyProperty'
newline|'\n'
name|'from'
name|'boto'
op|'.'
name|'sdb'
op|'.'
name|'persist'
op|'.'
name|'property'
name|'import'
name|'ObjectProperty'
op|','
name|'StringListProperty'
newline|'\n'
name|'from'
name|'boto'
op|'.'
name|'sdb'
op|'.'
name|'persist'
op|'.'
name|'property'
name|'import'
name|'PositiveIntegerListProperty'
op|','
name|'BooleanListProperty'
op|','
name|'ObjectListProperty'
newline|'\n'
name|'from'
name|'boto'
op|'.'
name|'sdb'
op|'.'
name|'persist'
name|'import'
name|'Manager'
newline|'\n'
name|'from'
name|'datetime'
name|'import'
name|'datetime'
newline|'\n'
name|'import'
name|'time'
newline|'\n'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# This will eventually be moved to the boto.tests module and become a real unit test'
nl|'\n'
comment|'# but for now it will live here.  It shows examples of each of the Property types in'
nl|'\n'
comment|'# use and tests the basic operations.'
nl|'\n'
comment|'#'
nl|'\n'
DECL|class|TestScalar
name|'class'
name|'TestScalar'
op|'('
name|'SDBObject'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|variable|name
indent|'    '
name|'name'
op|'='
name|'StringProperty'
op|'('
op|')'
newline|'\n'
DECL|variable|description
name|'description'
op|'='
name|'StringProperty'
op|'('
op|')'
newline|'\n'
DECL|variable|size
name|'size'
op|'='
name|'PositiveIntegerProperty'
op|'('
op|')'
newline|'\n'
DECL|variable|offset
name|'offset'
op|'='
name|'IntegerProperty'
op|'('
op|')'
newline|'\n'
DECL|variable|foo
name|'foo'
op|'='
name|'BooleanProperty'
op|'('
op|')'
newline|'\n'
DECL|variable|date
name|'date'
op|'='
name|'DateTimeProperty'
op|'('
op|')'
newline|'\n'
DECL|variable|file
name|'file'
op|'='
name|'S3KeyProperty'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|class|TestRef
dedent|''
name|'class'
name|'TestRef'
op|'('
name|'SDBObject'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|variable|name
indent|'    '
name|'name'
op|'='
name|'StringProperty'
op|'('
op|')'
newline|'\n'
DECL|variable|ref
name|'ref'
op|'='
name|'ObjectProperty'
op|'('
name|'ref_class'
op|'='
name|'TestScalar'
op|')'
newline|'\n'
nl|'\n'
DECL|class|TestSubClass1
dedent|''
name|'class'
name|'TestSubClass1'
op|'('
name|'TestRef'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|variable|answer
indent|'    '
name|'answer'
op|'='
name|'PositiveIntegerProperty'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|class|TestSubClass2
dedent|''
name|'class'
name|'TestSubClass2'
op|'('
name|'TestScalar'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|variable|flag
indent|'    '
name|'flag'
op|'='
name|'BooleanProperty'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|class|TestList
dedent|''
name|'class'
name|'TestList'
op|'('
name|'SDBObject'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|variable|names
indent|'    '
name|'names'
op|'='
name|'StringListProperty'
op|'('
op|')'
newline|'\n'
DECL|variable|numbers
name|'numbers'
op|'='
name|'PositiveIntegerListProperty'
op|'('
op|')'
newline|'\n'
DECL|variable|bools
name|'bools'
op|'='
name|'BooleanListProperty'
op|'('
op|')'
newline|'\n'
DECL|variable|objects
name|'objects'
op|'='
name|'ObjectListProperty'
op|'('
name|'ref_class'
op|'='
name|'TestScalar'
op|')'
newline|'\n'
nl|'\n'
DECL|function|test1
dedent|''
name|'def'
name|'test1'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
name|'s'
op|'='
name|'TestScalar'
op|'('
op|')'
newline|'\n'
name|'s'
op|'.'
name|'name'
op|'='
string|"'foo'"
newline|'\n'
name|'s'
op|'.'
name|'description'
op|'='
string|"'This is foo'"
newline|'\n'
name|'s'
op|'.'
name|'size'
op|'='
number|'42'
newline|'\n'
name|'s'
op|'.'
name|'offset'
op|'='
op|'-'
number|'100'
newline|'\n'
name|'s'
op|'.'
name|'foo'
op|'='
name|'True'
newline|'\n'
name|'s'
op|'.'
name|'date'
op|'='
name|'datetime'
op|'.'
name|'now'
op|'('
op|')'
newline|'\n'
name|'s'
op|'.'
name|'save'
op|'('
op|')'
newline|'\n'
name|'return'
name|'s'
newline|'\n'
nl|'\n'
DECL|function|test2
dedent|''
name|'def'
name|'test2'
op|'('
name|'ref_name'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'s'
op|'='
name|'TestRef'
op|'('
op|')'
newline|'\n'
name|'s'
op|'.'
name|'name'
op|'='
string|"'testref'"
newline|'\n'
name|'rs'
op|'='
name|'TestScalar'
op|'.'
name|'find'
op|'('
name|'name'
op|'='
name|'ref_name'
op|')'
newline|'\n'
name|'s'
op|'.'
name|'ref'
op|'='
name|'rs'
op|'.'
name|'next'
op|'('
op|')'
newline|'\n'
name|'s'
op|'.'
name|'save'
op|'('
op|')'
newline|'\n'
name|'return'
name|'s'
newline|'\n'
nl|'\n'
DECL|function|test3
dedent|''
name|'def'
name|'test3'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
name|'s'
op|'='
name|'TestScalar'
op|'('
op|')'
newline|'\n'
name|'s'
op|'.'
name|'name'
op|'='
string|"'bar'"
newline|'\n'
name|'s'
op|'.'
name|'description'
op|'='
string|"'This is bar'"
newline|'\n'
name|'s'
op|'.'
name|'size'
op|'='
number|'24'
newline|'\n'
name|'s'
op|'.'
name|'foo'
op|'='
name|'False'
newline|'\n'
name|'s'
op|'.'
name|'date'
op|'='
name|'datetime'
op|'.'
name|'now'
op|'('
op|')'
newline|'\n'
name|'s'
op|'.'
name|'save'
op|'('
op|')'
newline|'\n'
name|'return'
name|'s'
newline|'\n'
nl|'\n'
DECL|function|test4
dedent|''
name|'def'
name|'test4'
op|'('
name|'ref1'
op|','
name|'ref2'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'s'
op|'='
name|'TestList'
op|'('
op|')'
newline|'\n'
name|'s'
op|'.'
name|'names'
op|'.'
name|'append'
op|'('
name|'ref1'
op|'.'
name|'name'
op|')'
newline|'\n'
name|'s'
op|'.'
name|'names'
op|'.'
name|'append'
op|'('
name|'ref2'
op|'.'
name|'name'
op|')'
newline|'\n'
name|'s'
op|'.'
name|'numbers'
op|'.'
name|'append'
op|'('
name|'ref1'
op|'.'
name|'size'
op|')'
newline|'\n'
name|'s'
op|'.'
name|'numbers'
op|'.'
name|'append'
op|'('
name|'ref2'
op|'.'
name|'size'
op|')'
newline|'\n'
name|'s'
op|'.'
name|'bools'
op|'.'
name|'append'
op|'('
name|'ref1'
op|'.'
name|'foo'
op|')'
newline|'\n'
name|'s'
op|'.'
name|'bools'
op|'.'
name|'append'
op|'('
name|'ref2'
op|'.'
name|'foo'
op|')'
newline|'\n'
name|'s'
op|'.'
name|'objects'
op|'.'
name|'append'
op|'('
name|'ref1'
op|')'
newline|'\n'
name|'s'
op|'.'
name|'objects'
op|'.'
name|'append'
op|'('
name|'ref2'
op|')'
newline|'\n'
name|'s'
op|'.'
name|'save'
op|'('
op|')'
newline|'\n'
name|'return'
name|'s'
newline|'\n'
nl|'\n'
DECL|function|test5
dedent|''
name|'def'
name|'test5'
op|'('
name|'ref'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'s'
op|'='
name|'TestSubClass1'
op|'('
op|')'
newline|'\n'
name|'s'
op|'.'
name|'answer'
op|'='
number|'42'
newline|'\n'
name|'s'
op|'.'
name|'ref'
op|'='
name|'ref'
newline|'\n'
name|'s'
op|'.'
name|'save'
op|'('
op|')'
newline|'\n'
comment|'# test out free form attribute'
nl|'\n'
name|'s'
op|'.'
name|'fiddlefaddle'
op|'='
string|"'this is fiddlefaddle'"
newline|'\n'
name|'s'
op|'.'
name|'_fiddlefaddle'
op|'='
string|"'this is not fiddlefaddle'"
newline|'\n'
name|'return'
name|'s'
newline|'\n'
nl|'\n'
DECL|function|test6
dedent|''
name|'def'
name|'test6'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
name|'s'
op|'='
name|'TestSubClass2'
op|'('
op|')'
newline|'\n'
name|'s'
op|'.'
name|'name'
op|'='
string|"'fie'"
newline|'\n'
name|'s'
op|'.'
name|'description'
op|'='
string|"'This is fie'"
newline|'\n'
name|'s'
op|'.'
name|'size'
op|'='
number|'4200'
newline|'\n'
name|'s'
op|'.'
name|'offset'
op|'='
op|'-'
number|'820'
newline|'\n'
name|'s'
op|'.'
name|'foo'
op|'='
name|'False'
newline|'\n'
name|'s'
op|'.'
name|'date'
op|'='
name|'datetime'
op|'.'
name|'now'
op|'('
op|')'
newline|'\n'
name|'s'
op|'.'
name|'flag'
op|'='
name|'True'
newline|'\n'
name|'s'
op|'.'
name|'save'
op|'('
op|')'
newline|'\n'
name|'return'
name|'s'
newline|'\n'
nl|'\n'
DECL|function|test
dedent|''
name|'def'
name|'test'
op|'('
name|'domain_name'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'print'
string|"'Initialize the Persistance system'"
newline|'\n'
name|'Manager'
op|'.'
name|'DefaultDomainName'
op|'='
name|'domain_name'
newline|'\n'
name|'print'
string|"'Call test1'"
newline|'\n'
name|'s1'
op|'='
name|'test1'
op|'('
op|')'
newline|'\n'
comment|'# now create a new instance and read the saved data from SDB'
nl|'\n'
name|'print'
string|"'Now sleep to wait for things to converge'"
newline|'\n'
name|'time'
op|'.'
name|'sleep'
op|'('
number|'5'
op|')'
newline|'\n'
name|'print'
string|"'Now lookup the object and compare the fields'"
newline|'\n'
name|'s2'
op|'='
name|'TestScalar'
op|'('
name|'s1'
op|'.'
name|'id'
op|')'
newline|'\n'
name|'assert'
name|'s1'
op|'.'
name|'name'
op|'=='
name|'s2'
op|'.'
name|'name'
newline|'\n'
name|'assert'
name|'s1'
op|'.'
name|'description'
op|'=='
name|'s2'
op|'.'
name|'description'
newline|'\n'
name|'assert'
name|'s1'
op|'.'
name|'size'
op|'=='
name|'s2'
op|'.'
name|'size'
newline|'\n'
name|'assert'
name|'s1'
op|'.'
name|'offset'
op|'=='
name|'s2'
op|'.'
name|'offset'
newline|'\n'
name|'assert'
name|'s1'
op|'.'
name|'foo'
op|'=='
name|'s2'
op|'.'
name|'foo'
newline|'\n'
comment|'#assert s1.date == s2.date'
nl|'\n'
name|'print'
string|"'Call test2'"
newline|'\n'
name|'s2'
op|'='
name|'test2'
op|'('
name|'s1'
op|'.'
name|'name'
op|')'
newline|'\n'
name|'print'
string|"'Call test3'"
newline|'\n'
name|'s3'
op|'='
name|'test3'
op|'('
op|')'
newline|'\n'
name|'print'
string|"'Call test4'"
newline|'\n'
name|'s4'
op|'='
name|'test4'
op|'('
name|'s1'
op|','
name|'s3'
op|')'
newline|'\n'
name|'print'
string|"'Call test5'"
newline|'\n'
name|'s6'
op|'='
name|'test6'
op|'('
op|')'
newline|'\n'
name|'s5'
op|'='
name|'test5'
op|'('
name|'s6'
op|')'
newline|'\n'
name|'domain'
op|'='
name|'s5'
op|'.'
name|'_manager'
op|'.'
name|'domain'
newline|'\n'
name|'item1'
op|'='
name|'domain'
op|'.'
name|'get_item'
op|'('
name|'s1'
op|'.'
name|'id'
op|')'
newline|'\n'
name|'item2'
op|'='
name|'domain'
op|'.'
name|'get_item'
op|'('
name|'s2'
op|'.'
name|'id'
op|')'
newline|'\n'
name|'item3'
op|'='
name|'domain'
op|'.'
name|'get_item'
op|'('
name|'s3'
op|'.'
name|'id'
op|')'
newline|'\n'
name|'item4'
op|'='
name|'domain'
op|'.'
name|'get_item'
op|'('
name|'s4'
op|'.'
name|'id'
op|')'
newline|'\n'
name|'item5'
op|'='
name|'domain'
op|'.'
name|'get_item'
op|'('
name|'s5'
op|'.'
name|'id'
op|')'
newline|'\n'
name|'item6'
op|'='
name|'domain'
op|'.'
name|'get_item'
op|'('
name|'s6'
op|'.'
name|'id'
op|')'
newline|'\n'
name|'return'
op|'['
op|'('
name|'s1'
op|','
name|'item1'
op|')'
op|','
op|'('
name|'s2'
op|','
name|'item2'
op|')'
op|','
op|'('
name|'s3'
op|','
name|'item3'
op|')'
op|','
op|'('
name|'s4'
op|','
name|'item4'
op|')'
op|','
op|'('
name|'s5'
op|','
name|'item5'
op|')'
op|','
op|'('
name|'s6'
op|','
name|'item6'
op|')'
op|']'
newline|'\n'
dedent|''
endmarker|''
end_unit
