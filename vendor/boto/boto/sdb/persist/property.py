begin_unit
comment|'# Copyright (c) 2006,2007,2008 Mitch Garnaat http://garnaat.org/'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# Permission is hereby granted, free of charge, to any person obtaining a'
nl|'\n'
comment|'# copy of this software and associated documentation files (the'
nl|'\n'
comment|'# "Software"), to deal in the Software without restriction, including'
nl|'\n'
comment|'# without limitation the rights to use, copy, modify, merge, publish, dis-'
nl|'\n'
comment|'# tribute, sublicense, and/or sell copies of the Software, and to permit'
nl|'\n'
comment|'# persons to whom the Software is furnished to do so, subject to the fol-'
nl|'\n'
comment|'# lowing conditions:'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# The above copyright notice and this permission notice shall be included'
nl|'\n'
comment|'# in all copies or substantial portions of the Software.'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS'
nl|'\n'
comment|'# OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABIL-'
nl|'\n'
comment|'# ITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT'
nl|'\n'
comment|'# SHALL THE AUTHOR BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, '
nl|'\n'
comment|'# WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,'
nl|'\n'
comment|'# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS'
nl|'\n'
comment|'# IN THE SOFTWARE.'
nl|'\n'
nl|'\n'
name|'from'
name|'boto'
op|'.'
name|'exception'
name|'import'
name|'SDBPersistenceError'
newline|'\n'
name|'from'
name|'boto'
op|'.'
name|'sdb'
op|'.'
name|'persist'
op|'.'
name|'checker'
name|'import'
name|'StringChecker'
op|','
name|'PasswordChecker'
op|','
name|'IntegerChecker'
op|','
name|'BooleanChecker'
newline|'\n'
name|'from'
name|'boto'
op|'.'
name|'sdb'
op|'.'
name|'persist'
op|'.'
name|'checker'
name|'import'
name|'DateTimeChecker'
op|','
name|'ObjectChecker'
op|','
name|'S3KeyChecker'
op|','
name|'S3BucketChecker'
newline|'\n'
name|'from'
name|'boto'
op|'.'
name|'utils'
name|'import'
name|'Password'
newline|'\n'
nl|'\n'
DECL|class|Property
name|'class'
name|'Property'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'checker_class'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'name'
op|'='
string|"''"
newline|'\n'
name|'self'
op|'.'
name|'checker'
op|'='
name|'checker_class'
op|'('
op|'**'
name|'params'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'slot_name'
op|'='
string|"'__'"
newline|'\n'
nl|'\n'
DECL|member|set_name
dedent|''
name|'def'
name|'set_name'
op|'('
name|'self'
op|','
name|'name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'name'
op|'='
name|'name'
newline|'\n'
name|'self'
op|'.'
name|'slot_name'
op|'='
string|"'__'"
op|'+'
name|'self'
op|'.'
name|'name'
newline|'\n'
nl|'\n'
DECL|class|ScalarProperty
dedent|''
dedent|''
name|'class'
name|'ScalarProperty'
op|'('
name|'Property'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|save
indent|'    '
name|'def'
name|'save'
op|'('
name|'self'
op|','
name|'obj'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'domain'
op|'='
name|'obj'
op|'.'
name|'_manager'
op|'.'
name|'domain'
newline|'\n'
name|'domain'
op|'.'
name|'put_attributes'
op|'('
name|'obj'
op|'.'
name|'id'
op|','
op|'{'
name|'self'
op|'.'
name|'name'
op|':'
name|'self'
op|'.'
name|'to_string'
op|'('
name|'obj'
op|')'
op|'}'
op|','
name|'replace'
op|'='
name|'True'
op|')'
newline|'\n'
nl|'\n'
DECL|member|to_string
dedent|''
name|'def'
name|'to_string'
op|'('
name|'self'
op|','
name|'obj'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'checker'
op|'.'
name|'to_string'
op|'('
name|'getattr'
op|'('
name|'obj'
op|','
name|'self'
op|'.'
name|'name'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|load
dedent|''
name|'def'
name|'load'
op|'('
name|'self'
op|','
name|'obj'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'domain'
op|'='
name|'obj'
op|'.'
name|'_manager'
op|'.'
name|'domain'
newline|'\n'
name|'a'
op|'='
name|'domain'
op|'.'
name|'get_attributes'
op|'('
name|'obj'
op|'.'
name|'id'
op|','
name|'self'
op|'.'
name|'name'
op|')'
newline|'\n'
comment|'# try to get the attribute value from SDB'
nl|'\n'
name|'if'
name|'self'
op|'.'
name|'name'
name|'in'
name|'a'
op|':'
newline|'\n'
indent|'            '
name|'value'
op|'='
name|'self'
op|'.'
name|'checker'
op|'.'
name|'from_string'
op|'('
name|'a'
op|'['
name|'self'
op|'.'
name|'name'
op|']'
op|','
name|'obj'
op|')'
newline|'\n'
name|'setattr'
op|'('
name|'obj'
op|','
name|'self'
op|'.'
name|'slot_name'
op|','
name|'value'
op|')'
newline|'\n'
comment|"# if it's not there, set the value to the default value"
nl|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'__set__'
op|'('
name|'obj'
op|','
name|'self'
op|'.'
name|'checker'
op|'.'
name|'default'
op|')'
newline|'\n'
nl|'\n'
DECL|member|__get__
dedent|''
dedent|''
name|'def'
name|'__get__'
op|'('
name|'self'
op|','
name|'obj'
op|','
name|'objtype'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'obj'
op|':'
newline|'\n'
indent|'            '
name|'try'
op|':'
newline|'\n'
indent|'                '
name|'value'
op|'='
name|'getattr'
op|'('
name|'obj'
op|','
name|'self'
op|'.'
name|'slot_name'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'AttributeError'
op|':'
newline|'\n'
indent|'                '
name|'if'
name|'obj'
op|'.'
name|'_auto_update'
op|':'
newline|'\n'
indent|'                    '
name|'self'
op|'.'
name|'load'
op|'('
name|'obj'
op|')'
newline|'\n'
name|'value'
op|'='
name|'getattr'
op|'('
name|'obj'
op|','
name|'self'
op|'.'
name|'slot_name'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                    '
name|'value'
op|'='
name|'self'
op|'.'
name|'checker'
op|'.'
name|'default'
newline|'\n'
name|'setattr'
op|'('
name|'obj'
op|','
name|'self'
op|'.'
name|'slot_name'
op|','
name|'self'
op|'.'
name|'checker'
op|'.'
name|'default'
op|')'
newline|'\n'
dedent|''
dedent|''
dedent|''
name|'return'
name|'value'
newline|'\n'
nl|'\n'
DECL|member|__set__
dedent|''
name|'def'
name|'__set__'
op|'('
name|'self'
op|','
name|'obj'
op|','
name|'value'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'checker'
op|'.'
name|'check'
op|'('
name|'value'
op|')'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'old_value'
op|'='
name|'getattr'
op|'('
name|'obj'
op|','
name|'self'
op|'.'
name|'slot_name'
op|')'
newline|'\n'
dedent|''
name|'except'
op|':'
newline|'\n'
indent|'            '
name|'old_value'
op|'='
name|'self'
op|'.'
name|'checker'
op|'.'
name|'default'
newline|'\n'
dedent|''
name|'setattr'
op|'('
name|'obj'
op|','
name|'self'
op|'.'
name|'slot_name'
op|','
name|'value'
op|')'
newline|'\n'
name|'if'
name|'obj'
op|'.'
name|'_auto_update'
op|':'
newline|'\n'
indent|'            '
name|'try'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'save'
op|'('
name|'obj'
op|')'
newline|'\n'
dedent|''
name|'except'
op|':'
newline|'\n'
indent|'                '
name|'setattr'
op|'('
name|'obj'
op|','
name|'self'
op|'.'
name|'slot_name'
op|','
name|'old_value'
op|')'
newline|'\n'
name|'raise'
newline|'\n'
nl|'\n'
DECL|class|StringProperty
dedent|''
dedent|''
dedent|''
dedent|''
name|'class'
name|'StringProperty'
op|'('
name|'ScalarProperty'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'ScalarProperty'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'StringChecker'
op|','
op|'**'
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|class|PasswordProperty
dedent|''
dedent|''
name|'class'
name|'PasswordProperty'
op|'('
name|'ScalarProperty'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""\n    Hashed password\n    """'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'ScalarProperty'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'PasswordChecker'
op|','
op|'**'
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|member|__set__
dedent|''
name|'def'
name|'__set__'
op|'('
name|'self'
op|','
name|'obj'
op|','
name|'value'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'p'
op|'='
name|'Password'
op|'('
op|')'
newline|'\n'
name|'p'
op|'.'
name|'set'
op|'('
name|'value'
op|')'
newline|'\n'
name|'ScalarProperty'
op|'.'
name|'__set__'
op|'('
name|'self'
op|','
name|'obj'
op|','
name|'p'
op|')'
newline|'\n'
nl|'\n'
DECL|member|__get__
dedent|''
name|'def'
name|'__get__'
op|'('
name|'self'
op|','
name|'obj'
op|','
name|'objtype'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'Password'
op|'('
name|'ScalarProperty'
op|'.'
name|'__get__'
op|'('
name|'self'
op|','
name|'obj'
op|','
name|'objtype'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|class|SmallPositiveIntegerProperty
dedent|''
dedent|''
name|'class'
name|'SmallPositiveIntegerProperty'
op|'('
name|'ScalarProperty'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'params'
op|'['
string|"'size'"
op|']'
op|'='
string|"'small'"
newline|'\n'
name|'params'
op|'['
string|"'signed'"
op|']'
op|'='
name|'False'
newline|'\n'
name|'ScalarProperty'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'IntegerChecker'
op|','
op|'**'
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|class|SmallIntegerProperty
dedent|''
dedent|''
name|'class'
name|'SmallIntegerProperty'
op|'('
name|'ScalarProperty'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'params'
op|'['
string|"'size'"
op|']'
op|'='
string|"'small'"
newline|'\n'
name|'params'
op|'['
string|"'signed'"
op|']'
op|'='
name|'True'
newline|'\n'
name|'ScalarProperty'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'IntegerChecker'
op|','
op|'**'
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|class|PositiveIntegerProperty
dedent|''
dedent|''
name|'class'
name|'PositiveIntegerProperty'
op|'('
name|'ScalarProperty'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'params'
op|'['
string|"'size'"
op|']'
op|'='
string|"'medium'"
newline|'\n'
name|'params'
op|'['
string|"'signed'"
op|']'
op|'='
name|'False'
newline|'\n'
name|'ScalarProperty'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'IntegerChecker'
op|','
op|'**'
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|class|IntegerProperty
dedent|''
dedent|''
name|'class'
name|'IntegerProperty'
op|'('
name|'ScalarProperty'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'params'
op|'['
string|"'size'"
op|']'
op|'='
string|"'medium'"
newline|'\n'
name|'params'
op|'['
string|"'signed'"
op|']'
op|'='
name|'True'
newline|'\n'
name|'ScalarProperty'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'IntegerChecker'
op|','
op|'**'
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|class|LargePositiveIntegerProperty
dedent|''
dedent|''
name|'class'
name|'LargePositiveIntegerProperty'
op|'('
name|'ScalarProperty'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'params'
op|'['
string|"'size'"
op|']'
op|'='
string|"'large'"
newline|'\n'
name|'params'
op|'['
string|"'signed'"
op|']'
op|'='
name|'False'
newline|'\n'
name|'ScalarProperty'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'IntegerChecker'
op|','
op|'**'
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|class|LargeIntegerProperty
dedent|''
dedent|''
name|'class'
name|'LargeIntegerProperty'
op|'('
name|'ScalarProperty'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'params'
op|'['
string|"'size'"
op|']'
op|'='
string|"'large'"
newline|'\n'
name|'params'
op|'['
string|"'signed'"
op|']'
op|'='
name|'True'
newline|'\n'
name|'ScalarProperty'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'IntegerChecker'
op|','
op|'**'
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|class|BooleanProperty
dedent|''
dedent|''
name|'class'
name|'BooleanProperty'
op|'('
name|'ScalarProperty'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'ScalarProperty'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'BooleanChecker'
op|','
op|'**'
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|class|DateTimeProperty
dedent|''
dedent|''
name|'class'
name|'DateTimeProperty'
op|'('
name|'ScalarProperty'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'ScalarProperty'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'DateTimeChecker'
op|','
op|'**'
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|class|ObjectProperty
dedent|''
dedent|''
name|'class'
name|'ObjectProperty'
op|'('
name|'ScalarProperty'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'ScalarProperty'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'ObjectChecker'
op|','
op|'**'
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|class|S3KeyProperty
dedent|''
dedent|''
name|'class'
name|'S3KeyProperty'
op|'('
name|'ScalarProperty'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'ScalarProperty'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'S3KeyChecker'
op|','
op|'**'
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|member|__set__
dedent|''
name|'def'
name|'__set__'
op|'('
name|'self'
op|','
name|'obj'
op|','
name|'value'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'checker'
op|'.'
name|'check'
op|'('
name|'value'
op|')'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'old_value'
op|'='
name|'getattr'
op|'('
name|'obj'
op|','
name|'self'
op|'.'
name|'slot_name'
op|')'
newline|'\n'
dedent|''
name|'except'
op|':'
newline|'\n'
indent|'            '
name|'old_value'
op|'='
name|'self'
op|'.'
name|'checker'
op|'.'
name|'default'
newline|'\n'
dedent|''
name|'if'
name|'isinstance'
op|'('
name|'value'
op|','
name|'str'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'value'
op|'='
name|'self'
op|'.'
name|'checker'
op|'.'
name|'from_string'
op|'('
name|'value'
op|','
name|'obj'
op|')'
newline|'\n'
dedent|''
name|'setattr'
op|'('
name|'obj'
op|','
name|'self'
op|'.'
name|'slot_name'
op|','
name|'value'
op|')'
newline|'\n'
name|'if'
name|'obj'
op|'.'
name|'_auto_update'
op|':'
newline|'\n'
indent|'            '
name|'try'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'save'
op|'('
name|'obj'
op|')'
newline|'\n'
dedent|''
name|'except'
op|':'
newline|'\n'
indent|'                '
name|'setattr'
op|'('
name|'obj'
op|','
name|'self'
op|'.'
name|'slot_name'
op|','
name|'old_value'
op|')'
newline|'\n'
name|'raise'
newline|'\n'
nl|'\n'
DECL|class|S3BucketProperty
dedent|''
dedent|''
dedent|''
dedent|''
name|'class'
name|'S3BucketProperty'
op|'('
name|'ScalarProperty'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'ScalarProperty'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'S3BucketChecker'
op|','
op|'**'
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|member|__set__
dedent|''
name|'def'
name|'__set__'
op|'('
name|'self'
op|','
name|'obj'
op|','
name|'value'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'checker'
op|'.'
name|'check'
op|'('
name|'value'
op|')'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'old_value'
op|'='
name|'getattr'
op|'('
name|'obj'
op|','
name|'self'
op|'.'
name|'slot_name'
op|')'
newline|'\n'
dedent|''
name|'except'
op|':'
newline|'\n'
indent|'            '
name|'old_value'
op|'='
name|'self'
op|'.'
name|'checker'
op|'.'
name|'default'
newline|'\n'
dedent|''
name|'if'
name|'isinstance'
op|'('
name|'value'
op|','
name|'str'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'value'
op|'='
name|'self'
op|'.'
name|'checker'
op|'.'
name|'from_string'
op|'('
name|'value'
op|','
name|'obj'
op|')'
newline|'\n'
dedent|''
name|'setattr'
op|'('
name|'obj'
op|','
name|'self'
op|'.'
name|'slot_name'
op|','
name|'value'
op|')'
newline|'\n'
name|'if'
name|'obj'
op|'.'
name|'_auto_update'
op|':'
newline|'\n'
indent|'            '
name|'try'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'save'
op|'('
name|'obj'
op|')'
newline|'\n'
dedent|''
name|'except'
op|':'
newline|'\n'
indent|'                '
name|'setattr'
op|'('
name|'obj'
op|','
name|'self'
op|'.'
name|'slot_name'
op|','
name|'old_value'
op|')'
newline|'\n'
name|'raise'
newline|'\n'
nl|'\n'
DECL|class|MultiValueProperty
dedent|''
dedent|''
dedent|''
dedent|''
name|'class'
name|'MultiValueProperty'
op|'('
name|'Property'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'checker_class'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'Property'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'checker_class'
op|','
op|'**'
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|member|__get__
dedent|''
name|'def'
name|'__get__'
op|'('
name|'self'
op|','
name|'obj'
op|','
name|'objtype'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'obj'
op|':'
newline|'\n'
indent|'            '
name|'try'
op|':'
newline|'\n'
indent|'                '
name|'value'
op|'='
name|'getattr'
op|'('
name|'obj'
op|','
name|'self'
op|'.'
name|'slot_name'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'AttributeError'
op|':'
newline|'\n'
indent|'                '
name|'if'
name|'obj'
op|'.'
name|'_auto_update'
op|':'
newline|'\n'
indent|'                    '
name|'self'
op|'.'
name|'load'
op|'('
name|'obj'
op|')'
newline|'\n'
name|'value'
op|'='
name|'getattr'
op|'('
name|'obj'
op|','
name|'self'
op|'.'
name|'slot_name'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                    '
name|'value'
op|'='
name|'MultiValue'
op|'('
name|'self'
op|','
name|'obj'
op|','
op|'['
op|']'
op|')'
newline|'\n'
name|'setattr'
op|'('
name|'obj'
op|','
name|'self'
op|'.'
name|'slot_name'
op|','
name|'value'
op|')'
newline|'\n'
dedent|''
dedent|''
dedent|''
name|'return'
name|'value'
newline|'\n'
nl|'\n'
DECL|member|load
dedent|''
name|'def'
name|'load'
op|'('
name|'self'
op|','
name|'obj'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'obj'
op|'!='
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'_list'
op|'='
op|'['
op|']'
newline|'\n'
name|'domain'
op|'='
name|'obj'
op|'.'
name|'_manager'
op|'.'
name|'domain'
newline|'\n'
name|'a'
op|'='
name|'domain'
op|'.'
name|'get_attributes'
op|'('
name|'obj'
op|'.'
name|'id'
op|','
name|'self'
op|'.'
name|'name'
op|')'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'name'
name|'in'
name|'a'
op|':'
newline|'\n'
indent|'                '
name|'lst'
op|'='
name|'a'
op|'['
name|'self'
op|'.'
name|'name'
op|']'
newline|'\n'
name|'if'
name|'not'
name|'isinstance'
op|'('
name|'lst'
op|','
name|'list'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'lst'
op|'='
op|'['
name|'lst'
op|']'
newline|'\n'
dedent|''
name|'for'
name|'value'
name|'in'
name|'lst'
op|':'
newline|'\n'
indent|'                    '
name|'value'
op|'='
name|'self'
op|'.'
name|'checker'
op|'.'
name|'from_string'
op|'('
name|'value'
op|','
name|'obj'
op|')'
newline|'\n'
name|'_list'
op|'.'
name|'append'
op|'('
name|'value'
op|')'
newline|'\n'
dedent|''
dedent|''
dedent|''
name|'setattr'
op|'('
name|'obj'
op|','
name|'self'
op|'.'
name|'slot_name'
op|','
name|'MultiValue'
op|'('
name|'self'
op|','
name|'obj'
op|','
name|'_list'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|__set__
dedent|''
name|'def'
name|'__set__'
op|'('
name|'self'
op|','
name|'obj'
op|','
name|'value'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'not'
name|'isinstance'
op|'('
name|'value'
op|','
name|'list'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'SDBPersistenceError'
op|'('
string|"'Value must be a list'"
op|')'
newline|'\n'
dedent|''
name|'setattr'
op|'('
name|'obj'
op|','
name|'self'
op|'.'
name|'slot_name'
op|','
name|'MultiValue'
op|'('
name|'self'
op|','
name|'obj'
op|','
name|'value'
op|')'
op|')'
newline|'\n'
name|'str_list'
op|'='
name|'self'
op|'.'
name|'to_string'
op|'('
name|'obj'
op|')'
newline|'\n'
name|'domain'
op|'='
name|'obj'
op|'.'
name|'_manager'
op|'.'
name|'domain'
newline|'\n'
name|'if'
name|'obj'
op|'.'
name|'_auto_update'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'len'
op|'('
name|'str_list'
op|')'
op|'=='
number|'1'
op|':'
newline|'\n'
indent|'                '
name|'domain'
op|'.'
name|'put_attributes'
op|'('
name|'obj'
op|'.'
name|'id'
op|','
op|'{'
name|'self'
op|'.'
name|'name'
op|':'
name|'str_list'
op|'['
number|'0'
op|']'
op|'}'
op|','
name|'replace'
op|'='
name|'True'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'try'
op|':'
newline|'\n'
indent|'                    '
name|'self'
op|'.'
name|'__delete__'
op|'('
name|'obj'
op|')'
newline|'\n'
dedent|''
name|'except'
op|':'
newline|'\n'
indent|'                    '
name|'pass'
newline|'\n'
dedent|''
name|'domain'
op|'.'
name|'put_attributes'
op|'('
name|'obj'
op|'.'
name|'id'
op|','
op|'{'
name|'self'
op|'.'
name|'name'
op|':'
name|'str_list'
op|'}'
op|','
name|'replace'
op|'='
name|'True'
op|')'
newline|'\n'
name|'setattr'
op|'('
name|'obj'
op|','
name|'self'
op|'.'
name|'slot_name'
op|','
name|'MultiValue'
op|'('
name|'self'
op|','
name|'obj'
op|','
name|'value'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|__delete__
dedent|''
dedent|''
dedent|''
name|'def'
name|'__delete__'
op|'('
name|'self'
op|','
name|'obj'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'obj'
op|'.'
name|'_auto_update'
op|':'
newline|'\n'
indent|'            '
name|'domain'
op|'='
name|'obj'
op|'.'
name|'_manager'
op|'.'
name|'domain'
newline|'\n'
name|'domain'
op|'.'
name|'delete_attributes'
op|'('
name|'obj'
op|'.'
name|'id'
op|','
op|'['
name|'self'
op|'.'
name|'name'
op|']'
op|')'
newline|'\n'
dedent|''
name|'setattr'
op|'('
name|'obj'
op|','
name|'self'
op|'.'
name|'slot_name'
op|','
name|'MultiValue'
op|'('
name|'self'
op|','
name|'obj'
op|','
op|'['
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|to_string
dedent|''
name|'def'
name|'to_string'
op|'('
name|'self'
op|','
name|'obj'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'str_list'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'value'
name|'in'
name|'self'
op|'.'
name|'__get__'
op|'('
name|'obj'
op|','
name|'type'
op|'('
name|'obj'
op|')'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'str_list'
op|'.'
name|'append'
op|'('
name|'self'
op|'.'
name|'checker'
op|'.'
name|'to_string'
op|'('
name|'value'
op|')'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'str_list'
newline|'\n'
nl|'\n'
DECL|class|StringListProperty
dedent|''
dedent|''
name|'class'
name|'StringListProperty'
op|'('
name|'MultiValueProperty'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'MultiValueProperty'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'StringChecker'
op|','
op|'**'
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|class|SmallIntegerListProperty
dedent|''
dedent|''
name|'class'
name|'SmallIntegerListProperty'
op|'('
name|'MultiValueProperty'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'params'
op|'['
string|"'size'"
op|']'
op|'='
string|"'small'"
newline|'\n'
name|'params'
op|'['
string|"'signed'"
op|']'
op|'='
name|'True'
newline|'\n'
name|'MultiValueProperty'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'IntegerChecker'
op|','
op|'**'
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|class|SmallPositiveIntegerListProperty
dedent|''
dedent|''
name|'class'
name|'SmallPositiveIntegerListProperty'
op|'('
name|'MultiValueProperty'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'params'
op|'['
string|"'size'"
op|']'
op|'='
string|"'small'"
newline|'\n'
name|'params'
op|'['
string|"'signed'"
op|']'
op|'='
name|'False'
newline|'\n'
name|'MultiValueProperty'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'IntegerChecker'
op|','
op|'**'
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|class|IntegerListProperty
dedent|''
dedent|''
name|'class'
name|'IntegerListProperty'
op|'('
name|'MultiValueProperty'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'params'
op|'['
string|"'size'"
op|']'
op|'='
string|"'medium'"
newline|'\n'
name|'params'
op|'['
string|"'signed'"
op|']'
op|'='
name|'True'
newline|'\n'
name|'MultiValueProperty'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'IntegerChecker'
op|','
op|'**'
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|class|PositiveIntegerListProperty
dedent|''
dedent|''
name|'class'
name|'PositiveIntegerListProperty'
op|'('
name|'MultiValueProperty'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'params'
op|'['
string|"'size'"
op|']'
op|'='
string|"'medium'"
newline|'\n'
name|'params'
op|'['
string|"'signed'"
op|']'
op|'='
name|'False'
newline|'\n'
name|'MultiValueProperty'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'IntegerChecker'
op|','
op|'**'
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|class|LargeIntegerListProperty
dedent|''
dedent|''
name|'class'
name|'LargeIntegerListProperty'
op|'('
name|'MultiValueProperty'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'params'
op|'['
string|"'size'"
op|']'
op|'='
string|"'large'"
newline|'\n'
name|'params'
op|'['
string|"'signed'"
op|']'
op|'='
name|'True'
newline|'\n'
name|'MultiValueProperty'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'IntegerChecker'
op|','
op|'**'
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|class|LargePositiveIntegerListProperty
dedent|''
dedent|''
name|'class'
name|'LargePositiveIntegerListProperty'
op|'('
name|'MultiValueProperty'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'params'
op|'['
string|"'size'"
op|']'
op|'='
string|"'large'"
newline|'\n'
name|'params'
op|'['
string|"'signed'"
op|']'
op|'='
name|'False'
newline|'\n'
name|'MultiValueProperty'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'IntegerChecker'
op|','
op|'**'
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|class|BooleanListProperty
dedent|''
dedent|''
name|'class'
name|'BooleanListProperty'
op|'('
name|'MultiValueProperty'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'MultiValueProperty'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'BooleanChecker'
op|','
op|'**'
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|class|ObjectListProperty
dedent|''
dedent|''
name|'class'
name|'ObjectListProperty'
op|'('
name|'MultiValueProperty'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'MultiValueProperty'
op|'.'
name|'__init__'
op|'('
name|'self'
op|','
name|'ObjectChecker'
op|','
op|'**'
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|class|HasManyProperty
dedent|''
dedent|''
name|'class'
name|'HasManyProperty'
op|'('
name|'Property'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|set_name
indent|'    '
name|'def'
name|'set_name'
op|'('
name|'self'
op|','
name|'name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'name'
op|'='
name|'name'
newline|'\n'
name|'self'
op|'.'
name|'slot_name'
op|'='
string|"'__'"
op|'+'
name|'self'
op|'.'
name|'name'
newline|'\n'
nl|'\n'
DECL|member|__get__
dedent|''
name|'def'
name|'__get__'
op|'('
name|'self'
op|','
name|'obj'
op|','
name|'objtype'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|MultiValue
dedent|''
dedent|''
name|'class'
name|'MultiValue'
op|':'
newline|'\n'
indent|'    '
string|'"""\n    Special Multi Value for boto persistence layer to allow us to do \n    obj.list.append(foo)\n    """'
newline|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'property'
op|','
name|'obj'
op|','
name|'_list'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'checker'
op|'='
name|'property'
op|'.'
name|'checker'
newline|'\n'
name|'self'
op|'.'
name|'name'
op|'='
name|'property'
op|'.'
name|'name'
newline|'\n'
name|'self'
op|'.'
name|'object'
op|'='
name|'obj'
newline|'\n'
name|'self'
op|'.'
name|'_list'
op|'='
name|'_list'
newline|'\n'
nl|'\n'
DECL|member|__repr__
dedent|''
name|'def'
name|'__repr__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'repr'
op|'('
name|'self'
op|'.'
name|'_list'
op|')'
newline|'\n'
nl|'\n'
DECL|member|__getitem__
dedent|''
name|'def'
name|'__getitem__'
op|'('
name|'self'
op|','
name|'key'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'_list'
op|'.'
name|'__getitem__'
op|'('
name|'key'
op|')'
newline|'\n'
nl|'\n'
DECL|member|__delitem__
dedent|''
name|'def'
name|'__delitem__'
op|'('
name|'self'
op|','
name|'key'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'item'
op|'='
name|'self'
op|'['
name|'key'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'_list'
op|'.'
name|'__delitem__'
op|'('
name|'key'
op|')'
newline|'\n'
name|'domain'
op|'='
name|'self'
op|'.'
name|'object'
op|'.'
name|'_manager'
op|'.'
name|'domain'
newline|'\n'
name|'domain'
op|'.'
name|'delete_attributes'
op|'('
name|'self'
op|'.'
name|'object'
op|'.'
name|'id'
op|','
op|'{'
name|'self'
op|'.'
name|'name'
op|':'
op|'['
name|'self'
op|'.'
name|'checker'
op|'.'
name|'to_string'
op|'('
name|'item'
op|')'
op|']'
op|'}'
op|')'
newline|'\n'
nl|'\n'
DECL|member|__len__
dedent|''
name|'def'
name|'__len__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'len'
op|'('
name|'self'
op|'.'
name|'_list'
op|')'
newline|'\n'
nl|'\n'
DECL|member|append
dedent|''
name|'def'
name|'append'
op|'('
name|'self'
op|','
name|'value'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'checker'
op|'.'
name|'check'
op|'('
name|'value'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_list'
op|'.'
name|'append'
op|'('
name|'value'
op|')'
newline|'\n'
name|'domain'
op|'='
name|'self'
op|'.'
name|'object'
op|'.'
name|'_manager'
op|'.'
name|'domain'
newline|'\n'
name|'domain'
op|'.'
name|'put_attributes'
op|'('
name|'self'
op|'.'
name|'object'
op|'.'
name|'id'
op|','
op|'{'
name|'self'
op|'.'
name|'name'
op|':'
name|'self'
op|'.'
name|'checker'
op|'.'
name|'to_string'
op|'('
name|'value'
op|')'
op|'}'
op|','
name|'replace'
op|'='
name|'False'
op|')'
newline|'\n'
nl|'\n'
DECL|member|index
dedent|''
name|'def'
name|'index'
op|'('
name|'self'
op|','
name|'value'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'for'
name|'x'
name|'in'
name|'self'
op|'.'
name|'_list'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'x'
op|'.'
name|'id'
op|'=='
name|'value'
op|'.'
name|'id'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'self'
op|'.'
name|'_list'
op|'.'
name|'index'
op|'('
name|'x'
op|')'
newline|'\n'
nl|'\n'
DECL|member|remove
dedent|''
dedent|''
dedent|''
name|'def'
name|'remove'
op|'('
name|'self'
op|','
name|'value'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'del'
op|'('
name|'self'
op|'['
name|'self'
op|'.'
name|'index'
op|'('
name|'value'
op|')'
op|']'
op|')'
newline|'\n'
dedent|''
dedent|''
endmarker|''
end_unit
