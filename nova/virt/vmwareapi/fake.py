begin_unit
comment|'# vim: tabstop=4 shiftwidth=4 softtabstop=4'
nl|'\n'
nl|'\n'
comment|'# Copyright (c) 2012 VMware, Inc.'
nl|'\n'
comment|'# Copyright (c) 2011 Citrix Systems, Inc.'
nl|'\n'
comment|'# Copyright 2011 OpenStack Foundation'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#    Licensed under the Apache License, Version 2.0 (the "License"); you may'
nl|'\n'
comment|'#    not use this file except in compliance with the License. You may obtain'
nl|'\n'
comment|'#    a copy of the License at'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#         http://www.apache.org/licenses/LICENSE-2.0'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#    Unless required by applicable law or agreed to in writing, software'
nl|'\n'
comment|'#    distributed under the License is distributed on an "AS IS" BASIS, WITHOUT'
nl|'\n'
comment|'#    WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the'
nl|'\n'
comment|'#    License for the specific language governing permissions and limitations'
nl|'\n'
comment|'#    under the License.'
nl|'\n'
nl|'\n'
string|'"""\nA fake VMware VI API implementation.\n"""'
newline|'\n'
nl|'\n'
name|'import'
name|'pprint'
newline|'\n'
name|'import'
name|'uuid'
newline|'\n'
nl|'\n'
name|'from'
name|'nova'
name|'import'
name|'exception'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'openstack'
op|'.'
name|'common'
name|'import'
name|'log'
name|'as'
name|'logging'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'virt'
op|'.'
name|'vmwareapi'
name|'import'
name|'error_util'
newline|'\n'
nl|'\n'
DECL|variable|_CLASSES
name|'_CLASSES'
op|'='
op|'['
string|"'Datacenter'"
op|','
string|"'Datastore'"
op|','
string|"'ResourcePool'"
op|','
string|"'VirtualMachine'"
op|','
nl|'\n'
string|"'Network'"
op|','
string|"'HostSystem'"
op|','
string|"'HostNetworkSystem'"
op|','
string|"'Task'"
op|','
string|"'session'"
op|','
nl|'\n'
string|"'files'"
op|']'
newline|'\n'
nl|'\n'
DECL|variable|_FAKE_FILE_SIZE
name|'_FAKE_FILE_SIZE'
op|'='
number|'1024'
newline|'\n'
nl|'\n'
DECL|variable|_db_content
name|'_db_content'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
DECL|variable|LOG
name|'LOG'
op|'='
name|'logging'
op|'.'
name|'getLogger'
op|'('
name|'__name__'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|log_db_contents
name|'def'
name|'log_db_contents'
op|'('
name|'msg'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Log DB Contents."""'
newline|'\n'
name|'text'
op|'='
name|'msg'
name|'or'
string|'""'
newline|'\n'
name|'content'
op|'='
name|'pprint'
op|'.'
name|'pformat'
op|'('
name|'_db_content'
op|')'
newline|'\n'
name|'LOG'
op|'.'
name|'debug'
op|'('
name|'_'
op|'('
string|'"%(text)s: _db_content => %(content)s"'
op|')'
op|'%'
name|'locals'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|reset
dedent|''
name|'def'
name|'reset'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Resets the db contents."""'
newline|'\n'
name|'for'
name|'c'
name|'in'
name|'_CLASSES'
op|':'
newline|'\n'
comment|'# We fake the datastore by keeping the file references as a list of'
nl|'\n'
comment|'# names in the db'
nl|'\n'
indent|'        '
name|'if'
name|'c'
op|'=='
string|"'files'"
op|':'
newline|'\n'
indent|'            '
name|'_db_content'
op|'['
name|'c'
op|']'
op|'='
op|'['
op|']'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'_db_content'
op|'['
name|'c'
op|']'
op|'='
op|'{'
op|'}'
newline|'\n'
dedent|''
dedent|''
name|'create_network'
op|'('
op|')'
newline|'\n'
name|'create_host_network_system'
op|'('
op|')'
newline|'\n'
name|'create_host'
op|'('
op|')'
newline|'\n'
name|'create_datacenter'
op|'('
op|')'
newline|'\n'
name|'create_datastore'
op|'('
op|')'
newline|'\n'
name|'create_res_pool'
op|'('
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|cleanup
dedent|''
name|'def'
name|'cleanup'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Clear the db contents."""'
newline|'\n'
name|'for'
name|'c'
name|'in'
name|'_CLASSES'
op|':'
newline|'\n'
indent|'        '
name|'_db_content'
op|'['
name|'c'
op|']'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|_create_object
dedent|''
dedent|''
name|'def'
name|'_create_object'
op|'('
name|'table'
op|','
name|'table_obj'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Create an object in the db."""'
newline|'\n'
name|'_db_content'
op|'['
name|'table'
op|']'
op|'['
name|'table_obj'
op|'.'
name|'obj'
op|']'
op|'='
name|'table_obj'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|_get_objects
dedent|''
name|'def'
name|'_get_objects'
op|'('
name|'obj_type'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Get objects of the type."""'
newline|'\n'
name|'lst_objs'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'key'
name|'in'
name|'_db_content'
op|'['
name|'obj_type'
op|']'
op|':'
newline|'\n'
indent|'        '
name|'lst_objs'
op|'.'
name|'append'
op|'('
name|'_db_content'
op|'['
name|'obj_type'
op|']'
op|'['
name|'key'
op|']'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'lst_objs'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|Prop
dedent|''
name|'class'
name|'Prop'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Property Object base class."""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'name'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'val'
op|'='
name|'None'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|ManagedObject
dedent|''
dedent|''
name|'class'
name|'ManagedObject'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Managed Data Object base class."""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'name'
op|'='
string|'"ManagedObject"'
op|','
name|'obj_ref'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Sets the obj property which acts as a reference to the object."""'
newline|'\n'
name|'super'
op|'('
name|'ManagedObject'
op|','
name|'self'
op|')'
op|'.'
name|'__setattr__'
op|'('
string|"'objName'"
op|','
name|'name'
op|')'
newline|'\n'
name|'if'
name|'obj_ref'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'obj_ref'
op|'='
name|'str'
op|'('
name|'uuid'
op|'.'
name|'uuid4'
op|'('
op|')'
op|')'
newline|'\n'
dedent|''
name|'object'
op|'.'
name|'__setattr__'
op|'('
name|'self'
op|','
string|"'obj'"
op|','
name|'obj_ref'
op|')'
newline|'\n'
name|'object'
op|'.'
name|'__setattr__'
op|'('
name|'self'
op|','
string|"'propSet'"
op|','
op|'['
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|set
dedent|''
name|'def'
name|'set'
op|'('
name|'self'
op|','
name|'attr'
op|','
name|'val'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        Sets an attribute value. Not using the __setattr__ directly for we\n        want to set attributes of the type \'a.b.c\' and using this function\n        class we set the same.\n        """'
newline|'\n'
name|'self'
op|'.'
name|'__setattr__'
op|'('
name|'attr'
op|','
name|'val'
op|')'
newline|'\n'
nl|'\n'
DECL|member|get
dedent|''
name|'def'
name|'get'
op|'('
name|'self'
op|','
name|'attr'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        Gets an attribute. Used as an intermediary to get nested\n        property like \'a.b.c\' value.\n        """'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'__getattr__'
op|'('
name|'attr'
op|')'
newline|'\n'
nl|'\n'
DECL|member|__setattr__
dedent|''
name|'def'
name|'__setattr__'
op|'('
name|'self'
op|','
name|'attr'
op|','
name|'val'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'for'
name|'prop'
name|'in'
name|'self'
op|'.'
name|'propSet'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'prop'
op|'.'
name|'name'
op|'=='
name|'attr'
op|':'
newline|'\n'
indent|'                '
name|'prop'
op|'.'
name|'val'
op|'='
name|'val'
newline|'\n'
name|'return'
newline|'\n'
dedent|''
dedent|''
name|'elem'
op|'='
name|'Prop'
op|'('
op|')'
newline|'\n'
name|'elem'
op|'.'
name|'name'
op|'='
name|'attr'
newline|'\n'
name|'elem'
op|'.'
name|'val'
op|'='
name|'val'
newline|'\n'
name|'self'
op|'.'
name|'propSet'
op|'.'
name|'append'
op|'('
name|'elem'
op|')'
newline|'\n'
nl|'\n'
DECL|member|__getattr__
dedent|''
name|'def'
name|'__getattr__'
op|'('
name|'self'
op|','
name|'attr'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'for'
name|'elem'
name|'in'
name|'self'
op|'.'
name|'propSet'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'elem'
op|'.'
name|'name'
op|'=='
name|'attr'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'elem'
op|'.'
name|'val'
newline|'\n'
dedent|''
dedent|''
name|'msg'
op|'='
name|'_'
op|'('
string|'"Property %(attr)s not set for the managed object %(name)s"'
op|')'
newline|'\n'
name|'raise'
name|'exception'
op|'.'
name|'NovaException'
op|'('
name|'msg'
op|'%'
op|'{'
string|"'attr'"
op|':'
name|'attr'
op|','
nl|'\n'
string|"'name'"
op|':'
name|'self'
op|'.'
name|'objName'
op|'}'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|DataObject
dedent|''
dedent|''
name|'class'
name|'DataObject'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Data object base class."""'
newline|'\n'
name|'pass'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|VirtualDisk
dedent|''
name|'class'
name|'VirtualDisk'
op|'('
name|'DataObject'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""\n    Virtual Disk class.\n    """'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'VirtualDisk'
op|','
name|'self'
op|')'
op|'.'
name|'__init__'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'key'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'unitNumber'
op|'='
number|'0'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|VirtualDiskFlatVer2BackingInfo
dedent|''
dedent|''
name|'class'
name|'VirtualDiskFlatVer2BackingInfo'
op|'('
name|'DataObject'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""VirtualDiskFlatVer2BackingInfo class."""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'VirtualDiskFlatVer2BackingInfo'
op|','
name|'self'
op|')'
op|'.'
name|'__init__'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'thinProvisioned'
op|'='
name|'False'
newline|'\n'
name|'self'
op|'.'
name|'eagerlyScrub'
op|'='
name|'False'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|VirtualDiskRawDiskMappingVer1BackingInfo
dedent|''
dedent|''
name|'class'
name|'VirtualDiskRawDiskMappingVer1BackingInfo'
op|'('
name|'DataObject'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""VirtualDiskRawDiskMappingVer1BackingInfo class."""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'VirtualDiskRawDiskMappingVer1BackingInfo'
op|','
name|'self'
op|')'
op|'.'
name|'__init__'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'lunUuid'
op|'='
string|'""'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|VirtualLsiLogicController
dedent|''
dedent|''
name|'class'
name|'VirtualLsiLogicController'
op|'('
name|'DataObject'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""VirtualLsiLogicController class."""'
newline|'\n'
name|'pass'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|VirtualPCNet32
dedent|''
name|'class'
name|'VirtualPCNet32'
op|'('
name|'DataObject'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""VirtualPCNet32 class."""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'VirtualPCNet32'
op|','
name|'self'
op|')'
op|'.'
name|'__init__'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'key'
op|'='
number|'4000'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|VirtualMachine
dedent|''
dedent|''
name|'class'
name|'VirtualMachine'
op|'('
name|'ManagedObject'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Virtual Machine class."""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'VirtualMachine'
op|','
name|'self'
op|')'
op|'.'
name|'__init__'
op|'('
string|'"VirtualMachine"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"name"'
op|','
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"name"'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"runtime.connectionState"'
op|','
nl|'\n'
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"conn_state"'
op|','
string|'"connected"'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"summary.config.guestId"'
op|','
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"guest"'
op|','
string|'"otherGuest"'
op|')'
op|')'
newline|'\n'
name|'ds_do'
op|'='
name|'DataObject'
op|'('
op|')'
newline|'\n'
name|'ds_do'
op|'.'
name|'ManagedObjectReference'
op|'='
op|'['
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"ds"'
op|')'
op|'.'
name|'obj'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"datastore"'
op|','
name|'ds_do'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"summary.guest.toolsStatus"'
op|','
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"toolsstatus"'
op|','
nl|'\n'
string|'"toolsOk"'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"summary.guest.toolsRunningStatus"'
op|','
name|'kwargs'
op|'.'
name|'get'
op|'('
nl|'\n'
string|'"toolsrunningstate"'
op|','
string|'"guestToolsRunning"'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"runtime.powerState"'
op|','
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"powerstate"'
op|','
string|'"poweredOn"'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"config.files.vmPathName"'
op|','
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"vmPathName"'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"summary.config.numCpu"'
op|','
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"numCpu"'
op|','
number|'1'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"summary.config.memorySizeMB"'
op|','
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"mem"'
op|','
number|'1'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"config.hardware.device"'
op|','
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"virtual_device"'
op|','
name|'None'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"config.extraConfig"'
op|','
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"extra_config"'
op|','
name|'None'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|reconfig
dedent|''
name|'def'
name|'reconfig'
op|'('
name|'self'
op|','
name|'factory'
op|','
name|'val'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        Called to reconfigure the VM. Actually customizes the property\n        setting of the Virtual Machine object.\n        """'
newline|'\n'
name|'try'
op|':'
newline|'\n'
comment|'# Case of Reconfig of VM to attach disk'
nl|'\n'
indent|'            '
name|'controller_key'
op|'='
name|'val'
op|'.'
name|'deviceChange'
op|'['
number|'1'
op|']'
op|'.'
name|'device'
op|'.'
name|'controllerKey'
newline|'\n'
name|'filename'
op|'='
name|'val'
op|'.'
name|'deviceChange'
op|'['
number|'1'
op|']'
op|'.'
name|'device'
op|'.'
name|'backing'
op|'.'
name|'fileName'
newline|'\n'
nl|'\n'
name|'disk'
op|'='
name|'VirtualDisk'
op|'('
op|')'
newline|'\n'
name|'disk'
op|'.'
name|'controllerKey'
op|'='
name|'controller_key'
newline|'\n'
nl|'\n'
name|'disk_backing'
op|'='
name|'VirtualDiskFlatVer2BackingInfo'
op|'('
op|')'
newline|'\n'
name|'disk_backing'
op|'.'
name|'fileName'
op|'='
name|'filename'
newline|'\n'
name|'disk_backing'
op|'.'
name|'key'
op|'='
op|'-'
number|'101'
newline|'\n'
name|'disk'
op|'.'
name|'backing'
op|'='
name|'disk_backing'
newline|'\n'
nl|'\n'
name|'controller'
op|'='
name|'VirtualLsiLogicController'
op|'('
op|')'
newline|'\n'
name|'controller'
op|'.'
name|'key'
op|'='
name|'controller_key'
newline|'\n'
nl|'\n'
name|'nic'
op|'='
name|'VirtualPCNet32'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"config.hardware.device"'
op|','
op|'['
name|'disk'
op|','
name|'controller'
op|','
name|'nic'
op|']'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'AttributeError'
op|':'
newline|'\n'
comment|'# Case of Reconfig of VM to set extra params'
nl|'\n'
indent|'            '
name|'self'
op|'.'
name|'set'
op|'('
string|'"config.extraConfig"'
op|','
name|'val'
op|'.'
name|'extraConfig'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|Network
dedent|''
dedent|''
dedent|''
name|'class'
name|'Network'
op|'('
name|'ManagedObject'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Network class."""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'Network'
op|','
name|'self'
op|')'
op|'.'
name|'__init__'
op|'('
string|'"Network"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"summary.name"'
op|','
string|'"vmnet0"'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|ResourcePool
dedent|''
dedent|''
name|'class'
name|'ResourcePool'
op|'('
name|'ManagedObject'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Resource Pool class."""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'ResourcePool'
op|','
name|'self'
op|')'
op|'.'
name|'__init__'
op|'('
string|'"ResourcePool"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"name"'
op|','
string|'"ResPool"'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|Datastore
dedent|''
dedent|''
name|'class'
name|'Datastore'
op|'('
name|'ManagedObject'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Datastore class."""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'Datastore'
op|','
name|'self'
op|')'
op|'.'
name|'__init__'
op|'('
string|'"Datastore"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"summary.type"'
op|','
string|'"VMFS"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"summary.name"'
op|','
string|'"fake-ds"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"summary.capacity"'
op|','
number|'1024'
op|'*'
number|'1024'
op|'*'
number|'1024'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"summary.freeSpace"'
op|','
number|'500'
op|'*'
number|'1024'
op|'*'
number|'1024'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|HostNetworkSystem
dedent|''
dedent|''
name|'class'
name|'HostNetworkSystem'
op|'('
name|'ManagedObject'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""HostNetworkSystem class."""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'HostNetworkSystem'
op|','
name|'self'
op|')'
op|'.'
name|'__init__'
op|'('
string|'"HostNetworkSystem"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"name"'
op|','
string|'"networkSystem"'
op|')'
newline|'\n'
nl|'\n'
name|'pnic_do'
op|'='
name|'DataObject'
op|'('
op|')'
newline|'\n'
name|'pnic_do'
op|'.'
name|'device'
op|'='
string|'"vmnic0"'
newline|'\n'
nl|'\n'
name|'net_info_pnic'
op|'='
name|'DataObject'
op|'('
op|')'
newline|'\n'
name|'net_info_pnic'
op|'.'
name|'PhysicalNic'
op|'='
op|'['
name|'pnic_do'
op|']'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"networkInfo.pnic"'
op|','
name|'net_info_pnic'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|HostSystem
dedent|''
dedent|''
name|'class'
name|'HostSystem'
op|'('
name|'ManagedObject'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Host System class."""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'HostSystem'
op|','
name|'self'
op|')'
op|'.'
name|'__init__'
op|'('
string|'"HostSystem"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"name"'
op|','
string|'"ha-host"'
op|')'
newline|'\n'
name|'if'
name|'_db_content'
op|'.'
name|'get'
op|'('
string|'"HostNetworkSystem"'
op|','
name|'None'
op|')'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'create_host_network_system'
op|'('
op|')'
newline|'\n'
dedent|''
name|'host_net_key'
op|'='
name|'_db_content'
op|'['
string|'"HostNetworkSystem"'
op|']'
op|'.'
name|'keys'
op|'('
op|')'
op|'['
number|'0'
op|']'
newline|'\n'
name|'host_net_sys'
op|'='
name|'_db_content'
op|'['
string|'"HostNetworkSystem"'
op|']'
op|'['
name|'host_net_key'
op|']'
op|'.'
name|'obj'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"configManager.networkSystem"'
op|','
name|'host_net_sys'
op|')'
newline|'\n'
nl|'\n'
name|'summary'
op|'='
name|'DataObject'
op|'('
op|')'
newline|'\n'
name|'hardware'
op|'='
name|'DataObject'
op|'('
op|')'
newline|'\n'
name|'hardware'
op|'.'
name|'numCpuCores'
op|'='
number|'8'
newline|'\n'
name|'hardware'
op|'.'
name|'numCpuPkgs'
op|'='
number|'2'
newline|'\n'
name|'hardware'
op|'.'
name|'numCpuThreads'
op|'='
number|'16'
newline|'\n'
name|'hardware'
op|'.'
name|'vendor'
op|'='
string|'"Intel"'
newline|'\n'
name|'hardware'
op|'.'
name|'cpuModel'
op|'='
string|'"Intel(R) Xeon(R)"'
newline|'\n'
name|'hardware'
op|'.'
name|'memorySize'
op|'='
number|'1024'
op|'*'
number|'1024'
op|'*'
number|'1024'
newline|'\n'
name|'summary'
op|'.'
name|'hardware'
op|'='
name|'hardware'
newline|'\n'
nl|'\n'
name|'quickstats'
op|'='
name|'DataObject'
op|'('
op|')'
newline|'\n'
name|'quickstats'
op|'.'
name|'overallMemoryUsage'
op|'='
number|'500'
newline|'\n'
name|'summary'
op|'.'
name|'quickStats'
op|'='
name|'quickstats'
newline|'\n'
nl|'\n'
name|'product'
op|'='
name|'DataObject'
op|'('
op|')'
newline|'\n'
name|'product'
op|'.'
name|'name'
op|'='
string|'"VMware ESXi"'
newline|'\n'
name|'product'
op|'.'
name|'version'
op|'='
string|'"5.0.0"'
newline|'\n'
name|'config'
op|'='
name|'DataObject'
op|'('
op|')'
newline|'\n'
name|'config'
op|'.'
name|'product'
op|'='
name|'product'
newline|'\n'
name|'summary'
op|'.'
name|'config'
op|'='
name|'config'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"summary"'
op|','
name|'summary'
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'_db_content'
op|'.'
name|'get'
op|'('
string|'"Network"'
op|','
name|'None'
op|')'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'create_network'
op|'('
op|')'
newline|'\n'
dedent|''
name|'net_ref'
op|'='
name|'_db_content'
op|'['
string|'"Network"'
op|']'
op|'['
name|'_db_content'
op|'['
string|'"Network"'
op|']'
op|'.'
name|'keys'
op|'('
op|')'
op|'['
number|'0'
op|']'
op|']'
op|'.'
name|'obj'
newline|'\n'
name|'network_do'
op|'='
name|'DataObject'
op|'('
op|')'
newline|'\n'
name|'network_do'
op|'.'
name|'ManagedObjectReference'
op|'='
op|'['
name|'net_ref'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"network"'
op|','
name|'network_do'
op|')'
newline|'\n'
nl|'\n'
name|'vswitch_do'
op|'='
name|'DataObject'
op|'('
op|')'
newline|'\n'
name|'vswitch_do'
op|'.'
name|'pnic'
op|'='
op|'['
string|'"vmnic0"'
op|']'
newline|'\n'
name|'vswitch_do'
op|'.'
name|'name'
op|'='
string|'"vSwitch0"'
newline|'\n'
name|'vswitch_do'
op|'.'
name|'portgroup'
op|'='
op|'['
string|'"PortGroup-vmnet0"'
op|']'
newline|'\n'
nl|'\n'
name|'net_swicth'
op|'='
name|'DataObject'
op|'('
op|')'
newline|'\n'
name|'net_swicth'
op|'.'
name|'HostVirtualSwitch'
op|'='
op|'['
name|'vswitch_do'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"config.network.vswitch"'
op|','
name|'net_swicth'
op|')'
newline|'\n'
nl|'\n'
name|'host_pg_do'
op|'='
name|'DataObject'
op|'('
op|')'
newline|'\n'
name|'host_pg_do'
op|'.'
name|'key'
op|'='
string|'"PortGroup-vmnet0"'
newline|'\n'
nl|'\n'
name|'pg_spec'
op|'='
name|'DataObject'
op|'('
op|')'
newline|'\n'
name|'pg_spec'
op|'.'
name|'vlanId'
op|'='
number|'0'
newline|'\n'
name|'pg_spec'
op|'.'
name|'name'
op|'='
string|'"vmnet0"'
newline|'\n'
nl|'\n'
name|'host_pg_do'
op|'.'
name|'spec'
op|'='
name|'pg_spec'
newline|'\n'
nl|'\n'
name|'host_pg'
op|'='
name|'DataObject'
op|'('
op|')'
newline|'\n'
name|'host_pg'
op|'.'
name|'HostPortGroup'
op|'='
op|'['
name|'host_pg_do'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"config.network.portgroup"'
op|','
name|'host_pg'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_add_port_group
dedent|''
name|'def'
name|'_add_port_group'
op|'('
name|'self'
op|','
name|'spec'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Adds a port group to the host system object in the db."""'
newline|'\n'
name|'pg_name'
op|'='
name|'spec'
op|'.'
name|'name'
newline|'\n'
name|'vswitch_name'
op|'='
name|'spec'
op|'.'
name|'vswitchName'
newline|'\n'
name|'vlanid'
op|'='
name|'spec'
op|'.'
name|'vlanId'
newline|'\n'
nl|'\n'
name|'vswitch_do'
op|'='
name|'DataObject'
op|'('
op|')'
newline|'\n'
name|'vswitch_do'
op|'.'
name|'pnic'
op|'='
op|'['
string|'"vmnic0"'
op|']'
newline|'\n'
name|'vswitch_do'
op|'.'
name|'name'
op|'='
name|'vswitch_name'
newline|'\n'
name|'vswitch_do'
op|'.'
name|'portgroup'
op|'='
op|'['
string|'"PortGroup-%s"'
op|'%'
name|'pg_name'
op|']'
newline|'\n'
nl|'\n'
name|'vswitches'
op|'='
name|'self'
op|'.'
name|'get'
op|'('
string|'"config.network.vswitch"'
op|')'
op|'.'
name|'HostVirtualSwitch'
newline|'\n'
name|'vswitches'
op|'.'
name|'append'
op|'('
name|'vswitch_do'
op|')'
newline|'\n'
nl|'\n'
name|'host_pg_do'
op|'='
name|'DataObject'
op|'('
op|')'
newline|'\n'
name|'host_pg_do'
op|'.'
name|'key'
op|'='
string|'"PortGroup-%s"'
op|'%'
name|'pg_name'
newline|'\n'
nl|'\n'
name|'pg_spec'
op|'='
name|'DataObject'
op|'('
op|')'
newline|'\n'
name|'pg_spec'
op|'.'
name|'vlanId'
op|'='
name|'vlanid'
newline|'\n'
name|'pg_spec'
op|'.'
name|'name'
op|'='
name|'pg_name'
newline|'\n'
nl|'\n'
name|'host_pg_do'
op|'.'
name|'spec'
op|'='
name|'pg_spec'
newline|'\n'
name|'host_pgrps'
op|'='
name|'self'
op|'.'
name|'get'
op|'('
string|'"config.network.portgroup"'
op|')'
op|'.'
name|'HostPortGroup'
newline|'\n'
name|'host_pgrps'
op|'.'
name|'append'
op|'('
name|'host_pg_do'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|Datacenter
dedent|''
dedent|''
name|'class'
name|'Datacenter'
op|'('
name|'ManagedObject'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Datacenter class."""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'Datacenter'
op|','
name|'self'
op|')'
op|'.'
name|'__init__'
op|'('
string|'"Datacenter"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"name"'
op|','
string|'"ha-datacenter"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"vmFolder"'
op|','
string|'"vm_folder_ref"'
op|')'
newline|'\n'
name|'if'
name|'_db_content'
op|'.'
name|'get'
op|'('
string|'"Network"'
op|','
name|'None'
op|')'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'create_network'
op|'('
op|')'
newline|'\n'
dedent|''
name|'net_ref'
op|'='
name|'_db_content'
op|'['
string|'"Network"'
op|']'
op|'['
name|'_db_content'
op|'['
string|'"Network"'
op|']'
op|'.'
name|'keys'
op|'('
op|')'
op|'['
number|'0'
op|']'
op|']'
op|'.'
name|'obj'
newline|'\n'
name|'network_do'
op|'='
name|'DataObject'
op|'('
op|')'
newline|'\n'
name|'network_do'
op|'.'
name|'ManagedObjectReference'
op|'='
op|'['
name|'net_ref'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"network"'
op|','
name|'network_do'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|Task
dedent|''
dedent|''
name|'class'
name|'Task'
op|'('
name|'ManagedObject'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Task class."""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'task_name'
op|','
name|'state'
op|'='
string|'"running"'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'Task'
op|','
name|'self'
op|')'
op|'.'
name|'__init__'
op|'('
string|'"Task"'
op|')'
newline|'\n'
name|'info'
op|'='
name|'DataObject'
newline|'\n'
name|'info'
op|'.'
name|'name'
op|'='
name|'task_name'
newline|'\n'
name|'info'
op|'.'
name|'state'
op|'='
name|'state'
newline|'\n'
name|'self'
op|'.'
name|'set'
op|'('
string|'"info"'
op|','
name|'info'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|create_host_network_system
dedent|''
dedent|''
name|'def'
name|'create_host_network_system'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
name|'host_net_system'
op|'='
name|'HostNetworkSystem'
op|'('
op|')'
newline|'\n'
name|'_create_object'
op|'('
string|'"HostNetworkSystem"'
op|','
name|'host_net_system'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|create_host
dedent|''
name|'def'
name|'create_host'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
name|'host_system'
op|'='
name|'HostSystem'
op|'('
op|')'
newline|'\n'
name|'_create_object'
op|'('
string|"'HostSystem'"
op|','
name|'host_system'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|create_datacenter
dedent|''
name|'def'
name|'create_datacenter'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
name|'data_center'
op|'='
name|'Datacenter'
op|'('
op|')'
newline|'\n'
name|'_create_object'
op|'('
string|"'Datacenter'"
op|','
name|'data_center'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|create_datastore
dedent|''
name|'def'
name|'create_datastore'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
name|'data_store'
op|'='
name|'Datastore'
op|'('
op|')'
newline|'\n'
name|'_create_object'
op|'('
string|"'Datastore'"
op|','
name|'data_store'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|create_res_pool
dedent|''
name|'def'
name|'create_res_pool'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
name|'res_pool'
op|'='
name|'ResourcePool'
op|'('
op|')'
newline|'\n'
name|'_create_object'
op|'('
string|"'ResourcePool'"
op|','
name|'res_pool'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|create_network
dedent|''
name|'def'
name|'create_network'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
name|'network'
op|'='
name|'Network'
op|'('
op|')'
newline|'\n'
name|'_create_object'
op|'('
string|"'Network'"
op|','
name|'network'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|create_task
dedent|''
name|'def'
name|'create_task'
op|'('
name|'task_name'
op|','
name|'state'
op|'='
string|'"running"'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'task'
op|'='
name|'Task'
op|'('
name|'task_name'
op|','
name|'state'
op|')'
newline|'\n'
name|'_create_object'
op|'('
string|'"Task"'
op|','
name|'task'
op|')'
newline|'\n'
name|'return'
name|'task'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|_add_file
dedent|''
name|'def'
name|'_add_file'
op|'('
name|'file_path'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Adds a file reference to the  db."""'
newline|'\n'
name|'_db_content'
op|'['
string|'"files"'
op|']'
op|'.'
name|'append'
op|'('
name|'file_path'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|_remove_file
dedent|''
name|'def'
name|'_remove_file'
op|'('
name|'file_path'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Removes a file reference from the db."""'
newline|'\n'
name|'if'
name|'_db_content'
op|'.'
name|'get'
op|'('
string|'"files"'
op|')'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'        '
name|'raise'
name|'exception'
op|'.'
name|'NoFilesFound'
op|'('
op|')'
newline|'\n'
comment|'# Check if the remove is for a single file object or for a folder'
nl|'\n'
dedent|''
name|'if'
name|'file_path'
op|'.'
name|'find'
op|'('
string|'".vmdk"'
op|')'
op|'!='
op|'-'
number|'1'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'file_path'
name|'not'
name|'in'
name|'_db_content'
op|'.'
name|'get'
op|'('
string|'"files"'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'exception'
op|'.'
name|'FileNotFound'
op|'('
name|'file_path'
op|'='
name|'file_path'
op|')'
newline|'\n'
dedent|''
name|'_db_content'
op|'.'
name|'get'
op|'('
string|'"files"'
op|')'
op|'.'
name|'remove'
op|'('
name|'file_path'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
comment|'# Removes the files in the folder and the folder too from the db'
nl|'\n'
indent|'        '
name|'for'
name|'file'
name|'in'
name|'_db_content'
op|'.'
name|'get'
op|'('
string|'"files"'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'file'
op|'.'
name|'find'
op|'('
name|'file_path'
op|')'
op|'!='
op|'-'
number|'1'
op|':'
newline|'\n'
indent|'                '
name|'lst_files'
op|'='
name|'_db_content'
op|'.'
name|'get'
op|'('
string|'"files"'
op|')'
newline|'\n'
name|'if'
name|'lst_files'
name|'and'
name|'lst_files'
op|'.'
name|'count'
op|'('
name|'file'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'lst_files'
op|'.'
name|'remove'
op|'('
name|'file'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|fake_plug_vifs
dedent|''
dedent|''
dedent|''
dedent|''
dedent|''
name|'def'
name|'fake_plug_vifs'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Fakes plugging vifs."""'
newline|'\n'
name|'pass'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|fake_get_network
dedent|''
name|'def'
name|'fake_get_network'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Fake get network."""'
newline|'\n'
name|'return'
op|'{'
string|"'type'"
op|':'
string|"'fake'"
op|'}'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|fake_fetch_image
dedent|''
name|'def'
name|'fake_fetch_image'
op|'('
name|'context'
op|','
name|'image'
op|','
name|'instance'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Fakes fetch image call. Just adds a reference to the db for the file."""'
newline|'\n'
name|'ds_name'
op|'='
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"datastore_name"'
op|')'
newline|'\n'
name|'file_path'
op|'='
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"file_path"'
op|')'
newline|'\n'
name|'ds_file_path'
op|'='
string|'"["'
op|'+'
name|'ds_name'
op|'+'
string|'"] "'
op|'+'
name|'file_path'
newline|'\n'
name|'_add_file'
op|'('
name|'ds_file_path'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|fake_upload_image
dedent|''
name|'def'
name|'fake_upload_image'
op|'('
name|'context'
op|','
name|'image'
op|','
name|'instance'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Fakes the upload of an image."""'
newline|'\n'
name|'pass'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|fake_get_vmdk_size_and_properties
dedent|''
name|'def'
name|'fake_get_vmdk_size_and_properties'
op|'('
name|'context'
op|','
name|'image_id'
op|','
name|'instance'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Fakes the file size and properties fetch for the image file."""'
newline|'\n'
name|'props'
op|'='
op|'{'
string|'"vmware_ostype"'
op|':'
string|'"otherGuest"'
op|','
nl|'\n'
string|'"vmware_adaptertype"'
op|':'
string|'"lsiLogic"'
op|'}'
newline|'\n'
name|'return'
name|'_FAKE_FILE_SIZE'
op|','
name|'props'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|_get_vm_mdo
dedent|''
name|'def'
name|'_get_vm_mdo'
op|'('
name|'vm_ref'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Gets the Virtual Machine with the ref from the db."""'
newline|'\n'
name|'if'
name|'_db_content'
op|'.'
name|'get'
op|'('
string|'"VirtualMachine"'
op|','
name|'None'
op|')'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'exception'
op|'.'
name|'NotFound'
op|'('
name|'_'
op|'('
string|'"There is no VM registered"'
op|')'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'vm_ref'
name|'not'
name|'in'
name|'_db_content'
op|'.'
name|'get'
op|'('
string|'"VirtualMachine"'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'raise'
name|'exception'
op|'.'
name|'NotFound'
op|'('
name|'_'
op|'('
string|'"Virtual Machine with ref %s is not "'
nl|'\n'
string|'"there"'
op|')'
op|'%'
name|'vm_ref'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'_db_content'
op|'.'
name|'get'
op|'('
string|'"VirtualMachine"'
op|')'
op|'['
name|'vm_ref'
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|FakeFactory
dedent|''
name|'class'
name|'FakeFactory'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Fake factory class for the suds client."""'
newline|'\n'
nl|'\n'
DECL|member|create
name|'def'
name|'create'
op|'('
name|'self'
op|','
name|'obj_name'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Creates a namespace object."""'
newline|'\n'
name|'return'
name|'DataObject'
op|'('
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|FakeVim
dedent|''
dedent|''
name|'class'
name|'FakeVim'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Fake VIM Class."""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'protocol'
op|'='
string|'"https"'
op|','
name|'host'
op|'='
string|'"localhost"'
op|','
name|'trace'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        Initializes the suds client object, sets the service content\n        contents and the cookies for the session.\n        """'
newline|'\n'
name|'self'
op|'.'
name|'_session'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'client'
op|'='
name|'DataObject'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'client'
op|'.'
name|'factory'
op|'='
name|'FakeFactory'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'transport'
op|'='
name|'DataObject'
op|'('
op|')'
newline|'\n'
name|'transport'
op|'.'
name|'cookiejar'
op|'='
string|'"Fake-CookieJar"'
newline|'\n'
name|'options'
op|'='
name|'DataObject'
op|'('
op|')'
newline|'\n'
name|'options'
op|'.'
name|'transport'
op|'='
name|'transport'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'client'
op|'.'
name|'options'
op|'='
name|'options'
newline|'\n'
nl|'\n'
name|'service_content'
op|'='
name|'self'
op|'.'
name|'client'
op|'.'
name|'factory'
op|'.'
name|'create'
op|'('
string|"'ns0:ServiceContent'"
op|')'
newline|'\n'
name|'service_content'
op|'.'
name|'propertyCollector'
op|'='
string|'"PropCollector"'
newline|'\n'
name|'service_content'
op|'.'
name|'virtualDiskManager'
op|'='
string|'"VirtualDiskManager"'
newline|'\n'
name|'service_content'
op|'.'
name|'fileManager'
op|'='
string|'"FileManager"'
newline|'\n'
name|'service_content'
op|'.'
name|'rootFolder'
op|'='
string|'"RootFolder"'
newline|'\n'
name|'service_content'
op|'.'
name|'sessionManager'
op|'='
string|'"SessionManager"'
newline|'\n'
name|'self'
op|'.'
name|'_service_content'
op|'='
name|'service_content'
newline|'\n'
nl|'\n'
DECL|member|get_service_content
dedent|''
name|'def'
name|'get_service_content'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'_service_content'
newline|'\n'
nl|'\n'
DECL|member|__repr__
dedent|''
name|'def'
name|'__repr__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
string|'"Fake VIM Object"'
newline|'\n'
nl|'\n'
DECL|member|__str__
dedent|''
name|'def'
name|'__str__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
string|'"Fake VIM Object"'
newline|'\n'
nl|'\n'
DECL|member|_login
dedent|''
name|'def'
name|'_login'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Logs in and sets the session object in the db."""'
newline|'\n'
name|'self'
op|'.'
name|'_session'
op|'='
name|'str'
op|'('
name|'uuid'
op|'.'
name|'uuid4'
op|'('
op|')'
op|')'
newline|'\n'
name|'session'
op|'='
name|'DataObject'
op|'('
op|')'
newline|'\n'
name|'session'
op|'.'
name|'key'
op|'='
name|'self'
op|'.'
name|'_session'
newline|'\n'
name|'_db_content'
op|'['
string|"'session'"
op|']'
op|'['
name|'self'
op|'.'
name|'_session'
op|']'
op|'='
name|'session'
newline|'\n'
name|'return'
name|'session'
newline|'\n'
nl|'\n'
DECL|member|_logout
dedent|''
name|'def'
name|'_logout'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Logs out and remove the session object ref from the db."""'
newline|'\n'
name|'s'
op|'='
name|'self'
op|'.'
name|'_session'
newline|'\n'
name|'self'
op|'.'
name|'_session'
op|'='
name|'None'
newline|'\n'
name|'if'
name|'s'
name|'not'
name|'in'
name|'_db_content'
op|'['
string|"'session'"
op|']'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'exception'
op|'.'
name|'NovaException'
op|'('
nl|'\n'
name|'_'
op|'('
string|'"Logging out a session that is invalid or already logged "'
nl|'\n'
string|'"out: %s"'
op|')'
op|'%'
name|'s'
op|')'
newline|'\n'
dedent|''
name|'del'
name|'_db_content'
op|'['
string|"'session'"
op|']'
op|'['
name|'s'
op|']'
newline|'\n'
nl|'\n'
DECL|member|_terminate_session
dedent|''
name|'def'
name|'_terminate_session'
op|'('
name|'self'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Terminates a session."""'
newline|'\n'
name|'s'
op|'='
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"sessionId"'
op|')'
op|'['
number|'0'
op|']'
newline|'\n'
name|'if'
name|'s'
name|'not'
name|'in'
name|'_db_content'
op|'['
string|"'session'"
op|']'
op|':'
newline|'\n'
indent|'            '
name|'return'
newline|'\n'
dedent|''
name|'del'
name|'_db_content'
op|'['
string|"'session'"
op|']'
op|'['
name|'s'
op|']'
newline|'\n'
nl|'\n'
DECL|member|_check_session
dedent|''
name|'def'
name|'_check_session'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Checks if the session is active."""'
newline|'\n'
name|'if'
op|'('
name|'self'
op|'.'
name|'_session'
name|'is'
name|'None'
name|'or'
name|'self'
op|'.'
name|'_session'
name|'not'
name|'in'
nl|'\n'
name|'_db_content'
op|'['
string|"'session'"
op|']'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'LOG'
op|'.'
name|'debug'
op|'('
name|'_'
op|'('
string|'"Session is faulty"'
op|')'
op|')'
newline|'\n'
name|'raise'
name|'error_util'
op|'.'
name|'VimFaultException'
op|'('
nl|'\n'
op|'['
name|'error_util'
op|'.'
name|'FAULT_NOT_AUTHENTICATED'
op|']'
op|','
nl|'\n'
name|'_'
op|'('
string|'"Session Invalid"'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_create_vm
dedent|''
dedent|''
name|'def'
name|'_create_vm'
op|'('
name|'self'
op|','
name|'method'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Creates and registers a VM object with the Host System."""'
newline|'\n'
name|'config_spec'
op|'='
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"config"'
op|')'
newline|'\n'
name|'ds'
op|'='
name|'_db_content'
op|'['
string|'"Datastore"'
op|']'
op|'['
name|'_db_content'
op|'['
string|'"Datastore"'
op|']'
op|'.'
name|'keys'
op|'('
op|')'
op|'['
number|'0'
op|']'
op|']'
newline|'\n'
name|'vm_dict'
op|'='
op|'{'
string|'"name"'
op|':'
name|'config_spec'
op|'.'
name|'name'
op|','
nl|'\n'
string|'"ds"'
op|':'
name|'ds'
op|','
nl|'\n'
string|'"powerstate"'
op|':'
string|'"poweredOff"'
op|','
nl|'\n'
string|'"vmPathName"'
op|':'
name|'config_spec'
op|'.'
name|'files'
op|'.'
name|'vmPathName'
op|','
nl|'\n'
string|'"numCpu"'
op|':'
name|'config_spec'
op|'.'
name|'numCPUs'
op|','
nl|'\n'
string|'"mem"'
op|':'
name|'config_spec'
op|'.'
name|'memoryMB'
op|'}'
newline|'\n'
name|'virtual_machine'
op|'='
name|'VirtualMachine'
op|'('
op|'**'
name|'vm_dict'
op|')'
newline|'\n'
name|'_create_object'
op|'('
string|'"VirtualMachine"'
op|','
name|'virtual_machine'
op|')'
newline|'\n'
name|'task_mdo'
op|'='
name|'create_task'
op|'('
name|'method'
op|','
string|'"success"'
op|')'
newline|'\n'
name|'return'
name|'task_mdo'
op|'.'
name|'obj'
newline|'\n'
nl|'\n'
DECL|member|_reconfig_vm
dedent|''
name|'def'
name|'_reconfig_vm'
op|'('
name|'self'
op|','
name|'method'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Reconfigures a VM and sets the properties supplied."""'
newline|'\n'
name|'vm_ref'
op|'='
name|'args'
op|'['
number|'0'
op|']'
newline|'\n'
name|'vm_mdo'
op|'='
name|'_get_vm_mdo'
op|'('
name|'vm_ref'
op|')'
newline|'\n'
name|'vm_mdo'
op|'.'
name|'reconfig'
op|'('
name|'self'
op|'.'
name|'client'
op|'.'
name|'factory'
op|','
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"spec"'
op|')'
op|')'
newline|'\n'
name|'task_mdo'
op|'='
name|'create_task'
op|'('
name|'method'
op|','
string|'"success"'
op|')'
newline|'\n'
name|'return'
name|'task_mdo'
op|'.'
name|'obj'
newline|'\n'
nl|'\n'
DECL|member|_create_copy_disk
dedent|''
name|'def'
name|'_create_copy_disk'
op|'('
name|'self'
op|','
name|'method'
op|','
name|'vmdk_file_path'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Creates/copies a vmdk file object in the datastore."""'
newline|'\n'
comment|'# We need to add/create both .vmdk and .-flat.vmdk files'
nl|'\n'
name|'flat_vmdk_file_path'
op|'='
name|'vmdk_file_path'
op|'.'
name|'replace'
op|'('
string|'".vmdk"'
op|','
string|'"-flat.vmdk"'
op|')'
newline|'\n'
name|'_add_file'
op|'('
name|'vmdk_file_path'
op|')'
newline|'\n'
name|'_add_file'
op|'('
name|'flat_vmdk_file_path'
op|')'
newline|'\n'
name|'task_mdo'
op|'='
name|'create_task'
op|'('
name|'method'
op|','
string|'"success"'
op|')'
newline|'\n'
name|'return'
name|'task_mdo'
op|'.'
name|'obj'
newline|'\n'
nl|'\n'
DECL|member|_snapshot_vm
dedent|''
name|'def'
name|'_snapshot_vm'
op|'('
name|'self'
op|','
name|'method'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Snapshots a VM. Here we do nothing for faking sake."""'
newline|'\n'
name|'task_mdo'
op|'='
name|'create_task'
op|'('
name|'method'
op|','
string|'"success"'
op|')'
newline|'\n'
name|'return'
name|'task_mdo'
op|'.'
name|'obj'
newline|'\n'
nl|'\n'
DECL|member|_delete_disk
dedent|''
name|'def'
name|'_delete_disk'
op|'('
name|'self'
op|','
name|'method'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Deletes .vmdk and -flat.vmdk files corresponding to the VM."""'
newline|'\n'
name|'vmdk_file_path'
op|'='
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"name"'
op|')'
newline|'\n'
name|'flat_vmdk_file_path'
op|'='
name|'vmdk_file_path'
op|'.'
name|'replace'
op|'('
string|'".vmdk"'
op|','
string|'"-flat.vmdk"'
op|')'
newline|'\n'
name|'_remove_file'
op|'('
name|'vmdk_file_path'
op|')'
newline|'\n'
name|'_remove_file'
op|'('
name|'flat_vmdk_file_path'
op|')'
newline|'\n'
name|'task_mdo'
op|'='
name|'create_task'
op|'('
name|'method'
op|','
string|'"success"'
op|')'
newline|'\n'
name|'return'
name|'task_mdo'
op|'.'
name|'obj'
newline|'\n'
nl|'\n'
DECL|member|_delete_file
dedent|''
name|'def'
name|'_delete_file'
op|'('
name|'self'
op|','
name|'method'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Deletes a file from the datastore."""'
newline|'\n'
name|'_remove_file'
op|'('
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"name"'
op|')'
op|')'
newline|'\n'
name|'task_mdo'
op|'='
name|'create_task'
op|'('
name|'method'
op|','
string|'"success"'
op|')'
newline|'\n'
name|'return'
name|'task_mdo'
op|'.'
name|'obj'
newline|'\n'
nl|'\n'
DECL|member|_just_return
dedent|''
name|'def'
name|'_just_return'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Fakes a return."""'
newline|'\n'
name|'return'
newline|'\n'
nl|'\n'
DECL|member|_just_return_task
dedent|''
name|'def'
name|'_just_return_task'
op|'('
name|'self'
op|','
name|'method'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Fakes a task return."""'
newline|'\n'
name|'task_mdo'
op|'='
name|'create_task'
op|'('
name|'method'
op|','
string|'"success"'
op|')'
newline|'\n'
name|'return'
name|'task_mdo'
op|'.'
name|'obj'
newline|'\n'
nl|'\n'
DECL|member|_unregister_vm
dedent|''
name|'def'
name|'_unregister_vm'
op|'('
name|'self'
op|','
name|'method'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Unregisters a VM from the Host System."""'
newline|'\n'
name|'vm_ref'
op|'='
name|'args'
op|'['
number|'0'
op|']'
newline|'\n'
name|'_get_vm_mdo'
op|'('
name|'vm_ref'
op|')'
newline|'\n'
name|'del'
name|'_db_content'
op|'['
string|'"VirtualMachine"'
op|']'
op|'['
name|'vm_ref'
op|']'
newline|'\n'
nl|'\n'
DECL|member|_search_ds
dedent|''
name|'def'
name|'_search_ds'
op|'('
name|'self'
op|','
name|'method'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Searches the datastore for a file."""'
newline|'\n'
name|'ds_path'
op|'='
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"datastorePath"'
op|')'
newline|'\n'
name|'if'
name|'_db_content'
op|'.'
name|'get'
op|'('
string|'"files"'
op|','
name|'None'
op|')'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'exception'
op|'.'
name|'NoFilesFound'
op|'('
op|')'
newline|'\n'
dedent|''
name|'for'
name|'file'
name|'in'
name|'_db_content'
op|'.'
name|'get'
op|'('
string|'"files"'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'file'
op|'.'
name|'find'
op|'('
name|'ds_path'
op|')'
op|'!='
op|'-'
number|'1'
op|':'
newline|'\n'
indent|'                '
name|'task_mdo'
op|'='
name|'create_task'
op|'('
name|'method'
op|','
string|'"success"'
op|')'
newline|'\n'
name|'return'
name|'task_mdo'
op|'.'
name|'obj'
newline|'\n'
dedent|''
dedent|''
name|'task_mdo'
op|'='
name|'create_task'
op|'('
name|'method'
op|','
string|'"error"'
op|')'
newline|'\n'
name|'return'
name|'task_mdo'
op|'.'
name|'obj'
newline|'\n'
nl|'\n'
DECL|member|_make_dir
dedent|''
name|'def'
name|'_make_dir'
op|'('
name|'self'
op|','
name|'method'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Creates a directory in the datastore."""'
newline|'\n'
name|'ds_path'
op|'='
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"name"'
op|')'
newline|'\n'
name|'if'
name|'_db_content'
op|'.'
name|'get'
op|'('
string|'"files"'
op|','
name|'None'
op|')'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'exception'
op|'.'
name|'NoFilesFound'
op|'('
op|')'
newline|'\n'
dedent|''
name|'_db_content'
op|'['
string|'"files"'
op|']'
op|'.'
name|'append'
op|'('
name|'ds_path'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_set_power_state
dedent|''
name|'def'
name|'_set_power_state'
op|'('
name|'self'
op|','
name|'method'
op|','
name|'vm_ref'
op|','
name|'pwr_state'
op|'='
string|'"poweredOn"'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Sets power state for the VM."""'
newline|'\n'
name|'if'
name|'_db_content'
op|'.'
name|'get'
op|'('
string|'"VirtualMachine"'
op|','
name|'None'
op|')'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'exception'
op|'.'
name|'NotFound'
op|'('
name|'_'
op|'('
string|'"No Virtual Machine has been "'
nl|'\n'
string|'"registered yet"'
op|')'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'vm_ref'
name|'not'
name|'in'
name|'_db_content'
op|'.'
name|'get'
op|'('
string|'"VirtualMachine"'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'exception'
op|'.'
name|'NotFound'
op|'('
name|'_'
op|'('
string|'"Virtual Machine with ref %s is not "'
nl|'\n'
string|'"there"'
op|')'
op|'%'
name|'vm_ref'
op|')'
newline|'\n'
dedent|''
name|'vm_mdo'
op|'='
name|'_db_content'
op|'.'
name|'get'
op|'('
string|'"VirtualMachine"'
op|')'
op|'.'
name|'get'
op|'('
name|'vm_ref'
op|')'
newline|'\n'
name|'vm_mdo'
op|'.'
name|'set'
op|'('
string|'"runtime.powerState"'
op|','
name|'pwr_state'
op|')'
newline|'\n'
name|'task_mdo'
op|'='
name|'create_task'
op|'('
name|'method'
op|','
string|'"success"'
op|')'
newline|'\n'
name|'return'
name|'task_mdo'
op|'.'
name|'obj'
newline|'\n'
nl|'\n'
DECL|member|_retrieve_properties
dedent|''
name|'def'
name|'_retrieve_properties'
op|'('
name|'self'
op|','
name|'method'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Retrieves properties based on the type."""'
newline|'\n'
name|'spec_set'
op|'='
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"specSet"'
op|')'
op|'['
number|'0'
op|']'
newline|'\n'
name|'type'
op|'='
name|'spec_set'
op|'.'
name|'propSet'
op|'['
number|'0'
op|']'
op|'.'
name|'type'
newline|'\n'
name|'properties'
op|'='
name|'spec_set'
op|'.'
name|'propSet'
op|'['
number|'0'
op|']'
op|'.'
name|'pathSet'
newline|'\n'
name|'objs'
op|'='
name|'spec_set'
op|'.'
name|'objectSet'
newline|'\n'
name|'lst_ret_objs'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'obj'
name|'in'
name|'objs'
op|':'
newline|'\n'
indent|'            '
name|'try'
op|':'
newline|'\n'
indent|'                '
name|'obj_ref'
op|'='
name|'obj'
op|'.'
name|'obj'
newline|'\n'
comment|'# This means that we are doing a search for the managed'
nl|'\n'
comment|'# dataobjects of the type in the inventory'
nl|'\n'
name|'if'
name|'obj_ref'
op|'=='
string|'"RootFolder"'
op|':'
newline|'\n'
indent|'                    '
name|'for'
name|'mdo_ref'
name|'in'
name|'_db_content'
op|'['
name|'type'
op|']'
op|':'
newline|'\n'
indent|'                        '
name|'mdo'
op|'='
name|'_db_content'
op|'['
name|'type'
op|']'
op|'['
name|'mdo_ref'
op|']'
newline|'\n'
comment|'# Create a temp Managed object which has the same ref'
nl|'\n'
comment|'# as the parent object and copies just the properties'
nl|'\n'
comment|'# asked for. We need .obj along with the propSet of'
nl|'\n'
comment|'# just the properties asked for'
nl|'\n'
name|'temp_mdo'
op|'='
name|'ManagedObject'
op|'('
name|'mdo'
op|'.'
name|'objName'
op|','
name|'mdo'
op|'.'
name|'obj'
op|')'
newline|'\n'
name|'for'
name|'prop'
name|'in'
name|'properties'
op|':'
newline|'\n'
indent|'                            '
name|'temp_mdo'
op|'.'
name|'set'
op|'('
name|'prop'
op|','
name|'mdo'
op|'.'
name|'get'
op|'('
name|'prop'
op|')'
op|')'
newline|'\n'
dedent|''
name|'lst_ret_objs'
op|'.'
name|'append'
op|'('
name|'temp_mdo'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                    '
name|'if'
name|'obj_ref'
name|'in'
name|'_db_content'
op|'['
name|'type'
op|']'
op|':'
newline|'\n'
indent|'                        '
name|'mdo'
op|'='
name|'_db_content'
op|'['
name|'type'
op|']'
op|'['
name|'obj_ref'
op|']'
newline|'\n'
name|'temp_mdo'
op|'='
name|'ManagedObject'
op|'('
name|'mdo'
op|'.'
name|'objName'
op|','
name|'obj_ref'
op|')'
newline|'\n'
name|'for'
name|'prop'
name|'in'
name|'properties'
op|':'
newline|'\n'
indent|'                            '
name|'temp_mdo'
op|'.'
name|'set'
op|'('
name|'prop'
op|','
name|'mdo'
op|'.'
name|'get'
op|'('
name|'prop'
op|')'
op|')'
newline|'\n'
dedent|''
name|'lst_ret_objs'
op|'.'
name|'append'
op|'('
name|'temp_mdo'
op|')'
newline|'\n'
dedent|''
dedent|''
dedent|''
name|'except'
name|'Exception'
name|'as'
name|'exc'
op|':'
newline|'\n'
indent|'                '
name|'LOG'
op|'.'
name|'exception'
op|'('
name|'exc'
op|')'
newline|'\n'
name|'continue'
newline|'\n'
dedent|''
dedent|''
name|'return'
name|'lst_ret_objs'
newline|'\n'
nl|'\n'
DECL|member|_add_port_group
dedent|''
name|'def'
name|'_add_port_group'
op|'('
name|'self'
op|','
name|'method'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Adds a port group to the host system."""'
newline|'\n'
name|'_host_sk'
op|'='
name|'_db_content'
op|'['
string|'"HostSystem"'
op|']'
op|'.'
name|'keys'
op|'('
op|')'
op|'['
number|'0'
op|']'
newline|'\n'
name|'host_mdo'
op|'='
name|'_db_content'
op|'['
string|'"HostSystem"'
op|']'
op|'['
name|'_host_sk'
op|']'
newline|'\n'
name|'host_mdo'
op|'.'
name|'_add_port_group'
op|'('
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"portgrp"'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|__getattr__
dedent|''
name|'def'
name|'__getattr__'
op|'('
name|'self'
op|','
name|'attr_name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'attr_name'
op|'!='
string|'"Login"'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'_check_session'
op|'('
op|')'
newline|'\n'
dedent|''
name|'if'
name|'attr_name'
op|'=='
string|'"Login"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_login'
op|'('
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"Logout"'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'_logout'
op|'('
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"TerminateSession"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_terminate_session'
op|'('
nl|'\n'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"CreateVM_Task"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_create_vm'
op|'('
name|'attr_name'
op|','
nl|'\n'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"ReconfigVM_Task"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_reconfig_vm'
op|'('
name|'attr_name'
op|','
nl|'\n'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"CreateVirtualDisk_Task"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_create_copy_disk'
op|'('
name|'attr_name'
op|','
nl|'\n'
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"name"'
op|')'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"DeleteDatastoreFile_Task"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_delete_file'
op|'('
name|'attr_name'
op|','
nl|'\n'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"PowerOnVM_Task"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_set_power_state'
op|'('
name|'attr_name'
op|','
nl|'\n'
name|'args'
op|'['
number|'0'
op|']'
op|','
string|'"poweredOn"'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"PowerOffVM_Task"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_set_power_state'
op|'('
name|'attr_name'
op|','
nl|'\n'
name|'args'
op|'['
number|'0'
op|']'
op|','
string|'"poweredOff"'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"RebootGuest"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_just_return'
op|'('
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"ResetVM_Task"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_set_power_state'
op|'('
name|'attr_name'
op|','
nl|'\n'
name|'args'
op|'['
number|'0'
op|']'
op|','
string|'"poweredOn"'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"SuspendVM_Task"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_set_power_state'
op|'('
name|'attr_name'
op|','
nl|'\n'
name|'args'
op|'['
number|'0'
op|']'
op|','
string|'"suspended"'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"CreateSnapshot_Task"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_snapshot_vm'
op|'('
name|'attr_name'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"CopyVirtualDisk_Task"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_create_copy_disk'
op|'('
name|'attr_name'
op|','
nl|'\n'
name|'kwargs'
op|'.'
name|'get'
op|'('
string|'"destName"'
op|')'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"DeleteVirtualDisk_Task"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_delete_disk'
op|'('
name|'attr_name'
op|','
nl|'\n'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"Destroy_Task"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_unregister_vm'
op|'('
name|'attr_name'
op|','
nl|'\n'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"UnregisterVM"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_unregister_vm'
op|'('
name|'attr_name'
op|','
nl|'\n'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"SearchDatastore_Task"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_search_ds'
op|'('
name|'attr_name'
op|','
nl|'\n'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"MakeDirectory"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_make_dir'
op|'('
name|'attr_name'
op|','
nl|'\n'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"RetrieveProperties"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_retrieve_properties'
op|'('
nl|'\n'
name|'attr_name'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"AcquireCloneTicket"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_just_return'
op|'('
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"AddPortGroup"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_add_port_group'
op|'('
name|'attr_name'
op|','
nl|'\n'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"RebootHost_Task"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_just_return_task'
op|'('
name|'attr_name'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"ShutdownHost_Task"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_just_return_task'
op|'('
name|'attr_name'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"PowerDownHostToStandBy_Task"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_just_return_task'
op|'('
name|'attr_name'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"PowerUpHostFromStandBy_Task"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_just_return_task'
op|'('
name|'attr_name'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"EnterMaintenanceMode_Task"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_just_return_task'
op|'('
name|'attr_name'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'attr_name'
op|'=='
string|'"ExitMaintenanceMode_Task"'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'lambda'
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|':'
name|'self'
op|'.'
name|'_just_return_task'
op|'('
name|'attr_name'
op|')'
newline|'\n'
dedent|''
dedent|''
dedent|''
endmarker|''
end_unit
