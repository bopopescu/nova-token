begin_unit
comment|'# vim: tabstop=4 shiftwidth=4 softtabstop=4'
nl|'\r\n'
nl|'\r\n'
comment|'# Copyright (c) 2011 Citrix Systems, Inc.'
nl|'\r\n'
comment|'# Copyright 2011 OpenStack LLC.'
nl|'\r\n'
comment|'#'
nl|'\r\n'
comment|'#    Licensed under the Apache License, Version 2.0 (the "License"); you may'
nl|'\r\n'
comment|'#    not use this file except in compliance with the License. You may obtain'
nl|'\r\n'
comment|'#    a copy of the License at'
nl|'\r\n'
comment|'#'
nl|'\r\n'
comment|'#         http://www.apache.org/licenses/LICENSE-2.0'
nl|'\r\n'
comment|'#'
nl|'\r\n'
comment|'#    Unless required by applicable law or agreed to in writing, software'
nl|'\r\n'
comment|'#    distributed under the License is distributed on an "AS IS" BASIS, WITHOUT'
nl|'\r\n'
comment|'#    WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the'
nl|'\r\n'
comment|'#    License for the specific language governing permissions and limitations'
nl|'\r\n'
comment|'#    under the License.'
nl|'\r\n'
nl|'\r\n'
string|'"""\r\nThe VMware API utility module.\r\n"""'
newline|'\r\n'
nl|'\r\n'
nl|'\r\n'
DECL|function|build_selection_spec
name|'def'
name|'build_selection_spec'
op|'('
name|'client_factory'
op|','
name|'name'
op|')'
op|':'
newline|'\r\n'
indent|'    '
string|'"""Builds the selection spec."""'
newline|'\r\n'
name|'sel_spec'
op|'='
name|'client_factory'
op|'.'
name|'create'
op|'('
string|"'ns0:SelectionSpec'"
op|')'
newline|'\r\n'
name|'sel_spec'
op|'.'
name|'name'
op|'='
name|'name'
newline|'\r\n'
name|'return'
name|'sel_spec'
newline|'\r\n'
nl|'\r\n'
nl|'\r\n'
DECL|function|build_traversal_spec
dedent|''
name|'def'
name|'build_traversal_spec'
op|'('
name|'client_factory'
op|','
name|'name'
op|','
name|'spec_type'
op|','
name|'path'
op|','
name|'skip'
op|','
nl|'\r\n'
name|'select_set'
op|')'
op|':'
newline|'\r\n'
indent|'    '
string|'"""Builds the traversal spec object."""'
newline|'\r\n'
name|'traversal_spec'
op|'='
name|'client_factory'
op|'.'
name|'create'
op|'('
string|"'ns0:TraversalSpec'"
op|')'
newline|'\r\n'
name|'traversal_spec'
op|'.'
name|'name'
op|'='
name|'name'
newline|'\r\n'
name|'traversal_spec'
op|'.'
name|'type'
op|'='
name|'spec_type'
newline|'\r\n'
name|'traversal_spec'
op|'.'
name|'path'
op|'='
name|'path'
newline|'\r\n'
name|'traversal_spec'
op|'.'
name|'skip'
op|'='
name|'skip'
newline|'\r\n'
name|'traversal_spec'
op|'.'
name|'selectSet'
op|'='
name|'select_set'
newline|'\r\n'
name|'return'
name|'traversal_spec'
newline|'\r\n'
nl|'\r\n'
nl|'\r\n'
DECL|function|build_recursive_traversal_spec
dedent|''
name|'def'
name|'build_recursive_traversal_spec'
op|'('
name|'client_factory'
op|')'
op|':'
newline|'\r\n'
indent|'    '
string|'"""\r\n    Builds the Recursive Traversal Spec to traverse the object managed\r\n    object hierarchy.\r\n    """'
newline|'\r\n'
name|'visit_folders_select_spec'
op|'='
name|'build_selection_spec'
op|'('
name|'client_factory'
op|','
nl|'\r\n'
string|'"visitFolders"'
op|')'
newline|'\r\n'
comment|'# For getting to hostFolder from datacenter'
nl|'\r\n'
name|'dc_to_hf'
op|'='
name|'build_traversal_spec'
op|'('
name|'client_factory'
op|','
string|'"dc_to_hf"'
op|','
string|'"Datacenter"'
op|','
nl|'\r\n'
string|'"hostFolder"'
op|','
name|'False'
op|','
nl|'\r\n'
op|'['
name|'visit_folders_select_spec'
op|']'
op|')'
newline|'\r\n'
comment|'# For getting to vmFolder from datacenter'
nl|'\r\n'
name|'dc_to_vmf'
op|'='
name|'build_traversal_spec'
op|'('
name|'client_factory'
op|','
string|'"dc_to_vmf"'
op|','
string|'"Datacenter"'
op|','
nl|'\r\n'
string|'"vmFolder"'
op|','
name|'False'
op|','
nl|'\r\n'
op|'['
name|'visit_folders_select_spec'
op|']'
op|')'
newline|'\r\n'
comment|'# For getting Host System to virtual machine'
nl|'\r\n'
name|'h_to_vm'
op|'='
name|'build_traversal_spec'
op|'('
name|'client_factory'
op|','
string|'"h_to_vm"'
op|','
string|'"HostSystem"'
op|','
nl|'\r\n'
string|'"vm"'
op|','
name|'False'
op|','
nl|'\r\n'
op|'['
name|'visit_folders_select_spec'
op|']'
op|')'
newline|'\r\n'
nl|'\r\n'
comment|'# For getting to Host System from Compute Resource'
nl|'\r\n'
name|'cr_to_h'
op|'='
name|'build_traversal_spec'
op|'('
name|'client_factory'
op|','
string|'"cr_to_h"'
op|','
nl|'\r\n'
string|'"ComputeResource"'
op|','
string|'"host"'
op|','
name|'False'
op|','
op|'['
op|']'
op|')'
newline|'\r\n'
nl|'\r\n'
comment|'# For getting to datastore from Compute Resource'
nl|'\r\n'
name|'cr_to_ds'
op|'='
name|'build_traversal_spec'
op|'('
name|'client_factory'
op|','
string|'"cr_to_ds"'
op|','
nl|'\r\n'
string|'"ComputeResource"'
op|','
string|'"datastore"'
op|','
name|'False'
op|','
op|'['
op|']'
op|')'
newline|'\r\n'
nl|'\r\n'
name|'rp_to_rp_select_spec'
op|'='
name|'build_selection_spec'
op|'('
name|'client_factory'
op|','
string|'"rp_to_rp"'
op|')'
newline|'\r\n'
name|'rp_to_vm_select_spec'
op|'='
name|'build_selection_spec'
op|'('
name|'client_factory'
op|','
string|'"rp_to_vm"'
op|')'
newline|'\r\n'
comment|'# For getting to resource pool from Compute Resource'
nl|'\r\n'
name|'cr_to_rp'
op|'='
name|'build_traversal_spec'
op|'('
name|'client_factory'
op|','
string|'"cr_to_rp"'
op|','
nl|'\r\n'
string|'"ComputeResource"'
op|','
string|'"resourcePool"'
op|','
name|'False'
op|','
nl|'\r\n'
op|'['
name|'rp_to_rp_select_spec'
op|','
name|'rp_to_vm_select_spec'
op|']'
op|')'
newline|'\r\n'
nl|'\r\n'
comment|'# For getting to child res pool from the parent res pool'
nl|'\r\n'
name|'rp_to_rp'
op|'='
name|'build_traversal_spec'
op|'('
name|'client_factory'
op|','
string|'"rp_to_rp"'
op|','
string|'"ResourcePool"'
op|','
nl|'\r\n'
string|'"resourcePool"'
op|','
name|'False'
op|','
nl|'\r\n'
op|'['
name|'rp_to_rp_select_spec'
op|','
name|'rp_to_vm_select_spec'
op|']'
op|')'
newline|'\r\n'
nl|'\r\n'
comment|'# For getting to Virtual Machine from the Resource Pool'
nl|'\r\n'
name|'rp_to_vm'
op|'='
name|'build_traversal_spec'
op|'('
name|'client_factory'
op|','
string|'"rp_to_vm"'
op|','
string|'"ResourcePool"'
op|','
nl|'\r\n'
string|'"vm"'
op|','
name|'False'
op|','
nl|'\r\n'
op|'['
name|'rp_to_rp_select_spec'
op|','
name|'rp_to_vm_select_spec'
op|']'
op|')'
newline|'\r\n'
nl|'\r\n'
comment|'# Get the assorted traversal spec which takes care of the objects to'
nl|'\r\n'
comment|'# be searched for from the root folder'
nl|'\r\n'
name|'traversal_spec'
op|'='
name|'build_traversal_spec'
op|'('
name|'client_factory'
op|','
string|'"visitFolders"'
op|','
nl|'\r\n'
string|'"Folder"'
op|','
string|'"childEntity"'
op|','
name|'False'
op|','
nl|'\r\n'
op|'['
name|'visit_folders_select_spec'
op|','
name|'dc_to_hf'
op|','
nl|'\r\n'
name|'dc_to_vmf'
op|','
name|'cr_to_ds'
op|','
name|'cr_to_h'
op|','
name|'cr_to_rp'
op|','
nl|'\r\n'
name|'rp_to_rp'
op|','
name|'h_to_vm'
op|','
name|'rp_to_vm'
op|']'
op|')'
newline|'\r\n'
name|'return'
name|'traversal_spec'
newline|'\r\n'
nl|'\r\n'
nl|'\r\n'
DECL|function|build_property_spec
dedent|''
name|'def'
name|'build_property_spec'
op|'('
name|'client_factory'
op|','
name|'type'
op|'='
string|'"VirtualMachine"'
op|','
nl|'\r\n'
name|'properties_to_collect'
op|'='
name|'None'
op|','
nl|'\r\n'
name|'all_properties'
op|'='
name|'False'
op|')'
op|':'
newline|'\r\n'
indent|'    '
string|'"""Builds the Property Spec."""'
newline|'\r\n'
name|'if'
name|'not'
name|'properties_to_collect'
op|':'
newline|'\r\n'
indent|'        '
name|'properties_to_collect'
op|'='
op|'['
string|'"name"'
op|']'
newline|'\r\n'
nl|'\r\n'
dedent|''
name|'property_spec'
op|'='
name|'client_factory'
op|'.'
name|'create'
op|'('
string|"'ns0:PropertySpec'"
op|')'
newline|'\r\n'
name|'property_spec'
op|'.'
name|'all'
op|'='
name|'all_properties'
newline|'\r\n'
name|'property_spec'
op|'.'
name|'pathSet'
op|'='
name|'properties_to_collect'
newline|'\r\n'
name|'property_spec'
op|'.'
name|'type'
op|'='
name|'type'
newline|'\r\n'
name|'return'
name|'property_spec'
newline|'\r\n'
nl|'\r\n'
nl|'\r\n'
DECL|function|build_object_spec
dedent|''
name|'def'
name|'build_object_spec'
op|'('
name|'client_factory'
op|','
name|'root_folder'
op|','
name|'traversal_specs'
op|')'
op|':'
newline|'\r\n'
indent|'    '
string|'"""Builds the object Spec."""'
newline|'\r\n'
name|'object_spec'
op|'='
name|'client_factory'
op|'.'
name|'create'
op|'('
string|"'ns0:ObjectSpec'"
op|')'
newline|'\r\n'
name|'object_spec'
op|'.'
name|'obj'
op|'='
name|'root_folder'
newline|'\r\n'
name|'object_spec'
op|'.'
name|'skip'
op|'='
name|'False'
newline|'\r\n'
name|'object_spec'
op|'.'
name|'selectSet'
op|'='
name|'traversal_specs'
newline|'\r\n'
name|'return'
name|'object_spec'
newline|'\r\n'
nl|'\r\n'
nl|'\r\n'
DECL|function|build_property_filter_spec
dedent|''
name|'def'
name|'build_property_filter_spec'
op|'('
name|'client_factory'
op|','
name|'property_specs'
op|','
name|'object_specs'
op|')'
op|':'
newline|'\r\n'
indent|'    '
string|'"""Builds the Property Filter Spec."""'
newline|'\r\n'
name|'property_filter_spec'
op|'='
name|'client_factory'
op|'.'
name|'create'
op|'('
string|"'ns0:PropertyFilterSpec'"
op|')'
newline|'\r\n'
name|'property_filter_spec'
op|'.'
name|'propSet'
op|'='
name|'property_specs'
newline|'\r\n'
name|'property_filter_spec'
op|'.'
name|'objectSet'
op|'='
name|'object_specs'
newline|'\r\n'
name|'return'
name|'property_filter_spec'
newline|'\r\n'
nl|'\r\n'
nl|'\r\n'
DECL|function|get_object_properties
dedent|''
name|'def'
name|'get_object_properties'
op|'('
name|'vim'
op|','
name|'collector'
op|','
name|'mobj'
op|','
name|'type'
op|','
name|'properties'
op|')'
op|':'
newline|'\r\n'
indent|'    '
string|'"""Gets the properties of the Managed object specified."""'
newline|'\r\n'
name|'client_factory'
op|'='
name|'vim'
op|'.'
name|'client'
op|'.'
name|'factory'
newline|'\r\n'
name|'if'
name|'mobj'
name|'is'
name|'None'
op|':'
newline|'\r\n'
indent|'        '
name|'return'
name|'None'
newline|'\r\n'
dedent|''
name|'usecoll'
op|'='
name|'collector'
newline|'\r\n'
name|'if'
name|'usecoll'
name|'is'
name|'None'
op|':'
newline|'\r\n'
indent|'        '
name|'usecoll'
op|'='
name|'vim'
op|'.'
name|'get_service_content'
op|'('
op|')'
op|'.'
name|'propertyCollector'
newline|'\r\n'
dedent|''
name|'property_filter_spec'
op|'='
name|'client_factory'
op|'.'
name|'create'
op|'('
string|"'ns0:PropertyFilterSpec'"
op|')'
newline|'\r\n'
name|'property_spec'
op|'='
name|'client_factory'
op|'.'
name|'create'
op|'('
string|"'ns0:PropertySpec'"
op|')'
newline|'\r\n'
name|'property_spec'
op|'.'
name|'all'
op|'='
op|'('
name|'properties'
name|'is'
name|'None'
name|'or'
name|'len'
op|'('
name|'properties'
op|')'
op|'=='
number|'0'
op|')'
newline|'\r\n'
name|'property_spec'
op|'.'
name|'pathSet'
op|'='
name|'properties'
newline|'\r\n'
name|'property_spec'
op|'.'
name|'type'
op|'='
name|'type'
newline|'\r\n'
name|'object_spec'
op|'='
name|'client_factory'
op|'.'
name|'create'
op|'('
string|"'ns0:ObjectSpec'"
op|')'
newline|'\r\n'
name|'object_spec'
op|'.'
name|'obj'
op|'='
name|'mobj'
newline|'\r\n'
name|'object_spec'
op|'.'
name|'skip'
op|'='
name|'False'
newline|'\r\n'
name|'property_filter_spec'
op|'.'
name|'propSet'
op|'='
op|'['
name|'property_spec'
op|']'
newline|'\r\n'
name|'property_filter_spec'
op|'.'
name|'objectSet'
op|'='
op|'['
name|'object_spec'
op|']'
newline|'\r\n'
name|'return'
name|'vim'
op|'.'
name|'RetrieveProperties'
op|'('
name|'usecoll'
op|','
name|'specSet'
op|'='
op|'['
name|'property_filter_spec'
op|']'
op|')'
newline|'\r\n'
nl|'\r\n'
nl|'\r\n'
DECL|function|get_dynamic_property
dedent|''
name|'def'
name|'get_dynamic_property'
op|'('
name|'vim'
op|','
name|'mobj'
op|','
name|'type'
op|','
name|'property_name'
op|')'
op|':'
newline|'\r\n'
indent|'    '
string|'"""Gets a particular property of the Managed Object."""'
newline|'\r\n'
name|'obj_content'
op|'='
name|'get_object_properties'
op|'('
name|'vim'
op|','
name|'None'
op|','
name|'mobj'
op|','
name|'type'
op|','
op|'['
name|'property_name'
op|']'
op|')'
newline|'\r\n'
name|'property_value'
op|'='
name|'None'
newline|'\r\n'
name|'if'
name|'obj_content'
op|':'
newline|'\r\n'
indent|'        '
name|'dynamic_property'
op|'='
name|'obj_content'
op|'['
number|'0'
op|']'
op|'.'
name|'propSet'
newline|'\r\n'
name|'if'
name|'dynamic_property'
op|':'
newline|'\r\n'
indent|'            '
name|'property_value'
op|'='
name|'dynamic_property'
op|'['
number|'0'
op|']'
op|'.'
name|'val'
newline|'\r\n'
dedent|''
dedent|''
name|'return'
name|'property_value'
newline|'\r\n'
nl|'\r\n'
nl|'\r\n'
DECL|function|get_objects
dedent|''
name|'def'
name|'get_objects'
op|'('
name|'vim'
op|','
name|'type'
op|','
name|'properties_to_collect'
op|'='
name|'None'
op|','
name|'all'
op|'='
name|'False'
op|')'
op|':'
newline|'\r\n'
indent|'    '
string|'"""Gets the list of objects of the type specified."""'
newline|'\r\n'
name|'if'
name|'not'
name|'properties_to_collect'
op|':'
newline|'\r\n'
indent|'        '
name|'properties_to_collect'
op|'='
op|'['
string|'"name"'
op|']'
newline|'\r\n'
nl|'\r\n'
dedent|''
name|'client_factory'
op|'='
name|'vim'
op|'.'
name|'client'
op|'.'
name|'factory'
newline|'\r\n'
name|'object_spec'
op|'='
name|'build_object_spec'
op|'('
name|'client_factory'
op|','
nl|'\r\n'
name|'vim'
op|'.'
name|'get_service_content'
op|'('
op|')'
op|'.'
name|'rootFolder'
op|','
nl|'\r\n'
op|'['
name|'build_recursive_traversal_spec'
op|'('
name|'client_factory'
op|')'
op|']'
op|')'
newline|'\r\n'
name|'property_spec'
op|'='
name|'build_property_spec'
op|'('
name|'client_factory'
op|','
name|'type'
op|'='
name|'type'
op|','
nl|'\r\n'
name|'properties_to_collect'
op|'='
name|'properties_to_collect'
op|','
nl|'\r\n'
name|'all_properties'
op|'='
name|'all'
op|')'
newline|'\r\n'
name|'property_filter_spec'
op|'='
name|'build_property_filter_spec'
op|'('
name|'client_factory'
op|','
nl|'\r\n'
op|'['
name|'property_spec'
op|']'
op|','
nl|'\r\n'
op|'['
name|'object_spec'
op|']'
op|')'
newline|'\r\n'
name|'return'
name|'vim'
op|'.'
name|'RetrieveProperties'
op|'('
name|'vim'
op|'.'
name|'get_service_content'
op|'('
op|')'
op|'.'
name|'propertyCollector'
op|','
nl|'\r\n'
name|'specSet'
op|'='
op|'['
name|'property_filter_spec'
op|']'
op|')'
newline|'\r\n'
nl|'\r\n'
nl|'\r\n'
DECL|function|get_prop_spec
dedent|''
name|'def'
name|'get_prop_spec'
op|'('
name|'client_factory'
op|','
name|'spec_type'
op|','
name|'properties'
op|')'
op|':'
newline|'\r\n'
indent|'    '
string|'"""Builds the Property Spec Object."""'
newline|'\r\n'
name|'prop_spec'
op|'='
name|'client_factory'
op|'.'
name|'create'
op|'('
string|"'ns0:PropertySpec'"
op|')'
newline|'\r\n'
name|'prop_spec'
op|'.'
name|'type'
op|'='
name|'spec_type'
newline|'\r\n'
name|'prop_spec'
op|'.'
name|'pathSet'
op|'='
name|'properties'
newline|'\r\n'
name|'return'
name|'prop_spec'
newline|'\r\n'
nl|'\r\n'
nl|'\r\n'
DECL|function|get_obj_spec
dedent|''
name|'def'
name|'get_obj_spec'
op|'('
name|'client_factory'
op|','
name|'obj'
op|','
name|'select_set'
op|'='
name|'None'
op|')'
op|':'
newline|'\r\n'
indent|'    '
string|'"""Builds the Object Spec object."""'
newline|'\r\n'
name|'obj_spec'
op|'='
name|'client_factory'
op|'.'
name|'create'
op|'('
string|"'ns0:ObjectSpec'"
op|')'
newline|'\r\n'
name|'obj_spec'
op|'.'
name|'obj'
op|'='
name|'obj'
newline|'\r\n'
name|'obj_spec'
op|'.'
name|'skip'
op|'='
name|'False'
newline|'\r\n'
name|'if'
name|'select_set'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\r\n'
indent|'        '
name|'obj_spec'
op|'.'
name|'selectSet'
op|'='
name|'select_set'
newline|'\r\n'
dedent|''
name|'return'
name|'obj_spec'
newline|'\r\n'
nl|'\r\n'
nl|'\r\n'
DECL|function|get_prop_filter_spec
dedent|''
name|'def'
name|'get_prop_filter_spec'
op|'('
name|'client_factory'
op|','
name|'obj_spec'
op|','
name|'prop_spec'
op|')'
op|':'
newline|'\r\n'
indent|'    '
string|'"""Builds the Property Filter Spec Object."""'
newline|'\r\n'
name|'prop_filter_spec'
op|'='
name|'client_factory'
op|'.'
name|'create'
op|'('
string|"'ns0:PropertyFilterSpec'"
op|')'
newline|'\r\n'
name|'prop_filter_spec'
op|'.'
name|'propSet'
op|'='
name|'prop_spec'
newline|'\r\n'
name|'prop_filter_spec'
op|'.'
name|'objectSet'
op|'='
name|'obj_spec'
newline|'\r\n'
name|'return'
name|'prop_filter_spec'
newline|'\r\n'
nl|'\r\n'
nl|'\r\n'
DECL|function|get_properties_for_a_collection_of_objects
dedent|''
name|'def'
name|'get_properties_for_a_collection_of_objects'
op|'('
name|'vim'
op|','
name|'type'
op|','
nl|'\r\n'
name|'obj_list'
op|','
name|'properties'
op|')'
op|':'
newline|'\r\n'
indent|'    '
string|'"""\r\n    Gets the list of properties for the collection of\r\n    objects of the type specified.\r\n    """'
newline|'\r\n'
name|'client_factory'
op|'='
name|'vim'
op|'.'
name|'client'
op|'.'
name|'factory'
newline|'\r\n'
name|'if'
name|'len'
op|'('
name|'obj_list'
op|')'
op|'=='
number|'0'
op|':'
newline|'\r\n'
indent|'        '
name|'return'
op|'['
op|']'
newline|'\r\n'
dedent|''
name|'prop_spec'
op|'='
name|'get_prop_spec'
op|'('
name|'client_factory'
op|','
name|'type'
op|','
name|'properties'
op|')'
newline|'\r\n'
name|'lst_obj_specs'
op|'='
op|'['
op|']'
newline|'\r\n'
name|'for'
name|'obj'
name|'in'
name|'obj_list'
op|':'
newline|'\r\n'
indent|'        '
name|'lst_obj_specs'
op|'.'
name|'append'
op|'('
name|'get_obj_spec'
op|'('
name|'client_factory'
op|','
name|'obj'
op|')'
op|')'
newline|'\r\n'
dedent|''
name|'prop_filter_spec'
op|'='
name|'get_prop_filter_spec'
op|'('
name|'client_factory'
op|','
nl|'\r\n'
name|'lst_obj_specs'
op|','
op|'['
name|'prop_spec'
op|']'
op|')'
newline|'\r\n'
name|'return'
name|'vim'
op|'.'
name|'RetrieveProperties'
op|'('
name|'vim'
op|'.'
name|'get_service_content'
op|'('
op|')'
op|'.'
name|'propertyCollector'
op|','
nl|'\r\n'
name|'specSet'
op|'='
op|'['
name|'prop_filter_spec'
op|']'
op|')'
newline|'\r\n'
dedent|''
endmarker|''
end_unit
