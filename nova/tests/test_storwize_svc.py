begin_unit
comment|'# vim: tabstop=4 shiftwidth=4 softtabstop=4'
nl|'\n'
nl|'\n'
comment|'# Copyright (c) 2012 IBM, Inc.'
nl|'\n'
comment|'# Copyright (c) 2012 OpenStack LLC.'
nl|'\n'
comment|'# All Rights Reserved.'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#    Licensed under the Apache License, Version 2.0 (the "License"); you may'
nl|'\n'
comment|'#    not use this file except in compliance with the License. You may obtain'
nl|'\n'
comment|'#    a copy of the License at'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#         http://www.apache.org/licenses/LICENSE-2.0'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#    Unless required by applicable law or agreed to in writing, software'
nl|'\n'
comment|'#    distributed under the License is distributed on an "AS IS" BASIS, WITHOUT'
nl|'\n'
comment|'#    WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the'
nl|'\n'
comment|'#    License for the specific language governing permissions and limitations'
nl|'\n'
comment|'#    under the License.'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# Authors:'
nl|'\n'
comment|'#   Ronen Kat <ronenkat@il.ibm.com>'
nl|'\n'
comment|'#   Avishay Traeger <avishay@il.ibm.com>'
nl|'\n'
nl|'\n'
string|'"""\nTests for the IBM Storwize V7000 and SVC volume driver.\n"""'
newline|'\n'
nl|'\n'
name|'import'
name|'random'
newline|'\n'
name|'import'
name|'socket'
newline|'\n'
nl|'\n'
name|'from'
name|'nova'
name|'import'
name|'exception'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'openstack'
op|'.'
name|'common'
name|'import'
name|'excutils'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'openstack'
op|'.'
name|'common'
name|'import'
name|'log'
name|'as'
name|'logging'
newline|'\n'
name|'from'
name|'nova'
name|'import'
name|'test'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'volume'
name|'import'
name|'storwize_svc'
newline|'\n'
nl|'\n'
DECL|variable|LOG
name|'LOG'
op|'='
name|'logging'
op|'.'
name|'getLogger'
op|'('
name|'__name__'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|StorwizeSVCManagementSimulator
name|'class'
name|'StorwizeSVCManagementSimulator'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'pool_name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_flags'
op|'='
op|'{'
string|'"storwize_svc_volpool_name"'
op|':'
name|'pool_name'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'_volumes_list'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'_hosts_list'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'_mappings_list'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'_fcmappings_list'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'_next_cmd_error'
op|'='
op|'{'
nl|'\n'
string|'"lsportip"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"lsnodecanister"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"lsvdisk"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"lsfcmap"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"prestartfcmap"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"startfcmap"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"rmfcmap"'
op|':'
string|'""'
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'_errors'
op|'='
op|'{'
nl|'\n'
string|'"CMMVC5701E"'
op|':'
op|'('
string|'""'
op|','
string|'"CMMVC5701E No object ID was specified."'
op|')'
op|','
nl|'\n'
string|'"CMMVC6035E"'
op|':'
op|'('
string|'""'
op|','
string|'"CMMVC6035E The action failed as the "'
op|'+'
nl|'\n'
string|'"object already exists."'
op|')'
op|','
nl|'\n'
string|'"CMMVC5753E"'
op|':'
op|'('
string|'""'
op|','
string|'"CMMVC5753E The specified object does not "'
op|'+'
nl|'\n'
string|'"exist or is not a suitable candidate."'
op|')'
op|','
nl|'\n'
string|'"CMMVC5707E"'
op|':'
op|'('
string|'""'
op|','
string|'"CMMVC5707E Required parameters are missing."'
op|')'
op|','
nl|'\n'
string|'"CMMVC6581E"'
op|':'
op|'('
string|'""'
op|','
string|'"CMMVC6581E The command has failed because "'
op|'+'
nl|'\n'
string|'"the maximum number of allowed iSCSI "'
op|'+'
nl|'\n'
string|'"qualified names (IQNs) has been reached, "'
op|'+'
nl|'\n'
string|'"or the IQN is already assigned or is not "'
op|'+'
nl|'\n'
string|'"valid."'
op|')'
op|','
nl|'\n'
string|'"CMMVC5754E"'
op|':'
op|'('
string|'""'
op|','
string|'"CMMVC5754E The specified object does not "'
op|'+'
nl|'\n'
string|'"exist, or the name supplied does not meet "'
op|'+'
nl|'\n'
string|'"the naming rules."'
op|')'
op|','
nl|'\n'
string|'"CMMVC6071E"'
op|':'
op|'('
string|'""'
op|','
string|'"CMMVC6071E The VDisk-to-host mapping was "'
op|'+'
nl|'\n'
string|'"not created because the VDisk is already "'
op|'+'
nl|'\n'
string|'"mapped to a host."'
op|')'
op|','
nl|'\n'
string|'"CMMVC5879E"'
op|':'
op|'('
string|'""'
op|','
string|'"CMMVC5879E The VDisk-to-host mapping was "'
op|'+'
nl|'\n'
string|'"not created because a VDisk is already "'
op|'+'
nl|'\n'
string|'"mapped to this host with this SCSI LUN."'
op|')'
op|','
nl|'\n'
string|'"CMMVC5840E"'
op|':'
op|'('
string|'""'
op|','
string|'"CMMVC5840E The virtual disk (VDisk) was "'
op|'+'
nl|'\n'
string|'"not deleted because it is mapped to a "'
op|'+'
nl|'\n'
string|'"host or because it is part of a FlashCopy "'
op|'+'
nl|'\n'
string|'"or Remote Copy mapping, or is involved in "'
op|'+'
nl|'\n'
string|'"an image mode migrate."'
op|')'
op|','
nl|'\n'
string|'"CMMVC6527E"'
op|':'
op|'('
string|'""'
op|','
string|'"CMMVC6527E The name that you have entered "'
op|'+'
nl|'\n'
string|'"is not valid. The name can contain letters, "'
op|'+'
nl|'\n'
string|'"numbers, spaces, periods, dashes, and "'
op|'+'
nl|'\n'
string|'"underscores. The name must begin with a "'
op|'+'
nl|'\n'
string|'"letter or an underscore. The name must not "'
op|'+'
nl|'\n'
string|'"begin or end with a space."'
op|')'
op|','
nl|'\n'
string|'"CMMVC5871E"'
op|':'
op|'('
string|'""'
op|','
string|'"CMMVC5871E The action failed because one or "'
op|'+'
nl|'\n'
string|'"more of the configured port names is in a "'
op|'+'
nl|'\n'
string|'"mapping."'
op|')'
op|','
nl|'\n'
string|'"CMMVC5924E"'
op|':'
op|'('
string|'""'
op|','
string|'"CMMVC5924E The FlashCopy mapping was not "'
op|'+'
nl|'\n'
string|'"created because the source and target "'
op|'+'
nl|'\n'
string|'"virtual disks (VDisks) are different sizes."'
op|')'
op|','
nl|'\n'
string|'"CMMVC6303E"'
op|':'
op|'('
string|'""'
op|','
string|'"CMMVC6303E The create failed because the "'
op|'+'
nl|'\n'
string|'"source and target VDisks are the same."'
op|')'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
comment|'# Find an unused ID'
nl|'\n'
DECL|member|_find_unused_id
dedent|''
name|'def'
name|'_find_unused_id'
op|'('
name|'self'
op|','
name|'d'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'ids'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'k'
op|','
name|'v'
name|'in'
name|'d'
op|'.'
name|'iteritems'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'ids'
op|'.'
name|'append'
op|'('
name|'int'
op|'('
name|'v'
op|'['
string|'"id"'
op|']'
op|')'
op|')'
newline|'\n'
dedent|''
name|'ids'
op|'.'
name|'sort'
op|'('
op|')'
newline|'\n'
name|'for'
name|'index'
op|','
name|'n'
name|'in'
name|'enumerate'
op|'('
name|'ids'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'n'
op|'>'
name|'index'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'str'
op|'('
name|'index'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'return'
name|'str'
op|'('
name|'len'
op|'('
name|'ids'
op|')'
op|')'
newline|'\n'
nl|'\n'
comment|'# Check if name is valid'
nl|'\n'
DECL|member|_is_invalid_name
dedent|''
name|'def'
name|'_is_invalid_name'
op|'('
name|'self'
op|','
name|'name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
op|'('
name|'name'
op|'['
number|'0'
op|']'
op|'=='
string|'" "'
op|')'
name|'or'
op|'('
name|'name'
op|'['
op|'-'
number|'1'
op|']'
op|'=='
string|'" "'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'True'
newline|'\n'
dedent|''
name|'for'
name|'c'
name|'in'
name|'name'
op|':'
newline|'\n'
indent|'            '
name|'if'
op|'('
op|'('
name|'not'
name|'c'
op|'.'
name|'isalnum'
op|'('
op|')'
op|')'
name|'and'
op|'('
name|'c'
op|'!='
string|'" "'
op|')'
name|'and'
op|'('
name|'c'
op|'!='
string|'"."'
op|')'
nl|'\n'
name|'and'
op|'('
name|'c'
op|'!='
string|'"-"'
op|')'
name|'and'
op|'('
name|'c'
op|'!='
string|'"_"'
op|')'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'True'
newline|'\n'
dedent|''
dedent|''
name|'return'
name|'False'
newline|'\n'
nl|'\n'
comment|'# Convert argument string to dictionary'
nl|'\n'
DECL|member|_cmd_to_dict
dedent|''
name|'def'
name|'_cmd_to_dict'
op|'('
name|'self'
op|','
name|'cmd'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'arg_list'
op|'='
name|'cmd'
op|'.'
name|'split'
op|'('
op|')'
newline|'\n'
name|'no_param_args'
op|'='
op|'['
nl|'\n'
string|'"autodelete"'
op|','
nl|'\n'
string|'"autoexpand"'
op|','
nl|'\n'
string|'"bytes"'
op|','
nl|'\n'
string|'"compressed"'
op|','
nl|'\n'
string|'"force"'
op|','
nl|'\n'
string|'"nohdr"'
op|','
nl|'\n'
op|']'
newline|'\n'
name|'one_param_args'
op|'='
op|'['
nl|'\n'
string|'"cleanrate"'
op|','
nl|'\n'
string|'"delim"'
op|','
nl|'\n'
string|'"filtervalue"'
op|','
nl|'\n'
string|'"grainsize"'
op|','
nl|'\n'
string|'"host"'
op|','
nl|'\n'
string|'"iogrp"'
op|','
nl|'\n'
string|'"iscsiname"'
op|','
nl|'\n'
string|'"mdiskgrp"'
op|','
nl|'\n'
string|'"name"'
op|','
nl|'\n'
string|'"rsize"'
op|','
nl|'\n'
string|'"scsi"'
op|','
nl|'\n'
string|'"size"'
op|','
nl|'\n'
string|'"source"'
op|','
nl|'\n'
string|'"target"'
op|','
nl|'\n'
string|'"unit"'
op|','
nl|'\n'
string|'"vtype"'
op|','
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
comment|'# Handle the special case of lsnode which is a two-word command'
nl|'\n'
comment|'# Use the one word version of the command internally'
nl|'\n'
name|'if'
name|'arg_list'
op|'['
number|'0'
op|']'
op|'=='
string|'"svcinfo"'
name|'and'
name|'arg_list'
op|'['
number|'1'
op|']'
op|'=='
string|'"lsnode"'
op|':'
newline|'\n'
indent|'            '
name|'ret'
op|'='
op|'{'
string|'"cmd"'
op|':'
string|'"lsnodecanister"'
op|'}'
newline|'\n'
name|'arg_list'
op|'.'
name|'pop'
op|'('
number|'0'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'ret'
op|'='
op|'{'
string|'"cmd"'
op|':'
name|'arg_list'
op|'['
number|'0'
op|']'
op|'}'
newline|'\n'
nl|'\n'
dedent|''
name|'skip'
op|'='
name|'False'
newline|'\n'
name|'for'
name|'i'
name|'in'
name|'range'
op|'('
number|'1'
op|','
name|'len'
op|'('
name|'arg_list'
op|')'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'skip'
op|':'
newline|'\n'
indent|'                '
name|'skip'
op|'='
name|'False'
newline|'\n'
name|'continue'
newline|'\n'
dedent|''
name|'if'
name|'arg_list'
op|'['
name|'i'
op|']'
op|'['
number|'0'
op|']'
op|'=='
string|'"-"'
op|':'
newline|'\n'
indent|'                '
name|'if'
name|'arg_list'
op|'['
name|'i'
op|']'
op|'['
number|'1'
op|':'
op|']'
name|'in'
name|'no_param_args'
op|':'
newline|'\n'
indent|'                    '
name|'ret'
op|'['
name|'arg_list'
op|'['
name|'i'
op|']'
op|'['
number|'1'
op|':'
op|']'
op|']'
op|'='
name|'True'
newline|'\n'
dedent|''
name|'elif'
name|'arg_list'
op|'['
name|'i'
op|']'
op|'['
number|'1'
op|':'
op|']'
name|'in'
name|'one_param_args'
op|':'
newline|'\n'
indent|'                    '
name|'ret'
op|'['
name|'arg_list'
op|'['
name|'i'
op|']'
op|'['
number|'1'
op|':'
op|']'
op|']'
op|'='
name|'arg_list'
op|'['
name|'i'
op|'+'
number|'1'
op|']'
newline|'\n'
name|'skip'
op|'='
name|'True'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                    '
name|'raise'
name|'exception'
op|'.'
name|'InvalidInput'
op|'('
nl|'\n'
name|'reason'
op|'='
name|'_'
op|'('
string|"'unrecognized argument %s'"
op|')'
op|'%'
name|'arg_list'
op|'['
name|'i'
op|']'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'ret'
op|'['
string|'"obj"'
op|']'
op|'='
name|'arg_list'
op|'['
name|'i'
op|']'
newline|'\n'
dedent|''
dedent|''
name|'return'
name|'ret'
newline|'\n'
nl|'\n'
comment|'# Generic function for printing information'
nl|'\n'
DECL|member|_print_info_cmd
dedent|''
name|'def'
name|'_print_info_cmd'
op|'('
name|'self'
op|','
name|'rows'
op|','
name|'delim'
op|'='
string|'" "'
op|','
name|'nohdr'
op|'='
name|'False'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'nohdr'
op|':'
newline|'\n'
indent|'                '
name|'del'
name|'rows'
op|'['
number|'0'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'for'
name|'index'
name|'in'
name|'range'
op|'('
name|'len'
op|'('
name|'rows'
op|')'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'rows'
op|'['
name|'index'
op|']'
op|'='
name|'delim'
op|'.'
name|'join'
op|'('
name|'rows'
op|'['
name|'index'
op|']'
op|')'
newline|'\n'
dedent|''
name|'return'
op|'('
string|'"%s"'
op|'%'
string|'"\\n"'
op|'.'
name|'join'
op|'('
name|'rows'
op|')'
op|','
string|'""'
op|')'
newline|'\n'
nl|'\n'
comment|'# Print mostly made-up stuff in the correct syntax'
nl|'\n'
DECL|member|_cmd_lsmdiskgrp
dedent|''
name|'def'
name|'_cmd_lsmdiskgrp'
op|'('
name|'self'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'rows'
op|'='
op|'['
name|'None'
op|']'
op|'*'
number|'2'
newline|'\n'
name|'rows'
op|'['
number|'0'
op|']'
op|'='
op|'['
string|'"id"'
op|','
string|'"name"'
op|','
string|'"status"'
op|','
string|'"mdisk_count"'
op|','
nl|'\n'
string|'"vdisk_count capacity"'
op|','
string|'"extent_size"'
op|','
string|'"free_capacity"'
op|','
nl|'\n'
string|'"virtual_capacity"'
op|','
string|'"used_capacity"'
op|','
string|'"real_capacity"'
op|','
nl|'\n'
string|'"overallocation"'
op|','
string|'"warning"'
op|','
string|'"easy_tier"'
op|','
nl|'\n'
string|'"easy_tier_status"'
op|']'
newline|'\n'
name|'rows'
op|'['
number|'1'
op|']'
op|'='
op|'['
string|'"0"'
op|','
name|'self'
op|'.'
name|'_flags'
op|'['
string|'"storwize_svc_volpool_name"'
op|']'
op|','
string|'"online"'
op|','
nl|'\n'
string|'"1"'
op|','
name|'str'
op|'('
name|'len'
op|'('
name|'self'
op|'.'
name|'_volumes_list'
op|')'
op|')'
op|','
string|'"3.25TB"'
op|','
string|'"256"'
op|','
nl|'\n'
string|'"3.21TB"'
op|','
string|'"1.54TB"'
op|','
string|'"264.97MB"'
op|','
string|'"35.58GB"'
op|','
string|'"47"'
op|','
string|'"80"'
op|','
nl|'\n'
string|'"auto"'
op|','
string|'"inactive"'
op|']'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'_print_info_cmd'
op|'('
name|'rows'
op|'='
name|'rows'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
nl|'\n'
comment|'# Print mostly made-up stuff in the correct syntax'
nl|'\n'
DECL|member|_cmd_lsnodecanister
dedent|''
name|'def'
name|'_cmd_lsnodecanister'
op|'('
name|'self'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'rows'
op|'='
op|'['
name|'None'
op|']'
op|'*'
number|'3'
newline|'\n'
name|'rows'
op|'['
number|'0'
op|']'
op|'='
op|'['
string|'"id"'
op|','
string|'"name"'
op|','
string|'"UPS_serial_number"'
op|','
string|'"WWNN"'
op|','
string|'"status"'
op|','
nl|'\n'
string|'"IO_group_id"'
op|','
string|'"IO_group_name"'
op|','
string|'"config_node"'
op|','
nl|'\n'
string|'"UPS_unique_id"'
op|','
string|'"hardware"'
op|','
string|'"iscsi_name"'
op|','
string|'"iscsi_alias"'
op|','
nl|'\n'
string|'"panel_name"'
op|','
string|'"enclosure_id"'
op|','
string|'"canister_id"'
op|','
nl|'\n'
string|'"enclosure_serial_number"'
op|']'
newline|'\n'
name|'rows'
op|'['
number|'1'
op|']'
op|'='
op|'['
string|'"5"'
op|','
string|'"node1"'
op|','
string|'""'
op|','
string|'"123456789ABCDEF0"'
op|','
string|'"online"'
op|','
string|'"0"'
op|','
nl|'\n'
string|'"io_grp0"'
op|','
nl|'\n'
string|'"yes"'
op|','
string|'"123456789ABCDEF0"'
op|','
string|'"100"'
op|','
nl|'\n'
string|'"iqn.1982-01.com.ibm:1234.sim.node1"'
op|','
string|'""'
op|','
string|'"01-1"'
op|','
string|'"1"'
op|','
string|'"1"'
op|','
nl|'\n'
string|'"0123ABC"'
op|']'
newline|'\n'
name|'rows'
op|'['
number|'2'
op|']'
op|'='
op|'['
string|'"6"'
op|','
string|'"node2"'
op|','
string|'""'
op|','
string|'"123456789ABCDEF1"'
op|','
string|'"online"'
op|','
string|'"0"'
op|','
nl|'\n'
string|'"io_grp0"'
op|','
nl|'\n'
string|'"no"'
op|','
string|'"123456789ABCDEF1"'
op|','
string|'"100"'
op|','
nl|'\n'
string|'"iqn.1982-01.com.ibm:1234.sim.node2"'
op|','
string|'""'
op|','
string|'"01-2"'
op|','
string|'"1"'
op|','
string|'"2"'
op|','
nl|'\n'
string|'"0123ABC"'
op|']'
newline|'\n'
nl|'\n'
name|'if'
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"lsnodecanister"'
op|']'
op|'=='
string|'"header_mismatch"'
op|':'
newline|'\n'
indent|'            '
name|'rows'
op|'['
number|'0'
op|']'
op|'.'
name|'pop'
op|'('
number|'2'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"lsnodecanister"'
op|']'
op|'='
string|'""'
newline|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"lsnodecanister"'
op|']'
op|'=='
string|'"remove_field"'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'row'
name|'in'
name|'rows'
op|':'
newline|'\n'
indent|'                '
name|'row'
op|'.'
name|'pop'
op|'('
number|'0'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"lsnodecanister"'
op|']'
op|'='
string|'""'
newline|'\n'
nl|'\n'
dedent|''
name|'return'
name|'self'
op|'.'
name|'_print_info_cmd'
op|'('
name|'rows'
op|'='
name|'rows'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
nl|'\n'
comment|'# Print mostly made-up stuff in the correct syntax'
nl|'\n'
DECL|member|_cmd_lsportip
dedent|''
name|'def'
name|'_cmd_lsportip'
op|'('
name|'self'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"lsportip"'
op|']'
op|'=='
string|'"ip_no_config"'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"lsportip"'
op|']'
op|'='
string|'""'
newline|'\n'
name|'ip_addr1'
op|'='
string|'""'
newline|'\n'
name|'ip_addr2'
op|'='
string|'""'
newline|'\n'
name|'gw'
op|'='
string|'""'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'ip_addr1'
op|'='
string|'"1.234.56.78"'
newline|'\n'
name|'ip_addr2'
op|'='
string|'"1.234.56.79"'
newline|'\n'
name|'gw'
op|'='
string|'"1.234.56.1"'
newline|'\n'
nl|'\n'
dedent|''
name|'rows'
op|'='
op|'['
name|'None'
op|']'
op|'*'
number|'17'
newline|'\n'
name|'rows'
op|'['
number|'0'
op|']'
op|'='
op|'['
string|'"id"'
op|','
string|'"node_id"'
op|','
string|'"node_name"'
op|','
string|'"IP_address"'
op|','
string|'"mask"'
op|','
nl|'\n'
string|'"gateway"'
op|','
string|'"IP_address_6"'
op|','
string|'"prefix_6"'
op|','
string|'"gateway_6"'
op|','
string|'"MAC"'
op|','
nl|'\n'
string|'"duplex"'
op|','
string|'"state"'
op|','
string|'"speed"'
op|','
string|'"failover"'
op|']'
newline|'\n'
name|'rows'
op|'['
number|'1'
op|']'
op|'='
op|'['
string|'"1"'
op|','
string|'"5"'
op|','
string|'"node1"'
op|','
name|'ip_addr1'
op|','
string|'"255.255.255.0"'
op|','
nl|'\n'
name|'gw'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'"01:23:45:67:89:00"'
op|','
string|'"Full"'
op|','
nl|'\n'
string|'"online"'
op|','
string|'"1Gb/s"'
op|','
string|'"no"'
op|']'
newline|'\n'
name|'rows'
op|'['
number|'2'
op|']'
op|'='
op|'['
string|'"1"'
op|','
string|'"5"'
op|','
string|'"node1"'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
nl|'\n'
string|'"01:23:45:67:89:00"'
op|','
string|'"Full"'
op|','
string|'"online"'
op|','
string|'"1Gb/s"'
op|','
string|'"yes"'
op|']'
newline|'\n'
name|'rows'
op|'['
number|'3'
op|']'
op|'='
op|'['
string|'"2"'
op|','
string|'"5"'
op|','
string|'"node1"'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
nl|'\n'
string|'"01:23:45:67:89:01"'
op|','
string|'"Full"'
op|','
string|'"unconfigured"'
op|','
string|'"1Gb/s"'
op|','
string|'"no"'
op|']'
newline|'\n'
name|'rows'
op|'['
number|'4'
op|']'
op|'='
op|'['
string|'"2"'
op|','
string|'"5"'
op|','
string|'"node1"'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
nl|'\n'
string|'"01:23:45:67:89:01"'
op|','
string|'"Full"'
op|','
string|'"unconfigured"'
op|','
string|'"1Gb/s"'
op|','
string|'"yes"'
op|']'
newline|'\n'
name|'rows'
op|'['
number|'5'
op|']'
op|'='
op|'['
string|'"3"'
op|','
string|'"5"'
op|','
string|'"node1"'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
nl|'\n'
string|'"unconfigured"'
op|','
string|'""'
op|','
string|'"no"'
op|']'
newline|'\n'
name|'rows'
op|'['
number|'6'
op|']'
op|'='
op|'['
string|'"3"'
op|','
string|'"5"'
op|','
string|'"node1"'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
nl|'\n'
string|'"unconfigured"'
op|','
string|'""'
op|','
string|'"yes"'
op|']'
newline|'\n'
name|'rows'
op|'['
number|'7'
op|']'
op|'='
op|'['
string|'"4"'
op|','
string|'"5"'
op|','
string|'"node1"'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
nl|'\n'
string|'"unconfigured"'
op|','
string|'""'
op|','
string|'"no"'
op|']'
newline|'\n'
name|'rows'
op|'['
number|'8'
op|']'
op|'='
op|'['
string|'"4"'
op|','
string|'"5"'
op|','
string|'"node1"'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
nl|'\n'
string|'"unconfigured"'
op|','
string|'""'
op|','
string|'"yes"'
op|']'
newline|'\n'
name|'rows'
op|'['
number|'9'
op|']'
op|'='
op|'['
string|'"1"'
op|','
string|'"6"'
op|','
string|'"node2"'
op|','
name|'ip_addr2'
op|','
string|'"255.255.255.0"'
op|','
nl|'\n'
name|'gw'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'"01:23:45:67:89:02"'
op|','
string|'"Full"'
op|','
nl|'\n'
string|'"online"'
op|','
string|'"1Gb/s"'
op|','
string|'"no"'
op|']'
newline|'\n'
name|'rows'
op|'['
number|'10'
op|']'
op|'='
op|'['
string|'"1"'
op|','
string|'"6"'
op|','
string|'"node2"'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
nl|'\n'
string|'"01:23:45:67:89:02"'
op|','
string|'"Full"'
op|','
string|'"online"'
op|','
string|'"1Gb/s"'
op|','
string|'"yes"'
op|']'
newline|'\n'
name|'rows'
op|'['
number|'11'
op|']'
op|'='
op|'['
string|'"2"'
op|','
string|'"6"'
op|','
string|'"node2"'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
nl|'\n'
string|'"01:23:45:67:89:03"'
op|','
string|'"Full"'
op|','
string|'"unconfigured"'
op|','
string|'"1Gb/s"'
op|','
string|'"no"'
op|']'
newline|'\n'
name|'rows'
op|'['
number|'12'
op|']'
op|'='
op|'['
string|'"2"'
op|','
string|'"6"'
op|','
string|'"node2"'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
nl|'\n'
string|'"01:23:45:67:89:03"'
op|','
string|'"Full"'
op|','
string|'"unconfigured"'
op|','
string|'"1Gb/s"'
op|','
nl|'\n'
string|'"yes"'
op|']'
newline|'\n'
name|'rows'
op|'['
number|'13'
op|']'
op|'='
op|'['
string|'"3"'
op|','
string|'"6"'
op|','
string|'"node2"'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
nl|'\n'
string|'"unconfigured"'
op|','
string|'""'
op|','
string|'"no"'
op|']'
newline|'\n'
name|'rows'
op|'['
number|'14'
op|']'
op|'='
op|'['
string|'"3"'
op|','
string|'"6"'
op|','
string|'"node2"'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
nl|'\n'
string|'"unconfigured"'
op|','
string|'""'
op|','
string|'"yes"'
op|']'
newline|'\n'
name|'rows'
op|'['
number|'15'
op|']'
op|'='
op|'['
string|'"4"'
op|','
string|'"6"'
op|','
string|'"node2"'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
nl|'\n'
string|'"unconfigured"'
op|','
string|'""'
op|','
string|'"no"'
op|']'
newline|'\n'
name|'rows'
op|'['
number|'16'
op|']'
op|'='
op|'['
string|'"4"'
op|','
string|'"6"'
op|','
string|'"node2"'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
string|'""'
op|','
nl|'\n'
string|'"unconfigured"'
op|','
string|'""'
op|','
string|'"yes"'
op|']'
newline|'\n'
nl|'\n'
name|'if'
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"lsportip"'
op|']'
op|'=='
string|'"header_mismatch"'
op|':'
newline|'\n'
indent|'            '
name|'rows'
op|'['
number|'0'
op|']'
op|'.'
name|'pop'
op|'('
number|'2'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"lsportip"'
op|']'
op|'='
string|'""'
newline|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"lsportip"'
op|']'
op|'=='
string|'"remove_field"'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'row'
name|'in'
name|'rows'
op|':'
newline|'\n'
indent|'                '
name|'row'
op|'.'
name|'pop'
op|'('
number|'1'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"lsportip"'
op|']'
op|'='
string|'""'
newline|'\n'
nl|'\n'
dedent|''
name|'return'
name|'self'
op|'.'
name|'_print_info_cmd'
op|'('
name|'rows'
op|'='
name|'rows'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
nl|'\n'
comment|'# Create a vdisk'
nl|'\n'
DECL|member|_cmd_mkvdisk
dedent|''
name|'def'
name|'_cmd_mkvdisk'
op|'('
name|'self'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
comment|'# We only save the id/uid, name, and size - all else will be made up'
nl|'\n'
indent|'        '
name|'volume_info'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'volume_info'
op|'['
string|'"id"'
op|']'
op|'='
name|'self'
op|'.'
name|'_find_unused_id'
op|'('
name|'self'
op|'.'
name|'_volumes_list'
op|')'
newline|'\n'
name|'volume_info'
op|'['
string|'"uid"'
op|']'
op|'='
op|'('
string|'"ABCDEF"'
op|'*'
number|'3'
op|')'
op|'+'
op|'('
string|'"0"'
op|'*'
number|'14'
op|')'
op|'+'
name|'volume_info'
op|'['
string|'"id"'
op|']'
newline|'\n'
nl|'\n'
name|'if'
string|'"name"'
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'            '
name|'volume_info'
op|'['
string|'"name"'
op|']'
op|'='
name|'kwargs'
op|'['
string|'"name"'
op|']'
op|'.'
name|'strip'
op|'('
string|'\'\\\'\\"\''
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'volume_info'
op|'['
string|'"name"'
op|']'
op|'='
string|'"vdisk"'
op|'+'
name|'volume_info'
op|'['
string|'"id"'
op|']'
newline|'\n'
nl|'\n'
comment|'# Assume size and unit are given, store it in bytes'
nl|'\n'
dedent|''
name|'capacity'
op|'='
name|'int'
op|'('
name|'kwargs'
op|'['
string|'"size"'
op|']'
op|')'
newline|'\n'
name|'unit'
op|'='
name|'kwargs'
op|'['
string|'"unit"'
op|']'
newline|'\n'
nl|'\n'
name|'if'
name|'unit'
op|'=='
string|'"b"'
op|':'
newline|'\n'
indent|'            '
name|'volume_info'
op|'['
string|'"capacity"'
op|']'
op|'='
name|'capacity'
newline|'\n'
dedent|''
name|'elif'
name|'unit'
op|'=='
string|'"kb"'
op|':'
newline|'\n'
indent|'            '
name|'volume_info'
op|'['
string|'"capacity"'
op|']'
op|'='
name|'capacity'
op|'*'
name|'pow'
op|'('
number|'1024'
op|','
number|'1'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'unit'
op|'=='
string|'"mb"'
op|':'
newline|'\n'
indent|'            '
name|'volume_info'
op|'['
string|'"capacity"'
op|']'
op|'='
name|'capacity'
op|'*'
name|'pow'
op|'('
number|'1024'
op|','
number|'2'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'unit'
op|'=='
string|'"gb"'
op|':'
newline|'\n'
indent|'            '
name|'volume_info'
op|'['
string|'"capacity"'
op|']'
op|'='
name|'capacity'
op|'*'
name|'pow'
op|'('
number|'1024'
op|','
number|'3'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'unit'
op|'=='
string|'"tb"'
op|':'
newline|'\n'
indent|'            '
name|'volume_info'
op|'['
string|'"capacity"'
op|']'
op|'='
name|'capacity'
op|'*'
name|'pow'
op|'('
number|'1024'
op|','
number|'4'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'unit'
op|'=='
string|'"pb"'
op|':'
newline|'\n'
indent|'            '
name|'volume_info'
op|'['
string|'"capacity"'
op|']'
op|'='
name|'capacity'
op|'*'
name|'pow'
op|'('
number|'1024'
op|','
number|'5'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'volume_info'
op|'['
string|'"name"'
op|']'
name|'in'
name|'self'
op|'.'
name|'_volumes_list'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC6035E"'
op|']'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'_volumes_list'
op|'['
name|'volume_info'
op|'['
string|'"name"'
op|']'
op|']'
op|'='
name|'volume_info'
newline|'\n'
name|'return'
op|'('
string|'"Virtual Disk, id [%s], successfully created"'
op|'%'
nl|'\n'
op|'('
name|'volume_info'
op|'['
string|'"id"'
op|']'
op|')'
op|','
string|'""'
op|')'
newline|'\n'
nl|'\n'
comment|'# Delete a vdisk'
nl|'\n'
DECL|member|_cmd_rmvdisk
dedent|''
dedent|''
name|'def'
name|'_cmd_rmvdisk'
op|'('
name|'self'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'force'
op|'='
number|'0'
newline|'\n'
name|'if'
string|'"force"'
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'            '
name|'force'
op|'='
number|'1'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
string|'"obj"'
name|'not'
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5701E"'
op|']'
newline|'\n'
dedent|''
name|'vol_name'
op|'='
name|'kwargs'
op|'['
string|'"obj"'
op|']'
op|'.'
name|'strip'
op|'('
string|'\'\\\'\\"\''
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'not'
name|'vol_name'
name|'in'
name|'self'
op|'.'
name|'_volumes_list'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5753E"'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'force'
op|'=='
number|'0'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'k'
op|','
name|'mapping'
name|'in'
name|'self'
op|'.'
name|'_mappings_list'
op|'.'
name|'iteritems'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'if'
name|'mapping'
op|'['
string|'"vol"'
op|']'
op|'=='
name|'vol_name'
op|':'
newline|'\n'
indent|'                    '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5840E"'
op|']'
newline|'\n'
dedent|''
dedent|''
name|'for'
name|'k'
op|','
name|'fcmap'
name|'in'
name|'self'
op|'.'
name|'_fcmappings_list'
op|'.'
name|'iteritems'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'if'
op|'('
op|'('
name|'fcmap'
op|'['
string|'"source"'
op|']'
op|'=='
name|'vol_name'
op|')'
name|'or'
nl|'\n'
op|'('
name|'fcmap'
op|'['
string|'"target"'
op|']'
op|'=='
name|'vol_name'
op|')'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5840E"'
op|']'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
dedent|''
name|'del'
name|'self'
op|'.'
name|'_volumes_list'
op|'['
name|'vol_name'
op|']'
newline|'\n'
name|'return'
op|'('
string|'""'
op|','
string|'""'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_get_fcmap_info
dedent|''
name|'def'
name|'_get_fcmap_info'
op|'('
name|'self'
op|','
name|'vol_name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'ret_vals'
op|'='
op|'{'
nl|'\n'
string|'"fc_id"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"fc_name"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"fc_map_count"'
op|':'
string|'"0"'
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'for'
name|'k'
op|','
name|'fcmap'
name|'in'
name|'self'
op|'.'
name|'_fcmappings_list'
op|'.'
name|'iteritems'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
op|'('
op|'('
name|'fcmap'
op|'['
string|'"source"'
op|']'
op|'=='
name|'vol_name'
op|')'
name|'or'
nl|'\n'
op|'('
name|'fcmap'
op|'['
string|'"target"'
op|']'
op|'=='
name|'vol_name'
op|')'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'ret_vals'
op|'['
string|'"fc_id"'
op|']'
op|'='
name|'fcmap'
op|'['
string|'"id"'
op|']'
newline|'\n'
name|'ret_vals'
op|'['
string|'"fc_name"'
op|']'
op|'='
name|'fcmap'
op|'['
string|'"name"'
op|']'
newline|'\n'
name|'ret_vals'
op|'['
string|'"fc_map_count"'
op|']'
op|'='
string|'"1"'
newline|'\n'
dedent|''
dedent|''
name|'return'
name|'ret_vals'
newline|'\n'
nl|'\n'
comment|'# List information about vdisks'
nl|'\n'
DECL|member|_cmd_lsvdisk
dedent|''
name|'def'
name|'_cmd_lsvdisk'
op|'('
name|'self'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
string|'"obj"'
name|'not'
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'            '
name|'rows'
op|'='
op|'['
op|']'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"id"'
op|','
string|'"name"'
op|','
string|'"IO_group_id"'
op|','
string|'"IO_group_name"'
op|','
nl|'\n'
string|'"status"'
op|','
string|'"mdisk_grp_id"'
op|','
string|'"mdisk_grp_name"'
op|','
nl|'\n'
string|'"capacity"'
op|','
string|'"type"'
op|','
string|'"FC_id"'
op|','
string|'"FC_name"'
op|','
string|'"RC_id"'
op|','
nl|'\n'
string|'"RC_name"'
op|','
string|'"vdisk_UID"'
op|','
string|'"fc_map_count"'
op|','
string|'"copy_count"'
op|','
nl|'\n'
string|'"fast_write_state"'
op|','
string|'"se_copy_count"'
op|','
string|'"RC_change"'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'for'
name|'k'
op|','
name|'vol'
name|'in'
name|'self'
op|'.'
name|'_volumes_list'
op|'.'
name|'iteritems'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'if'
op|'('
op|'('
string|'"filtervalue"'
name|'not'
name|'in'
name|'kwargs'
op|')'
name|'or'
nl|'\n'
op|'('
name|'kwargs'
op|'['
string|'"filtervalue"'
op|']'
op|'=='
string|'"name="'
op|'+'
name|'vol'
op|'['
string|'"name"'
op|']'
op|')'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'fcmap_info'
op|'='
name|'self'
op|'.'
name|'_get_fcmap_info'
op|'('
name|'vol'
op|'['
string|'"name"'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
name|'str'
op|'('
name|'vol'
op|'['
string|'"id"'
op|']'
op|')'
op|','
name|'vol'
op|'['
string|'"name"'
op|']'
op|','
string|'"0"'
op|','
string|'"io_grp0"'
op|','
nl|'\n'
string|'"online"'
op|','
string|'"0"'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_flags'
op|'['
string|'"storwize_svc_volpool_name"'
op|']'
op|','
nl|'\n'
name|'str'
op|'('
name|'vol'
op|'['
string|'"capacity"'
op|']'
op|')'
op|','
string|'"striped"'
op|','
nl|'\n'
name|'fcmap_info'
op|'['
string|'"fc_id"'
op|']'
op|','
name|'fcmap_info'
op|'['
string|'"fc_name"'
op|']'
op|','
nl|'\n'
string|'""'
op|','
string|'""'
op|','
name|'vol'
op|'['
string|'"uid"'
op|']'
op|','
nl|'\n'
name|'fcmap_info'
op|'['
string|'"fc_map_count"'
op|']'
op|','
string|'"1"'
op|','
string|'"empty"'
op|','
nl|'\n'
string|'"1"'
op|','
string|'"no"'
op|']'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'return'
name|'self'
op|'.'
name|'_print_info_cmd'
op|'('
name|'rows'
op|'='
name|'rows'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'kwargs'
op|'['
string|'"obj"'
op|']'
name|'not'
name|'in'
name|'self'
op|'.'
name|'_volumes_list'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5754E"'
op|']'
newline|'\n'
dedent|''
name|'vol'
op|'='
name|'self'
op|'.'
name|'_volumes_list'
op|'['
name|'kwargs'
op|'['
string|'"obj"'
op|']'
op|']'
newline|'\n'
name|'fcmap_info'
op|'='
name|'self'
op|'.'
name|'_get_fcmap_info'
op|'('
name|'vol'
op|'['
string|'"name"'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'='
op|'['
op|']'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"id"'
op|','
name|'str'
op|'('
name|'vol'
op|'['
string|'"id"'
op|']'
op|')'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"name"'
op|','
name|'vol'
op|'['
string|'"name"'
op|']'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"IO_group_id"'
op|','
string|'"0"'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"IO_group_name"'
op|','
string|'"io_grp0"'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"status"'
op|','
string|'"online"'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"mdisk_grp_id"'
op|','
string|'"0"'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"mdisk_grp_name"'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_flags'
op|'['
string|'"storwize_svc_volpool_name"'
op|']'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"capacity"'
op|','
name|'str'
op|'('
name|'vol'
op|'['
string|'"capacity"'
op|']'
op|')'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"type"'
op|','
string|'"striped"'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"formatted"'
op|','
string|'"no"'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"mdisk_id"'
op|','
string|'""'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"mdisk_name"'
op|','
string|'""'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"FC_id"'
op|','
name|'fcmap_info'
op|'['
string|'"fc_id"'
op|']'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"FC_name"'
op|','
name|'fcmap_info'
op|'['
string|'"fc_name"'
op|']'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"RC_id"'
op|','
string|'""'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"RC_name"'
op|','
string|'""'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"vdisk_UID"'
op|','
name|'vol'
op|'['
string|'"uid"'
op|']'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"throttling"'
op|','
string|'"0"'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"lsvdisk"'
op|']'
op|'=='
string|'"blank_pref_node"'
op|':'
newline|'\n'
indent|'                '
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"preferred_node_id"'
op|','
string|'""'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"lsvdisk"'
op|']'
op|'='
string|'""'
newline|'\n'
dedent|''
name|'elif'
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"lsvdisk"'
op|']'
op|'=='
string|'"no_pref_node"'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"lsvdisk"'
op|']'
op|'='
string|'""'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"preferred_node_id"'
op|','
string|'"6"'
op|']'
op|')'
newline|'\n'
dedent|''
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"fast_write_state"'
op|','
string|'"empty"'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"cache"'
op|','
string|'"readwrite"'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"udid"'
op|','
string|'""'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"fc_map_count"'
op|','
name|'fcmap_info'
op|'['
string|'"fc_map_count"'
op|']'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"sync_rate"'
op|','
string|'"50"'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"copy_count"'
op|','
string|'"1"'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"se_copy_count"'
op|','
string|'"0"'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"mirror_write_priority"'
op|','
string|'"latency"'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"RC_change"'
op|','
string|'"no"'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'if'
string|'"nohdr"'
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'                '
name|'for'
name|'index'
name|'in'
name|'range'
op|'('
name|'len'
op|'('
name|'rows'
op|')'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'rows'
op|'['
name|'index'
op|']'
op|'='
string|'" "'
op|'.'
name|'join'
op|'('
name|'rows'
op|'['
name|'index'
op|']'
op|'['
number|'1'
op|':'
op|']'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'if'
string|'"delim"'
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'                '
name|'for'
name|'index'
name|'in'
name|'range'
op|'('
name|'len'
op|'('
name|'rows'
op|')'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'rows'
op|'['
name|'index'
op|']'
op|'='
name|'kwargs'
op|'['
string|'"delim"'
op|']'
op|'.'
name|'join'
op|'('
name|'rows'
op|'['
name|'index'
op|']'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'return'
op|'('
string|'"%s"'
op|'%'
string|'"\\n"'
op|'.'
name|'join'
op|'('
name|'rows'
op|')'
op|','
string|'""'
op|')'
newline|'\n'
nl|'\n'
comment|'# Make a host'
nl|'\n'
DECL|member|_cmd_mkhost
dedent|''
dedent|''
name|'def'
name|'_cmd_mkhost'
op|'('
name|'self'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_info'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'host_info'
op|'['
string|'"id"'
op|']'
op|'='
name|'self'
op|'.'
name|'_find_unused_id'
op|'('
name|'self'
op|'.'
name|'_hosts_list'
op|')'
newline|'\n'
nl|'\n'
name|'if'
string|'"name"'
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'            '
name|'host_name'
op|'='
name|'kwargs'
op|'['
string|'"name"'
op|']'
op|'.'
name|'strip'
op|'('
string|'\'\\\'\\"\''
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'host_name'
op|'='
string|'"host"'
op|'+'
name|'str'
op|'('
name|'host_info'
op|'['
string|'"id"'
op|']'
op|')'
newline|'\n'
dedent|''
name|'host_info'
op|'['
string|'"host_name"'
op|']'
op|'='
name|'host_name'
newline|'\n'
nl|'\n'
name|'if'
string|'"iscsiname"'
name|'not'
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5707E"'
op|']'
newline|'\n'
dedent|''
name|'host_info'
op|'['
string|'"iscsi_name"'
op|']'
op|'='
name|'kwargs'
op|'['
string|'"iscsiname"'
op|']'
op|'.'
name|'strip'
op|'('
string|'\'\\\'\\"\''
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'self'
op|'.'
name|'_is_invalid_name'
op|'('
name|'host_name'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC6527E"'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'host_name'
name|'in'
name|'self'
op|'.'
name|'_hosts_list'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC6035E"'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'for'
name|'k'
op|','
name|'v'
name|'in'
name|'self'
op|'.'
name|'_hosts_list'
op|'.'
name|'iteritems'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'v'
op|'['
string|'"iscsi_name"'
op|']'
op|'=='
name|'host_info'
op|'['
string|'"iscsi_name"'
op|']'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC6581E"'
op|']'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'self'
op|'.'
name|'_hosts_list'
op|'['
name|'host_name'
op|']'
op|'='
name|'host_info'
newline|'\n'
name|'return'
op|'('
string|'"Host, id [%s], successfully created"'
op|'%'
nl|'\n'
op|'('
name|'host_info'
op|'['
string|'"id"'
op|']'
op|')'
op|','
string|'""'
op|')'
newline|'\n'
nl|'\n'
comment|'# Remove a host'
nl|'\n'
DECL|member|_cmd_rmhost
dedent|''
name|'def'
name|'_cmd_rmhost'
op|'('
name|'self'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
string|'"obj"'
name|'not'
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5701E"'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'host_name'
op|'='
name|'kwargs'
op|'['
string|'"obj"'
op|']'
op|'.'
name|'strip'
op|'('
string|'\'\\\'\\"\''
op|')'
newline|'\n'
name|'if'
name|'host_name'
name|'not'
name|'in'
name|'self'
op|'.'
name|'_hosts_list'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5753E"'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'for'
name|'k'
op|','
name|'v'
name|'in'
name|'self'
op|'.'
name|'_mappings_list'
op|'.'
name|'iteritems'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
op|'('
name|'v'
op|'['
string|'"host"'
op|']'
op|'=='
name|'host_name'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5871E"'
op|']'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'del'
name|'self'
op|'.'
name|'_hosts_list'
op|'['
name|'host_name'
op|']'
newline|'\n'
name|'return'
op|'('
string|'""'
op|','
string|'""'
op|')'
newline|'\n'
nl|'\n'
comment|'# List information about hosts'
nl|'\n'
DECL|member|_cmd_lshost
dedent|''
name|'def'
name|'_cmd_lshost'
op|'('
name|'self'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
string|'"obj"'
name|'not'
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'            '
name|'rows'
op|'='
op|'['
op|']'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"id"'
op|','
string|'"name"'
op|','
string|'"port_count"'
op|','
string|'"iogrp_count"'
op|','
string|'"status"'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'found'
op|'='
name|'False'
newline|'\n'
name|'for'
name|'k'
op|','
name|'host'
name|'in'
name|'self'
op|'.'
name|'_hosts_list'
op|'.'
name|'iteritems'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'filterstr'
op|'='
string|'"name="'
op|'+'
name|'host'
op|'['
string|'"host_name"'
op|']'
newline|'\n'
name|'if'
op|'('
op|'('
string|'"filtervalue"'
name|'not'
name|'in'
name|'kwargs'
op|')'
name|'or'
nl|'\n'
op|'('
name|'kwargs'
op|'['
string|'"filtervalue"'
op|']'
op|'=='
name|'filterstr'
op|')'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
name|'host'
op|'['
string|'"id"'
op|']'
op|','
name|'host'
op|'['
string|'"host_name"'
op|']'
op|','
string|'"1"'
op|','
string|'"4"'
op|','
nl|'\n'
string|'"offline"'
op|']'
op|')'
newline|'\n'
name|'found'
op|'='
name|'True'
newline|'\n'
dedent|''
dedent|''
name|'if'
name|'found'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'self'
op|'.'
name|'_print_info_cmd'
op|'('
name|'rows'
op|'='
name|'rows'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'return'
op|'('
string|'""'
op|','
string|'""'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'kwargs'
op|'['
string|'"obj"'
op|']'
name|'not'
name|'in'
name|'self'
op|'.'
name|'_hosts_list'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5754E"'
op|']'
newline|'\n'
dedent|''
name|'host'
op|'='
name|'self'
op|'.'
name|'_hosts_list'
op|'['
name|'kwargs'
op|'['
string|'"obj"'
op|']'
op|']'
newline|'\n'
name|'rows'
op|'='
op|'['
op|']'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"id"'
op|','
name|'host'
op|'['
string|'"id"'
op|']'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"name"'
op|','
name|'host'
op|'['
string|'"host_name"'
op|']'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"port_count"'
op|','
string|'"1"'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"type"'
op|','
string|'"generic"'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"mask"'
op|','
string|'"1111"'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"iogrp_count"'
op|','
string|'"4"'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"status"'
op|','
string|'"offline"'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"iscsi_name"'
op|','
name|'host'
op|'['
string|'"iscsi_name"'
op|']'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"node_logged_in_count"'
op|','
string|'"0"'
op|']'
op|')'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"state"'
op|','
string|'"offline"'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'if'
string|'"nohdr"'
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'                '
name|'for'
name|'index'
name|'in'
name|'range'
op|'('
name|'len'
op|'('
name|'rows'
op|')'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'rows'
op|'['
name|'index'
op|']'
op|'='
string|'" "'
op|'.'
name|'join'
op|'('
name|'rows'
op|'['
name|'index'
op|']'
op|'['
number|'1'
op|':'
op|']'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'if'
string|'"delim"'
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'                '
name|'for'
name|'index'
name|'in'
name|'range'
op|'('
name|'len'
op|'('
name|'rows'
op|')'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'rows'
op|'['
name|'index'
op|']'
op|'='
name|'kwargs'
op|'['
string|'"delim"'
op|']'
op|'.'
name|'join'
op|'('
name|'rows'
op|'['
name|'index'
op|']'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'return'
op|'('
string|'"%s"'
op|'%'
string|'"\\n"'
op|'.'
name|'join'
op|'('
name|'rows'
op|')'
op|','
string|'""'
op|')'
newline|'\n'
nl|'\n'
comment|'# Create a vdisk-host mapping'
nl|'\n'
DECL|member|_cmd_mkvdiskhostmap
dedent|''
dedent|''
name|'def'
name|'_cmd_mkvdiskhostmap'
op|'('
name|'self'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'mapping_info'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'mapping_info'
op|'['
string|'"id"'
op|']'
op|'='
name|'self'
op|'.'
name|'_find_unused_id'
op|'('
name|'self'
op|'.'
name|'_mappings_list'
op|')'
newline|'\n'
nl|'\n'
name|'if'
string|'"host"'
name|'not'
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5707E"'
op|']'
newline|'\n'
dedent|''
name|'mapping_info'
op|'['
string|'"host"'
op|']'
op|'='
name|'kwargs'
op|'['
string|'"host"'
op|']'
op|'.'
name|'strip'
op|'('
string|'\'\\\'\\"\''
op|')'
newline|'\n'
nl|'\n'
name|'if'
string|'"scsi"'
name|'not'
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5707E"'
op|']'
newline|'\n'
dedent|''
name|'mapping_info'
op|'['
string|'"lun"'
op|']'
op|'='
name|'kwargs'
op|'['
string|'"scsi"'
op|']'
op|'.'
name|'strip'
op|'('
string|'\'\\\'\\"\''
op|')'
newline|'\n'
nl|'\n'
name|'if'
string|'"obj"'
name|'not'
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5707E"'
op|']'
newline|'\n'
dedent|''
name|'mapping_info'
op|'['
string|'"vol"'
op|']'
op|'='
name|'kwargs'
op|'['
string|'"obj"'
op|']'
op|'.'
name|'strip'
op|'('
string|'\'\\\'\\"\''
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'not'
name|'mapping_info'
op|'['
string|'"vol"'
op|']'
name|'in'
name|'self'
op|'.'
name|'_volumes_list'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5753E"'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'not'
name|'mapping_info'
op|'['
string|'"host"'
op|']'
name|'in'
name|'self'
op|'.'
name|'_hosts_list'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5754E"'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'mapping_info'
op|'['
string|'"vol"'
op|']'
name|'in'
name|'self'
op|'.'
name|'_mappings_list'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC6071E"'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'for'
name|'k'
op|','
name|'v'
name|'in'
name|'self'
op|'.'
name|'_mappings_list'
op|'.'
name|'iteritems'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
op|'('
op|'('
name|'v'
op|'['
string|'"host"'
op|']'
op|'=='
name|'mapping_info'
op|'['
string|'"host"'
op|']'
op|')'
name|'and'
nl|'\n'
op|'('
name|'v'
op|'['
string|'"lun"'
op|']'
op|'=='
name|'mapping_info'
op|'['
string|'"lun"'
op|']'
op|')'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5879E"'
op|']'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'self'
op|'.'
name|'_mappings_list'
op|'['
name|'mapping_info'
op|'['
string|'"vol"'
op|']'
op|']'
op|'='
name|'mapping_info'
newline|'\n'
name|'return'
op|'('
string|'"Virtual Disk to Host map, id [%s], successfully created"'
nl|'\n'
op|'%'
op|'('
name|'mapping_info'
op|'['
string|'"id"'
op|']'
op|')'
op|','
string|'""'
op|')'
newline|'\n'
nl|'\n'
comment|'# Delete a vdisk-host mapping'
nl|'\n'
DECL|member|_cmd_rmvdiskhostmap
dedent|''
name|'def'
name|'_cmd_rmvdiskhostmap'
op|'('
name|'self'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
string|'"host"'
name|'not'
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5707E"'
op|']'
newline|'\n'
dedent|''
name|'host'
op|'='
name|'kwargs'
op|'['
string|'"host"'
op|']'
op|'.'
name|'strip'
op|'('
string|'\'\\\'\\"\''
op|')'
newline|'\n'
nl|'\n'
name|'if'
string|'"obj"'
name|'not'
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5701E"'
op|']'
newline|'\n'
dedent|''
name|'vol'
op|'='
name|'kwargs'
op|'['
string|'"obj"'
op|']'
op|'.'
name|'strip'
op|'('
string|'\'\\\'\\"\''
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'not'
name|'vol'
name|'in'
name|'self'
op|'.'
name|'_mappings_list'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5753E"'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'_mappings_list'
op|'['
name|'vol'
op|']'
op|'['
string|'"host"'
op|']'
op|'!='
name|'host'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5753E"'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'del'
name|'self'
op|'.'
name|'_mappings_list'
op|'['
name|'vol'
op|']'
newline|'\n'
name|'return'
op|'('
string|'""'
op|','
string|'""'
op|')'
newline|'\n'
nl|'\n'
comment|'# List information about vdisk-host mappings'
nl|'\n'
DECL|member|_cmd_lshostvdiskmap
dedent|''
name|'def'
name|'_cmd_lshostvdiskmap'
op|'('
name|'self'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'index'
op|'='
number|'1'
newline|'\n'
name|'no_hdr'
op|'='
number|'0'
newline|'\n'
name|'delimeter'
op|'='
string|'""'
newline|'\n'
name|'host_name'
op|'='
name|'kwargs'
op|'['
string|'"obj"'
op|']'
newline|'\n'
nl|'\n'
name|'if'
name|'host_name'
name|'not'
name|'in'
name|'self'
op|'.'
name|'_hosts_list'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5754E"'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'rows'
op|'='
op|'['
op|']'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"id"'
op|','
string|'"name"'
op|','
string|'"SCSI_id"'
op|','
string|'"vdisk_id"'
op|','
string|'"vdisk_name"'
op|','
nl|'\n'
string|'"vdisk_UID"'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'for'
name|'k'
op|','
name|'mapping'
name|'in'
name|'self'
op|'.'
name|'_mappings_list'
op|'.'
name|'iteritems'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
op|'('
name|'host_name'
op|'=='
string|'""'
op|')'
name|'or'
op|'('
name|'mapping'
op|'['
string|'"host"'
op|']'
op|'=='
name|'host_name'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'volume'
op|'='
name|'self'
op|'.'
name|'_volumes_list'
op|'['
name|'mapping'
op|'['
string|'"vol"'
op|']'
op|']'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
name|'mapping'
op|'['
string|'"id"'
op|']'
op|','
name|'mapping'
op|'['
string|'"host"'
op|']'
op|','
nl|'\n'
name|'mapping'
op|'['
string|'"lun"'
op|']'
op|','
name|'volume'
op|'['
string|'"id"'
op|']'
op|','
nl|'\n'
name|'volume'
op|'['
string|'"name"'
op|']'
op|','
name|'volume'
op|'['
string|'"uid"'
op|']'
op|']'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'return'
name|'self'
op|'.'
name|'_print_info_cmd'
op|'('
name|'rows'
op|'='
name|'rows'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
nl|'\n'
comment|'# Create a FlashCopy mapping'
nl|'\n'
DECL|member|_cmd_mkfcmap
dedent|''
name|'def'
name|'_cmd_mkfcmap'
op|'('
name|'self'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'source'
op|'='
string|'""'
newline|'\n'
name|'target'
op|'='
string|'""'
newline|'\n'
nl|'\n'
name|'if'
string|'"source"'
name|'not'
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5707E"'
op|']'
newline|'\n'
dedent|''
name|'source'
op|'='
name|'kwargs'
op|'['
string|'"source"'
op|']'
op|'.'
name|'strip'
op|'('
string|'\'\\\'\\"\''
op|')'
newline|'\n'
name|'if'
name|'not'
name|'source'
name|'in'
name|'self'
op|'.'
name|'_volumes_list'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5754E"'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
string|'"target"'
name|'not'
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5707E"'
op|']'
newline|'\n'
dedent|''
name|'target'
op|'='
name|'kwargs'
op|'['
string|'"target"'
op|']'
op|'.'
name|'strip'
op|'('
string|'\'\\\'\\"\''
op|')'
newline|'\n'
name|'if'
name|'not'
name|'target'
name|'in'
name|'self'
op|'.'
name|'_volumes_list'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5754E"'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'source'
op|'=='
name|'target'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC6303E"'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
op|'('
name|'self'
op|'.'
name|'_volumes_list'
op|'['
name|'source'
op|']'
op|'['
string|'"capacity"'
op|']'
op|'!='
nl|'\n'
name|'self'
op|'.'
name|'_volumes_list'
op|'['
name|'target'
op|']'
op|'['
string|'"capacity"'
op|']'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5924E"'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'fcmap_info'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'fcmap_info'
op|'['
string|'"source"'
op|']'
op|'='
name|'source'
newline|'\n'
name|'fcmap_info'
op|'['
string|'"target"'
op|']'
op|'='
name|'target'
newline|'\n'
name|'fcmap_info'
op|'['
string|'"id"'
op|']'
op|'='
name|'self'
op|'.'
name|'_find_unused_id'
op|'('
name|'self'
op|'.'
name|'_fcmappings_list'
op|')'
newline|'\n'
name|'fcmap_info'
op|'['
string|'"name"'
op|']'
op|'='
string|'"fcmap"'
op|'+'
name|'fcmap_info'
op|'['
string|'"id"'
op|']'
newline|'\n'
name|'fcmap_info'
op|'['
string|'"status"'
op|']'
op|'='
string|'"idle_or_copied"'
newline|'\n'
name|'fcmap_info'
op|'['
string|'"progress"'
op|']'
op|'='
string|'"0"'
newline|'\n'
name|'self'
op|'.'
name|'_fcmappings_list'
op|'['
name|'target'
op|']'
op|'='
name|'fcmap_info'
newline|'\n'
nl|'\n'
name|'return'
op|'('
string|'"FlashCopy Mapping, id ["'
op|'+'
name|'fcmap_info'
op|'['
string|'"id"'
op|']'
op|'+'
nl|'\n'
string|'"], successfully created"'
op|','
string|'""'
op|')'
newline|'\n'
nl|'\n'
comment|'# Same function used for both prestartfcmap and startfcmap'
nl|'\n'
DECL|member|_cmd_gen_startfcmap
dedent|''
name|'def'
name|'_cmd_gen_startfcmap'
op|'('
name|'self'
op|','
name|'mode'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
string|'"obj"'
name|'not'
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5701E"'
op|']'
newline|'\n'
dedent|''
name|'id_num'
op|'='
name|'kwargs'
op|'['
string|'"obj"'
op|']'
newline|'\n'
nl|'\n'
name|'if'
name|'mode'
op|'=='
string|'"pre"'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"prestartfcmap"'
op|']'
op|'=='
string|'"bad_id"'
op|':'
newline|'\n'
indent|'                '
name|'id_num'
op|'='
op|'-'
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"prestartfcmap"'
op|']'
op|'='
string|'""'
newline|'\n'
dedent|''
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"startfcmap"'
op|']'
op|'=='
string|'"bad_id"'
op|':'
newline|'\n'
indent|'                '
name|'id_num'
op|'='
op|'-'
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"startfcmap"'
op|']'
op|'='
string|'""'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'for'
name|'k'
op|','
name|'fcmap'
name|'in'
name|'self'
op|'.'
name|'_fcmappings_list'
op|'.'
name|'iteritems'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'fcmap'
op|'['
string|'"id"'
op|']'
op|'=='
name|'id_num'
op|':'
newline|'\n'
indent|'                '
name|'if'
name|'mode'
op|'=='
string|'"pre"'
op|':'
newline|'\n'
indent|'                    '
name|'fcmap'
op|'['
string|'"status"'
op|']'
op|'='
string|'"preparing"'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                    '
name|'fcmap'
op|'['
string|'"status"'
op|']'
op|'='
string|'"copying"'
newline|'\n'
dedent|''
name|'fcmap'
op|'['
string|'"progress"'
op|']'
op|'='
string|'"0"'
newline|'\n'
name|'return'
op|'('
string|'""'
op|','
string|'""'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5753E"'
op|']'
newline|'\n'
nl|'\n'
comment|'# Same function used for both stopfcmap and rmfcmap'
nl|'\n'
comment|'# Assumes it is called with "-force <fc_map_id>"'
nl|'\n'
DECL|member|_cmd_stoprmfcmap
dedent|''
name|'def'
name|'_cmd_stoprmfcmap'
op|'('
name|'self'
op|','
name|'mode'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
string|'"obj"'
name|'not'
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5701E"'
op|']'
newline|'\n'
dedent|''
name|'id_num'
op|'='
name|'kwargs'
op|'['
string|'"obj"'
op|']'
newline|'\n'
nl|'\n'
name|'if'
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"rmfcmap"'
op|']'
op|'=='
string|'"bad_id"'
op|':'
newline|'\n'
indent|'            '
name|'id_num'
op|'='
op|'-'
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"rmfcmap"'
op|']'
op|'='
string|'""'
newline|'\n'
nl|'\n'
dedent|''
name|'to_delete'
op|'='
name|'None'
newline|'\n'
name|'found'
op|'='
name|'False'
newline|'\n'
name|'for'
name|'k'
op|','
name|'fcmap'
name|'in'
name|'self'
op|'.'
name|'_fcmappings_list'
op|'.'
name|'iteritems'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'fcmap'
op|'['
string|'"id"'
op|']'
op|'=='
name|'id_num'
op|':'
newline|'\n'
indent|'                '
name|'found'
op|'='
name|'True'
newline|'\n'
name|'if'
name|'mode'
op|'=='
string|'"rm"'
op|':'
newline|'\n'
indent|'                    '
name|'to_delete'
op|'='
name|'k'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
dedent|''
name|'if'
name|'to_delete'
op|':'
newline|'\n'
indent|'            '
name|'del'
name|'self'
op|'.'
name|'_fcmappings_list'
op|'['
name|'to_delete'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'found'
op|':'
newline|'\n'
indent|'            '
name|'return'
op|'('
string|'""'
op|','
string|'""'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5753E"'
op|']'
newline|'\n'
nl|'\n'
DECL|member|_cmd_lsfcmap
dedent|''
dedent|''
name|'def'
name|'_cmd_lsfcmap'
op|'('
name|'self'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'rows'
op|'='
op|'['
op|']'
newline|'\n'
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
string|'"id"'
op|','
string|'"name"'
op|','
string|'"source_vdisk_id"'
op|','
string|'"source_vdisk_name"'
op|','
nl|'\n'
string|'"target_vdisk_id"'
op|','
string|'"target_vdisk_name"'
op|','
string|'"group_id"'
op|','
nl|'\n'
string|'"group_name"'
op|','
string|'"status"'
op|','
string|'"progress"'
op|','
string|'"copy_rate"'
op|','
nl|'\n'
string|'"clean_progress"'
op|','
string|'"incremental"'
op|','
string|'"partner_FC_id"'
op|','
nl|'\n'
string|'"partner_FC_name"'
op|','
string|'"restoring"'
op|','
string|'"start_time"'
op|','
nl|'\n'
string|'"rc_controlled"'
op|']'
op|')'
newline|'\n'
nl|'\n'
comment|'# Assume we always get a filtervalue argument'
nl|'\n'
name|'filter_key'
op|'='
name|'kwargs'
op|'['
string|'"filtervalue"'
op|']'
op|'.'
name|'split'
op|'('
string|'"="'
op|')'
op|'['
number|'0'
op|']'
newline|'\n'
name|'filter_value'
op|'='
name|'kwargs'
op|'['
string|'"filtervalue"'
op|']'
op|'.'
name|'split'
op|'('
string|'"="'
op|')'
op|'['
number|'1'
op|']'
newline|'\n'
name|'to_delete'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'k'
op|','
name|'v'
name|'in'
name|'self'
op|'.'
name|'_fcmappings_list'
op|'.'
name|'iteritems'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'str'
op|'('
name|'v'
op|'['
name|'filter_key'
op|']'
op|')'
op|'=='
name|'filter_value'
op|':'
newline|'\n'
indent|'                '
name|'source'
op|'='
name|'self'
op|'.'
name|'_volumes_list'
op|'['
name|'v'
op|'['
string|'"source"'
op|']'
op|']'
newline|'\n'
name|'target'
op|'='
name|'self'
op|'.'
name|'_volumes_list'
op|'['
name|'v'
op|'['
string|'"target"'
op|']'
op|']'
newline|'\n'
name|'old_status'
op|'='
name|'v'
op|'['
string|'"status"'
op|']'
newline|'\n'
name|'if'
name|'old_status'
op|'=='
string|'"preparing"'
op|':'
newline|'\n'
indent|'                    '
name|'new_status'
op|'='
string|'"prepared"'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"lsfcmap"'
op|']'
op|'=='
string|'"bogus_prepare"'
op|':'
newline|'\n'
indent|'                        '
name|'new_status'
op|'='
string|'"bogus"'
newline|'\n'
dedent|''
dedent|''
name|'elif'
op|'('
name|'old_status'
op|'=='
string|'"copying"'
op|')'
name|'and'
op|'('
name|'v'
op|'['
string|'"progress"'
op|']'
op|'=='
string|'"0"'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'new_status'
op|'='
string|'"copying"'
newline|'\n'
name|'v'
op|'['
string|'"progress"'
op|']'
op|'='
string|'"50"'
newline|'\n'
dedent|''
name|'elif'
op|'('
name|'old_status'
op|'=='
string|'"copying"'
op|')'
name|'and'
op|'('
name|'v'
op|'['
string|'"progress"'
op|']'
op|'=='
string|'"50"'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'new_status'
op|'='
string|'"idle_or_copied"'
newline|'\n'
name|'to_delete'
op|'.'
name|'append'
op|'('
name|'k'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                    '
name|'new_status'
op|'='
name|'old_status'
newline|'\n'
dedent|''
name|'v'
op|'['
string|'"status"'
op|']'
op|'='
name|'new_status'
newline|'\n'
nl|'\n'
name|'if'
op|'('
op|'('
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"lsfcmap"'
op|']'
op|'=='
string|'"speed_up"'
op|')'
name|'or'
nl|'\n'
op|'('
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"lsfcmap"'
op|']'
op|'=='
string|'"bogus_prepare"'
op|')'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'print_status'
op|'='
name|'new_status'
newline|'\n'
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
string|'"lsfcmap"'
op|']'
op|'='
string|'""'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                    '
name|'print_status'
op|'='
name|'old_status'
newline|'\n'
nl|'\n'
dedent|''
name|'rows'
op|'.'
name|'append'
op|'('
op|'['
name|'v'
op|'['
string|'"id"'
op|']'
op|','
name|'v'
op|'['
string|'"name"'
op|']'
op|','
name|'source'
op|'['
string|'"id"'
op|']'
op|','
nl|'\n'
name|'source'
op|'['
string|'"name"'
op|']'
op|','
name|'target'
op|'['
string|'"id"'
op|']'
op|','
name|'target'
op|'['
string|'"name"'
op|']'
op|','
string|'""'
op|','
nl|'\n'
string|'""'
op|','
name|'print_status'
op|','
name|'v'
op|'['
string|'"progress"'
op|']'
op|','
string|'"50"'
op|','
string|'"100"'
op|','
nl|'\n'
string|'"off"'
op|','
string|'""'
op|','
string|'""'
op|','
string|'"no"'
op|','
string|'""'
op|','
string|'"no"'
op|']'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'for'
name|'d'
name|'in'
name|'to_delete'
op|':'
newline|'\n'
indent|'            '
name|'del'
name|'self'
op|'.'
name|'_fcmappings_list'
op|'['
name|'k'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'return'
name|'self'
op|'.'
name|'_print_info_cmd'
op|'('
name|'rows'
op|'='
name|'rows'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
nl|'\n'
comment|'# The main function to run commands on the management simulator'
nl|'\n'
DECL|member|execute_command
dedent|''
name|'def'
name|'execute_command'
op|'('
name|'self'
op|','
name|'cmd'
op|','
name|'check_exit_code'
op|'='
name|'True'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'kwargs'
op|'='
name|'self'
op|'.'
name|'_cmd_to_dict'
op|'('
name|'cmd'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'IndexError'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_errors'
op|'['
string|'"CMMVC5707E"'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'command'
op|'='
name|'kwargs'
op|'['
string|'"cmd"'
op|']'
newline|'\n'
name|'del'
name|'kwargs'
op|'['
string|'"cmd"'
op|']'
newline|'\n'
name|'arg_list'
op|'='
name|'cmd'
op|'.'
name|'split'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'command'
op|'=='
string|'"lsmdiskgrp"'
op|':'
newline|'\n'
indent|'            '
name|'out'
op|','
name|'err'
op|'='
name|'self'
op|'.'
name|'_cmd_lsmdiskgrp'
op|'('
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'command'
op|'=='
string|'"lsnodecanister"'
op|':'
newline|'\n'
indent|'            '
name|'out'
op|','
name|'err'
op|'='
name|'self'
op|'.'
name|'_cmd_lsnodecanister'
op|'('
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'command'
op|'=='
string|'"lsportip"'
op|':'
newline|'\n'
indent|'            '
name|'out'
op|','
name|'err'
op|'='
name|'self'
op|'.'
name|'_cmd_lsportip'
op|'('
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'command'
op|'=='
string|'"mkvdisk"'
op|':'
newline|'\n'
indent|'            '
name|'out'
op|','
name|'err'
op|'='
name|'self'
op|'.'
name|'_cmd_mkvdisk'
op|'('
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'command'
op|'=='
string|'"rmvdisk"'
op|':'
newline|'\n'
indent|'            '
name|'out'
op|','
name|'err'
op|'='
name|'self'
op|'.'
name|'_cmd_rmvdisk'
op|'('
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'command'
op|'=='
string|'"lsvdisk"'
op|':'
newline|'\n'
indent|'            '
name|'out'
op|','
name|'err'
op|'='
name|'self'
op|'.'
name|'_cmd_lsvdisk'
op|'('
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'command'
op|'=='
string|'"mkhost"'
op|':'
newline|'\n'
indent|'            '
name|'out'
op|','
name|'err'
op|'='
name|'self'
op|'.'
name|'_cmd_mkhost'
op|'('
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'command'
op|'=='
string|'"rmhost"'
op|':'
newline|'\n'
indent|'            '
name|'out'
op|','
name|'err'
op|'='
name|'self'
op|'.'
name|'_cmd_rmhost'
op|'('
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'command'
op|'=='
string|'"lshost"'
op|':'
newline|'\n'
indent|'            '
name|'out'
op|','
name|'err'
op|'='
name|'self'
op|'.'
name|'_cmd_lshost'
op|'('
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'command'
op|'=='
string|'"mkvdiskhostmap"'
op|':'
newline|'\n'
indent|'            '
name|'out'
op|','
name|'err'
op|'='
name|'self'
op|'.'
name|'_cmd_mkvdiskhostmap'
op|'('
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'command'
op|'=='
string|'"rmvdiskhostmap"'
op|':'
newline|'\n'
indent|'            '
name|'out'
op|','
name|'err'
op|'='
name|'self'
op|'.'
name|'_cmd_rmvdiskhostmap'
op|'('
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'command'
op|'=='
string|'"lshostvdiskmap"'
op|':'
newline|'\n'
indent|'            '
name|'out'
op|','
name|'err'
op|'='
name|'self'
op|'.'
name|'_cmd_lshostvdiskmap'
op|'('
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'command'
op|'=='
string|'"mkfcmap"'
op|':'
newline|'\n'
indent|'            '
name|'out'
op|','
name|'err'
op|'='
name|'self'
op|'.'
name|'_cmd_mkfcmap'
op|'('
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'command'
op|'=='
string|'"prestartfcmap"'
op|':'
newline|'\n'
indent|'            '
name|'out'
op|','
name|'err'
op|'='
name|'self'
op|'.'
name|'_cmd_gen_startfcmap'
op|'('
name|'mode'
op|'='
string|'"pre"'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'command'
op|'=='
string|'"startfcmap"'
op|':'
newline|'\n'
indent|'            '
name|'out'
op|','
name|'err'
op|'='
name|'self'
op|'.'
name|'_cmd_gen_startfcmap'
op|'('
name|'mode'
op|'='
string|'"start"'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'command'
op|'=='
string|'"stopfcmap"'
op|':'
newline|'\n'
indent|'            '
name|'out'
op|','
name|'err'
op|'='
name|'self'
op|'.'
name|'_cmd_stoprmfcmap'
op|'('
name|'mode'
op|'='
string|'"stop"'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'command'
op|'=='
string|'"rmfcmap"'
op|':'
newline|'\n'
indent|'            '
name|'out'
op|','
name|'err'
op|'='
name|'self'
op|'.'
name|'_cmd_stoprmfcmap'
op|'('
name|'mode'
op|'='
string|'"rm"'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'command'
op|'=='
string|'"lsfcmap"'
op|':'
newline|'\n'
indent|'            '
name|'out'
op|','
name|'err'
op|'='
name|'self'
op|'.'
name|'_cmd_lsfcmap'
op|'('
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'out'
op|','
name|'err'
op|'='
op|'('
string|'""'
op|','
string|'"ERROR: Unsupported command"'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
op|'('
name|'check_exit_code'
op|')'
name|'and'
op|'('
name|'len'
op|'('
name|'err'
op|')'
op|'!='
number|'0'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'exception'
op|'.'
name|'ProcessExecutionError'
op|'('
name|'exit_code'
op|'='
number|'1'
op|','
nl|'\n'
name|'stdout'
op|'='
name|'out'
op|','
nl|'\n'
name|'stderr'
op|'='
name|'err'
op|','
nl|'\n'
name|'cmd'
op|'='
string|"' '"
op|'.'
name|'join'
op|'('
name|'cmd'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'return'
op|'('
name|'out'
op|','
name|'err'
op|')'
newline|'\n'
nl|'\n'
comment|'# After calling this function, the next call to the specified command will'
nl|'\n'
comment|'# result in in the error specified'
nl|'\n'
DECL|member|error_injection
dedent|''
name|'def'
name|'error_injection'
op|'('
name|'self'
op|','
name|'cmd'
op|','
name|'error'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_next_cmd_error'
op|'['
name|'cmd'
op|']'
op|'='
name|'error'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|StorwizeSVCFakeDriver
dedent|''
dedent|''
name|'class'
name|'StorwizeSVCFakeDriver'
op|'('
name|'storwize_svc'
op|'.'
name|'StorwizeSVCDriver'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'StorwizeSVCFakeDriver'
op|','
name|'self'
op|')'
op|'.'
name|'__init__'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
nl|'\n'
DECL|member|set_fake_storage
dedent|''
name|'def'
name|'set_fake_storage'
op|'('
name|'self'
op|','
name|'fake'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'fake_storage'
op|'='
name|'fake'
newline|'\n'
nl|'\n'
DECL|member|_run_ssh
dedent|''
name|'def'
name|'_run_ssh'
op|'('
name|'self'
op|','
name|'cmd'
op|','
name|'check_exit_code'
op|'='
name|'True'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'LOG'
op|'.'
name|'debug'
op|'('
name|'_'
op|'('
string|"'Run CLI command: %s'"
op|')'
op|'%'
name|'cmd'
op|')'
newline|'\n'
name|'ret'
op|'='
name|'self'
op|'.'
name|'fake_storage'
op|'.'
name|'execute_command'
op|'('
name|'cmd'
op|','
name|'check_exit_code'
op|')'
newline|'\n'
op|'('
name|'stdout'
op|','
name|'stderr'
op|')'
op|'='
name|'ret'
newline|'\n'
name|'LOG'
op|'.'
name|'debug'
op|'('
name|'_'
op|'('
string|"'CLI output:\\n stdout: %(out)s\\n stderr: %(err)s'"
op|')'
op|'%'
nl|'\n'
op|'{'
string|"'out'"
op|':'
name|'stdout'
op|','
string|"'err'"
op|':'
name|'stderr'
op|'}'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'except'
name|'exception'
op|'.'
name|'ProcessExecutionError'
name|'as'
name|'e'
op|':'
newline|'\n'
indent|'            '
name|'with'
name|'excutils'
op|'.'
name|'save_and_reraise_exception'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'LOG'
op|'.'
name|'debug'
op|'('
name|'_'
op|'('
string|"'CLI Exception output:\\n stdout: %(out)s\\n '"
nl|'\n'
string|"'stderr: %(err)s'"
op|')'
op|'%'
op|'{'
string|"'out'"
op|':'
name|'e'
op|'.'
name|'stdout'
op|','
nl|'\n'
string|"'err'"
op|':'
name|'e'
op|'.'
name|'stderr'
op|'}'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'return'
name|'ret'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|StorwizeSVCDriverTestCase
dedent|''
dedent|''
name|'class'
name|'StorwizeSVCDriverTestCase'
op|'('
name|'test'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'StorwizeSVCDriverTestCase'
op|','
name|'self'
op|')'
op|'.'
name|'setUp'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'USESIM'
op|'='
number|'1'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'USESIM'
op|'=='
number|'1'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'sim'
op|'='
name|'StorwizeSVCManagementSimulator'
op|'('
string|'"volpool"'
op|')'
newline|'\n'
name|'driver'
op|'='
name|'StorwizeSVCFakeDriver'
op|'('
op|')'
newline|'\n'
name|'driver'
op|'.'
name|'set_fake_storage'
op|'('
name|'self'
op|'.'
name|'sim'
op|')'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'san_ip'
op|'='
string|'"hostname"'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'san_login'
op|'='
string|'"user"'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'san_password'
op|'='
string|'"pass"'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_volpool_name'
op|'='
string|'"volpool"'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_flashcopy_timeout'
op|'='
string|'"20"'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'driver'
op|'='
name|'storwize_svc'
op|'.'
name|'StorwizeSVCDriver'
op|'('
op|')'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'san_ip'
op|'='
string|'"-1.-1.-1.-1"'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'san_login'
op|'='
string|'"user"'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'san_password'
op|'='
string|'"password"'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_volpool_name'
op|'='
string|'"pool"'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'driver'
op|'='
name|'driver'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'do_setup'
op|'('
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'check_for_setup_error'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_storwize_svc_volume_tests
dedent|''
name|'def'
name|'test_storwize_svc_volume_tests'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_rsize'
op|'='
string|'"-1"'
newline|'\n'
name|'volume'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'volume'
op|'['
string|'"name"'
op|']'
op|'='
string|'"test1_volume%s"'
op|'%'
name|'random'
op|'.'
name|'randint'
op|'('
number|'10000'
op|','
number|'99999'
op|')'
newline|'\n'
name|'volume'
op|'['
string|'"size"'
op|']'
op|'='
number|'10'
newline|'\n'
name|'volume'
op|'['
string|'"id"'
op|']'
op|'='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_volume'
op|'('
name|'volume'
op|')'
newline|'\n'
comment|'# Make sure that the volume has been created'
nl|'\n'
name|'is_volume_defined'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_is_volume_defined'
op|'('
name|'volume'
op|'['
string|'"name"'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'is_volume_defined'
op|','
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'delete_volume'
op|'('
name|'volume'
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'self'
op|'.'
name|'USESIM'
op|'=='
number|'1'
op|':'
newline|'\n'
indent|'            '
name|'saved_rsize'
op|'='
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_rsize'
newline|'\n'
name|'saved_comp'
op|'='
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_compression'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_rsize'
op|'='
string|'"2%"'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_compression'
op|'='
name|'True'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_volume'
op|'('
name|'volume'
op|')'
newline|'\n'
name|'is_volume_defined'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_is_volume_defined'
op|'('
name|'volume'
op|'['
string|'"name"'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'is_volume_defined'
op|','
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'delete_volume'
op|'('
name|'volume'
op|')'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_rsize'
op|'='
name|'saved_rsize'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_compression'
op|'='
name|'saved_comp'
newline|'\n'
nl|'\n'
DECL|member|test_storwize_svc_ip_connectivity
dedent|''
dedent|''
name|'def'
name|'test_storwize_svc_ip_connectivity'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# Check for missing san_ip'
nl|'\n'
indent|'        '
name|'saved'
op|'='
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'san_ip'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'san_ip'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'InvalidInput'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_check_flags'
op|')'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'san_ip'
op|'='
name|'saved'
newline|'\n'
nl|'\n'
name|'if'
name|'self'
op|'.'
name|'USESIM'
op|'!='
number|'1'
op|':'
newline|'\n'
indent|'            '
name|'saved'
op|'='
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'san_ip'
newline|'\n'
nl|'\n'
comment|'# Check for invalid ip'
nl|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'san_ip'
op|'='
string|'"-1.-1.-1.-1"'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'socket'
op|'.'
name|'gaierror'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'check_for_setup_error'
op|')'
newline|'\n'
nl|'\n'
comment|'# Check for unreachable IP'
nl|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'san_ip'
op|'='
string|'"1.1.1.1"'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'socket'
op|'.'
name|'error'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'check_for_setup_error'
op|')'
newline|'\n'
nl|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'san_ip'
op|'='
name|'saved'
newline|'\n'
nl|'\n'
DECL|member|test_storwize_svc_connectivity
dedent|''
dedent|''
name|'def'
name|'test_storwize_svc_connectivity'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|"# Make sure we detect if the pool doesn't exist"
nl|'\n'
indent|'        '
name|'orig_pool'
op|'='
name|'getattr'
op|'('
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|','
string|'"storwize_svc_volpool_name"'
op|')'
newline|'\n'
name|'no_exist_pool'
op|'='
string|'"i-dont-exist-%s"'
op|'%'
name|'random'
op|'.'
name|'randint'
op|'('
number|'10000'
op|','
number|'99999'
op|')'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_volpool_name'
op|'='
name|'no_exist_pool'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'InvalidInput'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'check_for_setup_error'
op|')'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_volpool_name'
op|'='
name|'orig_pool'
newline|'\n'
nl|'\n'
comment|"# Check the case where the user didn't configure IP addresses"
nl|'\n'
comment|'# as well as receiving unexpected results from the storage'
nl|'\n'
name|'if'
name|'self'
op|'.'
name|'USESIM'
op|'=='
number|'1'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'sim'
op|'.'
name|'error_injection'
op|'('
string|'"lsnodecanister"'
op|','
string|'"header_mismatch"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'VolumeBackendAPIException'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'check_for_setup_error'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'sim'
op|'.'
name|'error_injection'
op|'('
string|'"lsnodecanister"'
op|','
string|'"remove_field"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'VolumeBackendAPIException'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'check_for_setup_error'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'sim'
op|'.'
name|'error_injection'
op|'('
string|'"lsportip"'
op|','
string|'"ip_no_config"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'VolumeBackendAPIException'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'check_for_setup_error'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'sim'
op|'.'
name|'error_injection'
op|'('
string|'"lsportip"'
op|','
string|'"header_mismatch"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'VolumeBackendAPIException'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'check_for_setup_error'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'sim'
op|'.'
name|'error_injection'
op|'('
string|'"lsportip"'
op|','
string|'"remove_field"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'VolumeBackendAPIException'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'check_for_setup_error'
op|')'
newline|'\n'
nl|'\n'
comment|'# Check with bad parameters'
nl|'\n'
dedent|''
name|'saved_pass'
op|'='
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'san_password'
newline|'\n'
name|'saved_key'
op|'='
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'san_private_key'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'san_password'
op|'='
name|'None'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'san_private_key'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'InvalidInput'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_check_flags'
op|')'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'san_password'
op|'='
name|'saved_pass'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'san_private_key'
op|'='
name|'saved_key'
newline|'\n'
nl|'\n'
name|'saved'
op|'='
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_vtype'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_vtype'
op|'='
string|'"invalid"'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'InvalidInput'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_check_flags'
op|')'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_vtype'
op|'='
name|'saved'
newline|'\n'
nl|'\n'
name|'saved'
op|'='
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_rsize'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_rsize'
op|'='
string|'"invalid"'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'InvalidInput'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_check_flags'
op|')'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_rsize'
op|'='
name|'saved'
newline|'\n'
nl|'\n'
name|'saved'
op|'='
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_warning'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_warning'
op|'='
string|'"invalid"'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'InvalidInput'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_check_flags'
op|')'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_warning'
op|'='
name|'saved'
newline|'\n'
nl|'\n'
name|'saved'
op|'='
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_autoexpand'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_autoexpand'
op|'='
string|'"invalid"'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'InvalidInput'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_check_flags'
op|')'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_autoexpand'
op|'='
name|'saved'
newline|'\n'
nl|'\n'
name|'saved'
op|'='
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_grainsize'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_grainsize'
op|'='
name|'str'
op|'('
number|'42'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'InvalidInput'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_check_flags'
op|')'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_grainsize'
op|'='
name|'saved'
newline|'\n'
nl|'\n'
name|'saved'
op|'='
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_flashcopy_timeout'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_flashcopy_timeout'
op|'='
name|'str'
op|'('
number|'601'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'InvalidInput'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_check_flags'
op|')'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_flashcopy_timeout'
op|'='
name|'saved'
newline|'\n'
nl|'\n'
comment|'# Finally, check with good parameters'
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'check_for_setup_error'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_storwize_svc_flashcopy
dedent|''
name|'def'
name|'test_storwize_svc_flashcopy'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'volume1'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'volume1'
op|'['
string|'"name"'
op|']'
op|'='
string|'"test_volume%s"'
op|'%'
name|'random'
op|'.'
name|'randint'
op|'('
number|'10000'
op|','
number|'99999'
op|')'
newline|'\n'
name|'volume1'
op|'['
string|'"size"'
op|']'
op|'='
number|'10'
newline|'\n'
name|'volume1'
op|'['
string|'"id"'
op|']'
op|'='
number|'10'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_volume'
op|'('
name|'volume1'
op|')'
newline|'\n'
nl|'\n'
name|'snapshot'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'snapshot'
op|'['
string|'"name"'
op|']'
op|'='
string|'"snap_volume%s"'
op|'%'
name|'random'
op|'.'
name|'randint'
op|'('
number|'10000'
op|','
number|'99999'
op|')'
newline|'\n'
name|'snapshot'
op|'['
string|'"volume_name"'
op|']'
op|'='
name|'volume1'
op|'['
string|'"name"'
op|']'
newline|'\n'
nl|'\n'
comment|'# Test timeout and volume cleanup'
nl|'\n'
name|'saved'
op|'='
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_flashcopy_timeout'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_flashcopy_timeout'
op|'='
name|'str'
op|'('
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'InvalidSnapshot'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_snapshot'
op|','
name|'snapshot'
op|')'
newline|'\n'
name|'is_volume_defined'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_is_volume_defined'
op|'('
name|'snapshot'
op|'['
string|'"name"'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'is_volume_defined'
op|','
name|'False'
op|')'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_flashcopy_timeout'
op|'='
name|'saved'
newline|'\n'
nl|'\n'
comment|'# Test bogus statuses'
nl|'\n'
name|'if'
name|'self'
op|'.'
name|'USESIM'
op|'=='
number|'1'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'sim'
op|'.'
name|'error_injection'
op|'('
string|'"lsfcmap"'
op|','
string|'"bogus_prepare"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'VolumeBackendAPIException'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_snapshot'
op|','
name|'snapshot'
op|')'
newline|'\n'
nl|'\n'
comment|'# Test prestartfcmap, startfcmap, and rmfcmap failing'
nl|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'USESIM'
op|'=='
number|'1'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'sim'
op|'.'
name|'error_injection'
op|'('
string|'"prestartfcmap"'
op|','
string|'"bad_id"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'ProcessExecutionError'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_snapshot'
op|','
name|'snapshot'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'sim'
op|'.'
name|'error_injection'
op|'('
string|'"lsfcmap"'
op|','
string|'"speed_up"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'sim'
op|'.'
name|'error_injection'
op|'('
string|'"startfcmap"'
op|','
string|'"bad_id"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'ProcessExecutionError'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_snapshot'
op|','
name|'snapshot'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'sim'
op|'.'
name|'error_injection'
op|'('
string|'"prestartfcmap"'
op|','
string|'"bad_id"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'sim'
op|'.'
name|'error_injection'
op|'('
string|'"rmfcmap"'
op|','
string|'"bad_id"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'ProcessExecutionError'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_snapshot'
op|','
name|'snapshot'
op|')'
newline|'\n'
nl|'\n'
comment|'# Test successful snapshot'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_snapshot'
op|'('
name|'snapshot'
op|')'
newline|'\n'
nl|'\n'
comment|'# Ensure snapshot is defined'
nl|'\n'
name|'is_volume_defined'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_is_volume_defined'
op|'('
name|'snapshot'
op|'['
string|'"name"'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'is_volume_defined'
op|','
name|'True'
op|')'
newline|'\n'
nl|'\n'
comment|'# Try to create a snapshot from an non-existing volume - should fail'
nl|'\n'
name|'snapshot2'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'snapshot2'
op|'['
string|'"name"'
op|']'
op|'='
string|'"snap_volume%s"'
op|'%'
name|'random'
op|'.'
name|'randint'
op|'('
number|'10000'
op|','
number|'99999'
op|')'
newline|'\n'
name|'snapshot2'
op|'['
string|'"volume_name"'
op|']'
op|'='
string|'"undefined-vol"'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'VolumeNotFound'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_snapshot'
op|','
nl|'\n'
name|'snapshot2'
op|')'
newline|'\n'
nl|'\n'
comment|'# Create volume from snapshot'
nl|'\n'
name|'volume2'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'volume2'
op|'['
string|'"name"'
op|']'
op|'='
string|'"snap2vol_volume%s"'
op|'%'
name|'random'
op|'.'
name|'randint'
op|'('
number|'10000'
op|','
number|'99999'
op|')'
newline|'\n'
nl|'\n'
comment|'# Create volume from snapshot into an existsing volume'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'InvalidSnapshot'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_volume_from_snapshot'
op|','
nl|'\n'
name|'volume1'
op|','
nl|'\n'
name|'snapshot'
op|')'
newline|'\n'
nl|'\n'
comment|'# Try to create a volume from a non-existing snapshot'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'SnapshotNotFound'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_volume_from_snapshot'
op|','
nl|'\n'
name|'volume2'
op|','
nl|'\n'
name|'snapshot2'
op|')'
newline|'\n'
nl|'\n'
comment|'# Fail the snapshot'
nl|'\n'
name|'if'
name|'self'
op|'.'
name|'USESIM'
op|'=='
number|'1'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'sim'
op|'.'
name|'error_injection'
op|'('
string|'"prestartfcmap"'
op|','
string|'"bad_id"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'ProcessExecutionError'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_volume_from_snapshot'
op|','
name|'volume2'
op|','
name|'snapshot'
op|')'
newline|'\n'
nl|'\n'
comment|'# Succeed'
nl|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'USESIM'
op|'=='
number|'1'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'sim'
op|'.'
name|'error_injection'
op|'('
string|'"lsfcmap"'
op|','
string|'"speed_up"'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_volume_from_snapshot'
op|'('
name|'volume2'
op|','
name|'snapshot'
op|')'
newline|'\n'
nl|'\n'
comment|'# Ensure volume is defined'
nl|'\n'
name|'is_volume_defined'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_is_volume_defined'
op|'('
name|'volume2'
op|'['
string|'"name"'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'is_volume_defined'
op|','
name|'True'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_delete_volume'
op|'('
name|'volume2'
op|','
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_delete_snapshot'
op|'('
name|'snapshot'
op|','
name|'True'
op|')'
newline|'\n'
nl|'\n'
comment|'# Check with target with different size'
nl|'\n'
name|'volume3'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'volume3'
op|'['
string|'"name"'
op|']'
op|'='
string|'"test_volume%s"'
op|'%'
name|'random'
op|'.'
name|'randint'
op|'('
number|'10000'
op|','
number|'99999'
op|')'
newline|'\n'
name|'volume3'
op|'['
string|'"size"'
op|']'
op|'='
number|'11'
newline|'\n'
name|'volume3'
op|'['
string|'"id"'
op|']'
op|'='
number|'11'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_volume'
op|'('
name|'volume3'
op|')'
newline|'\n'
name|'snapshot'
op|'['
string|'"name"'
op|']'
op|'='
name|'volume3'
op|'['
string|'"name"'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'InvalidSnapshot'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_snapshot'
op|','
name|'snapshot'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_delete_volume'
op|'('
name|'volume1'
op|','
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_delete_volume'
op|'('
name|'volume3'
op|','
name|'True'
op|')'
newline|'\n'
nl|'\n'
comment|"# Snapshot volume that doesn't exist"
nl|'\n'
name|'snapshot'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'snapshot'
op|'['
string|'"name"'
op|']'
op|'='
string|'"snap_volume%s"'
op|'%'
name|'random'
op|'.'
name|'randint'
op|'('
number|'10000'
op|','
number|'99999'
op|')'
newline|'\n'
name|'snapshot'
op|'['
string|'"volume_name"'
op|']'
op|'='
string|'"no_exist"'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'VolumeNotFound'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_snapshot'
op|','
name|'snapshot'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_storwize_svc_volumes
dedent|''
name|'def'
name|'test_storwize_svc_volumes'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# Create a first volume'
nl|'\n'
indent|'        '
name|'volume'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'volume'
op|'['
string|'"name"'
op|']'
op|'='
string|'"test1_volume%s"'
op|'%'
name|'random'
op|'.'
name|'randint'
op|'('
number|'10000'
op|','
number|'99999'
op|')'
newline|'\n'
name|'volume'
op|'['
string|'"size"'
op|']'
op|'='
number|'10'
newline|'\n'
name|'volume'
op|'['
string|'"id"'
op|']'
op|'='
number|'1'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_volume'
op|'('
name|'volume'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'ensure_export'
op|'('
name|'None'
op|','
name|'volume'
op|')'
newline|'\n'
nl|'\n'
comment|'# Do nothing'
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_export'
op|'('
name|'None'
op|','
name|'volume'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'remove_export'
op|'('
name|'None'
op|','
name|'volume'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'NotImplementedError'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'check_for_export'
op|','
name|'None'
op|','
name|'volume'
op|'['
string|'"id"'
op|']'
op|')'
newline|'\n'
nl|'\n'
comment|'# Make sure volume attributes are as they should be'
nl|'\n'
name|'attributes'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_get_volume_attributes'
op|'('
name|'volume'
op|'['
string|'"name"'
op|']'
op|')'
newline|'\n'
name|'attr_size'
op|'='
name|'float'
op|'('
name|'attributes'
op|'['
string|'"capacity"'
op|']'
op|')'
op|'/'
number|'1073741824'
comment|'# bytes to GB'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'attr_size'
op|','
name|'float'
op|'('
name|'volume'
op|'['
string|'"size"'
op|']'
op|')'
op|')'
newline|'\n'
name|'pool'
op|'='
name|'getattr'
op|'('
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|','
string|'"storwize_svc_volpool_name"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'attributes'
op|'['
string|'"mdisk_grp_name"'
op|']'
op|','
name|'pool'
op|')'
newline|'\n'
name|'vtype'
op|'='
name|'getattr'
op|'('
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|','
string|'"storwize_svc_vol_vtype"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'attributes'
op|'['
string|'"type"'
op|']'
op|','
name|'vtype'
op|')'
newline|'\n'
nl|'\n'
comment|'# Try to create the volume again (should fail)'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'ProcessExecutionError'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_volume'
op|','
name|'volume'
op|')'
newline|'\n'
nl|'\n'
comment|"# Try to delete a volume that doesn't exist (should not fail)"
nl|'\n'
name|'vol_no_exist'
op|'='
op|'{'
string|'"name"'
op|':'
string|'"i_dont_exist"'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'delete_volume'
op|'('
name|'vol_no_exist'
op|')'
newline|'\n'
comment|"# Ensure export for volume that doesn't exist (should not fail)"
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'ensure_export'
op|'('
name|'None'
op|','
name|'vol_no_exist'
op|')'
newline|'\n'
nl|'\n'
comment|'# Delete the volume'
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'delete_volume'
op|'('
name|'volume'
op|')'
newline|'\n'
nl|'\n'
comment|'# Check auto-expand option'
nl|'\n'
name|'saved'
op|'='
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_autoexpand'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_autoexpand'
op|'='
name|'False'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_volume'
op|'('
name|'volume'
op|')'
newline|'\n'
name|'is_volume_defined'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_is_volume_defined'
op|'('
name|'volume'
op|'['
string|'"name"'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'is_volume_defined'
op|','
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'delete_volume'
op|'('
name|'volume'
op|')'
newline|'\n'
name|'storwize_svc'
op|'.'
name|'FLAGS'
op|'.'
name|'storwize_svc_vol_autoexpand'
op|'='
name|'saved'
newline|'\n'
nl|'\n'
DECL|member|test_storwize_svc_unicode_host_and_volume_names
dedent|''
name|'def'
name|'test_storwize_svc_unicode_host_and_volume_names'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'volume1'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'volume1'
op|'['
string|'"name"'
op|']'
op|'='
string|'u"unicode1_volume%s"'
op|'%'
name|'random'
op|'.'
name|'randint'
op|'('
number|'10000'
op|','
number|'99999'
op|')'
newline|'\n'
name|'volume1'
op|'['
string|'"size"'
op|']'
op|'='
number|'2'
newline|'\n'
name|'volume1'
op|'['
string|'"id"'
op|']'
op|'='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_volume'
op|'('
name|'volume1'
op|')'
newline|'\n'
comment|'# Make sure that the volumes have been created'
nl|'\n'
name|'is_volume_defined'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_is_volume_defined'
op|'('
name|'volume1'
op|'['
string|'"name"'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'is_volume_defined'
op|','
name|'True'
op|')'
newline|'\n'
name|'conn'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'conn'
op|'['
string|'"initiator"'
op|']'
op|'='
string|'u"unicode:init:%s"'
op|'%'
name|'random'
op|'.'
name|'randint'
op|'('
number|'10000'
op|','
number|'99999'
op|')'
newline|'\n'
name|'conn'
op|'['
string|'"ip"'
op|']'
op|'='
string|'"10.10.10.10"'
comment|'# Bogus ip for testing'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'initialize_connection'
op|'('
name|'volume1'
op|','
name|'conn'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'terminate_connection'
op|'('
name|'volume1'
op|','
name|'conn'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'delete_volume'
op|'('
name|'volume1'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_storwize_svc_host_maps
dedent|''
name|'def'
name|'test_storwize_svc_host_maps'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# Create two volumes to be used in mappings'
nl|'\n'
indent|'        '
name|'volume1'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'volume1'
op|'['
string|'"name"'
op|']'
op|'='
string|'"test1_volume%s"'
op|'%'
name|'random'
op|'.'
name|'randint'
op|'('
number|'10000'
op|','
number|'99999'
op|')'
newline|'\n'
name|'volume1'
op|'['
string|'"size"'
op|']'
op|'='
number|'2'
newline|'\n'
name|'volume1'
op|'['
string|'"id"'
op|']'
op|'='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_volume'
op|'('
name|'volume1'
op|')'
newline|'\n'
name|'volume2'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'volume2'
op|'['
string|'"name"'
op|']'
op|'='
string|'"test2_volume%s"'
op|'%'
name|'random'
op|'.'
name|'randint'
op|'('
number|'10000'
op|','
number|'99999'
op|')'
newline|'\n'
name|'volume2'
op|'['
string|'"size"'
op|']'
op|'='
number|'2'
newline|'\n'
name|'volume2'
op|'['
string|'"id"'
op|']'
op|'='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'create_volume'
op|'('
name|'volume2'
op|')'
newline|'\n'
nl|'\n'
comment|'# Check case where no hosts exist'
nl|'\n'
name|'if'
name|'self'
op|'.'
name|'USESIM'
op|'=='
number|'1'
op|':'
newline|'\n'
indent|'            '
name|'ret'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_get_host_from_iscsiname'
op|'('
string|'"foo"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'ret'
op|','
name|'None'
op|')'
newline|'\n'
name|'ret'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_is_host_defined'
op|'('
string|'"foo"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'ret'
op|','
name|'False'
op|')'
newline|'\n'
nl|'\n'
comment|'# Make sure that the volumes have been created'
nl|'\n'
dedent|''
name|'is_volume_defined'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_is_volume_defined'
op|'('
name|'volume1'
op|'['
string|'"name"'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'is_volume_defined'
op|','
name|'True'
op|')'
newline|'\n'
name|'is_volume_defined'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_is_volume_defined'
op|'('
name|'volume2'
op|'['
string|'"name"'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'is_volume_defined'
op|','
name|'True'
op|')'
newline|'\n'
nl|'\n'
comment|'# Initialize connection from the first volume to a host'
nl|'\n'
comment|'# Add some characters to the initiator name that should be converted'
nl|'\n'
comment|'# when used for the host name'
nl|'\n'
name|'conn'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'conn'
op|'['
string|'"initiator"'
op|']'
op|'='
string|'"test:init:%s"'
op|'%'
name|'random'
op|'.'
name|'randint'
op|'('
number|'10000'
op|','
number|'99999'
op|')'
newline|'\n'
name|'conn'
op|'['
string|'"ip"'
op|']'
op|'='
string|'"10.10.10.10"'
comment|'# Bogus ip for testing'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'initialize_connection'
op|'('
name|'volume1'
op|','
name|'conn'
op|')'
newline|'\n'
nl|'\n'
comment|'# Initialize again, should notice it and do nothing'
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'initialize_connection'
op|'('
name|'volume1'
op|','
name|'conn'
op|')'
newline|'\n'
nl|'\n'
comment|'# Try to delete the 1st volume (should fail because it is mapped)'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'ProcessExecutionError'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'delete_volume'
op|','
name|'volume1'
op|')'
newline|'\n'
nl|'\n'
comment|'# Test no preferred node'
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'terminate_connection'
op|'('
name|'volume1'
op|','
name|'conn'
op|')'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'USESIM'
op|'=='
number|'1'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'sim'
op|'.'
name|'error_injection'
op|'('
string|'"lsvdisk"'
op|','
string|'"no_pref_node"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'initialize_connection'
op|'('
name|'volume1'
op|','
name|'conn'
op|')'
newline|'\n'
nl|'\n'
comment|'# Initialize connection from the second volume to the host with no'
nl|'\n'
comment|'# preferred node set if in simulation mode, otherwise, just'
nl|'\n'
comment|'# another initialize connection.'
nl|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'USESIM'
op|'=='
number|'1'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'sim'
op|'.'
name|'error_injection'
op|'('
string|'"lsvdisk"'
op|','
string|'"blank_pref_node"'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'driver'
op|'.'
name|'initialize_connection'
op|'('
name|'volume2'
op|','
name|'conn'
op|')'
newline|'\n'
nl|'\n'
comment|"# Try to remove connection from host that doesn't exist (should fail)"
nl|'\n'
name|'conn_no_exist'
op|'='
op|'{'
string|'"initiator"'
op|':'
string|'"i_dont_exist"'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'VolumeBackendAPIException'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'terminate_connection'
op|','
name|'volume1'
op|','
name|'conn_no_exist'
op|')'
newline|'\n'
nl|'\n'
comment|"# Try to remove connection from volume that isn't mapped (should print"
nl|'\n'
comment|'# message but NOT fail)'
nl|'\n'
name|'vol_no_exist'
op|'='
op|'{'
string|'"name"'
op|':'
string|'"i_dont_exist"'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'terminate_connection'
op|'('
name|'vol_no_exist'
op|','
name|'conn'
op|')'
newline|'\n'
nl|'\n'
comment|'# Remove the mapping from the 1st volume and delete it'
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'terminate_connection'
op|'('
name|'volume1'
op|','
name|'conn'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'delete_volume'
op|'('
name|'volume1'
op|')'
newline|'\n'
name|'vol_def'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_is_volume_defined'
op|'('
name|'volume1'
op|'['
string|'"name"'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'vol_def'
op|','
name|'False'
op|')'
newline|'\n'
nl|'\n'
comment|'# Make sure our host still exists'
nl|'\n'
name|'host_name'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_get_host_from_iscsiname'
op|'('
name|'conn'
op|'['
string|'"initiator"'
op|']'
op|')'
newline|'\n'
name|'host_def'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_is_host_defined'
op|'('
name|'host_name'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'host_def'
op|','
name|'True'
op|')'
newline|'\n'
nl|'\n'
comment|'# Remove the mapping from the 2nd volume and delete it. The host should'
nl|'\n'
comment|'# be automatically removed because there are no more mappings.'
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'terminate_connection'
op|'('
name|'volume2'
op|','
name|'conn'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'delete_volume'
op|'('
name|'volume2'
op|')'
newline|'\n'
name|'vol_def'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_is_volume_defined'
op|'('
name|'volume2'
op|'['
string|'"name"'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'vol_def'
op|','
name|'False'
op|')'
newline|'\n'
nl|'\n'
comment|'# Check if our host still exists (it should not)'
nl|'\n'
name|'ret'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_get_host_from_iscsiname'
op|'('
name|'conn'
op|'['
string|'"initiator"'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'ret'
op|','
name|'None'
op|')'
newline|'\n'
name|'ret'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_is_host_defined'
op|'('
name|'host_name'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'ret'
op|','
name|'False'
op|')'
newline|'\n'
dedent|''
dedent|''
endmarker|''
end_unit
