begin_unit
comment|'# Copyright 2014 Red Hat, Inc.'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# Licensed under the Apache License, Version 2.0 (the "License"); you may'
nl|'\n'
comment|'# not use this file except in compliance with the License. You may obtain'
nl|'\n'
comment|'# a copy of the License at'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#   http://www.apache.org/licenses/LICENSE-2.0'
nl|'\n'
comment|'#'
nl|'\n'
comment|'# Unless required by applicable law or agreed to in writing, software'
nl|'\n'
comment|'# distributed under the License is distributed on an "AS IS" BASIS, WITHOUT'
nl|'\n'
comment|'# WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the'
nl|'\n'
comment|'# License for the specific language governing permissions and limitations'
nl|'\n'
comment|'# under the License.'
nl|'\n'
nl|'\n'
name|'import'
name|'collections'
newline|'\n'
name|'import'
name|'uuid'
newline|'\n'
nl|'\n'
name|'import'
name|'mock'
newline|'\n'
name|'from'
name|'oslo_serialization'
name|'import'
name|'jsonutils'
newline|'\n'
name|'import'
name|'six'
newline|'\n'
nl|'\n'
name|'from'
name|'nova'
name|'import'
name|'context'
newline|'\n'
name|'from'
name|'nova'
name|'import'
name|'exception'
newline|'\n'
name|'from'
name|'nova'
name|'import'
name|'objects'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'objects'
name|'import'
name|'base'
name|'as'
name|'base_obj'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'objects'
name|'import'
name|'fields'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'pci'
name|'import'
name|'stats'
newline|'\n'
name|'from'
name|'nova'
name|'import'
name|'test'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'virt'
name|'import'
name|'hardware'
name|'as'
name|'hw'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|InstanceInfoTests
name|'class'
name|'InstanceInfoTests'
op|'('
name|'test'
op|'.'
name|'NoDBTestCase'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|test_instance_info_default
indent|'    '
name|'def'
name|'test_instance_info_default'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'ii'
op|'='
name|'hw'
op|'.'
name|'InstanceInfo'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'ii'
op|'.'
name|'state'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'ii'
op|'.'
name|'id'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'0'
op|','
name|'ii'
op|'.'
name|'max_mem_kb'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'0'
op|','
name|'ii'
op|'.'
name|'mem_kb'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'0'
op|','
name|'ii'
op|'.'
name|'num_cpu'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'0'
op|','
name|'ii'
op|'.'
name|'cpu_time_ns'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_instance_info
dedent|''
name|'def'
name|'test_instance_info'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'ii'
op|'='
name|'hw'
op|'.'
name|'InstanceInfo'
op|'('
name|'state'
op|'='
string|"'fake-state'"
op|','
nl|'\n'
name|'max_mem_kb'
op|'='
number|'1'
op|','
nl|'\n'
name|'mem_kb'
op|'='
number|'2'
op|','
nl|'\n'
name|'num_cpu'
op|'='
number|'3'
op|','
nl|'\n'
name|'cpu_time_ns'
op|'='
number|'4'
op|','
nl|'\n'
name|'id'
op|'='
string|"'fake-id'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'fake-state'"
op|','
name|'ii'
op|'.'
name|'state'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'fake-id'"
op|','
name|'ii'
op|'.'
name|'id'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'1'
op|','
name|'ii'
op|'.'
name|'max_mem_kb'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'2'
op|','
name|'ii'
op|'.'
name|'mem_kb'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'3'
op|','
name|'ii'
op|'.'
name|'num_cpu'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'4'
op|','
name|'ii'
op|'.'
name|'cpu_time_ns'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_instance_infoi_equals
dedent|''
name|'def'
name|'test_instance_infoi_equals'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'ii1'
op|'='
name|'hw'
op|'.'
name|'InstanceInfo'
op|'('
name|'state'
op|'='
string|"'fake-state'"
op|','
nl|'\n'
name|'max_mem_kb'
op|'='
number|'1'
op|','
nl|'\n'
name|'mem_kb'
op|'='
number|'2'
op|','
nl|'\n'
name|'num_cpu'
op|'='
number|'3'
op|','
nl|'\n'
name|'cpu_time_ns'
op|'='
number|'4'
op|','
nl|'\n'
name|'id'
op|'='
string|"'fake-id'"
op|')'
newline|'\n'
name|'ii2'
op|'='
name|'hw'
op|'.'
name|'InstanceInfo'
op|'('
name|'state'
op|'='
string|"'fake-state'"
op|','
nl|'\n'
name|'max_mem_kb'
op|'='
number|'1'
op|','
nl|'\n'
name|'mem_kb'
op|'='
number|'2'
op|','
nl|'\n'
name|'num_cpu'
op|'='
number|'3'
op|','
nl|'\n'
name|'cpu_time_ns'
op|'='
number|'4'
op|','
nl|'\n'
name|'id'
op|'='
string|"'fake-id'"
op|')'
newline|'\n'
name|'ii3'
op|'='
name|'hw'
op|'.'
name|'InstanceInfo'
op|'('
name|'state'
op|'='
string|"'fake-estat'"
op|','
nl|'\n'
name|'max_mem_kb'
op|'='
number|'11'
op|','
nl|'\n'
name|'mem_kb'
op|'='
number|'22'
op|','
nl|'\n'
name|'num_cpu'
op|'='
number|'33'
op|','
nl|'\n'
name|'cpu_time_ns'
op|'='
number|'44'
op|','
nl|'\n'
name|'id'
op|'='
string|"'fake-di'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'ii1'
op|','
name|'ii2'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertNotEqual'
op|'('
name|'ii1'
op|','
name|'ii3'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|CpuSetTestCase
dedent|''
dedent|''
name|'class'
name|'CpuSetTestCase'
op|'('
name|'test'
op|'.'
name|'NoDBTestCase'
op|')'
op|':'
newline|'\n'
DECL|member|test_get_vcpu_pin_set
indent|'    '
name|'def'
name|'test_get_vcpu_pin_set'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'flags'
op|'('
name|'vcpu_pin_set'
op|'='
string|'"1-3,5,^2"'
op|')'
newline|'\n'
name|'cpuset_ids'
op|'='
name|'hw'
op|'.'
name|'get_vcpu_pin_set'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'3'
op|','
number|'5'
op|']'
op|')'
op|','
name|'cpuset_ids'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_parse_cpu_spec_none_returns_none
dedent|''
name|'def'
name|'test_parse_cpu_spec_none_returns_none'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'flags'
op|'('
name|'vcpu_pin_set'
op|'='
name|'None'
op|')'
newline|'\n'
name|'cpuset_ids'
op|'='
name|'hw'
op|'.'
name|'get_vcpu_pin_set'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'cpuset_ids'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_parse_cpu_spec_valid_syntax_works
dedent|''
name|'def'
name|'test_parse_cpu_spec_valid_syntax_works'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'cpuset_ids'
op|'='
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|'('
string|'"1"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
op|'['
number|'1'
op|']'
op|')'
op|','
name|'cpuset_ids'
op|')'
newline|'\n'
nl|'\n'
name|'cpuset_ids'
op|'='
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|'('
string|'"1,2"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
name|'cpuset_ids'
op|')'
newline|'\n'
nl|'\n'
name|'cpuset_ids'
op|'='
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|'('
string|'", ,   1 ,  ,,  2,    ,"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
name|'cpuset_ids'
op|')'
newline|'\n'
nl|'\n'
name|'cpuset_ids'
op|'='
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|'('
string|'"1-1"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
op|'['
number|'1'
op|']'
op|')'
op|','
name|'cpuset_ids'
op|')'
newline|'\n'
nl|'\n'
name|'cpuset_ids'
op|'='
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|'('
string|'" 1 - 1, 1 - 2 , 1 -3"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'cpuset_ids'
op|')'
newline|'\n'
nl|'\n'
name|'cpuset_ids'
op|'='
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|'('
string|'"1,^2"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
op|'['
number|'1'
op|']'
op|')'
op|','
name|'cpuset_ids'
op|')'
newline|'\n'
nl|'\n'
name|'cpuset_ids'
op|'='
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|'('
string|'"1-2, ^1"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
op|'['
number|'2'
op|']'
op|')'
op|','
name|'cpuset_ids'
op|')'
newline|'\n'
nl|'\n'
name|'cpuset_ids'
op|'='
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|'('
string|'"1-3,5,^2"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'3'
op|','
number|'5'
op|']'
op|')'
op|','
name|'cpuset_ids'
op|')'
newline|'\n'
nl|'\n'
name|'cpuset_ids'
op|'='
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|'('
string|'" 1 -    3        ,   ^2,        5"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'3'
op|','
number|'5'
op|']'
op|')'
op|','
name|'cpuset_ids'
op|')'
newline|'\n'
nl|'\n'
name|'cpuset_ids'
op|'='
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|'('
string|'" 1,1, ^1"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
op|'['
op|']'
op|')'
op|','
name|'cpuset_ids'
op|')'
newline|'\n'
nl|'\n'
name|'cpuset_ids'
op|'='
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|'('
string|'"^0-1"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
op|'['
op|']'
op|')'
op|','
name|'cpuset_ids'
op|')'
newline|'\n'
nl|'\n'
name|'cpuset_ids'
op|'='
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|'('
string|'"0-3,^1-2"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'3'
op|']'
op|')'
op|','
name|'cpuset_ids'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_parse_cpu_spec_invalid_syntax_raises
dedent|''
name|'def'
name|'test_parse_cpu_spec_invalid_syntax_raises'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'Invalid'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|','
nl|'\n'
string|'" -1-3,5,^2"'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'Invalid'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|','
nl|'\n'
string|'"1-3-,5,^2"'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'Invalid'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|','
nl|'\n'
string|'"-3,5,^2"'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'Invalid'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|','
nl|'\n'
string|'"1-,5,^2"'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'Invalid'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|','
nl|'\n'
string|'"1-3,5,^2^"'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'Invalid'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|','
nl|'\n'
string|'"1-3,5,^2-"'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'Invalid'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|','
nl|'\n'
string|'"--13,^^5,^2"'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'Invalid'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|','
nl|'\n'
string|'"a-3,5,^2"'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'Invalid'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|','
nl|'\n'
string|'"1-a,5,^2"'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'Invalid'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|','
nl|'\n'
string|'"1-3,b,^2"'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'Invalid'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|','
nl|'\n'
string|'"1-3,5,^c"'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'Invalid'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'parse_cpu_spec'
op|','
nl|'\n'
string|'"3 - 1, 5 , ^ 2 "'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_format_cpu_spec
dedent|''
name|'def'
name|'test_format_cpu_spec'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
newline|'\n'
name|'spec'
op|'='
name|'hw'
op|'.'
name|'format_cpu_spec'
op|'('
name|'cpus'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|'""'
op|','
name|'spec'
op|')'
newline|'\n'
nl|'\n'
name|'cpus'
op|'='
op|'['
op|']'
newline|'\n'
name|'spec'
op|'='
name|'hw'
op|'.'
name|'format_cpu_spec'
op|'('
name|'cpus'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|'""'
op|','
name|'spec'
op|')'
newline|'\n'
nl|'\n'
name|'cpus'
op|'='
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'3'
op|']'
op|')'
newline|'\n'
name|'spec'
op|'='
name|'hw'
op|'.'
name|'format_cpu_spec'
op|'('
name|'cpus'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|'"1,3"'
op|','
name|'spec'
op|')'
newline|'\n'
nl|'\n'
name|'cpus'
op|'='
op|'['
number|'1'
op|','
number|'3'
op|']'
newline|'\n'
name|'spec'
op|'='
name|'hw'
op|'.'
name|'format_cpu_spec'
op|'('
name|'cpus'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|'"1,3"'
op|','
name|'spec'
op|')'
newline|'\n'
nl|'\n'
name|'cpus'
op|'='
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'2'
op|','
number|'4'
op|','
number|'6'
op|']'
op|')'
newline|'\n'
name|'spec'
op|'='
name|'hw'
op|'.'
name|'format_cpu_spec'
op|'('
name|'cpus'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|'"1-2,4,6"'
op|','
name|'spec'
op|')'
newline|'\n'
nl|'\n'
name|'cpus'
op|'='
op|'['
number|'1'
op|','
number|'2'
op|','
number|'4'
op|','
number|'6'
op|']'
newline|'\n'
name|'spec'
op|'='
name|'hw'
op|'.'
name|'format_cpu_spec'
op|'('
name|'cpus'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|'"1-2,4,6"'
op|','
name|'spec'
op|')'
newline|'\n'
nl|'\n'
name|'cpus'
op|'='
name|'set'
op|'('
op|'['
number|'10'
op|','
number|'11'
op|','
number|'13'
op|','
number|'14'
op|','
number|'15'
op|','
number|'16'
op|','
number|'19'
op|','
number|'20'
op|','
number|'40'
op|','
number|'42'
op|','
number|'48'
op|']'
op|')'
newline|'\n'
name|'spec'
op|'='
name|'hw'
op|'.'
name|'format_cpu_spec'
op|'('
name|'cpus'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|'"10-11,13-16,19-20,40,42,48"'
op|','
name|'spec'
op|')'
newline|'\n'
nl|'\n'
name|'cpus'
op|'='
op|'['
number|'10'
op|','
number|'11'
op|','
number|'13'
op|','
number|'14'
op|','
number|'15'
op|','
number|'16'
op|','
number|'19'
op|','
number|'20'
op|','
number|'40'
op|','
number|'42'
op|','
number|'48'
op|']'
newline|'\n'
name|'spec'
op|'='
name|'hw'
op|'.'
name|'format_cpu_spec'
op|'('
name|'cpus'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|'"10-11,13-16,19-20,40,42,48"'
op|','
name|'spec'
op|')'
newline|'\n'
nl|'\n'
name|'cpus'
op|'='
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'2'
op|','
number|'4'
op|','
number|'6'
op|']'
op|')'
newline|'\n'
name|'spec'
op|'='
name|'hw'
op|'.'
name|'format_cpu_spec'
op|'('
name|'cpus'
op|','
name|'allow_ranges'
op|'='
name|'False'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|'"1,2,4,6"'
op|','
name|'spec'
op|')'
newline|'\n'
nl|'\n'
name|'cpus'
op|'='
op|'['
number|'1'
op|','
number|'2'
op|','
number|'4'
op|','
number|'6'
op|']'
newline|'\n'
name|'spec'
op|'='
name|'hw'
op|'.'
name|'format_cpu_spec'
op|'('
name|'cpus'
op|','
name|'allow_ranges'
op|'='
name|'False'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|'"1,2,4,6"'
op|','
name|'spec'
op|')'
newline|'\n'
nl|'\n'
name|'cpus'
op|'='
name|'set'
op|'('
op|'['
number|'10'
op|','
number|'11'
op|','
number|'13'
op|','
number|'14'
op|','
number|'15'
op|','
number|'16'
op|','
number|'19'
op|','
number|'20'
op|','
number|'40'
op|','
number|'42'
op|','
number|'48'
op|']'
op|')'
newline|'\n'
name|'spec'
op|'='
name|'hw'
op|'.'
name|'format_cpu_spec'
op|'('
name|'cpus'
op|','
name|'allow_ranges'
op|'='
name|'False'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|'"10,11,13,14,15,16,19,20,40,42,48"'
op|','
name|'spec'
op|')'
newline|'\n'
nl|'\n'
name|'cpus'
op|'='
op|'['
number|'10'
op|','
number|'11'
op|','
number|'13'
op|','
number|'14'
op|','
number|'15'
op|','
number|'16'
op|','
number|'19'
op|','
number|'20'
op|','
number|'40'
op|','
number|'42'
op|','
number|'48'
op|']'
newline|'\n'
name|'spec'
op|'='
name|'hw'
op|'.'
name|'format_cpu_spec'
op|'('
name|'cpus'
op|','
name|'allow_ranges'
op|'='
name|'False'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|'"10,11,13,14,15,16,19,20,40,42,48"'
op|','
name|'spec'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|VCPUTopologyTest
dedent|''
dedent|''
name|'class'
name|'VCPUTopologyTest'
op|'('
name|'test'
op|'.'
name|'NoDBTestCase'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|test_validate_config
indent|'    '
name|'def'
name|'test_validate_config'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'testdata'
op|'='
op|'['
nl|'\n'
op|'{'
comment|'# Flavor sets preferred topology only'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'16'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:cpu_sockets"'
op|':'
string|'"8"'
op|','
nl|'\n'
string|'"hw:cpu_cores"'
op|':'
string|'"2"'
op|','
nl|'\n'
string|'"hw:cpu_threads"'
op|':'
string|'"1"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'('
nl|'\n'
number|'8'
op|','
number|'2'
op|','
number|'1'
op|','
number|'65536'
op|','
number|'65536'
op|','
number|'65536'
nl|'\n'
op|')'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
comment|'# Image topology overrides flavor'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'16'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:cpu_sockets"'
op|':'
string|'"8"'
op|','
nl|'\n'
string|'"hw:cpu_cores"'
op|':'
string|'"2"'
op|','
nl|'\n'
string|'"hw:cpu_threads"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"hw:cpu_max_threads"'
op|':'
string|'"2"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
nl|'\n'
string|'"hw_cpu_sockets"'
op|':'
string|'"4"'
op|','
nl|'\n'
string|'"hw_cpu_cores"'
op|':'
string|'"2"'
op|','
nl|'\n'
string|'"hw_cpu_threads"'
op|':'
string|'"2"'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'('
nl|'\n'
number|'4'
op|','
number|'2'
op|','
number|'2'
op|','
number|'65536'
op|','
number|'65536'
op|','
number|'2'
op|','
nl|'\n'
op|')'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
comment|'# Partial image topology overrides flavor'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'16'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:cpu_sockets"'
op|':'
string|'"8"'
op|','
nl|'\n'
string|'"hw:cpu_cores"'
op|':'
string|'"2"'
op|','
nl|'\n'
string|'"hw:cpu_threads"'
op|':'
string|'"1"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
nl|'\n'
string|'"hw_cpu_sockets"'
op|':'
string|'"2"'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'('
nl|'\n'
number|'2'
op|','
op|'-'
number|'1'
op|','
op|'-'
number|'1'
op|','
number|'65536'
op|','
number|'65536'
op|','
number|'65536'
op|','
nl|'\n'
op|')'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
comment|'# Restrict use of threads'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'16'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:cpu_max_threads"'
op|':'
string|'"2"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
nl|'\n'
string|'"hw_cpu_max_threads"'
op|':'
string|'"1"'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'('
nl|'\n'
op|'-'
number|'1'
op|','
op|'-'
number|'1'
op|','
op|'-'
number|'1'
op|','
number|'65536'
op|','
number|'65536'
op|','
number|'1'
op|','
nl|'\n'
op|')'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
comment|'# Force use of at least two sockets'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'16'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:cpu_max_cores"'
op|':'
string|'"8"'
op|','
nl|'\n'
string|'"hw:cpu_max_threads"'
op|':'
string|'"1"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'('
nl|'\n'
op|'-'
number|'1'
op|','
op|'-'
number|'1'
op|','
op|'-'
number|'1'
op|','
number|'65536'
op|','
number|'8'
op|','
number|'1'
nl|'\n'
op|')'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
comment|'# Image limits reduce flavor'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'16'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:cpu_max_cores"'
op|':'
string|'"8"'
op|','
nl|'\n'
string|'"hw:cpu_max_threads"'
op|':'
string|'"1"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
nl|'\n'
string|'"hw_cpu_max_cores"'
op|':'
string|'"4"'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'('
nl|'\n'
op|'-'
number|'1'
op|','
op|'-'
number|'1'
op|','
op|'-'
number|'1'
op|','
number|'65536'
op|','
number|'4'
op|','
number|'1'
nl|'\n'
op|')'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
comment|'# Image limits kill flavor preferred'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'16'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:cpu_sockets"'
op|':'
string|'"2"'
op|','
nl|'\n'
string|'"hw:cpu_cores"'
op|':'
string|'"8"'
op|','
nl|'\n'
string|'"hw:cpu_threads"'
op|':'
string|'"1"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
nl|'\n'
string|'"hw_cpu_max_cores"'
op|':'
string|'"4"'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'('
nl|'\n'
op|'-'
number|'1'
op|','
op|'-'
number|'1'
op|','
op|'-'
number|'1'
op|','
number|'65536'
op|','
number|'4'
op|','
number|'65536'
nl|'\n'
op|')'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
comment|'# Image limits cannot exceed flavor'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'16'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:cpu_max_cores"'
op|':'
string|'"8"'
op|','
nl|'\n'
string|'"hw:cpu_max_threads"'
op|':'
string|'"1"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
nl|'\n'
string|'"hw_cpu_max_cores"'
op|':'
string|'"16"'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'exception'
op|'.'
name|'ImageVCPULimitsRangeExceeded'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
comment|'# Image preferred cannot exceed flavor'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'16'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:cpu_max_cores"'
op|':'
string|'"8"'
op|','
nl|'\n'
string|'"hw:cpu_max_threads"'
op|':'
string|'"1"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
nl|'\n'
string|'"hw_cpu_cores"'
op|':'
string|'"16"'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'exception'
op|'.'
name|'ImageVCPUTopologyRangeExceeded'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
name|'for'
name|'topo_test'
name|'in'
name|'testdata'
op|':'
newline|'\n'
indent|'            '
name|'image_meta'
op|'='
name|'objects'
op|'.'
name|'ImageMeta'
op|'.'
name|'from_dict'
op|'('
name|'topo_test'
op|'['
string|'"image"'
op|']'
op|')'
newline|'\n'
name|'if'
name|'type'
op|'('
name|'topo_test'
op|'['
string|'"expect"'
op|']'
op|')'
op|'=='
name|'tuple'
op|':'
newline|'\n'
indent|'                '
op|'('
name|'preferred'
op|','
nl|'\n'
name|'maximum'
op|')'
op|'='
name|'hw'
op|'.'
name|'_get_cpu_topology_constraints'
op|'('
nl|'\n'
name|'topo_test'
op|'['
string|'"flavor"'
op|']'
op|','
name|'image_meta'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'topo_test'
op|'['
string|'"expect"'
op|']'
op|'['
number|'0'
op|']'
op|','
name|'preferred'
op|'.'
name|'sockets'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'topo_test'
op|'['
string|'"expect"'
op|']'
op|'['
number|'1'
op|']'
op|','
name|'preferred'
op|'.'
name|'cores'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'topo_test'
op|'['
string|'"expect"'
op|']'
op|'['
number|'2'
op|']'
op|','
name|'preferred'
op|'.'
name|'threads'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'topo_test'
op|'['
string|'"expect"'
op|']'
op|'['
number|'3'
op|']'
op|','
name|'maximum'
op|'.'
name|'sockets'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'topo_test'
op|'['
string|'"expect"'
op|']'
op|'['
number|'4'
op|']'
op|','
name|'maximum'
op|'.'
name|'cores'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'topo_test'
op|'['
string|'"expect"'
op|']'
op|'['
number|'5'
op|']'
op|','
name|'maximum'
op|'.'
name|'threads'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'topo_test'
op|'['
string|'"expect"'
op|']'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'_get_cpu_topology_constraints'
op|','
nl|'\n'
name|'topo_test'
op|'['
string|'"flavor"'
op|']'
op|','
nl|'\n'
name|'image_meta'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_possible_topologies
dedent|''
dedent|''
dedent|''
name|'def'
name|'test_possible_topologies'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'testdata'
op|'='
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'True'
op|','
nl|'\n'
string|'"vcpus"'
op|':'
number|'8'
op|','
nl|'\n'
string|'"maxsockets"'
op|':'
number|'8'
op|','
nl|'\n'
string|'"maxcores"'
op|':'
number|'8'
op|','
nl|'\n'
string|'"maxthreads"'
op|':'
number|'2'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'['
nl|'\n'
op|'['
number|'8'
op|','
number|'1'
op|','
number|'1'
op|']'
op|','
nl|'\n'
op|'['
number|'4'
op|','
number|'2'
op|','
number|'1'
op|']'
op|','
nl|'\n'
op|'['
number|'2'
op|','
number|'4'
op|','
number|'1'
op|']'
op|','
nl|'\n'
op|'['
number|'1'
op|','
number|'8'
op|','
number|'1'
op|']'
op|','
nl|'\n'
op|'['
number|'4'
op|','
number|'1'
op|','
number|'2'
op|']'
op|','
nl|'\n'
op|'['
number|'2'
op|','
number|'2'
op|','
number|'2'
op|']'
op|','
nl|'\n'
op|'['
number|'1'
op|','
number|'4'
op|','
number|'2'
op|']'
op|','
nl|'\n'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'False'
op|','
nl|'\n'
string|'"vcpus"'
op|':'
number|'8'
op|','
nl|'\n'
string|'"maxsockets"'
op|':'
number|'8'
op|','
nl|'\n'
string|'"maxcores"'
op|':'
number|'8'
op|','
nl|'\n'
string|'"maxthreads"'
op|':'
number|'2'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'['
nl|'\n'
op|'['
number|'8'
op|','
number|'1'
op|','
number|'1'
op|']'
op|','
nl|'\n'
op|'['
number|'4'
op|','
number|'2'
op|','
number|'1'
op|']'
op|','
nl|'\n'
op|'['
number|'2'
op|','
number|'4'
op|','
number|'1'
op|']'
op|','
nl|'\n'
op|'['
number|'1'
op|','
number|'8'
op|','
number|'1'
op|']'
op|','
nl|'\n'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'True'
op|','
nl|'\n'
string|'"vcpus"'
op|':'
number|'8'
op|','
nl|'\n'
string|'"maxsockets"'
op|':'
number|'1024'
op|','
nl|'\n'
string|'"maxcores"'
op|':'
number|'1024'
op|','
nl|'\n'
string|'"maxthreads"'
op|':'
number|'2'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'['
nl|'\n'
op|'['
number|'8'
op|','
number|'1'
op|','
number|'1'
op|']'
op|','
nl|'\n'
op|'['
number|'4'
op|','
number|'2'
op|','
number|'1'
op|']'
op|','
nl|'\n'
op|'['
number|'2'
op|','
number|'4'
op|','
number|'1'
op|']'
op|','
nl|'\n'
op|'['
number|'1'
op|','
number|'8'
op|','
number|'1'
op|']'
op|','
nl|'\n'
op|'['
number|'4'
op|','
number|'1'
op|','
number|'2'
op|']'
op|','
nl|'\n'
op|'['
number|'2'
op|','
number|'2'
op|','
number|'2'
op|']'
op|','
nl|'\n'
op|'['
number|'1'
op|','
number|'4'
op|','
number|'2'
op|']'
op|','
nl|'\n'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'True'
op|','
nl|'\n'
string|'"vcpus"'
op|':'
number|'8'
op|','
nl|'\n'
string|'"maxsockets"'
op|':'
number|'1024'
op|','
nl|'\n'
string|'"maxcores"'
op|':'
number|'1'
op|','
nl|'\n'
string|'"maxthreads"'
op|':'
number|'2'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'['
nl|'\n'
op|'['
number|'8'
op|','
number|'1'
op|','
number|'1'
op|']'
op|','
nl|'\n'
op|'['
number|'4'
op|','
number|'1'
op|','
number|'2'
op|']'
op|','
nl|'\n'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'True'
op|','
nl|'\n'
string|'"vcpus"'
op|':'
number|'7'
op|','
nl|'\n'
string|'"maxsockets"'
op|':'
number|'8'
op|','
nl|'\n'
string|'"maxcores"'
op|':'
number|'8'
op|','
nl|'\n'
string|'"maxthreads"'
op|':'
number|'2'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'['
nl|'\n'
op|'['
number|'7'
op|','
number|'1'
op|','
number|'1'
op|']'
op|','
nl|'\n'
op|'['
number|'1'
op|','
number|'7'
op|','
number|'1'
op|']'
op|','
nl|'\n'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'True'
op|','
nl|'\n'
string|'"vcpus"'
op|':'
number|'8'
op|','
nl|'\n'
string|'"maxsockets"'
op|':'
number|'2'
op|','
nl|'\n'
string|'"maxcores"'
op|':'
number|'1'
op|','
nl|'\n'
string|'"maxthreads"'
op|':'
number|'1'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'exception'
op|'.'
name|'ImageVCPULimitsRangeImpossible'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'False'
op|','
nl|'\n'
string|'"vcpus"'
op|':'
number|'8'
op|','
nl|'\n'
string|'"maxsockets"'
op|':'
number|'2'
op|','
nl|'\n'
string|'"maxcores"'
op|':'
number|'1'
op|','
nl|'\n'
string|'"maxthreads"'
op|':'
number|'4'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'exception'
op|'.'
name|'ImageVCPULimitsRangeImpossible'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
name|'for'
name|'topo_test'
name|'in'
name|'testdata'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'type'
op|'('
name|'topo_test'
op|'['
string|'"expect"'
op|']'
op|')'
op|'=='
name|'list'
op|':'
newline|'\n'
indent|'                '
name|'actual'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'topology'
name|'in'
name|'hw'
op|'.'
name|'_get_possible_cpu_topologies'
op|'('
nl|'\n'
name|'topo_test'
op|'['
string|'"vcpus"'
op|']'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
nl|'\n'
name|'sockets'
op|'='
name|'topo_test'
op|'['
string|'"maxsockets"'
op|']'
op|','
nl|'\n'
name|'cores'
op|'='
name|'topo_test'
op|'['
string|'"maxcores"'
op|']'
op|','
nl|'\n'
name|'threads'
op|'='
name|'topo_test'
op|'['
string|'"maxthreads"'
op|']'
op|')'
op|','
nl|'\n'
name|'topo_test'
op|'['
string|'"allow_threads"'
op|']'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'actual'
op|'.'
name|'append'
op|'('
op|'['
name|'topology'
op|'.'
name|'sockets'
op|','
nl|'\n'
name|'topology'
op|'.'
name|'cores'
op|','
nl|'\n'
name|'topology'
op|'.'
name|'threads'
op|']'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'topo_test'
op|'['
string|'"expect"'
op|']'
op|','
name|'actual'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'topo_test'
op|'['
string|'"expect"'
op|']'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'_get_possible_cpu_topologies'
op|','
nl|'\n'
name|'topo_test'
op|'['
string|'"vcpus"'
op|']'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
nl|'\n'
name|'sockets'
op|'='
name|'topo_test'
op|'['
string|'"maxsockets"'
op|']'
op|','
nl|'\n'
name|'cores'
op|'='
name|'topo_test'
op|'['
string|'"maxcores"'
op|']'
op|','
nl|'\n'
name|'threads'
op|'='
name|'topo_test'
op|'['
string|'"maxthreads"'
op|']'
op|')'
op|','
nl|'\n'
name|'topo_test'
op|'['
string|'"allow_threads"'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_sorting_topologies
dedent|''
dedent|''
dedent|''
name|'def'
name|'test_sorting_topologies'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'testdata'
op|'='
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'True'
op|','
nl|'\n'
string|'"vcpus"'
op|':'
number|'8'
op|','
nl|'\n'
string|'"maxsockets"'
op|':'
number|'8'
op|','
nl|'\n'
string|'"maxcores"'
op|':'
number|'8'
op|','
nl|'\n'
string|'"maxthreads"'
op|':'
number|'2'
op|','
nl|'\n'
string|'"sockets"'
op|':'
number|'4'
op|','
nl|'\n'
string|'"cores"'
op|':'
number|'2'
op|','
nl|'\n'
string|'"threads"'
op|':'
number|'1'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'['
nl|'\n'
op|'['
number|'4'
op|','
number|'2'
op|','
number|'1'
op|']'
op|','
comment|'# score = 2'
nl|'\n'
op|'['
number|'8'
op|','
number|'1'
op|','
number|'1'
op|']'
op|','
comment|'# score = 1'
nl|'\n'
op|'['
number|'2'
op|','
number|'4'
op|','
number|'1'
op|']'
op|','
comment|'# score = 1'
nl|'\n'
op|'['
number|'1'
op|','
number|'8'
op|','
number|'1'
op|']'
op|','
comment|'# score = 1'
nl|'\n'
op|'['
number|'4'
op|','
number|'1'
op|','
number|'2'
op|']'
op|','
comment|'# score = 1'
nl|'\n'
op|'['
number|'2'
op|','
number|'2'
op|','
number|'2'
op|']'
op|','
comment|'# score = 1'
nl|'\n'
op|'['
number|'1'
op|','
number|'4'
op|','
number|'2'
op|']'
op|','
comment|'# score = 1'
nl|'\n'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'True'
op|','
nl|'\n'
string|'"vcpus"'
op|':'
number|'8'
op|','
nl|'\n'
string|'"maxsockets"'
op|':'
number|'1024'
op|','
nl|'\n'
string|'"maxcores"'
op|':'
number|'1024'
op|','
nl|'\n'
string|'"maxthreads"'
op|':'
number|'2'
op|','
nl|'\n'
string|'"sockets"'
op|':'
op|'-'
number|'1'
op|','
nl|'\n'
string|'"cores"'
op|':'
number|'4'
op|','
nl|'\n'
string|'"threads"'
op|':'
op|'-'
number|'1'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'['
nl|'\n'
op|'['
number|'2'
op|','
number|'4'
op|','
number|'1'
op|']'
op|','
comment|'# score = 1'
nl|'\n'
op|'['
number|'1'
op|','
number|'4'
op|','
number|'2'
op|']'
op|','
comment|'# score = 1'
nl|'\n'
op|'['
number|'8'
op|','
number|'1'
op|','
number|'1'
op|']'
op|','
comment|'# score = 0'
nl|'\n'
op|'['
number|'4'
op|','
number|'2'
op|','
number|'1'
op|']'
op|','
comment|'# score = 0'
nl|'\n'
op|'['
number|'1'
op|','
number|'8'
op|','
number|'1'
op|']'
op|','
comment|'# score = 0'
nl|'\n'
op|'['
number|'4'
op|','
number|'1'
op|','
number|'2'
op|']'
op|','
comment|'# score = 0'
nl|'\n'
op|'['
number|'2'
op|','
number|'2'
op|','
number|'2'
op|']'
op|','
comment|'# score = 0'
nl|'\n'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'True'
op|','
nl|'\n'
string|'"vcpus"'
op|':'
number|'8'
op|','
nl|'\n'
string|'"maxsockets"'
op|':'
number|'1024'
op|','
nl|'\n'
string|'"maxcores"'
op|':'
number|'1'
op|','
nl|'\n'
string|'"maxthreads"'
op|':'
number|'2'
op|','
nl|'\n'
string|'"sockets"'
op|':'
op|'-'
number|'1'
op|','
nl|'\n'
string|'"cores"'
op|':'
op|'-'
number|'1'
op|','
nl|'\n'
string|'"threads"'
op|':'
number|'2'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'['
nl|'\n'
op|'['
number|'4'
op|','
number|'1'
op|','
number|'2'
op|']'
op|','
comment|'# score = 1'
nl|'\n'
op|'['
number|'8'
op|','
number|'1'
op|','
number|'1'
op|']'
op|','
comment|'# score = 0'
nl|'\n'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'False'
op|','
nl|'\n'
string|'"vcpus"'
op|':'
number|'8'
op|','
nl|'\n'
string|'"maxsockets"'
op|':'
number|'1024'
op|','
nl|'\n'
string|'"maxcores"'
op|':'
number|'1'
op|','
nl|'\n'
string|'"maxthreads"'
op|':'
number|'2'
op|','
nl|'\n'
string|'"sockets"'
op|':'
op|'-'
number|'1'
op|','
nl|'\n'
string|'"cores"'
op|':'
op|'-'
number|'1'
op|','
nl|'\n'
string|'"threads"'
op|':'
number|'2'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'['
nl|'\n'
op|'['
number|'8'
op|','
number|'1'
op|','
number|'1'
op|']'
op|','
comment|'# score = 0'
nl|'\n'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
name|'for'
name|'topo_test'
name|'in'
name|'testdata'
op|':'
newline|'\n'
indent|'            '
name|'actual'
op|'='
op|'['
op|']'
newline|'\n'
name|'possible'
op|'='
name|'hw'
op|'.'
name|'_get_possible_cpu_topologies'
op|'('
nl|'\n'
name|'topo_test'
op|'['
string|'"vcpus"'
op|']'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
name|'sockets'
op|'='
name|'topo_test'
op|'['
string|'"maxsockets"'
op|']'
op|','
nl|'\n'
name|'cores'
op|'='
name|'topo_test'
op|'['
string|'"maxcores"'
op|']'
op|','
nl|'\n'
name|'threads'
op|'='
name|'topo_test'
op|'['
string|'"maxthreads"'
op|']'
op|')'
op|','
nl|'\n'
name|'topo_test'
op|'['
string|'"allow_threads"'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'tops'
op|'='
name|'hw'
op|'.'
name|'_sort_possible_cpu_topologies'
op|'('
nl|'\n'
name|'possible'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
name|'sockets'
op|'='
name|'topo_test'
op|'['
string|'"sockets"'
op|']'
op|','
nl|'\n'
name|'cores'
op|'='
name|'topo_test'
op|'['
string|'"cores"'
op|']'
op|','
nl|'\n'
name|'threads'
op|'='
name|'topo_test'
op|'['
string|'"threads"'
op|']'
op|')'
op|')'
newline|'\n'
name|'for'
name|'topology'
name|'in'
name|'tops'
op|':'
newline|'\n'
indent|'                '
name|'actual'
op|'.'
name|'append'
op|'('
op|'['
name|'topology'
op|'.'
name|'sockets'
op|','
nl|'\n'
name|'topology'
op|'.'
name|'cores'
op|','
nl|'\n'
name|'topology'
op|'.'
name|'threads'
op|']'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'topo_test'
op|'['
string|'"expect"'
op|']'
op|','
name|'actual'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_best_config
dedent|''
dedent|''
name|'def'
name|'test_best_config'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'testdata'
op|'='
op|'['
nl|'\n'
op|'{'
comment|'# Flavor sets preferred topology only'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'True'
op|','
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'16'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:cpu_sockets"'
op|':'
string|'"8"'
op|','
nl|'\n'
string|'"hw:cpu_cores"'
op|':'
string|'"2"'
op|','
nl|'\n'
string|'"hw:cpu_threads"'
op|':'
string|'"1"'
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'['
number|'8'
op|','
number|'2'
op|','
number|'1'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
comment|'# Image topology overrides flavor'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'True'
op|','
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'16'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:cpu_sockets"'
op|':'
string|'"8"'
op|','
nl|'\n'
string|'"hw:cpu_cores"'
op|':'
string|'"2"'
op|','
nl|'\n'
string|'"hw:cpu_threads"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"hw:cpu_maxthreads"'
op|':'
string|'"2"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
nl|'\n'
string|'"hw_cpu_sockets"'
op|':'
string|'"4"'
op|','
nl|'\n'
string|'"hw_cpu_cores"'
op|':'
string|'"2"'
op|','
nl|'\n'
string|'"hw_cpu_threads"'
op|':'
string|'"2"'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'['
number|'4'
op|','
number|'2'
op|','
number|'2'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
comment|'# Image topology overrides flavor'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'False'
op|','
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'16'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:cpu_sockets"'
op|':'
string|'"8"'
op|','
nl|'\n'
string|'"hw:cpu_cores"'
op|':'
string|'"2"'
op|','
nl|'\n'
string|'"hw:cpu_threads"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"hw:cpu_maxthreads"'
op|':'
string|'"2"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
nl|'\n'
string|'"hw_cpu_sockets"'
op|':'
string|'"4"'
op|','
nl|'\n'
string|'"hw_cpu_cores"'
op|':'
string|'"2"'
op|','
nl|'\n'
string|'"hw_cpu_threads"'
op|':'
string|'"2"'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'['
number|'8'
op|','
number|'2'
op|','
number|'1'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
comment|'# Partial image topology overrides flavor'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'True'
op|','
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'16'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:cpu_sockets"'
op|':'
string|'"8"'
op|','
nl|'\n'
string|'"hw:cpu_cores"'
op|':'
string|'"2"'
op|','
nl|'\n'
string|'"hw:cpu_threads"'
op|':'
string|'"1"'
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
nl|'\n'
string|'"hw_cpu_sockets"'
op|':'
string|'"2"'
nl|'\n'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'['
number|'2'
op|','
number|'8'
op|','
number|'1'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
comment|'# Restrict use of threads'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'True'
op|','
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'16'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:cpu_max_threads"'
op|':'
string|'"1"'
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'['
number|'16'
op|','
number|'1'
op|','
number|'1'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
comment|'# Force use of at least two sockets'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'True'
op|','
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'16'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:cpu_max_cores"'
op|':'
string|'"8"'
op|','
nl|'\n'
string|'"hw:cpu_max_threads"'
op|':'
string|'"1"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'['
number|'16'
op|','
number|'1'
op|','
number|'1'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
comment|'# Image limits reduce flavor'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'True'
op|','
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'16'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:cpu_max_sockets"'
op|':'
string|'"8"'
op|','
nl|'\n'
string|'"hw:cpu_max_cores"'
op|':'
string|'"8"'
op|','
nl|'\n'
string|'"hw:cpu_max_threads"'
op|':'
string|'"1"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
nl|'\n'
string|'"hw_cpu_max_sockets"'
op|':'
number|'4'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'['
number|'4'
op|','
number|'4'
op|','
number|'1'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
comment|'# Image limits kill flavor preferred'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'True'
op|','
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'16'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:cpu_sockets"'
op|':'
string|'"2"'
op|','
nl|'\n'
string|'"hw:cpu_cores"'
op|':'
string|'"8"'
op|','
nl|'\n'
string|'"hw:cpu_threads"'
op|':'
string|'"1"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
nl|'\n'
string|'"hw_cpu_max_cores"'
op|':'
number|'4'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'['
number|'16'
op|','
number|'1'
op|','
number|'1'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
comment|'# NUMA needs threads, only cores requested by flavor'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'True'
op|','
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'4'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:cpu_cores"'
op|':'
string|'"2"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
nl|'\n'
string|'"hw_cpu_max_cores"'
op|':'
number|'2'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"numa_topology"'
op|':'
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
nl|'\n'
name|'cpu_topology'
op|'='
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
nl|'\n'
name|'sockets'
op|'='
number|'1'
op|','
name|'cores'
op|'='
number|'1'
op|','
name|'threads'
op|'='
number|'2'
op|')'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|')'
op|']'
op|')'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'['
number|'1'
op|','
number|'2'
op|','
number|'2'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
comment|'# NUMA needs threads, but more than requested by flavor - the'
nl|'\n'
comment|'# least amount of threads wins'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'True'
op|','
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'4'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:cpu_threads"'
op|':'
string|'"2"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"numa_topology"'
op|':'
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_topology'
op|'='
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
nl|'\n'
name|'sockets'
op|'='
number|'1'
op|','
name|'cores'
op|'='
number|'1'
op|','
name|'threads'
op|'='
number|'4'
op|')'
op|')'
op|']'
op|')'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'['
number|'2'
op|','
number|'1'
op|','
number|'2'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
comment|'# NUMA needs threads, but more than limit in flavor - the'
nl|'\n'
comment|'# least amount of threads which divides into the vcpu'
nl|'\n'
comment|'# count wins. So with desired 4, max of 3, and'
nl|'\n'
comment|'# vcpu count of 4, we should get 2 threads.'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'True'
op|','
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'4'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:cpu_max_sockets"'
op|':'
string|'"5"'
op|','
nl|'\n'
string|'"hw:cpu_max_cores"'
op|':'
string|'"2"'
op|','
nl|'\n'
string|'"hw:cpu_max_threads"'
op|':'
string|'"3"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"numa_topology"'
op|':'
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_topology'
op|'='
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
nl|'\n'
name|'sockets'
op|'='
number|'1'
op|','
name|'cores'
op|'='
number|'1'
op|','
name|'threads'
op|'='
number|'4'
op|')'
op|')'
op|']'
op|')'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'['
number|'2'
op|','
number|'1'
op|','
number|'2'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
comment|'# NUMA needs threads, but thread count does not'
nl|'\n'
comment|'# divide into flavor vcpu count, so we must'
nl|'\n'
comment|'# reduce thread count to closest divisor'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'True'
op|','
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'6'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"numa_topology"'
op|':'
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_topology'
op|'='
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
nl|'\n'
name|'sockets'
op|'='
number|'1'
op|','
name|'cores'
op|'='
number|'1'
op|','
name|'threads'
op|'='
number|'4'
op|')'
op|')'
op|']'
op|')'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'['
number|'2'
op|','
number|'1'
op|','
number|'3'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
comment|'# NUMA needs different number of threads per cell - the least'
nl|'\n'
comment|'# amount of threads wins'
nl|'\n'
string|'"allow_threads"'
op|':'
name|'True'
op|','
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'8'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"numa_topology"'
op|':'
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
nl|'\n'
name|'cpu_topology'
op|'='
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
nl|'\n'
name|'sockets'
op|'='
number|'1'
op|','
name|'cores'
op|'='
number|'2'
op|','
name|'threads'
op|'='
number|'2'
op|')'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'4'
op|','
number|'5'
op|','
number|'6'
op|','
number|'7'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
nl|'\n'
name|'cpu_topology'
op|'='
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
nl|'\n'
name|'sockets'
op|'='
number|'1'
op|','
name|'cores'
op|'='
number|'1'
op|','
name|'threads'
op|'='
number|'4'
op|')'
op|')'
op|']'
op|')'
op|','
nl|'\n'
string|'"expect"'
op|':'
op|'['
number|'4'
op|','
number|'1'
op|','
number|'2'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
name|'for'
name|'topo_test'
name|'in'
name|'testdata'
op|':'
newline|'\n'
indent|'            '
name|'image_meta'
op|'='
name|'objects'
op|'.'
name|'ImageMeta'
op|'.'
name|'from_dict'
op|'('
name|'topo_test'
op|'['
string|'"image"'
op|']'
op|')'
newline|'\n'
name|'topology'
op|'='
name|'hw'
op|'.'
name|'_get_desirable_cpu_topologies'
op|'('
nl|'\n'
name|'topo_test'
op|'['
string|'"flavor"'
op|']'
op|','
nl|'\n'
name|'image_meta'
op|','
nl|'\n'
name|'topo_test'
op|'['
string|'"allow_threads"'
op|']'
op|','
nl|'\n'
name|'topo_test'
op|'.'
name|'get'
op|'('
string|'"numa_topology"'
op|')'
op|')'
op|'['
number|'0'
op|']'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'topo_test'
op|'['
string|'"expect"'
op|']'
op|'['
number|'0'
op|']'
op|','
name|'topology'
op|'.'
name|'sockets'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'topo_test'
op|'['
string|'"expect"'
op|']'
op|'['
number|'1'
op|']'
op|','
name|'topology'
op|'.'
name|'cores'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'topo_test'
op|'['
string|'"expect"'
op|']'
op|'['
number|'2'
op|']'
op|','
name|'topology'
op|'.'
name|'threads'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|NUMATopologyTest
dedent|''
dedent|''
dedent|''
name|'class'
name|'NUMATopologyTest'
op|'('
name|'test'
op|'.'
name|'NoDBTestCase'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|test_topology_constraints
indent|'    '
name|'def'
name|'test_topology_constraints'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'testdata'
op|'='
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'8'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'None'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'8'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:numa_nodes"'
op|':'
number|'2'
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
name|'cells'
op|'='
nl|'\n'
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'4'
op|','
number|'5'
op|','
number|'6'
op|','
number|'7'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|')'
op|','
nl|'\n'
op|']'
op|')'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'8'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:mem_page_size"'
op|':'
number|'2048'
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
name|'cells'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|','
number|'4'
op|','
number|'5'
op|','
number|'6'
op|','
number|'7'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|','
name|'pagesize'
op|'='
number|'2048'
op|')'
nl|'\n'
op|']'
op|')'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
comment|'# vcpus is not a multiple of nodes, so it'
nl|'\n'
comment|'# is an error to not provide cpu/mem mapping'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'8'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:numa_nodes"'
op|':'
number|'3'
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'exception'
op|'.'
name|'ImageNUMATopologyAsymmetric'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'8'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:numa_nodes"'
op|':'
number|'3'
op|','
nl|'\n'
string|'"hw:numa_cpus.0"'
op|':'
string|'"0-3"'
op|','
nl|'\n'
string|'"hw:numa_mem.0"'
op|':'
string|'"1024"'
op|','
nl|'\n'
string|'"hw:numa_cpus.1"'
op|':'
string|'"4,6"'
op|','
nl|'\n'
string|'"hw:numa_mem.1"'
op|':'
string|'"512"'
op|','
nl|'\n'
string|'"hw:numa_cpus.2"'
op|':'
string|'"5,7"'
op|','
nl|'\n'
string|'"hw:numa_mem.2"'
op|':'
string|'"512"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
name|'cells'
op|'='
nl|'\n'
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'4'
op|','
number|'6'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'512'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'2'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'5'
op|','
number|'7'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'512'
op|')'
nl|'\n'
op|']'
op|')'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'8'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
nl|'\n'
string|'"hw_numa_nodes"'
op|':'
number|'3'
op|','
nl|'\n'
string|'"hw_numa_cpus.0"'
op|':'
string|'"0-3"'
op|','
nl|'\n'
string|'"hw_numa_mem.0"'
op|':'
string|'"1024"'
op|','
nl|'\n'
string|'"hw_numa_cpus.1"'
op|':'
string|'"4,6"'
op|','
nl|'\n'
string|'"hw_numa_mem.1"'
op|':'
string|'"512"'
op|','
nl|'\n'
string|'"hw_numa_cpus.2"'
op|':'
string|'"5,7"'
op|','
nl|'\n'
string|'"hw_numa_mem.2"'
op|':'
string|'"512"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
name|'cells'
op|'='
nl|'\n'
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'4'
op|','
number|'6'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'512'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'2'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'5'
op|','
number|'7'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'512'
op|')'
nl|'\n'
op|']'
op|')'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
comment|'# Request a CPU that is out of range'
nl|'\n'
comment|'# wrt vCPU count'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'8'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:numa_nodes"'
op|':'
number|'1'
op|','
nl|'\n'
string|'"hw:numa_cpus.0"'
op|':'
string|'"0-16"'
op|','
nl|'\n'
string|'"hw:numa_mem.0"'
op|':'
string|'"2048"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'exception'
op|'.'
name|'ImageNUMATopologyCPUOutOfRange'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
comment|'# Request the same CPU in two nodes'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'8'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:numa_nodes"'
op|':'
number|'2'
op|','
nl|'\n'
string|'"hw:numa_cpus.0"'
op|':'
string|'"0-7"'
op|','
nl|'\n'
string|'"hw:numa_mem.0"'
op|':'
string|'"1024"'
op|','
nl|'\n'
string|'"hw:numa_cpus.1"'
op|':'
string|'"0-7"'
op|','
nl|'\n'
string|'"hw:numa_mem.1"'
op|':'
string|'"1024"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'exception'
op|'.'
name|'ImageNUMATopologyCPUDuplicates'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
comment|'# Request with some CPUs not assigned'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'8'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:numa_nodes"'
op|':'
number|'2'
op|','
nl|'\n'
string|'"hw:numa_cpus.0"'
op|':'
string|'"0-2"'
op|','
nl|'\n'
string|'"hw:numa_mem.0"'
op|':'
string|'"1024"'
op|','
nl|'\n'
string|'"hw:numa_cpus.1"'
op|':'
string|'"3-4"'
op|','
nl|'\n'
string|'"hw:numa_mem.1"'
op|':'
string|'"1024"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'exception'
op|'.'
name|'ImageNUMATopologyCPUsUnassigned'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
comment|'# Request too little memory vs flavor total'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'8'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:numa_nodes"'
op|':'
number|'2'
op|','
nl|'\n'
string|'"hw:numa_cpus.0"'
op|':'
string|'"0-3"'
op|','
nl|'\n'
string|'"hw:numa_mem.0"'
op|':'
string|'"512"'
op|','
nl|'\n'
string|'"hw:numa_cpus.1"'
op|':'
string|'"4-7"'
op|','
nl|'\n'
string|'"hw:numa_mem.1"'
op|':'
string|'"512"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'exception'
op|'.'
name|'ImageNUMATopologyMemoryOutOfRange'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
comment|'# Request too much memory vs flavor total'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'8'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:numa_nodes"'
op|':'
number|'2'
op|','
nl|'\n'
string|'"hw:numa_cpus.0"'
op|':'
string|'"0-3"'
op|','
nl|'\n'
string|'"hw:numa_mem.0"'
op|':'
string|'"1576"'
op|','
nl|'\n'
string|'"hw:numa_cpus.1"'
op|':'
string|'"4-7"'
op|','
nl|'\n'
string|'"hw:numa_mem.1"'
op|':'
string|'"1576"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'exception'
op|'.'
name|'ImageNUMATopologyMemoryOutOfRange'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
comment|'# Request missing mem.0'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'8'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:numa_nodes"'
op|':'
number|'2'
op|','
nl|'\n'
string|'"hw:numa_cpus.0"'
op|':'
string|'"0-3"'
op|','
nl|'\n'
string|'"hw:numa_mem.1"'
op|':'
string|'"1576"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'exception'
op|'.'
name|'ImageNUMATopologyIncomplete'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
comment|'# Request missing cpu.0'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'8'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:numa_nodes"'
op|':'
number|'2'
op|','
nl|'\n'
string|'"hw:numa_mem.0"'
op|':'
string|'"1576"'
op|','
nl|'\n'
string|'"hw:numa_cpus.1"'
op|':'
string|'"4-7"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'exception'
op|'.'
name|'ImageNUMATopologyIncomplete'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
comment|'# Image attempts to override flavor'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'8'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:numa_nodes"'
op|':'
number|'2'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
nl|'\n'
string|'"hw_numa_nodes"'
op|':'
number|'4'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'exception'
op|'.'
name|'ImageNUMATopologyForbidden'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
comment|'# NUMA + CPU pinning requested in the flavor'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'4'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:numa_nodes"'
op|':'
number|'2'
op|','
nl|'\n'
string|'"hw:cpu_policy"'
op|':'
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
name|'cells'
op|'='
nl|'\n'
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|']'
op|')'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
comment|'# no NUMA + CPU pinning requested in the flavor'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'4'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:cpu_policy"'
op|':'
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
name|'cells'
op|'='
nl|'\n'
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|']'
op|')'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
comment|'# NUMA + CPU pinning requested in the image'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'4'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:numa_nodes"'
op|':'
number|'2'
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
nl|'\n'
string|'"hw_cpu_policy"'
op|':'
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
nl|'\n'
op|'}'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
name|'cells'
op|'='
nl|'\n'
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|']'
op|')'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
comment|'# no NUMA + CPU pinning requested in the image'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'4'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
nl|'\n'
string|'"hw_cpu_policy"'
op|':'
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
nl|'\n'
op|'}'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
name|'cells'
op|'='
nl|'\n'
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|']'
op|')'
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
comment|'# Invalid CPU pinning override'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'4'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:numa_nodes"'
op|':'
number|'2'
op|','
nl|'\n'
string|'"hw:cpu_policy"'
op|':'
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'SHARED'
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
nl|'\n'
string|'"hw_cpu_policy"'
op|':'
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'exception'
op|'.'
name|'ImageCPUPinningForbidden'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
comment|'# Invalid CPU pinning policy with realtime'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'4'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:cpu_policy"'
op|':'
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'SHARED'
op|','
nl|'\n'
string|'"hw:cpu_realtime"'
op|':'
string|'"yes"'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'exception'
op|'.'
name|'RealtimeConfigurationInvalid'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
comment|'# Invalid CPU thread pinning override'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'4'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:numa_nodes"'
op|':'
number|'2'
op|','
nl|'\n'
string|'"hw:cpu_policy"'
op|':'
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|','
nl|'\n'
string|'"hw:cpu_thread_policy"'
op|':'
nl|'\n'
name|'fields'
op|'.'
name|'CPUThreadAllocationPolicy'
op|'.'
name|'ISOLATE'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
nl|'\n'
string|'"hw_cpu_policy"'
op|':'
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|','
nl|'\n'
string|'"hw_cpu_thread_policy"'
op|':'
nl|'\n'
name|'fields'
op|'.'
name|'CPUThreadAllocationPolicy'
op|'.'
name|'REQUIRE'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'exception'
op|'.'
name|'ImageCPUThreadPolicyForbidden'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
comment|'# Invalid CPU pinning policy with CPU thread pinning'
nl|'\n'
string|'"flavor"'
op|':'
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'4'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
nl|'\n'
string|'"hw:cpu_policy"'
op|':'
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'SHARED'
op|','
nl|'\n'
string|'"hw:cpu_thread_policy"'
op|':'
nl|'\n'
name|'fields'
op|'.'
name|'CPUThreadAllocationPolicy'
op|'.'
name|'ISOLATE'
op|','
nl|'\n'
op|'}'
op|')'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"properties"'
op|':'
op|'{'
op|'}'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"expect"'
op|':'
name|'exception'
op|'.'
name|'CPUThreadPolicyConfigurationInvalid'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
name|'for'
name|'testitem'
name|'in'
name|'testdata'
op|':'
newline|'\n'
indent|'            '
name|'image_meta'
op|'='
name|'objects'
op|'.'
name|'ImageMeta'
op|'.'
name|'from_dict'
op|'('
name|'testitem'
op|'['
string|'"image"'
op|']'
op|')'
newline|'\n'
name|'if'
name|'testitem'
op|'['
string|'"expect"'
op|']'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'                '
name|'topology'
op|'='
name|'hw'
op|'.'
name|'numa_get_constraints'
op|'('
nl|'\n'
name|'testitem'
op|'['
string|'"flavor"'
op|']'
op|','
name|'image_meta'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'topology'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'type'
op|'('
name|'testitem'
op|'['
string|'"expect"'
op|']'
op|')'
op|'=='
name|'type'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'testitem'
op|'['
string|'"expect"'
op|']'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'numa_get_constraints'
op|','
nl|'\n'
name|'testitem'
op|'['
string|'"flavor"'
op|']'
op|','
nl|'\n'
name|'image_meta'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'topology'
op|'='
name|'hw'
op|'.'
name|'numa_get_constraints'
op|'('
nl|'\n'
name|'testitem'
op|'['
string|'"flavor"'
op|']'
op|','
name|'image_meta'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsNotNone'
op|'('
name|'topology'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'testitem'
op|'['
string|'"expect"'
op|']'
op|'.'
name|'cells'
op|')'
op|','
nl|'\n'
name|'len'
op|'('
name|'topology'
op|'.'
name|'cells'
op|')'
op|')'
newline|'\n'
name|'for'
name|'i'
name|'in'
name|'range'
op|'('
name|'len'
op|'('
name|'topology'
op|'.'
name|'cells'
op|')'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'testitem'
op|'['
string|'"expect"'
op|']'
op|'.'
name|'cells'
op|'['
name|'i'
op|']'
op|'.'
name|'id'
op|','
nl|'\n'
name|'topology'
op|'.'
name|'cells'
op|'['
name|'i'
op|']'
op|'.'
name|'id'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'testitem'
op|'['
string|'"expect"'
op|']'
op|'.'
name|'cells'
op|'['
name|'i'
op|']'
op|'.'
name|'cpuset'
op|','
nl|'\n'
name|'topology'
op|'.'
name|'cells'
op|'['
name|'i'
op|']'
op|'.'
name|'cpuset'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'testitem'
op|'['
string|'"expect"'
op|']'
op|'.'
name|'cells'
op|'['
name|'i'
op|']'
op|'.'
name|'memory'
op|','
nl|'\n'
name|'topology'
op|'.'
name|'cells'
op|'['
name|'i'
op|']'
op|'.'
name|'memory'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'testitem'
op|'['
string|'"expect"'
op|']'
op|'.'
name|'cells'
op|'['
name|'i'
op|']'
op|'.'
name|'pagesize'
op|','
nl|'\n'
name|'topology'
op|'.'
name|'cells'
op|'['
name|'i'
op|']'
op|'.'
name|'pagesize'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'testitem'
op|'['
string|'"expect"'
op|']'
op|'.'
name|'cells'
op|'['
name|'i'
op|']'
op|'.'
name|'cpu_pinning'
op|','
nl|'\n'
name|'topology'
op|'.'
name|'cells'
op|'['
name|'i'
op|']'
op|'.'
name|'cpu_pinning'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_host_usage_contiguous
dedent|''
dedent|''
dedent|''
dedent|''
name|'def'
name|'test_host_usage_contiguous'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'hpages0_4K'
op|'='
name|'objects'
op|'.'
name|'NUMAPagesTopology'
op|'('
name|'size_kb'
op|'='
number|'4'
op|','
name|'total'
op|'='
number|'256'
op|','
name|'used'
op|'='
number|'0'
op|')'
newline|'\n'
name|'hpages0_2M'
op|'='
name|'objects'
op|'.'
name|'NUMAPagesTopology'
op|'('
name|'size_kb'
op|'='
number|'2048'
op|','
name|'total'
op|'='
number|'0'
op|','
name|'used'
op|'='
number|'1'
op|')'
newline|'\n'
name|'hpages1_4K'
op|'='
name|'objects'
op|'.'
name|'NUMAPagesTopology'
op|'('
name|'size_kb'
op|'='
number|'4'
op|','
name|'total'
op|'='
number|'128'
op|','
name|'used'
op|'='
number|'2'
op|')'
newline|'\n'
name|'hpages1_2M'
op|'='
name|'objects'
op|'.'
name|'NUMAPagesTopology'
op|'('
name|'size_kb'
op|'='
number|'2048'
op|','
name|'total'
op|'='
number|'0'
op|','
name|'used'
op|'='
number|'3'
op|')'
newline|'\n'
nl|'\n'
name|'hosttopo'
op|'='
name|'objects'
op|'.'
name|'NUMATopology'
op|'('
name|'cells'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
nl|'\n'
name|'cpu_usage'
op|'='
number|'0'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
name|'mempages'
op|'='
op|'['
nl|'\n'
name|'hpages0_4K'
op|','
name|'hpages0_2M'
op|']'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'4'
op|','
number|'6'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'512'
op|','
nl|'\n'
name|'cpu_usage'
op|'='
number|'0'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
name|'mempages'
op|'='
op|'['
nl|'\n'
name|'hpages1_4K'
op|','
name|'hpages1_2M'
op|']'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'2'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'5'
op|','
number|'7'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'512'
op|','
nl|'\n'
name|'cpu_usage'
op|'='
number|'0'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'instance1'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
name|'cells'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'256'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'4'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'256'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'instance2'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
name|'cells'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'256'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'5'
op|','
number|'7'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'256'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'hostusage'
op|'='
name|'hw'
op|'.'
name|'numa_usage_from_instances'
op|'('
nl|'\n'
name|'hosttopo'
op|','
op|'['
name|'instance1'
op|','
name|'instance2'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'hosttopo'
op|')'
op|','
name|'len'
op|'('
name|'hostusage'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|','
name|'objects'
op|'.'
name|'NUMACell'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hosttopo'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'cpuset'
op|','
nl|'\n'
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'cpuset'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hosttopo'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'memory'
op|','
nl|'\n'
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'memory'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'cpu_usage'
op|','
number|'5'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'memory_usage'
op|','
number|'512'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'mempages'
op|','
op|'['
nl|'\n'
name|'hpages0_4K'
op|','
name|'hpages0_2M'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|','
name|'objects'
op|'.'
name|'NUMACell'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hosttopo'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'cpuset'
op|','
nl|'\n'
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'cpuset'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hosttopo'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'memory'
op|','
nl|'\n'
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'memory'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'cpu_usage'
op|','
number|'3'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'memory_usage'
op|','
number|'512'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'mempages'
op|','
op|'['
nl|'\n'
name|'hpages1_4K'
op|','
name|'hpages1_2M'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'256'
op|','
name|'hpages0_4K'
op|'.'
name|'total'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'0'
op|','
name|'hpages0_4K'
op|'.'
name|'used'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'0'
op|','
name|'hpages0_2M'
op|'.'
name|'total'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'1'
op|','
name|'hpages0_2M'
op|'.'
name|'used'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'2'
op|']'
op|','
name|'objects'
op|'.'
name|'NUMACell'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hosttopo'
op|'.'
name|'cells'
op|'['
number|'2'
op|']'
op|'.'
name|'cpuset'
op|','
nl|'\n'
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'2'
op|']'
op|'.'
name|'cpuset'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hosttopo'
op|'.'
name|'cells'
op|'['
number|'2'
op|']'
op|'.'
name|'memory'
op|','
nl|'\n'
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'2'
op|']'
op|'.'
name|'memory'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'2'
op|']'
op|'.'
name|'cpu_usage'
op|','
number|'0'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'2'
op|']'
op|'.'
name|'memory_usage'
op|','
number|'0'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'128'
op|','
name|'hpages1_4K'
op|'.'
name|'total'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'2'
op|','
name|'hpages1_4K'
op|'.'
name|'used'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'0'
op|','
name|'hpages1_2M'
op|'.'
name|'total'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'3'
op|','
name|'hpages1_2M'
op|'.'
name|'used'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_host_usage_sparse
dedent|''
name|'def'
name|'test_host_usage_sparse'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'hosttopo'
op|'='
name|'objects'
op|'.'
name|'NUMATopology'
op|'('
name|'cells'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
nl|'\n'
name|'cpu_usage'
op|'='
number|'0'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'5'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'4'
op|','
number|'6'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'512'
op|','
nl|'\n'
name|'cpu_usage'
op|'='
number|'0'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'6'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'5'
op|','
number|'7'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'512'
op|','
nl|'\n'
name|'cpu_usage'
op|'='
number|'0'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'instance1'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
name|'cells'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'256'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'id'
op|'='
number|'6'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'4'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'256'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'instance2'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
name|'cells'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'256'
op|','
nl|'\n'
name|'cpu_usage'
op|'='
number|'0'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'id'
op|'='
number|'5'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'5'
op|','
number|'7'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'256'
op|','
nl|'\n'
name|'cpu_usage'
op|'='
number|'0'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'hostusage'
op|'='
name|'hw'
op|'.'
name|'numa_usage_from_instances'
op|'('
nl|'\n'
name|'hosttopo'
op|','
op|'['
name|'instance1'
op|','
name|'instance2'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'hosttopo'
op|')'
op|','
name|'len'
op|'('
name|'hostusage'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|','
name|'objects'
op|'.'
name|'NUMACell'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hosttopo'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'id'
op|','
nl|'\n'
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'id'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hosttopo'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'cpuset'
op|','
nl|'\n'
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'cpuset'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hosttopo'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'memory'
op|','
nl|'\n'
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'memory'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'cpu_usage'
op|','
number|'5'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'memory_usage'
op|','
number|'512'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|','
name|'objects'
op|'.'
name|'NUMACell'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hosttopo'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'id'
op|','
nl|'\n'
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'id'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hosttopo'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'cpuset'
op|','
nl|'\n'
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'cpuset'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hosttopo'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'memory'
op|','
nl|'\n'
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'memory'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'cpu_usage'
op|','
number|'2'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'memory_usage'
op|','
number|'256'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'2'
op|']'
op|','
name|'objects'
op|'.'
name|'NUMACell'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hosttopo'
op|'.'
name|'cells'
op|'['
number|'2'
op|']'
op|'.'
name|'cpuset'
op|','
nl|'\n'
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'2'
op|']'
op|'.'
name|'cpuset'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hosttopo'
op|'.'
name|'cells'
op|'['
number|'2'
op|']'
op|'.'
name|'memory'
op|','
nl|'\n'
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'2'
op|']'
op|'.'
name|'memory'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'2'
op|']'
op|'.'
name|'cpu_usage'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'2'
op|']'
op|'.'
name|'memory_usage'
op|','
number|'256'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_host_usage_culmulative_with_free
dedent|''
name|'def'
name|'test_host_usage_culmulative_with_free'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'hosttopo'
op|'='
name|'objects'
op|'.'
name|'NUMATopology'
op|'('
name|'cells'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
nl|'\n'
name|'cpu_usage'
op|'='
number|'2'
op|','
name|'memory_usage'
op|'='
number|'512'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'4'
op|','
number|'6'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'512'
op|','
nl|'\n'
name|'cpu_usage'
op|'='
number|'1'
op|','
name|'memory_usage'
op|'='
number|'512'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'2'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'5'
op|','
number|'7'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'256'
op|','
nl|'\n'
name|'cpu_usage'
op|'='
number|'0'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'instance1'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
name|'cells'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'512'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'256'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'id'
op|'='
number|'2'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'4'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'256'
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'hostusage'
op|'='
name|'hw'
op|'.'
name|'numa_usage_from_instances'
op|'('
nl|'\n'
name|'hosttopo'
op|','
op|'['
name|'instance1'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|','
name|'objects'
op|'.'
name|'NUMACell'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'cpu_usage'
op|','
number|'5'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'memory_usage'
op|','
number|'1024'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|','
name|'objects'
op|'.'
name|'NUMACell'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'cpu_usage'
op|','
number|'2'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'memory_usage'
op|','
number|'768'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'2'
op|']'
op|','
name|'objects'
op|'.'
name|'NUMACell'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'2'
op|']'
op|'.'
name|'cpu_usage'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'2'
op|']'
op|'.'
name|'memory_usage'
op|','
number|'256'
op|')'
newline|'\n'
nl|'\n'
comment|'# Test freeing of resources'
nl|'\n'
name|'hostusage'
op|'='
name|'hw'
op|'.'
name|'numa_usage_from_instances'
op|'('
nl|'\n'
name|'hostusage'
op|','
op|'['
name|'instance1'
op|']'
op|','
name|'free'
op|'='
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'cpu_usage'
op|','
number|'2'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'memory_usage'
op|','
number|'512'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'cpu_usage'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'memory_usage'
op|','
number|'512'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'2'
op|']'
op|'.'
name|'cpu_usage'
op|','
number|'0'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'2'
op|']'
op|'.'
name|'memory_usage'
op|','
number|'0'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_topo_usage_none
dedent|''
name|'def'
name|'test_topo_usage_none'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'hosttopo'
op|'='
name|'objects'
op|'.'
name|'NUMATopology'
op|'('
name|'cells'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'512'
op|','
nl|'\n'
name|'cpu_usage'
op|'='
number|'0'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'512'
op|','
nl|'\n'
name|'cpu_usage'
op|'='
number|'0'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'instance1'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
name|'cells'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'256'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'id'
op|'='
number|'2'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'2'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'256'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'hostusage'
op|'='
name|'hw'
op|'.'
name|'numa_usage_from_instances'
op|'('
nl|'\n'
name|'None'
op|','
op|'['
name|'instance1'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'hostusage'
op|')'
newline|'\n'
nl|'\n'
name|'hostusage'
op|'='
name|'hw'
op|'.'
name|'numa_usage_from_instances'
op|'('
nl|'\n'
name|'hosttopo'
op|','
op|'['
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'cpu_usage'
op|','
number|'0'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'memory_usage'
op|','
number|'0'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'cpu_usage'
op|','
number|'0'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'memory_usage'
op|','
number|'0'
op|')'
newline|'\n'
nl|'\n'
name|'hostusage'
op|'='
name|'hw'
op|'.'
name|'numa_usage_from_instances'
op|'('
nl|'\n'
name|'hosttopo'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'cpu_usage'
op|','
number|'0'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'memory_usage'
op|','
number|'0'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'cpu_usage'
op|','
number|'0'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'hostusage'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'memory_usage'
op|','
number|'0'
op|')'
newline|'\n'
nl|'\n'
DECL|member|assertNUMACellMatches
dedent|''
name|'def'
name|'assertNUMACellMatches'
op|'('
name|'self'
op|','
name|'expected_cell'
op|','
name|'got_cell'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'attrs'
op|'='
op|'('
string|"'cpuset'"
op|','
string|"'memory'"
op|','
string|"'id'"
op|')'
newline|'\n'
name|'if'
name|'isinstance'
op|'('
name|'expected_cell'
op|','
name|'objects'
op|'.'
name|'NUMATopology'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'attrs'
op|'+='
op|'('
string|"'cpu_usage'"
op|','
string|"'memory_usage'"
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'for'
name|'attr'
name|'in'
name|'attrs'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'getattr'
op|'('
name|'expected_cell'
op|','
name|'attr'
op|')'
op|','
nl|'\n'
name|'getattr'
op|'('
name|'got_cell'
op|','
name|'attr'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_json
dedent|''
dedent|''
name|'def'
name|'test_json'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'expected'
op|'='
name|'objects'
op|'.'
name|'NUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
nl|'\n'
name|'cpu_usage'
op|'='
number|'0'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'2'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'3'
op|','
number|'4'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
nl|'\n'
name|'cpu_usage'
op|'='
number|'0'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'siblings'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|']'
op|')'
newline|'\n'
name|'got'
op|'='
name|'objects'
op|'.'
name|'NUMATopology'
op|'.'
name|'obj_from_db_obj'
op|'('
name|'expected'
op|'.'
name|'_to_json'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'for'
name|'exp_cell'
op|','
name|'got_cell'
name|'in'
name|'zip'
op|'('
name|'expected'
op|'.'
name|'cells'
op|','
name|'got'
op|'.'
name|'cells'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertNUMACellMatches'
op|'('
name|'exp_cell'
op|','
name|'got_cell'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|VirtNUMATopologyCellUsageTestCase
dedent|''
dedent|''
dedent|''
name|'class'
name|'VirtNUMATopologyCellUsageTestCase'
op|'('
name|'test'
op|'.'
name|'NoDBTestCase'
op|')'
op|':'
newline|'\n'
DECL|member|test_fit_instance_cell_success_no_limit
indent|'    '
name|'def'
name|'test_fit_instance_cell_success_no_limit'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_cell'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'4'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
nl|'\n'
name|'cpu_usage'
op|'='
number|'0'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
name|'instance_cell'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|')'
newline|'\n'
name|'fitted_cell'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell'
op|'('
name|'host_cell'
op|','
name|'instance_cell'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'fitted_cell'
op|','
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'host_cell'
op|'.'
name|'id'
op|','
name|'fitted_cell'
op|'.'
name|'id'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_fit_instance_cell_success_w_limit
dedent|''
name|'def'
name|'test_fit_instance_cell_success_w_limit'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_cell'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'4'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
nl|'\n'
name|'cpu_usage'
op|'='
number|'2'
op|','
nl|'\n'
name|'memory_usage'
op|'='
number|'1024'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'siblings'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
name|'limit_cell'
op|'='
name|'objects'
op|'.'
name|'NUMATopologyLimits'
op|'('
nl|'\n'
name|'cpu_allocation_ratio'
op|'='
number|'2'
op|','
name|'ram_allocation_ratio'
op|'='
number|'2'
op|')'
newline|'\n'
name|'instance_cell'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|')'
newline|'\n'
name|'fitted_cell'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell'
op|'('
nl|'\n'
name|'host_cell'
op|','
name|'instance_cell'
op|','
name|'limit_cell'
op|'='
name|'limit_cell'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'fitted_cell'
op|','
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'host_cell'
op|'.'
name|'id'
op|','
name|'fitted_cell'
op|'.'
name|'id'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_fit_instance_cell_self_overcommit
dedent|''
name|'def'
name|'test_fit_instance_cell_self_overcommit'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_cell'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'4'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
nl|'\n'
name|'cpu_usage'
op|'='
number|'0'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
name|'limit_cell'
op|'='
name|'objects'
op|'.'
name|'NUMATopologyLimits'
op|'('
nl|'\n'
name|'cpu_allocation_ratio'
op|'='
number|'2'
op|','
name|'ram_allocation_ratio'
op|'='
number|'2'
op|')'
newline|'\n'
name|'instance_cell'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'4096'
op|')'
newline|'\n'
name|'fitted_cell'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell'
op|'('
nl|'\n'
name|'host_cell'
op|','
name|'instance_cell'
op|','
name|'limit_cell'
op|'='
name|'limit_cell'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'fitted_cell'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_fit_instance_cell_fail_w_limit
dedent|''
name|'def'
name|'test_fit_instance_cell_fail_w_limit'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_cell'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'4'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
nl|'\n'
name|'cpu_usage'
op|'='
number|'2'
op|','
nl|'\n'
name|'memory_usage'
op|'='
number|'1024'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'siblings'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
name|'instance_cell'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'4096'
op|')'
newline|'\n'
name|'limit_cell'
op|'='
name|'objects'
op|'.'
name|'NUMATopologyLimits'
op|'('
nl|'\n'
name|'cpu_allocation_ratio'
op|'='
number|'2'
op|','
name|'ram_allocation_ratio'
op|'='
number|'2'
op|')'
newline|'\n'
name|'fitted_cell'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell'
op|'('
nl|'\n'
name|'host_cell'
op|','
name|'instance_cell'
op|','
name|'limit_cell'
op|'='
name|'limit_cell'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'fitted_cell'
op|')'
newline|'\n'
nl|'\n'
name|'instance_cell'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'2'
op|','
number|'3'
op|','
number|'4'
op|','
number|'5'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|')'
newline|'\n'
name|'fitted_cell'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell'
op|'('
nl|'\n'
name|'host_cell'
op|','
name|'instance_cell'
op|','
name|'limit_cell'
op|'='
name|'limit_cell'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'fitted_cell'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|VirtNUMAHostTopologyTestCase
dedent|''
dedent|''
name|'class'
name|'VirtNUMAHostTopologyTestCase'
op|'('
name|'test'
op|'.'
name|'NoDBTestCase'
op|')'
op|':'
newline|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'VirtNUMAHostTopologyTestCase'
op|','
name|'self'
op|')'
op|'.'
name|'setUp'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'host'
op|'='
name|'objects'
op|'.'
name|'NUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_usage'
op|'='
number|'2'
op|','
name|'memory_usage'
op|'='
number|'2048'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'siblings'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'2'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'3'
op|','
number|'4'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_usage'
op|'='
number|'2'
op|','
name|'memory_usage'
op|'='
number|'2048'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'siblings'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'limits'
op|'='
name|'objects'
op|'.'
name|'NUMATopologyLimits'
op|'('
nl|'\n'
name|'cpu_allocation_ratio'
op|'='
number|'2'
op|','
name|'ram_allocation_ratio'
op|'='
number|'2'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'instance1'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|')'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'instance2'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'2'
op|','
number|'3'
op|','
number|'4'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|')'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'instance3'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_fitting_success_no_limits
dedent|''
name|'def'
name|'test_get_fitting_success_no_limits'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'fitted_instance1'
op|'='
name|'hw'
op|'.'
name|'numa_fit_instance_to_host'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'host'
op|','
name|'self'
op|'.'
name|'instance1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'fitted_instance1'
op|','
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'host'
op|'='
name|'hw'
op|'.'
name|'numa_usage_from_instances'
op|'('
name|'self'
op|'.'
name|'host'
op|','
nl|'\n'
op|'['
name|'fitted_instance1'
op|']'
op|')'
newline|'\n'
name|'fitted_instance2'
op|'='
name|'hw'
op|'.'
name|'numa_fit_instance_to_host'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'host'
op|','
name|'self'
op|'.'
name|'instance3'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'fitted_instance2'
op|','
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_fitting_success_limits
dedent|''
name|'def'
name|'test_get_fitting_success_limits'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'fitted_instance'
op|'='
name|'hw'
op|'.'
name|'numa_fit_instance_to_host'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'host'
op|','
name|'self'
op|'.'
name|'instance3'
op|','
name|'self'
op|'.'
name|'limits'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'fitted_instance'
op|','
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'1'
op|','
name|'fitted_instance'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'id'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_fitting_fails_no_limits
dedent|''
name|'def'
name|'test_get_fitting_fails_no_limits'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'fitted_instance'
op|'='
name|'hw'
op|'.'
name|'numa_fit_instance_to_host'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'host'
op|','
name|'self'
op|'.'
name|'instance2'
op|','
name|'self'
op|'.'
name|'limits'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'fitted_instance'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_fitting_culmulative_fails_limits
dedent|''
name|'def'
name|'test_get_fitting_culmulative_fails_limits'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'fitted_instance1'
op|'='
name|'hw'
op|'.'
name|'numa_fit_instance_to_host'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'host'
op|','
name|'self'
op|'.'
name|'instance1'
op|','
name|'self'
op|'.'
name|'limits'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'fitted_instance1'
op|','
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'1'
op|','
name|'fitted_instance1'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'id'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'host'
op|'='
name|'hw'
op|'.'
name|'numa_usage_from_instances'
op|'('
name|'self'
op|'.'
name|'host'
op|','
nl|'\n'
op|'['
name|'fitted_instance1'
op|']'
op|')'
newline|'\n'
name|'fitted_instance2'
op|'='
name|'hw'
op|'.'
name|'numa_fit_instance_to_host'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'host'
op|','
name|'self'
op|'.'
name|'instance2'
op|','
name|'self'
op|'.'
name|'limits'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'fitted_instance2'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_fitting_culmulative_success_limits
dedent|''
name|'def'
name|'test_get_fitting_culmulative_success_limits'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'fitted_instance1'
op|'='
name|'hw'
op|'.'
name|'numa_fit_instance_to_host'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'host'
op|','
name|'self'
op|'.'
name|'instance1'
op|','
name|'self'
op|'.'
name|'limits'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'fitted_instance1'
op|','
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'1'
op|','
name|'fitted_instance1'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'id'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'host'
op|'='
name|'hw'
op|'.'
name|'numa_usage_from_instances'
op|'('
name|'self'
op|'.'
name|'host'
op|','
nl|'\n'
op|'['
name|'fitted_instance1'
op|']'
op|')'
newline|'\n'
name|'fitted_instance2'
op|'='
name|'hw'
op|'.'
name|'numa_fit_instance_to_host'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'host'
op|','
name|'self'
op|'.'
name|'instance3'
op|','
name|'self'
op|'.'
name|'limits'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'fitted_instance2'
op|','
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'2'
op|','
name|'fitted_instance2'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'id'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_fitting_pci_success
dedent|''
name|'def'
name|'test_get_fitting_pci_success'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pci_request'
op|'='
name|'objects'
op|'.'
name|'InstancePCIRequest'
op|'('
name|'count'
op|'='
number|'1'
op|','
nl|'\n'
name|'spec'
op|'='
op|'['
op|'{'
string|"'vendor_id'"
op|':'
string|"'8086'"
op|'}'
op|']'
op|')'
newline|'\n'
name|'pci_reqs'
op|'='
op|'['
name|'pci_request'
op|']'
newline|'\n'
name|'pci_stats'
op|'='
name|'stats'
op|'.'
name|'PciDeviceStats'
op|'('
op|')'
newline|'\n'
name|'with'
name|'mock'
op|'.'
name|'patch'
op|'.'
name|'object'
op|'('
name|'stats'
op|'.'
name|'PciDeviceStats'
op|','
nl|'\n'
string|"'support_requests'"
op|','
name|'return_value'
op|'='
name|'True'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'fitted_instance1'
op|'='
name|'hw'
op|'.'
name|'numa_fit_instance_to_host'
op|'('
name|'self'
op|'.'
name|'host'
op|','
nl|'\n'
name|'self'
op|'.'
name|'instance1'
op|','
nl|'\n'
name|'pci_requests'
op|'='
name|'pci_reqs'
op|','
nl|'\n'
name|'pci_stats'
op|'='
name|'pci_stats'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'fitted_instance1'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_fitting_pci_fail
dedent|''
dedent|''
name|'def'
name|'test_get_fitting_pci_fail'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pci_request'
op|'='
name|'objects'
op|'.'
name|'InstancePCIRequest'
op|'('
name|'count'
op|'='
number|'1'
op|','
nl|'\n'
name|'spec'
op|'='
op|'['
op|'{'
string|"'vendor_id'"
op|':'
string|"'8086'"
op|'}'
op|']'
op|')'
newline|'\n'
name|'pci_reqs'
op|'='
op|'['
name|'pci_request'
op|']'
newline|'\n'
name|'pci_stats'
op|'='
name|'stats'
op|'.'
name|'PciDeviceStats'
op|'('
op|')'
newline|'\n'
name|'with'
name|'mock'
op|'.'
name|'patch'
op|'.'
name|'object'
op|'('
name|'stats'
op|'.'
name|'PciDeviceStats'
op|','
nl|'\n'
string|"'support_requests'"
op|','
name|'return_value'
op|'='
name|'False'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'fitted_instance1'
op|'='
name|'hw'
op|'.'
name|'numa_fit_instance_to_host'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'host'
op|','
nl|'\n'
name|'self'
op|'.'
name|'instance1'
op|','
nl|'\n'
name|'pci_requests'
op|'='
name|'pci_reqs'
op|','
nl|'\n'
name|'pci_stats'
op|'='
name|'pci_stats'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'fitted_instance1'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|NumberOfSerialPortsTest
dedent|''
dedent|''
dedent|''
name|'class'
name|'NumberOfSerialPortsTest'
op|'('
name|'test'
op|'.'
name|'NoDBTestCase'
op|')'
op|':'
newline|'\n'
DECL|member|test_flavor
indent|'    '
name|'def'
name|'test_flavor'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'flavor'
op|'='
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'8'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
string|'"hw:serial_port_count"'
op|':'
number|'3'
op|'}'
op|')'
newline|'\n'
name|'image_meta'
op|'='
name|'objects'
op|'.'
name|'ImageMeta'
op|'.'
name|'from_dict'
op|'('
op|'{'
op|'}'
op|')'
newline|'\n'
name|'num_ports'
op|'='
name|'hw'
op|'.'
name|'get_number_of_serial_ports'
op|'('
name|'flavor'
op|','
name|'image_meta'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'3'
op|','
name|'num_ports'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_image_meta
dedent|''
name|'def'
name|'test_image_meta'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'flavor'
op|'='
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'8'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
name|'extra_specs'
op|'='
op|'{'
op|'}'
op|')'
newline|'\n'
name|'image_meta'
op|'='
name|'objects'
op|'.'
name|'ImageMeta'
op|'.'
name|'from_dict'
op|'('
nl|'\n'
op|'{'
string|'"properties"'
op|':'
op|'{'
string|'"hw_serial_port_count"'
op|':'
number|'2'
op|'}'
op|'}'
op|')'
newline|'\n'
name|'num_ports'
op|'='
name|'hw'
op|'.'
name|'get_number_of_serial_ports'
op|'('
name|'flavor'
op|','
name|'image_meta'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'2'
op|','
name|'num_ports'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_flavor_invalid_value
dedent|''
name|'def'
name|'test_flavor_invalid_value'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'flavor'
op|'='
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'8'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
string|'"hw:serial_port_count"'
op|':'
string|"'foo'"
op|'}'
op|')'
newline|'\n'
name|'image_meta'
op|'='
name|'objects'
op|'.'
name|'ImageMeta'
op|'.'
name|'from_dict'
op|'('
op|'{'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'ImageSerialPortNumberInvalid'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'get_number_of_serial_ports'
op|','
nl|'\n'
name|'flavor'
op|','
name|'image_meta'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_image_meta_smaller_than_flavor
dedent|''
name|'def'
name|'test_image_meta_smaller_than_flavor'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'flavor'
op|'='
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'8'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
string|'"hw:serial_port_count"'
op|':'
number|'3'
op|'}'
op|')'
newline|'\n'
name|'image_meta'
op|'='
name|'objects'
op|'.'
name|'ImageMeta'
op|'.'
name|'from_dict'
op|'('
nl|'\n'
op|'{'
string|'"properties"'
op|':'
op|'{'
string|'"hw_serial_port_count"'
op|':'
number|'2'
op|'}'
op|'}'
op|')'
newline|'\n'
name|'num_ports'
op|'='
name|'hw'
op|'.'
name|'get_number_of_serial_ports'
op|'('
name|'flavor'
op|','
name|'image_meta'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'2'
op|','
name|'num_ports'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_flavor_smaller_than_image_meta
dedent|''
name|'def'
name|'test_flavor_smaller_than_image_meta'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'flavor'
op|'='
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'8'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
op|'{'
string|'"hw:serial_port_count"'
op|':'
number|'3'
op|'}'
op|')'
newline|'\n'
name|'image_meta'
op|'='
name|'objects'
op|'.'
name|'ImageMeta'
op|'.'
name|'from_dict'
op|'('
nl|'\n'
op|'{'
string|'"properties"'
op|':'
op|'{'
string|'"hw_serial_port_count"'
op|':'
number|'4'
op|'}'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'ImageSerialPortNumberExceedFlavorValue'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'get_number_of_serial_ports'
op|','
nl|'\n'
name|'flavor'
op|','
name|'image_meta'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|HelperMethodsTestCase
dedent|''
dedent|''
name|'class'
name|'HelperMethodsTestCase'
op|'('
name|'test'
op|'.'
name|'NoDBTestCase'
op|')'
op|':'
newline|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'HelperMethodsTestCase'
op|','
name|'self'
op|')'
op|'.'
name|'setUp'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'hosttopo'
op|'='
name|'objects'
op|'.'
name|'NUMATopology'
op|'('
name|'cells'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'512'
op|','
nl|'\n'
name|'memory_usage'
op|'='
number|'0'
op|','
name|'cpu_usage'
op|'='
number|'0'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'512'
op|','
nl|'\n'
name|'memory_usage'
op|'='
number|'0'
op|','
name|'cpu_usage'
op|'='
number|'0'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'instancetopo'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
nl|'\n'
name|'instance_uuid'
op|'='
string|"'fake-uuid'"
op|','
nl|'\n'
name|'cells'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'256'
op|','
name|'pagesize'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_pinning'
op|'='
op|'{'
number|'0'
op|':'
number|'0'
op|','
number|'1'
op|':'
number|'1'
op|'}'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'2'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'256'
op|','
name|'pagesize'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_pinning'
op|'='
op|'{'
number|'2'
op|':'
number|'3'
op|'}'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'context'
op|'='
name|'context'
op|'.'
name|'RequestContext'
op|'('
string|"'fake-user'"
op|','
nl|'\n'
string|"'fake-project'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|_check_usage
dedent|''
name|'def'
name|'_check_usage'
op|'('
name|'self'
op|','
name|'host_usage'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'2'
op|','
name|'host_usage'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'cpu_usage'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'256'
op|','
name|'host_usage'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'memory_usage'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'1'
op|','
name|'host_usage'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'cpu_usage'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'256'
op|','
name|'host_usage'
op|'.'
name|'cells'
op|'['
number|'1'
op|']'
op|'.'
name|'memory_usage'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_dicts_json
dedent|''
name|'def'
name|'test_dicts_json'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host'
op|'='
op|'{'
string|"'numa_topology'"
op|':'
name|'self'
op|'.'
name|'hosttopo'
op|'.'
name|'_to_json'
op|'('
op|')'
op|'}'
newline|'\n'
name|'instance'
op|'='
op|'{'
string|"'numa_topology'"
op|':'
name|'self'
op|'.'
name|'instancetopo'
op|'.'
name|'_to_json'
op|'('
op|')'
op|'}'
newline|'\n'
nl|'\n'
name|'res'
op|'='
name|'hw'
op|'.'
name|'get_host_numa_usage_from_instance'
op|'('
name|'host'
op|','
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'res'
op|','
name|'six'
op|'.'
name|'string_types'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_check_usage'
op|'('
name|'objects'
op|'.'
name|'NUMATopology'
op|'.'
name|'obj_from_db_obj'
op|'('
name|'res'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_dicts_instance_json
dedent|''
name|'def'
name|'test_dicts_instance_json'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host'
op|'='
op|'{'
string|"'numa_topology'"
op|':'
name|'self'
op|'.'
name|'hosttopo'
op|'}'
newline|'\n'
name|'instance'
op|'='
op|'{'
string|"'numa_topology'"
op|':'
name|'self'
op|'.'
name|'instancetopo'
op|'.'
name|'_to_json'
op|'('
op|')'
op|'}'
newline|'\n'
nl|'\n'
name|'res'
op|'='
name|'hw'
op|'.'
name|'get_host_numa_usage_from_instance'
op|'('
name|'host'
op|','
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'res'
op|','
name|'objects'
op|'.'
name|'NUMATopology'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_check_usage'
op|'('
name|'res'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_dicts_instance_json_old
dedent|''
name|'def'
name|'test_dicts_instance_json_old'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host'
op|'='
op|'{'
string|"'numa_topology'"
op|':'
name|'self'
op|'.'
name|'hosttopo'
op|'}'
newline|'\n'
name|'instance'
op|'='
op|'{'
string|"'numa_topology'"
op|':'
nl|'\n'
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'self'
op|'.'
name|'instancetopo'
op|'.'
name|'_to_dict'
op|'('
op|')'
op|')'
op|'}'
newline|'\n'
nl|'\n'
name|'res'
op|'='
name|'hw'
op|'.'
name|'get_host_numa_usage_from_instance'
op|'('
name|'host'
op|','
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'res'
op|','
name|'objects'
op|'.'
name|'NUMATopology'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_check_usage'
op|'('
name|'res'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_dicts_host_json
dedent|''
name|'def'
name|'test_dicts_host_json'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host'
op|'='
op|'{'
string|"'numa_topology'"
op|':'
name|'self'
op|'.'
name|'hosttopo'
op|'.'
name|'_to_json'
op|'('
op|')'
op|'}'
newline|'\n'
name|'instance'
op|'='
op|'{'
string|"'numa_topology'"
op|':'
name|'self'
op|'.'
name|'instancetopo'
op|'}'
newline|'\n'
nl|'\n'
name|'res'
op|'='
name|'hw'
op|'.'
name|'get_host_numa_usage_from_instance'
op|'('
name|'host'
op|','
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'res'
op|','
name|'six'
op|'.'
name|'string_types'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_check_usage'
op|'('
name|'objects'
op|'.'
name|'NUMATopology'
op|'.'
name|'obj_from_db_obj'
op|'('
name|'res'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_dicts_host_json_old
dedent|''
name|'def'
name|'test_dicts_host_json_old'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host'
op|'='
op|'{'
string|"'numa_topology'"
op|':'
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'hosttopo'
op|'.'
name|'_to_dict'
op|'('
op|')'
op|')'
op|'}'
newline|'\n'
name|'instance'
op|'='
op|'{'
string|"'numa_topology'"
op|':'
name|'self'
op|'.'
name|'instancetopo'
op|'}'
newline|'\n'
nl|'\n'
name|'res'
op|'='
name|'hw'
op|'.'
name|'get_host_numa_usage_from_instance'
op|'('
name|'host'
op|','
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'res'
op|','
name|'six'
op|'.'
name|'string_types'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_check_usage'
op|'('
name|'objects'
op|'.'
name|'NUMATopology'
op|'.'
name|'obj_from_db_obj'
op|'('
name|'res'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_object_host_instance_json
dedent|''
name|'def'
name|'test_object_host_instance_json'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host'
op|'='
name|'objects'
op|'.'
name|'ComputeNode'
op|'('
name|'numa_topology'
op|'='
name|'self'
op|'.'
name|'hosttopo'
op|'.'
name|'_to_json'
op|'('
op|')'
op|')'
newline|'\n'
name|'instance'
op|'='
op|'{'
string|"'numa_topology'"
op|':'
name|'self'
op|'.'
name|'instancetopo'
op|'.'
name|'_to_json'
op|'('
op|')'
op|'}'
newline|'\n'
nl|'\n'
name|'res'
op|'='
name|'hw'
op|'.'
name|'get_host_numa_usage_from_instance'
op|'('
name|'host'
op|','
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'res'
op|','
name|'six'
op|'.'
name|'string_types'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_check_usage'
op|'('
name|'objects'
op|'.'
name|'NUMATopology'
op|'.'
name|'obj_from_db_obj'
op|'('
name|'res'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_object_host_instance
dedent|''
name|'def'
name|'test_object_host_instance'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host'
op|'='
name|'objects'
op|'.'
name|'ComputeNode'
op|'('
name|'numa_topology'
op|'='
name|'self'
op|'.'
name|'hosttopo'
op|'.'
name|'_to_json'
op|'('
op|')'
op|')'
newline|'\n'
name|'instance'
op|'='
op|'{'
string|"'numa_topology'"
op|':'
name|'self'
op|'.'
name|'instancetopo'
op|'}'
newline|'\n'
nl|'\n'
name|'res'
op|'='
name|'hw'
op|'.'
name|'get_host_numa_usage_from_instance'
op|'('
name|'host'
op|','
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'res'
op|','
name|'six'
op|'.'
name|'string_types'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_check_usage'
op|'('
name|'objects'
op|'.'
name|'NUMATopology'
op|'.'
name|'obj_from_db_obj'
op|'('
name|'res'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_instance_with_fetch
dedent|''
name|'def'
name|'test_instance_with_fetch'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host'
op|'='
name|'objects'
op|'.'
name|'ComputeNode'
op|'('
name|'numa_topology'
op|'='
name|'self'
op|'.'
name|'hosttopo'
op|'.'
name|'_to_json'
op|'('
op|')'
op|')'
newline|'\n'
name|'fake_uuid'
op|'='
name|'str'
op|'('
name|'uuid'
op|'.'
name|'uuid4'
op|'('
op|')'
op|')'
newline|'\n'
name|'instance'
op|'='
op|'{'
string|"'uuid'"
op|':'
name|'fake_uuid'
op|'}'
newline|'\n'
nl|'\n'
name|'with'
name|'mock'
op|'.'
name|'patch'
op|'.'
name|'object'
op|'('
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|','
nl|'\n'
string|"'get_by_instance_uuid'"
op|','
name|'return_value'
op|'='
name|'None'
op|')'
name|'as'
name|'get_mock'
op|':'
newline|'\n'
indent|'            '
name|'res'
op|'='
name|'hw'
op|'.'
name|'get_host_numa_usage_from_instance'
op|'('
name|'host'
op|','
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'res'
op|','
name|'six'
op|'.'
name|'string_types'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
name|'get_mock'
op|'.'
name|'called'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_object_instance_with_load
dedent|''
dedent|''
name|'def'
name|'test_object_instance_with_load'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host'
op|'='
name|'objects'
op|'.'
name|'ComputeNode'
op|'('
name|'numa_topology'
op|'='
name|'self'
op|'.'
name|'hosttopo'
op|'.'
name|'_to_json'
op|'('
op|')'
op|')'
newline|'\n'
name|'fake_uuid'
op|'='
name|'str'
op|'('
name|'uuid'
op|'.'
name|'uuid4'
op|'('
op|')'
op|')'
newline|'\n'
name|'instance'
op|'='
name|'objects'
op|'.'
name|'Instance'
op|'('
name|'context'
op|'='
name|'self'
op|'.'
name|'context'
op|','
name|'uuid'
op|'='
name|'fake_uuid'
op|')'
newline|'\n'
nl|'\n'
name|'with'
name|'mock'
op|'.'
name|'patch'
op|'.'
name|'object'
op|'('
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|','
nl|'\n'
string|"'get_by_instance_uuid'"
op|','
name|'return_value'
op|'='
name|'None'
op|')'
name|'as'
name|'get_mock'
op|':'
newline|'\n'
indent|'            '
name|'res'
op|'='
name|'hw'
op|'.'
name|'get_host_numa_usage_from_instance'
op|'('
name|'host'
op|','
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'res'
op|','
name|'six'
op|'.'
name|'string_types'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
name|'get_mock'
op|'.'
name|'called'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_instance_serialized_by_build_request_spec
dedent|''
dedent|''
name|'def'
name|'test_instance_serialized_by_build_request_spec'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host'
op|'='
name|'objects'
op|'.'
name|'ComputeNode'
op|'('
name|'numa_topology'
op|'='
name|'self'
op|'.'
name|'hosttopo'
op|'.'
name|'_to_json'
op|'('
op|')'
op|')'
newline|'\n'
name|'fake_uuid'
op|'='
name|'str'
op|'('
name|'uuid'
op|'.'
name|'uuid4'
op|'('
op|')'
op|')'
newline|'\n'
name|'instance'
op|'='
name|'objects'
op|'.'
name|'Instance'
op|'('
name|'context'
op|'='
name|'self'
op|'.'
name|'context'
op|','
name|'id'
op|'='
number|'1'
op|','
name|'uuid'
op|'='
name|'fake_uuid'
op|','
nl|'\n'
name|'numa_topology'
op|'='
name|'self'
op|'.'
name|'instancetopo'
op|')'
newline|'\n'
comment|'# NOTE (ndipanov): This emulates scheduler.utils.build_request_spec'
nl|'\n'
comment|'# We can remove this test once we no longer use that method.'
nl|'\n'
name|'instance_raw'
op|'='
name|'jsonutils'
op|'.'
name|'to_primitive'
op|'('
nl|'\n'
name|'base_obj'
op|'.'
name|'obj_to_primitive'
op|'('
name|'instance'
op|')'
op|')'
newline|'\n'
name|'res'
op|'='
name|'hw'
op|'.'
name|'get_host_numa_usage_from_instance'
op|'('
name|'host'
op|','
name|'instance_raw'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'res'
op|','
name|'six'
op|'.'
name|'string_types'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_check_usage'
op|'('
name|'objects'
op|'.'
name|'NUMATopology'
op|'.'
name|'obj_from_db_obj'
op|'('
name|'res'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_attr_host
dedent|''
name|'def'
name|'test_attr_host'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|class|Host
indent|'        '
name|'class'
name|'Host'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'            '
name|'def'
name|'__init__'
op|'('
name|'obj'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'obj'
op|'.'
name|'numa_topology'
op|'='
name|'self'
op|'.'
name|'hosttopo'
op|'.'
name|'_to_json'
op|'('
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'host'
op|'='
name|'Host'
op|'('
op|')'
newline|'\n'
name|'instance'
op|'='
op|'{'
string|"'numa_topology'"
op|':'
name|'self'
op|'.'
name|'instancetopo'
op|'.'
name|'_to_json'
op|'('
op|')'
op|'}'
newline|'\n'
nl|'\n'
name|'res'
op|'='
name|'hw'
op|'.'
name|'get_host_numa_usage_from_instance'
op|'('
name|'host'
op|','
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'res'
op|','
name|'six'
op|'.'
name|'string_types'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_check_usage'
op|'('
name|'objects'
op|'.'
name|'NUMATopology'
op|'.'
name|'obj_from_db_obj'
op|'('
name|'res'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_never_serialize_result
dedent|''
name|'def'
name|'test_never_serialize_result'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host'
op|'='
op|'{'
string|"'numa_topology'"
op|':'
name|'self'
op|'.'
name|'hosttopo'
op|'.'
name|'_to_json'
op|'('
op|')'
op|'}'
newline|'\n'
name|'instance'
op|'='
op|'{'
string|"'numa_topology'"
op|':'
name|'self'
op|'.'
name|'instancetopo'
op|'}'
newline|'\n'
nl|'\n'
name|'res'
op|'='
name|'hw'
op|'.'
name|'get_host_numa_usage_from_instance'
op|'('
name|'host'
op|','
name|'instance'
op|','
nl|'\n'
name|'never_serialize_result'
op|'='
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'res'
op|','
name|'objects'
op|'.'
name|'NUMATopology'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_check_usage'
op|'('
name|'res'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_dict_numa_topology_to_obj
dedent|''
name|'def'
name|'test_dict_numa_topology_to_obj'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'fake_uuid'
op|'='
name|'str'
op|'('
name|'uuid'
op|'.'
name|'uuid4'
op|'('
op|')'
op|')'
newline|'\n'
name|'instance'
op|'='
name|'objects'
op|'.'
name|'Instance'
op|'('
name|'context'
op|'='
name|'self'
op|'.'
name|'context'
op|','
name|'id'
op|'='
number|'1'
op|','
name|'uuid'
op|'='
name|'fake_uuid'
op|','
nl|'\n'
name|'numa_topology'
op|'='
name|'self'
op|'.'
name|'instancetopo'
op|')'
newline|'\n'
name|'instance_dict'
op|'='
name|'base_obj'
op|'.'
name|'obj_to_primitive'
op|'('
name|'instance'
op|')'
newline|'\n'
name|'instance_numa_topo'
op|'='
name|'hw'
op|'.'
name|'instance_topology_from_instance'
op|'('
name|'instance_dict'
op|')'
newline|'\n'
name|'for'
name|'expected_cell'
op|','
name|'actual_cell'
name|'in'
name|'zip'
op|'('
name|'self'
op|'.'
name|'instancetopo'
op|'.'
name|'cells'
op|','
nl|'\n'
name|'instance_numa_topo'
op|'.'
name|'cells'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'k'
name|'in'
name|'expected_cell'
op|'.'
name|'fields'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'getattr'
op|'('
name|'expected_cell'
op|','
name|'k'
op|')'
op|','
nl|'\n'
name|'getattr'
op|'('
name|'actual_cell'
op|','
name|'k'
op|')'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|VirtMemoryPagesTestCase
dedent|''
dedent|''
dedent|''
dedent|''
name|'class'
name|'VirtMemoryPagesTestCase'
op|'('
name|'test'
op|'.'
name|'NoDBTestCase'
op|')'
op|':'
newline|'\n'
DECL|member|test_cell_instance_pagesize
indent|'    '
name|'def'
name|'test_cell_instance_pagesize'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'cell'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
name|'pagesize'
op|'='
number|'2048'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'0'
op|','
name|'cell'
op|'.'
name|'id'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
op|'['
number|'0'
op|']'
op|')'
op|','
name|'cell'
op|'.'
name|'cpuset'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'1024'
op|','
name|'cell'
op|'.'
name|'memory'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'2048'
op|','
name|'cell'
op|'.'
name|'pagesize'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_numa_pagesize_usage_from_cell
dedent|''
name|'def'
name|'test_numa_pagesize_usage_from_cell'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'instcell'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'512'
op|','
name|'pagesize'
op|'='
number|'2048'
op|')'
newline|'\n'
name|'hostcell'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
nl|'\n'
name|'cpu_usage'
op|'='
number|'0'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
name|'objects'
op|'.'
name|'NUMAPagesTopology'
op|'('
nl|'\n'
name|'size_kb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'total'
op|'='
number|'512'
op|','
nl|'\n'
name|'used'
op|'='
number|'0'
op|')'
op|']'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'topo'
op|'='
name|'hw'
op|'.'
name|'_numa_pagesize_usage_from_cell'
op|'('
name|'hostcell'
op|','
name|'instcell'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'2048'
op|','
name|'topo'
op|'['
number|'0'
op|']'
op|'.'
name|'size_kb'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'512'
op|','
name|'topo'
op|'['
number|'0'
op|']'
op|'.'
name|'total'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
number|'256'
op|','
name|'topo'
op|'['
number|'0'
op|']'
op|'.'
name|'used'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_test_get_requested_mempages_pagesize
dedent|''
name|'def'
name|'_test_get_requested_mempages_pagesize'
op|'('
name|'self'
op|','
name|'spec'
op|'='
name|'None'
op|','
name|'props'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'flavor'
op|'='
name|'objects'
op|'.'
name|'Flavor'
op|'('
name|'vcpus'
op|'='
number|'16'
op|','
name|'memory_mb'
op|'='
number|'2048'
op|','
nl|'\n'
name|'extra_specs'
op|'='
name|'spec'
name|'or'
op|'{'
op|'}'
op|')'
newline|'\n'
name|'image_meta'
op|'='
name|'objects'
op|'.'
name|'ImageMeta'
op|'.'
name|'from_dict'
op|'('
op|'{'
string|'"properties"'
op|':'
name|'props'
name|'or'
op|'{'
op|'}'
op|'}'
op|')'
newline|'\n'
name|'return'
name|'hw'
op|'.'
name|'_numa_get_pagesize_constraints'
op|'('
name|'flavor'
op|','
name|'image_meta'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_requested_mempages_pagesize_from_flavor_swipe
dedent|''
name|'def'
name|'test_get_requested_mempages_pagesize_from_flavor_swipe'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'hw'
op|'.'
name|'MEMPAGES_SMALL'
op|','
name|'self'
op|'.'
name|'_test_get_requested_mempages_pagesize'
op|'('
nl|'\n'
name|'spec'
op|'='
op|'{'
string|'"hw:mem_page_size"'
op|':'
string|'"small"'
op|'}'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'hw'
op|'.'
name|'MEMPAGES_LARGE'
op|','
name|'self'
op|'.'
name|'_test_get_requested_mempages_pagesize'
op|'('
nl|'\n'
name|'spec'
op|'='
op|'{'
string|'"hw:mem_page_size"'
op|':'
string|'"large"'
op|'}'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
name|'hw'
op|'.'
name|'MEMPAGES_ANY'
op|','
name|'self'
op|'.'
name|'_test_get_requested_mempages_pagesize'
op|'('
nl|'\n'
name|'spec'
op|'='
op|'{'
string|'"hw:mem_page_size"'
op|':'
string|'"any"'
op|'}'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_requested_mempages_pagesize_from_flavor_specific
dedent|''
name|'def'
name|'test_get_requested_mempages_pagesize_from_flavor_specific'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
number|'2048'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_test_get_requested_mempages_pagesize'
op|'('
nl|'\n'
name|'spec'
op|'='
op|'{'
string|'"hw:mem_page_size"'
op|':'
string|'"2048"'
op|'}'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_requested_mempages_pagesize_from_flavor_invalid
dedent|''
name|'def'
name|'test_get_requested_mempages_pagesize_from_flavor_invalid'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'assertRaises'
op|'('
nl|'\n'
name|'exception'
op|'.'
name|'MemoryPageSizeInvalid'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_test_get_requested_mempages_pagesize'
op|','
nl|'\n'
op|'{'
string|'"hw:mem_page_size"'
op|':'
string|'"foo"'
op|'}'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
nl|'\n'
name|'exception'
op|'.'
name|'MemoryPageSizeInvalid'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_test_get_requested_mempages_pagesize'
op|','
nl|'\n'
op|'{'
string|'"hw:mem_page_size"'
op|':'
string|'"-42"'
op|'}'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_requested_mempages_pagesizes_from_flavor_suffix_sweep
dedent|''
name|'def'
name|'test_get_requested_mempages_pagesizes_from_flavor_suffix_sweep'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
number|'2048'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_test_get_requested_mempages_pagesize'
op|'('
nl|'\n'
name|'spec'
op|'='
op|'{'
string|'"hw:mem_page_size"'
op|':'
string|'"2048KB"'
op|'}'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
number|'2048'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_test_get_requested_mempages_pagesize'
op|'('
nl|'\n'
name|'spec'
op|'='
op|'{'
string|'"hw:mem_page_size"'
op|':'
string|'"2MB"'
op|'}'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
number|'1048576'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_test_get_requested_mempages_pagesize'
op|'('
nl|'\n'
name|'spec'
op|'='
op|'{'
string|'"hw:mem_page_size"'
op|':'
string|'"1GB"'
op|'}'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_requested_mempages_pagesize_from_image_flavor_any
dedent|''
name|'def'
name|'test_get_requested_mempages_pagesize_from_image_flavor_any'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
number|'2048'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_test_get_requested_mempages_pagesize'
op|'('
nl|'\n'
name|'spec'
op|'='
op|'{'
string|'"hw:mem_page_size"'
op|':'
string|'"any"'
op|'}'
op|','
nl|'\n'
name|'props'
op|'='
op|'{'
string|'"hw_mem_page_size"'
op|':'
string|'"2048"'
op|'}'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_requested_mempages_pagesize_from_image_flavor_large
dedent|''
name|'def'
name|'test_get_requested_mempages_pagesize_from_image_flavor_large'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
number|'2048'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_test_get_requested_mempages_pagesize'
op|'('
nl|'\n'
name|'spec'
op|'='
op|'{'
string|'"hw:mem_page_size"'
op|':'
string|'"large"'
op|'}'
op|','
nl|'\n'
name|'props'
op|'='
op|'{'
string|'"hw_mem_page_size"'
op|':'
string|'"2048"'
op|'}'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_requested_mempages_pagesize_from_image_forbidden
dedent|''
name|'def'
name|'test_get_requested_mempages_pagesize_from_image_forbidden'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'assertRaises'
op|'('
nl|'\n'
name|'exception'
op|'.'
name|'MemoryPageSizeForbidden'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_test_get_requested_mempages_pagesize'
op|','
nl|'\n'
op|'{'
string|'"hw:mem_page_size"'
op|':'
string|'"small"'
op|'}'
op|','
nl|'\n'
op|'{'
string|'"hw_mem_page_size"'
op|':'
string|'"2048"'
op|'}'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_requested_mempages_pagesize_from_image_forbidden2
dedent|''
name|'def'
name|'test_get_requested_mempages_pagesize_from_image_forbidden2'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'assertRaises'
op|'('
nl|'\n'
name|'exception'
op|'.'
name|'MemoryPageSizeForbidden'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_test_get_requested_mempages_pagesize'
op|','
nl|'\n'
op|'{'
op|'}'
op|','
op|'{'
string|'"hw_mem_page_size"'
op|':'
string|'"2048"'
op|'}'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_cell_accepts_request_wipe
dedent|''
name|'def'
name|'test_cell_accepts_request_wipe'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_cell'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
name|'mempages'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'NUMAPagesTopology'
op|'('
name|'size_kb'
op|'='
number|'4'
op|','
name|'total'
op|'='
number|'262144'
op|','
name|'used'
op|'='
number|'0'
op|')'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'inst_cell'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
name|'pagesize'
op|'='
name|'hw'
op|'.'
name|'MEMPAGES_SMALL'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
number|'4'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'_numa_cell_supports_pagesize_request'
op|'('
name|'host_cell'
op|','
name|'inst_cell'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'inst_cell'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
name|'pagesize'
op|'='
name|'hw'
op|'.'
name|'MEMPAGES_ANY'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
number|'4'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'_numa_cell_supports_pagesize_request'
op|'('
name|'host_cell'
op|','
name|'inst_cell'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'inst_cell'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
name|'pagesize'
op|'='
name|'hw'
op|'.'
name|'MEMPAGES_LARGE'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'hw'
op|'.'
name|'_numa_cell_supports_pagesize_request'
op|'('
nl|'\n'
name|'host_cell'
op|','
name|'inst_cell'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_cell_accepts_request_large_pass
dedent|''
name|'def'
name|'test_cell_accepts_request_large_pass'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'inst_cell'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
name|'pagesize'
op|'='
name|'hw'
op|'.'
name|'MEMPAGES_LARGE'
op|')'
newline|'\n'
name|'host_cell'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
name|'mempages'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'NUMAPagesTopology'
op|'('
name|'size_kb'
op|'='
number|'4'
op|','
name|'total'
op|'='
number|'256'
op|','
name|'used'
op|'='
number|'0'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'NUMAPagesTopology'
op|'('
name|'size_kb'
op|'='
number|'2048'
op|','
name|'total'
op|'='
number|'512'
op|','
name|'used'
op|'='
number|'0'
op|')'
nl|'\n'
op|']'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
number|'2048'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'_numa_cell_supports_pagesize_request'
op|'('
name|'host_cell'
op|','
name|'inst_cell'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_cell_accepts_request_custom_pass
dedent|''
name|'def'
name|'test_cell_accepts_request_custom_pass'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'inst_cell'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
name|'pagesize'
op|'='
number|'2048'
op|')'
newline|'\n'
name|'host_cell'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
name|'mempages'
op|'='
op|'['
nl|'\n'
name|'objects'
op|'.'
name|'NUMAPagesTopology'
op|'('
name|'size_kb'
op|'='
number|'4'
op|','
name|'total'
op|'='
number|'256'
op|','
name|'used'
op|'='
number|'0'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'NUMAPagesTopology'
op|'('
name|'size_kb'
op|'='
number|'2048'
op|','
name|'total'
op|'='
number|'512'
op|','
name|'used'
op|'='
number|'0'
op|')'
nl|'\n'
op|']'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
nl|'\n'
number|'2048'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'_numa_cell_supports_pagesize_request'
op|'('
name|'host_cell'
op|','
name|'inst_cell'
op|')'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|_CPUPinningTestCaseBase
dedent|''
dedent|''
name|'class'
name|'_CPUPinningTestCaseBase'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|assertEqualTopology
indent|'    '
name|'def'
name|'assertEqualTopology'
op|'('
name|'self'
op|','
name|'expected'
op|','
name|'got'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'for'
name|'attr'
name|'in'
op|'('
string|"'sockets'"
op|','
string|"'cores'"
op|','
string|"'threads'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'getattr'
op|'('
name|'expected'
op|','
name|'attr'
op|')'
op|','
name|'getattr'
op|'('
name|'got'
op|','
name|'attr'
op|')'
op|','
nl|'\n'
string|'"Mismatch on %s"'
op|'%'
name|'attr'
op|')'
newline|'\n'
nl|'\n'
DECL|member|assertInstanceCellPinned
dedent|''
dedent|''
name|'def'
name|'assertInstanceCellPinned'
op|'('
name|'self'
op|','
name|'instance_cell'
op|','
name|'cell_ids'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'default_cell_id'
op|'='
number|'0'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertIsNotNone'
op|'('
name|'instance_cell'
op|')'
newline|'\n'
name|'if'
name|'cell_ids'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'default_cell_id'
op|','
name|'instance_cell'
op|'.'
name|'id'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertIn'
op|'('
name|'instance_cell'
op|'.'
name|'id'
op|','
name|'cell_ids'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'instance_cell'
op|'.'
name|'cpuset'
op|')'
op|','
nl|'\n'
name|'len'
op|'('
name|'instance_cell'
op|'.'
name|'cpu_pinning'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|assertPinningPreferThreads
dedent|''
name|'def'
name|'assertPinningPreferThreads'
op|'('
name|'self'
op|','
name|'instance_cell'
op|','
name|'host_cell'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Make sure we are preferring threads.\n\n        We do this by assessing that at least 2 CPUs went to the same core\n        if that was even possible to begin with.\n        """'
newline|'\n'
name|'max_free_siblings'
op|'='
name|'max'
op|'('
name|'map'
op|'('
name|'len'
op|','
name|'host_cell'
op|'.'
name|'free_siblings'
op|')'
op|')'
newline|'\n'
name|'if'
name|'len'
op|'('
name|'instance_cell'
op|')'
op|'>'
number|'1'
name|'and'
name|'max_free_siblings'
op|'>'
number|'1'
op|':'
newline|'\n'
indent|'            '
name|'cpu_to_sib'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'for'
name|'sib'
name|'in'
name|'host_cell'
op|'.'
name|'free_siblings'
op|':'
newline|'\n'
indent|'                '
name|'for'
name|'cpu'
name|'in'
name|'sib'
op|':'
newline|'\n'
indent|'                    '
name|'cpu_to_sib'
op|'['
name|'cpu'
op|']'
op|'='
name|'tuple'
op|'('
name|'sorted'
op|'('
name|'sib'
op|')'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'pins_per_sib'
op|'='
name|'collections'
op|'.'
name|'defaultdict'
op|'('
name|'int'
op|')'
newline|'\n'
name|'for'
name|'inst_p'
op|','
name|'host_p'
name|'in'
name|'instance_cell'
op|'.'
name|'cpu_pinning'
op|'.'
name|'items'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'pins_per_sib'
op|'['
name|'cpu_to_sib'
op|'['
name|'host_p'
op|']'
op|']'
op|'+='
number|'1'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'assertTrue'
op|'('
name|'max'
op|'('
name|'pins_per_sib'
op|'.'
name|'values'
op|'('
op|')'
op|')'
op|'>'
number|'1'
op|','
nl|'\n'
string|'"Seems threads were not prefered by the pinning "'
nl|'\n'
string|'"logic."'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|CPUPinningCellTestCase
dedent|''
dedent|''
dedent|''
name|'class'
name|'CPUPinningCellTestCase'
op|'('
name|'test'
op|'.'
name|'NoDBTestCase'
op|','
name|'_CPUPinningTestCaseBase'
op|')'
op|':'
newline|'\n'
DECL|member|test_get_pinning_inst_too_large_cpu
indent|'    '
name|'def'
name|'test_get_pinning_inst_too_large_cpu'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_pin'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
name|'siblings'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|')'
newline|'\n'
nl|'\n'
name|'inst_pin'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell_with_pinning'
op|'('
name|'host_pin'
op|','
name|'inst_pin'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'inst_pin'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_pinning_inst_too_large_mem
dedent|''
name|'def'
name|'test_get_pinning_inst_too_large_mem'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_pin'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|','
name|'memory_usage'
op|'='
number|'1024'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|')'
newline|'\n'
nl|'\n'
name|'inst_pin'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell_with_pinning'
op|'('
name|'host_pin'
op|','
name|'inst_pin'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'inst_pin'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_pinning_inst_not_avail
dedent|''
name|'def'
name|'test_get_pinning_inst_not_avail'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_pin'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|']'
op|')'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|')'
newline|'\n'
nl|'\n'
name|'inst_pin'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell_with_pinning'
op|'('
name|'host_pin'
op|','
name|'inst_pin'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'inst_pin'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_pinning_no_sibling_fits_empty
dedent|''
name|'def'
name|'test_get_pinning_no_sibling_fits_empty'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_pin'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
name|'siblings'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|')'
newline|'\n'
nl|'\n'
name|'inst_pin'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell_with_pinning'
op|'('
name|'host_pin'
op|','
name|'inst_pin'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertInstanceCellPinned'
op|'('
name|'inst_pin'
op|')'
newline|'\n'
name|'got_topo'
op|'='
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
name|'sockets'
op|'='
number|'1'
op|','
name|'cores'
op|'='
number|'1'
op|','
name|'threads'
op|'='
number|'3'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqualTopology'
op|'('
name|'got_topo'
op|','
name|'inst_pin'
op|'.'
name|'cpu_topology'
op|')'
newline|'\n'
name|'got_pinning'
op|'='
op|'{'
name|'x'
op|':'
name|'x'
name|'for'
name|'x'
name|'in'
name|'range'
op|'('
number|'0'
op|','
number|'3'
op|')'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'got_pinning'
op|','
name|'inst_pin'
op|'.'
name|'cpu_pinning'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_pinning_no_sibling_fits_w_usage
dedent|''
name|'def'
name|'test_get_pinning_no_sibling_fits_w_usage'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_pin'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
number|'1'
op|']'
op|')'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|')'
newline|'\n'
nl|'\n'
name|'inst_pin'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell_with_pinning'
op|'('
name|'host_pin'
op|','
name|'inst_pin'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertInstanceCellPinned'
op|'('
name|'inst_pin'
op|')'
newline|'\n'
name|'got_pinning'
op|'='
op|'{'
number|'0'
op|':'
number|'0'
op|','
number|'1'
op|':'
number|'2'
op|','
number|'2'
op|':'
number|'3'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'got_pinning'
op|','
name|'inst_pin'
op|'.'
name|'cpu_pinning'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_pinning_instance_siblings_fits
dedent|''
name|'def'
name|'test_get_pinning_instance_siblings_fits'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_pin'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
name|'siblings'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|')'
newline|'\n'
nl|'\n'
name|'inst_pin'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell_with_pinning'
op|'('
name|'host_pin'
op|','
name|'inst_pin'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertInstanceCellPinned'
op|'('
name|'inst_pin'
op|')'
newline|'\n'
name|'got_topo'
op|'='
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
name|'sockets'
op|'='
number|'1'
op|','
name|'cores'
op|'='
number|'1'
op|','
name|'threads'
op|'='
number|'4'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqualTopology'
op|'('
name|'got_topo'
op|','
name|'inst_pin'
op|'.'
name|'cpu_topology'
op|')'
newline|'\n'
name|'got_pinning'
op|'='
op|'{'
name|'x'
op|':'
name|'x'
name|'for'
name|'x'
name|'in'
name|'range'
op|'('
number|'0'
op|','
number|'4'
op|')'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'got_pinning'
op|','
name|'inst_pin'
op|'.'
name|'cpu_pinning'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_pinning_instance_siblings_host_siblings_fits_empty
dedent|''
name|'def'
name|'test_get_pinning_instance_siblings_host_siblings_fits_empty'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_pin'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'2'
op|','
number|'3'
op|']'
op|')'
op|']'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|')'
newline|'\n'
nl|'\n'
name|'inst_pin'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell_with_pinning'
op|'('
name|'host_pin'
op|','
name|'inst_pin'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertInstanceCellPinned'
op|'('
name|'inst_pin'
op|')'
newline|'\n'
name|'got_topo'
op|'='
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
name|'sockets'
op|'='
number|'1'
op|','
name|'cores'
op|'='
number|'2'
op|','
name|'threads'
op|'='
number|'2'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqualTopology'
op|'('
name|'got_topo'
op|','
name|'inst_pin'
op|'.'
name|'cpu_topology'
op|')'
newline|'\n'
name|'got_pinning'
op|'='
op|'{'
name|'x'
op|':'
name|'x'
name|'for'
name|'x'
name|'in'
name|'range'
op|'('
number|'0'
op|','
number|'4'
op|')'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'got_pinning'
op|','
name|'inst_pin'
op|'.'
name|'cpu_pinning'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_pinning_instance_siblings_host_siblings_fits_empty_2
dedent|''
name|'def'
name|'test_get_pinning_instance_siblings_host_siblings_fits_empty_2'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_pin'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|','
number|'4'
op|','
number|'5'
op|','
number|'6'
op|','
number|'7'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'4096'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'4'
op|','
number|'5'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'6'
op|','
number|'7'
op|']'
op|')'
op|']'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|','
number|'4'
op|','
number|'5'
op|','
number|'6'
op|','
number|'7'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|')'
newline|'\n'
nl|'\n'
name|'inst_pin'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell_with_pinning'
op|'('
name|'host_pin'
op|','
name|'inst_pin'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertInstanceCellPinned'
op|'('
name|'inst_pin'
op|')'
newline|'\n'
name|'got_topo'
op|'='
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
name|'sockets'
op|'='
number|'1'
op|','
name|'cores'
op|'='
number|'4'
op|','
name|'threads'
op|'='
number|'2'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqualTopology'
op|'('
name|'got_topo'
op|','
name|'inst_pin'
op|'.'
name|'cpu_topology'
op|')'
newline|'\n'
name|'got_pinning'
op|'='
op|'{'
name|'x'
op|':'
name|'x'
name|'for'
name|'x'
name|'in'
name|'range'
op|'('
number|'0'
op|','
number|'8'
op|')'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'got_pinning'
op|','
name|'inst_pin'
op|'.'
name|'cpu_pinning'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_pinning_instance_siblings_host_siblings_fits_w_usage
dedent|''
name|'def'
name|'test_get_pinning_instance_siblings_host_siblings_fits_w_usage'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_pin'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|','
number|'4'
op|','
number|'5'
op|','
number|'6'
op|','
number|'7'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'4096'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'2'
op|','
number|'5'
op|','
number|'6'
op|']'
op|')'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'4'
op|','
number|'5'
op|','
number|'6'
op|','
number|'7'
op|']'
op|')'
op|']'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|')'
newline|'\n'
nl|'\n'
name|'inst_pin'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell_with_pinning'
op|'('
name|'host_pin'
op|','
name|'inst_pin'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertInstanceCellPinned'
op|'('
name|'inst_pin'
op|')'
newline|'\n'
name|'got_topo'
op|'='
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
name|'sockets'
op|'='
number|'1'
op|','
name|'cores'
op|'='
number|'2'
op|','
name|'threads'
op|'='
number|'2'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqualTopology'
op|'('
name|'got_topo'
op|','
name|'inst_pin'
op|'.'
name|'cpu_topology'
op|')'
newline|'\n'
name|'got_pinning'
op|'='
op|'{'
number|'0'
op|':'
number|'0'
op|','
number|'1'
op|':'
number|'3'
op|','
number|'2'
op|':'
number|'4'
op|','
number|'3'
op|':'
number|'7'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'got_pinning'
op|','
name|'inst_pin'
op|'.'
name|'cpu_pinning'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_pinning_host_siblings_fit_single_core
dedent|''
name|'def'
name|'test_get_pinning_host_siblings_fit_single_core'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_pin'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|','
number|'4'
op|','
number|'5'
op|','
number|'6'
op|','
number|'7'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'4096'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'4'
op|','
number|'5'
op|','
number|'6'
op|','
number|'7'
op|']'
op|')'
op|']'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|')'
newline|'\n'
nl|'\n'
name|'inst_pin'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell_with_pinning'
op|'('
name|'host_pin'
op|','
name|'inst_pin'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertInstanceCellPinned'
op|'('
name|'inst_pin'
op|')'
newline|'\n'
name|'got_topo'
op|'='
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
name|'sockets'
op|'='
number|'1'
op|','
name|'cores'
op|'='
number|'1'
op|','
name|'threads'
op|'='
number|'4'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqualTopology'
op|'('
name|'got_topo'
op|','
name|'inst_pin'
op|'.'
name|'cpu_topology'
op|')'
newline|'\n'
name|'got_pinning'
op|'='
op|'{'
name|'x'
op|':'
name|'x'
name|'for'
name|'x'
name|'in'
name|'range'
op|'('
number|'0'
op|','
number|'4'
op|')'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'got_pinning'
op|','
name|'inst_pin'
op|'.'
name|'cpu_pinning'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_pinning_host_siblings_fit
dedent|''
name|'def'
name|'test_get_pinning_host_siblings_fit'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_pin'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'4096'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'2'
op|','
number|'3'
op|']'
op|')'
op|']'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell_with_pinning'
op|'('
name|'host_pin'
op|','
name|'inst_pin'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertInstanceCellPinned'
op|'('
name|'inst_pin'
op|')'
newline|'\n'
name|'got_topo'
op|'='
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
name|'sockets'
op|'='
number|'1'
op|','
name|'cores'
op|'='
number|'2'
op|','
name|'threads'
op|'='
number|'2'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqualTopology'
op|'('
name|'got_topo'
op|','
name|'inst_pin'
op|'.'
name|'cpu_topology'
op|')'
newline|'\n'
name|'got_pinning'
op|'='
op|'{'
name|'x'
op|':'
name|'x'
name|'for'
name|'x'
name|'in'
name|'range'
op|'('
number|'0'
op|','
number|'4'
op|')'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'got_pinning'
op|','
name|'inst_pin'
op|'.'
name|'cpu_pinning'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_pinning_require_policy_too_few_siblings
dedent|''
name|'def'
name|'test_get_pinning_require_policy_too_few_siblings'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_pin'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|','
number|'4'
op|','
number|'5'
op|','
number|'6'
op|','
number|'7'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'4096'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'4'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'5'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'2'
op|','
number|'6'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'3'
op|','
number|'7'
op|']'
op|')'
op|']'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|','
nl|'\n'
name|'cpu_thread_policy'
op|'='
name|'fields'
op|'.'
name|'CPUThreadAllocationPolicy'
op|'.'
name|'REQUIRE'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell_with_pinning'
op|'('
name|'host_pin'
op|','
name|'inst_pin'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'inst_pin'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_pinning_require_policy_fits
dedent|''
name|'def'
name|'test_get_pinning_require_policy_fits'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_pin'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'4096'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'2'
op|','
number|'3'
op|']'
op|')'
op|']'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|','
nl|'\n'
name|'cpu_thread_policy'
op|'='
name|'fields'
op|'.'
name|'CPUThreadAllocationPolicy'
op|'.'
name|'REQUIRE'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell_with_pinning'
op|'('
name|'host_pin'
op|','
name|'inst_pin'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertInstanceCellPinned'
op|'('
name|'inst_pin'
op|')'
newline|'\n'
name|'got_topo'
op|'='
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
name|'sockets'
op|'='
number|'1'
op|','
name|'cores'
op|'='
number|'2'
op|','
name|'threads'
op|'='
number|'2'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqualTopology'
op|'('
name|'got_topo'
op|','
name|'inst_pin'
op|'.'
name|'cpu_topology'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_pinning_require_policy_fits_w_usage
dedent|''
name|'def'
name|'test_get_pinning_require_policy_fits_w_usage'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_pin'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
nl|'\n'
name|'id'
op|'='
number|'0'
op|','
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|','
number|'4'
op|','
number|'5'
op|','
number|'6'
op|','
number|'7'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'4096'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'4'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'5'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'2'
op|','
number|'6'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'3'
op|','
number|'7'
op|']'
op|')'
op|']'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|','
nl|'\n'
name|'cpu_thread_policy'
op|'='
name|'fields'
op|'.'
name|'CPUThreadAllocationPolicy'
op|'.'
name|'REQUIRE'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell_with_pinning'
op|'('
name|'host_pin'
op|','
name|'inst_pin'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertInstanceCellPinned'
op|'('
name|'inst_pin'
op|')'
newline|'\n'
name|'got_topo'
op|'='
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
name|'sockets'
op|'='
number|'1'
op|','
name|'cores'
op|'='
number|'2'
op|','
name|'threads'
op|'='
number|'2'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqualTopology'
op|'('
name|'got_topo'
op|','
name|'inst_pin'
op|'.'
name|'cpu_topology'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_pinning_host_siblings_instance_odd_fit
dedent|''
name|'def'
name|'test_get_pinning_host_siblings_instance_odd_fit'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_pin'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|','
number|'4'
op|','
number|'5'
op|','
number|'6'
op|','
number|'7'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'4096'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'set'
op|'('
op|'['
number|'4'
op|','
number|'5'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'6'
op|','
number|'7'
op|']'
op|')'
op|']'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|','
number|'4'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell_with_pinning'
op|'('
name|'host_pin'
op|','
name|'inst_pin'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertInstanceCellPinned'
op|'('
name|'inst_pin'
op|')'
newline|'\n'
name|'got_topo'
op|'='
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
name|'sockets'
op|'='
number|'1'
op|','
name|'cores'
op|'='
number|'5'
op|','
name|'threads'
op|'='
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqualTopology'
op|'('
name|'got_topo'
op|','
name|'inst_pin'
op|'.'
name|'cpu_topology'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_pinning_host_siblings_instance_fit_optimize_threads
dedent|''
name|'def'
name|'test_get_pinning_host_siblings_instance_fit_optimize_threads'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_pin'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|','
number|'4'
op|','
number|'5'
op|','
number|'6'
op|','
number|'7'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'4096'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'set'
op|'('
op|'['
number|'4'
op|','
number|'5'
op|','
number|'6'
op|','
number|'7'
op|']'
op|')'
op|']'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|','
number|'4'
op|','
number|'5'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell_with_pinning'
op|'('
name|'host_pin'
op|','
name|'inst_pin'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertInstanceCellPinned'
op|'('
name|'inst_pin'
op|')'
newline|'\n'
name|'got_topo'
op|'='
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
name|'sockets'
op|'='
number|'1'
op|','
name|'cores'
op|'='
number|'3'
op|','
name|'threads'
op|'='
number|'2'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqualTopology'
op|'('
name|'got_topo'
op|','
name|'inst_pin'
op|'.'
name|'cpu_topology'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_pinning_host_siblings_instance_odd_fit_w_usage
dedent|''
name|'def'
name|'test_get_pinning_host_siblings_instance_odd_fit_w_usage'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_pin'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|','
number|'4'
op|','
number|'5'
op|','
number|'6'
op|','
number|'7'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'4096'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'set'
op|'('
op|'['
number|'4'
op|','
number|'5'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'6'
op|','
number|'7'
op|']'
op|')'
op|']'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'2'
op|','
number|'5'
op|']'
op|')'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell_with_pinning'
op|'('
name|'host_pin'
op|','
name|'inst_pin'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertInstanceCellPinned'
op|'('
name|'inst_pin'
op|')'
newline|'\n'
name|'got_topo'
op|'='
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
name|'sockets'
op|'='
number|'1'
op|','
name|'cores'
op|'='
number|'3'
op|','
name|'threads'
op|'='
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqualTopology'
op|'('
name|'got_topo'
op|','
name|'inst_pin'
op|'.'
name|'cpu_topology'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_pinning_host_siblings_instance_odd_fit_orphan_only
dedent|''
name|'def'
name|'test_get_pinning_host_siblings_instance_odd_fit_orphan_only'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_pin'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|','
number|'4'
op|','
number|'5'
op|','
number|'6'
op|','
number|'7'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'4096'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'set'
op|'('
op|'['
number|'4'
op|','
number|'5'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'6'
op|','
number|'7'
op|']'
op|')'
op|']'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'2'
op|','
number|'5'
op|','
number|'6'
op|']'
op|')'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell_with_pinning'
op|'('
name|'host_pin'
op|','
name|'inst_pin'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertInstanceCellPinned'
op|'('
name|'inst_pin'
op|')'
newline|'\n'
name|'got_topo'
op|'='
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
name|'sockets'
op|'='
number|'1'
op|','
name|'cores'
op|'='
number|'4'
op|','
name|'threads'
op|'='
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqualTopology'
op|'('
name|'got_topo'
op|','
name|'inst_pin'
op|'.'
name|'cpu_topology'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_pinning_host_siblings_large_instance_odd_fit
dedent|''
name|'def'
name|'test_get_pinning_host_siblings_large_instance_odd_fit'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_pin'
op|'='
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|','
number|'4'
op|','
number|'5'
op|','
number|'6'
op|','
number|'7'
op|','
nl|'\n'
number|'8'
op|','
number|'9'
op|','
number|'10'
op|','
number|'11'
op|','
number|'12'
op|','
number|'13'
op|','
number|'14'
op|','
nl|'\n'
number|'15'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'4096'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'8'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'1'
op|','
number|'9'
op|']'
op|')'
op|','
nl|'\n'
name|'set'
op|'('
op|'['
number|'2'
op|','
number|'10'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'3'
op|','
number|'11'
op|']'
op|')'
op|','
nl|'\n'
name|'set'
op|'('
op|'['
number|'4'
op|','
number|'12'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'5'
op|','
number|'13'
op|']'
op|')'
op|','
nl|'\n'
name|'set'
op|'('
op|'['
number|'6'
op|','
number|'14'
op|']'
op|')'
op|','
name|'set'
op|'('
op|'['
number|'7'
op|','
number|'15'
op|']'
op|')'
op|']'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|','
number|'4'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|')'
newline|'\n'
name|'inst_pin'
op|'='
name|'hw'
op|'.'
name|'_numa_fit_instance_cell_with_pinning'
op|'('
name|'host_pin'
op|','
name|'inst_pin'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertInstanceCellPinned'
op|'('
name|'inst_pin'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertPinningPreferThreads'
op|'('
name|'inst_pin'
op|','
name|'host_pin'
op|')'
newline|'\n'
name|'got_topo'
op|'='
name|'objects'
op|'.'
name|'VirtCPUTopology'
op|'('
name|'sockets'
op|'='
number|'1'
op|','
name|'cores'
op|'='
number|'5'
op|','
name|'threads'
op|'='
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqualTopology'
op|'('
name|'got_topo'
op|','
name|'inst_pin'
op|'.'
name|'cpu_topology'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|CPUPinningTestCase
dedent|''
dedent|''
name|'class'
name|'CPUPinningTestCase'
op|'('
name|'test'
op|'.'
name|'NoDBTestCase'
op|','
name|'_CPUPinningTestCaseBase'
op|')'
op|':'
newline|'\n'
DECL|member|test_host_numa_fit_instance_to_host_single_cell
indent|'    '
name|'def'
name|'test_host_numa_fit_instance_to_host_single_cell'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_topo'
op|'='
name|'objects'
op|'.'
name|'NUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'memory_usage'
op|'='
number|'0'
op|','
name|'siblings'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'memory_usage'
op|'='
number|'0'
op|','
name|'siblings'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|']'
nl|'\n'
op|')'
newline|'\n'
name|'inst_topo'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'inst_topo'
op|'='
name|'hw'
op|'.'
name|'numa_fit_instance_to_host'
op|'('
name|'host_topo'
op|','
name|'inst_topo'
op|')'
newline|'\n'
nl|'\n'
name|'for'
name|'cell'
name|'in'
name|'inst_topo'
op|'.'
name|'cells'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertInstanceCellPinned'
op|'('
name|'cell'
op|','
name|'cell_ids'
op|'='
op|'('
number|'0'
op|','
number|'1'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_host_numa_fit_instance_to_host_single_cell_w_usage
dedent|''
dedent|''
name|'def'
name|'test_host_numa_fit_instance_to_host_single_cell_w_usage'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_topo'
op|'='
name|'objects'
op|'.'
name|'NUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
nl|'\n'
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'memory_usage'
op|'='
number|'0'
op|','
name|'siblings'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'memory_usage'
op|'='
number|'0'
op|','
name|'siblings'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|']'
op|')'
newline|'\n'
name|'inst_topo'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'inst_topo'
op|'='
name|'hw'
op|'.'
name|'numa_fit_instance_to_host'
op|'('
name|'host_topo'
op|','
name|'inst_topo'
op|')'
newline|'\n'
nl|'\n'
name|'for'
name|'cell'
name|'in'
name|'inst_topo'
op|'.'
name|'cells'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertInstanceCellPinned'
op|'('
name|'cell'
op|','
name|'cell_ids'
op|'='
op|'('
number|'1'
op|','
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_host_numa_fit_instance_to_host_single_cell_fail
dedent|''
dedent|''
name|'def'
name|'test_host_numa_fit_instance_to_host_single_cell_fail'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_topo'
op|'='
name|'objects'
op|'.'
name|'NUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|']'
op|')'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
number|'2'
op|']'
op|')'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|')'
op|']'
op|')'
newline|'\n'
name|'inst_topo'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'inst_topo'
op|'='
name|'hw'
op|'.'
name|'numa_fit_instance_to_host'
op|'('
name|'host_topo'
op|','
name|'inst_topo'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'inst_topo'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_host_numa_fit_instance_to_host_fit
dedent|''
name|'def'
name|'test_host_numa_fit_instance_to_host_fit'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_topo'
op|'='
name|'objects'
op|'.'
name|'NUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'4'
op|','
number|'5'
op|','
number|'6'
op|','
number|'7'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|']'
op|')'
newline|'\n'
name|'inst_topo'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|']'
op|')'
newline|'\n'
name|'inst_topo'
op|'='
name|'hw'
op|'.'
name|'numa_fit_instance_to_host'
op|'('
name|'host_topo'
op|','
name|'inst_topo'
op|')'
newline|'\n'
nl|'\n'
name|'for'
name|'cell'
name|'in'
name|'inst_topo'
op|'.'
name|'cells'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertInstanceCellPinned'
op|'('
name|'cell'
op|','
name|'cell_ids'
op|'='
op|'('
number|'0'
op|','
number|'1'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_host_numa_fit_instance_to_host_barely_fit
dedent|''
dedent|''
name|'def'
name|'test_host_numa_fit_instance_to_host_barely_fit'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_topo'
op|'='
name|'objects'
op|'.'
name|'NUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|']'
op|')'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'memory_usage'
op|'='
number|'0'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'4'
op|','
number|'5'
op|','
number|'6'
op|','
number|'7'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
number|'4'
op|','
number|'5'
op|','
number|'6'
op|']'
op|')'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'2'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'8'
op|','
number|'9'
op|','
number|'10'
op|','
number|'11'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'2048'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
number|'10'
op|','
number|'11'
op|']'
op|')'
op|')'
op|']'
op|')'
newline|'\n'
name|'inst_topo'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|']'
op|')'
newline|'\n'
name|'inst_topo'
op|'='
name|'hw'
op|'.'
name|'numa_fit_instance_to_host'
op|'('
name|'host_topo'
op|','
name|'inst_topo'
op|')'
newline|'\n'
nl|'\n'
name|'for'
name|'cell'
name|'in'
name|'inst_topo'
op|'.'
name|'cells'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertInstanceCellPinned'
op|'('
name|'cell'
op|','
name|'cell_ids'
op|'='
op|'('
number|'0'
op|','
number|'2'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_host_numa_fit_instance_to_host_fail_capacity
dedent|''
dedent|''
name|'def'
name|'test_host_numa_fit_instance_to_host_fail_capacity'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_topo'
op|'='
name|'objects'
op|'.'
name|'NUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'4096'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'siblings'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|']'
op|')'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'4'
op|','
number|'5'
op|','
number|'6'
op|','
number|'7'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'4096'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
number|'4'
op|','
number|'5'
op|','
number|'6'
op|']'
op|')'
op|')'
op|']'
op|')'
newline|'\n'
name|'inst_topo'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|']'
op|')'
newline|'\n'
name|'inst_topo'
op|'='
name|'hw'
op|'.'
name|'numa_fit_instance_to_host'
op|'('
name|'host_topo'
op|','
name|'inst_topo'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'inst_topo'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_host_numa_fit_instance_to_host_fail_topology
dedent|''
name|'def'
name|'test_host_numa_fit_instance_to_host_fail_topology'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_topo'
op|'='
name|'objects'
op|'.'
name|'NUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'4096'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'1'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'4'
op|','
number|'5'
op|','
number|'6'
op|','
number|'7'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'4096'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|']'
op|')'
newline|'\n'
name|'inst_topo'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'4'
op|','
number|'5'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|']'
op|')'
newline|'\n'
name|'inst_topo'
op|'='
name|'hw'
op|'.'
name|'numa_fit_instance_to_host'
op|'('
name|'host_topo'
op|','
name|'inst_topo'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'inst_topo'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_cpu_pinning_usage_from_instances
dedent|''
name|'def'
name|'test_cpu_pinning_usage_from_instances'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_pin'
op|'='
name|'objects'
op|'.'
name|'NUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'4096'
op|','
name|'cpu_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'memory_usage'
op|'='
number|'0'
op|','
name|'siblings'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|']'
op|')'
newline|'\n'
name|'inst_pin_1'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'id'
op|'='
number|'0'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_pinning'
op|'='
op|'{'
number|'0'
op|':'
number|'0'
op|','
number|'1'
op|':'
number|'3'
op|'}'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|']'
op|')'
newline|'\n'
name|'inst_pin_2'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'id'
op|'='
number|'0'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_pinning'
op|'='
op|'{'
number|'0'
op|':'
number|'1'
op|','
number|'1'
op|':'
number|'2'
op|'}'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'host_pin'
op|'='
name|'hw'
op|'.'
name|'numa_usage_from_instances'
op|'('
nl|'\n'
name|'host_pin'
op|','
op|'['
name|'inst_pin_1'
op|','
name|'inst_pin_2'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'host_pin'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'pinned_cpus'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_cpu_pinning_usage_from_instances_free
dedent|''
name|'def'
name|'test_cpu_pinning_usage_from_instances_free'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_pin'
op|'='
name|'objects'
op|'.'
name|'NUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'4096'
op|','
name|'cpu_usage'
op|'='
number|'0'
op|','
name|'memory_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'siblings'
op|'='
op|'['
op|']'
op|','
name|'mempages'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'3'
op|']'
op|')'
op|')'
op|']'
op|')'
newline|'\n'
name|'inst_pin_1'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
name|'cpu_pinning'
op|'='
op|'{'
number|'0'
op|':'
number|'1'
op|'}'
op|','
name|'id'
op|'='
number|'0'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|']'
op|')'
newline|'\n'
name|'inst_pin_2'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'1024'
op|','
name|'id'
op|'='
number|'0'
op|','
nl|'\n'
name|'cpu_pinning'
op|'='
op|'{'
number|'0'
op|':'
number|'0'
op|','
number|'1'
op|':'
number|'3'
op|'}'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|']'
op|')'
newline|'\n'
name|'host_pin'
op|'='
name|'hw'
op|'.'
name|'numa_usage_from_instances'
op|'('
nl|'\n'
name|'host_pin'
op|','
op|'['
name|'inst_pin_1'
op|','
name|'inst_pin_2'
op|']'
op|','
name|'free'
op|'='
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
op|')'
op|','
name|'host_pin'
op|'.'
name|'cells'
op|'['
number|'0'
op|']'
op|'.'
name|'pinned_cpus'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_host_usage_from_instances_fail
dedent|''
name|'def'
name|'test_host_usage_from_instances_fail'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'host_pin'
op|'='
name|'objects'
op|'.'
name|'NUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
name|'objects'
op|'.'
name|'NUMACell'
op|'('
name|'id'
op|'='
number|'0'
op|','
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|','
number|'3'
op|']'
op|')'
op|','
nl|'\n'
name|'memory'
op|'='
number|'4096'
op|','
name|'cpu_usage'
op|'='
number|'0'
op|','
nl|'\n'
name|'memory_usage'
op|'='
number|'0'
op|','
name|'siblings'
op|'='
op|'['
op|']'
op|','
nl|'\n'
name|'mempages'
op|'='
op|'['
op|']'
op|','
name|'pinned_cpus'
op|'='
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
op|']'
op|')'
newline|'\n'
name|'inst_pin_1'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'memory'
op|'='
number|'2048'
op|','
name|'id'
op|'='
number|'0'
op|','
nl|'\n'
name|'cpu_pinning'
op|'='
op|'{'
number|'0'
op|':'
number|'0'
op|','
number|'1'
op|':'
number|'3'
op|'}'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|']'
op|')'
newline|'\n'
name|'inst_pin_2'
op|'='
name|'objects'
op|'.'
name|'InstanceNUMATopology'
op|'('
nl|'\n'
name|'cells'
op|'='
op|'['
name|'objects'
op|'.'
name|'InstanceNUMACell'
op|'('
nl|'\n'
name|'cpuset'
op|'='
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'id'
op|'='
number|'0'
op|','
name|'memory'
op|'='
number|'2048'
op|','
nl|'\n'
name|'cpu_pinning'
op|'='
op|'{'
number|'0'
op|':'
number|'0'
op|','
number|'1'
op|':'
number|'2'
op|'}'
op|','
nl|'\n'
name|'cpu_policy'
op|'='
name|'fields'
op|'.'
name|'CPUAllocationPolicy'
op|'.'
name|'DEDICATED'
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'CPUPinningInvalid'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'numa_usage_from_instances'
op|','
name|'host_pin'
op|','
nl|'\n'
op|'['
name|'inst_pin_1'
op|','
name|'inst_pin_2'
op|']'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|CPURealtimeTestCase
dedent|''
dedent|''
name|'class'
name|'CPURealtimeTestCase'
op|'('
name|'test'
op|'.'
name|'NoDBTestCase'
op|')'
op|':'
newline|'\n'
DECL|member|test_success_flavor
indent|'    '
name|'def'
name|'test_success_flavor'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'flavor'
op|'='
op|'{'
string|'"extra_specs"'
op|':'
op|'{'
string|'"hw:cpu_realtime_mask"'
op|':'
string|'"^1"'
op|'}'
op|'}'
newline|'\n'
name|'image'
op|'='
name|'objects'
op|'.'
name|'ImageMeta'
op|'.'
name|'from_dict'
op|'('
op|'{'
op|'}'
op|')'
newline|'\n'
name|'rt'
op|','
name|'em'
op|'='
name|'hw'
op|'.'
name|'vcpus_realtime_topology'
op|'('
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
name|'flavor'
op|','
name|'image'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'2'
op|']'
op|')'
op|','
name|'rt'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
op|'['
number|'1'
op|']'
op|')'
op|','
name|'em'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_success_image
dedent|''
name|'def'
name|'test_success_image'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'flavor'
op|'='
op|'{'
string|'"extra_specs"'
op|':'
op|'{'
op|'}'
op|'}'
newline|'\n'
name|'image'
op|'='
name|'objects'
op|'.'
name|'ImageMeta'
op|'.'
name|'from_dict'
op|'('
nl|'\n'
op|'{'
string|'"properties"'
op|':'
op|'{'
string|'"hw_cpu_realtime_mask"'
op|':'
string|'"^0-1"'
op|'}'
op|'}'
op|')'
newline|'\n'
name|'rt'
op|','
name|'em'
op|'='
name|'hw'
op|'.'
name|'vcpus_realtime_topology'
op|'('
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
name|'flavor'
op|','
name|'image'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
op|'['
number|'2'
op|']'
op|')'
op|','
name|'rt'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|']'
op|')'
op|','
name|'em'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_no_mask_configured
dedent|''
name|'def'
name|'test_no_mask_configured'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'flavor'
op|'='
op|'{'
string|'"extra_specs"'
op|':'
op|'{'
op|'}'
op|'}'
newline|'\n'
name|'image'
op|'='
name|'objects'
op|'.'
name|'ImageMeta'
op|'.'
name|'from_dict'
op|'('
op|'{'
string|'"properties"'
op|':'
op|'{'
op|'}'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
nl|'\n'
name|'exception'
op|'.'
name|'RealtimeMaskNotFoundOrInvalid'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'vcpus_realtime_topology'
op|','
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
name|'flavor'
op|','
name|'image'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_mask_badly_configured
dedent|''
name|'def'
name|'test_mask_badly_configured'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'flavor'
op|'='
op|'{'
string|'"extra_specs"'
op|':'
op|'{'
string|'"hw:cpu_realtime_mask"'
op|':'
string|'"^0-2"'
op|'}'
op|'}'
newline|'\n'
name|'image'
op|'='
name|'objects'
op|'.'
name|'ImageMeta'
op|'.'
name|'from_dict'
op|'('
op|'{'
string|'"properties"'
op|':'
op|'{'
op|'}'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
nl|'\n'
name|'exception'
op|'.'
name|'RealtimeMaskNotFoundOrInvalid'
op|','
nl|'\n'
name|'hw'
op|'.'
name|'vcpus_realtime_topology'
op|','
name|'set'
op|'('
op|'['
number|'0'
op|','
number|'1'
op|','
number|'2'
op|']'
op|')'
op|','
name|'flavor'
op|','
name|'image'
op|')'
newline|'\n'
dedent|''
dedent|''
endmarker|''
end_unit
