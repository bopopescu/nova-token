begin_unit
comment|'# Copyright 2010 United States Government as represented by the'
nl|'\n'
comment|'# Administrator of the National Aeronautics and Space Administration.'
nl|'\n'
comment|'# All Rights Reserved.'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#    Licensed under the Apache License, Version 2.0 (the "License"); you may'
nl|'\n'
comment|'#    not use this file except in compliance with the License. You may obtain'
nl|'\n'
comment|'#    a copy of the License at'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#         http://www.apache.org/licenses/LICENSE-2.0'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#    Unless required by applicable law or agreed to in writing, software'
nl|'\n'
comment|'#    distributed under the License is distributed on an "AS IS" BASIS, WITHOUT'
nl|'\n'
comment|'#    WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the'
nl|'\n'
comment|'#    License for the specific language governing permissions and limitations'
nl|'\n'
comment|'#    under the License.'
nl|'\n'
nl|'\n'
name|'import'
name|'datetime'
newline|'\n'
nl|'\n'
name|'from'
name|'oslo'
op|'.'
name|'config'
name|'import'
name|'cfg'
newline|'\n'
name|'from'
name|'oslo'
op|'.'
name|'utils'
name|'import'
name|'timeutils'
newline|'\n'
nl|'\n'
name|'from'
name|'nova'
name|'import'
name|'compute'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'compute'
name|'import'
name|'flavors'
newline|'\n'
name|'from'
name|'nova'
name|'import'
name|'context'
newline|'\n'
name|'from'
name|'nova'
name|'import'
name|'db'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'db'
op|'.'
name|'sqlalchemy'
name|'import'
name|'api'
name|'as'
name|'sqa_api'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'db'
op|'.'
name|'sqlalchemy'
name|'import'
name|'models'
name|'as'
name|'sqa_models'
newline|'\n'
name|'from'
name|'nova'
name|'import'
name|'exception'
newline|'\n'
name|'from'
name|'nova'
name|'import'
name|'quota'
newline|'\n'
name|'from'
name|'nova'
name|'import'
name|'test'
newline|'\n'
name|'import'
name|'nova'
op|'.'
name|'tests'
op|'.'
name|'unit'
op|'.'
name|'image'
op|'.'
name|'fake'
newline|'\n'
nl|'\n'
DECL|variable|CONF
name|'CONF'
op|'='
name|'cfg'
op|'.'
name|'CONF'
newline|'\n'
name|'CONF'
op|'.'
name|'import_opt'
op|'('
string|"'compute_driver'"
op|','
string|"'nova.virt.driver'"
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|QuotaIntegrationTestCase
name|'class'
name|'QuotaIntegrationTestCase'
op|'('
name|'test'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|variable|REQUIRES_LOCKING
indent|'    '
name|'REQUIRES_LOCKING'
op|'='
name|'True'
newline|'\n'
nl|'\n'
DECL|member|setUp
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'QuotaIntegrationTestCase'
op|','
name|'self'
op|')'
op|'.'
name|'setUp'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'flags'
op|'('
name|'compute_driver'
op|'='
string|"'nova.virt.fake.FakeDriver'"
op|','
nl|'\n'
name|'quota_instances'
op|'='
number|'2'
op|','
nl|'\n'
name|'quota_cores'
op|'='
number|'4'
op|','
nl|'\n'
name|'quota_floating_ips'
op|'='
number|'1'
op|','
nl|'\n'
name|'network_manager'
op|'='
string|"'nova.network.manager.FlatDHCPManager'"
op|')'
newline|'\n'
nl|'\n'
comment|'# Apparently needed by the RPC tests...'
nl|'\n'
name|'self'
op|'.'
name|'network'
op|'='
name|'self'
op|'.'
name|'start_service'
op|'('
string|"'network'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'user_id'
op|'='
string|"'admin'"
newline|'\n'
name|'self'
op|'.'
name|'project_id'
op|'='
string|"'admin'"
newline|'\n'
name|'self'
op|'.'
name|'context'
op|'='
name|'context'
op|'.'
name|'RequestContext'
op|'('
name|'self'
op|'.'
name|'user_id'
op|','
nl|'\n'
name|'self'
op|'.'
name|'project_id'
op|','
nl|'\n'
name|'is_admin'
op|'='
name|'True'
op|')'
newline|'\n'
nl|'\n'
name|'nova'
op|'.'
name|'tests'
op|'.'
name|'unit'
op|'.'
name|'image'
op|'.'
name|'fake'
op|'.'
name|'stub_out_image_service'
op|'('
name|'self'
op|'.'
name|'stubs'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'compute_api'
op|'='
name|'compute'
op|'.'
name|'API'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|tearDown
dedent|''
name|'def'
name|'tearDown'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'QuotaIntegrationTestCase'
op|','
name|'self'
op|')'
op|'.'
name|'tearDown'
op|'('
op|')'
newline|'\n'
name|'nova'
op|'.'
name|'tests'
op|'.'
name|'unit'
op|'.'
name|'image'
op|'.'
name|'fake'
op|'.'
name|'FakeImageService_reset'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|_create_instance
dedent|''
name|'def'
name|'_create_instance'
op|'('
name|'self'
op|','
name|'cores'
op|'='
number|'2'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Create a test instance."""'
newline|'\n'
name|'inst'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'inst'
op|'['
string|"'image_id'"
op|']'
op|'='
string|"'cedef40a-ed67-4d10-800e-17455edce175'"
newline|'\n'
name|'inst'
op|'['
string|"'reservation_id'"
op|']'
op|'='
string|"'r-fakeres'"
newline|'\n'
name|'inst'
op|'['
string|"'user_id'"
op|']'
op|'='
name|'self'
op|'.'
name|'user_id'
newline|'\n'
name|'inst'
op|'['
string|"'project_id'"
op|']'
op|'='
name|'self'
op|'.'
name|'project_id'
newline|'\n'
name|'inst'
op|'['
string|"'instance_type_id'"
op|']'
op|'='
string|"'3'"
comment|'# m1.large'
newline|'\n'
name|'inst'
op|'['
string|"'vcpus'"
op|']'
op|'='
name|'cores'
newline|'\n'
name|'return'
name|'db'
op|'.'
name|'instance_create'
op|'('
name|'self'
op|'.'
name|'context'
op|','
name|'inst'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_too_many_instances
dedent|''
name|'def'
name|'test_too_many_instances'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'instance_uuids'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'i'
name|'in'
name|'range'
op|'('
name|'CONF'
op|'.'
name|'quota_instances'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'instance'
op|'='
name|'self'
op|'.'
name|'_create_instance'
op|'('
op|')'
newline|'\n'
name|'instance_uuids'
op|'.'
name|'append'
op|'('
name|'instance'
op|'['
string|"'uuid'"
op|']'
op|')'
newline|'\n'
dedent|''
name|'inst_type'
op|'='
name|'flavors'
op|'.'
name|'get_flavor_by_name'
op|'('
string|"'m1.small'"
op|')'
newline|'\n'
name|'image_uuid'
op|'='
string|"'cedef40a-ed67-4d10-800e-17455edce175'"
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'compute_api'
op|'.'
name|'create'
op|'('
name|'self'
op|'.'
name|'context'
op|','
name|'min_count'
op|'='
number|'1'
op|','
name|'max_count'
op|'='
number|'1'
op|','
nl|'\n'
name|'instance_type'
op|'='
name|'inst_type'
op|','
nl|'\n'
name|'image_href'
op|'='
name|'image_uuid'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'exception'
op|'.'
name|'QuotaError'
name|'as'
name|'e'
op|':'
newline|'\n'
indent|'            '
name|'expected_kwargs'
op|'='
op|'{'
string|"'code'"
op|':'
number|'413'
op|','
string|"'resource'"
op|':'
string|"'cores'"
op|','
string|"'req'"
op|':'
number|'1'
op|','
nl|'\n'
string|"'used'"
op|':'
number|'4'
op|','
string|"'allowed'"
op|':'
number|'4'
op|','
string|"'overs'"
op|':'
string|"'cores,instances'"
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'e'
op|'.'
name|'kwargs'
op|','
name|'expected_kwargs'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'fail'
op|'('
string|"'Expected QuotaError exception'"
op|')'
newline|'\n'
dedent|''
name|'for'
name|'instance_uuid'
name|'in'
name|'instance_uuids'
op|':'
newline|'\n'
indent|'            '
name|'db'
op|'.'
name|'instance_destroy'
op|'('
name|'self'
op|'.'
name|'context'
op|','
name|'instance_uuid'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_too_many_cores
dedent|''
dedent|''
name|'def'
name|'test_too_many_cores'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'instance'
op|'='
name|'self'
op|'.'
name|'_create_instance'
op|'('
name|'cores'
op|'='
number|'4'
op|')'
newline|'\n'
name|'inst_type'
op|'='
name|'flavors'
op|'.'
name|'get_flavor_by_name'
op|'('
string|"'m1.small'"
op|')'
newline|'\n'
name|'image_uuid'
op|'='
string|"'cedef40a-ed67-4d10-800e-17455edce175'"
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'compute_api'
op|'.'
name|'create'
op|'('
name|'self'
op|'.'
name|'context'
op|','
name|'min_count'
op|'='
number|'1'
op|','
name|'max_count'
op|'='
number|'1'
op|','
nl|'\n'
name|'instance_type'
op|'='
name|'inst_type'
op|','
nl|'\n'
name|'image_href'
op|'='
name|'image_uuid'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'exception'
op|'.'
name|'QuotaError'
name|'as'
name|'e'
op|':'
newline|'\n'
indent|'            '
name|'expected_kwargs'
op|'='
op|'{'
string|"'code'"
op|':'
number|'413'
op|','
string|"'resource'"
op|':'
string|"'cores'"
op|','
string|"'req'"
op|':'
number|'1'
op|','
nl|'\n'
string|"'used'"
op|':'
number|'4'
op|','
string|"'allowed'"
op|':'
number|'4'
op|','
string|"'overs'"
op|':'
string|"'cores'"
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'e'
op|'.'
name|'kwargs'
op|','
name|'expected_kwargs'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'fail'
op|'('
string|"'Expected QuotaError exception'"
op|')'
newline|'\n'
dedent|''
name|'db'
op|'.'
name|'instance_destroy'
op|'('
name|'self'
op|'.'
name|'context'
op|','
name|'instance'
op|'['
string|"'uuid'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_many_cores_with_unlimited_quota
dedent|''
name|'def'
name|'test_many_cores_with_unlimited_quota'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# Setting cores quota to unlimited:'
nl|'\n'
indent|'        '
name|'self'
op|'.'
name|'flags'
op|'('
name|'quota_cores'
op|'='
op|'-'
number|'1'
op|')'
newline|'\n'
name|'instance'
op|'='
name|'self'
op|'.'
name|'_create_instance'
op|'('
name|'cores'
op|'='
number|'4'
op|')'
newline|'\n'
name|'db'
op|'.'
name|'instance_destroy'
op|'('
name|'self'
op|'.'
name|'context'
op|','
name|'instance'
op|'['
string|"'uuid'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_too_many_addresses
dedent|''
name|'def'
name|'test_too_many_addresses'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'address'
op|'='
string|"'192.168.0.100'"
newline|'\n'
name|'db'
op|'.'
name|'floating_ip_create'
op|'('
name|'context'
op|'.'
name|'get_admin_context'
op|'('
op|')'
op|','
nl|'\n'
op|'{'
string|"'address'"
op|':'
name|'address'
op|','
nl|'\n'
string|"'pool'"
op|':'
string|"'nova'"
op|','
nl|'\n'
string|"'project_id'"
op|':'
name|'self'
op|'.'
name|'project_id'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'QuotaError'
op|','
nl|'\n'
name|'self'
op|'.'
name|'network'
op|'.'
name|'allocate_floating_ip'
op|','
nl|'\n'
name|'self'
op|'.'
name|'context'
op|','
nl|'\n'
name|'self'
op|'.'
name|'project_id'
op|')'
newline|'\n'
name|'db'
op|'.'
name|'floating_ip_destroy'
op|'('
name|'context'
op|'.'
name|'get_admin_context'
op|'('
op|')'
op|','
name|'address'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_auto_assigned
dedent|''
name|'def'
name|'test_auto_assigned'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'address'
op|'='
string|"'192.168.0.100'"
newline|'\n'
name|'db'
op|'.'
name|'floating_ip_create'
op|'('
name|'context'
op|'.'
name|'get_admin_context'
op|'('
op|')'
op|','
nl|'\n'
op|'{'
string|"'address'"
op|':'
name|'address'
op|','
nl|'\n'
string|"'pool'"
op|':'
string|"'nova'"
op|','
nl|'\n'
string|"'project_id'"
op|':'
name|'self'
op|'.'
name|'project_id'
op|'}'
op|')'
newline|'\n'
comment|'# auto allocated addresses should not be counted'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'NoMoreFloatingIps'
op|','
nl|'\n'
name|'self'
op|'.'
name|'network'
op|'.'
name|'allocate_floating_ip'
op|','
nl|'\n'
name|'self'
op|'.'
name|'context'
op|','
nl|'\n'
name|'self'
op|'.'
name|'project_id'
op|','
nl|'\n'
name|'True'
op|')'
newline|'\n'
name|'db'
op|'.'
name|'floating_ip_destroy'
op|'('
name|'context'
op|'.'
name|'get_admin_context'
op|'('
op|')'
op|','
name|'address'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_too_many_metadata_items
dedent|''
name|'def'
name|'test_too_many_metadata_items'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'metadata'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'for'
name|'i'
name|'in'
name|'range'
op|'('
name|'CONF'
op|'.'
name|'quota_metadata_items'
op|'+'
number|'1'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'metadata'
op|'['
string|"'key%s'"
op|'%'
name|'i'
op|']'
op|'='
string|"'value%s'"
op|'%'
name|'i'
newline|'\n'
dedent|''
name|'inst_type'
op|'='
name|'flavors'
op|'.'
name|'get_flavor_by_name'
op|'('
string|"'m1.small'"
op|')'
newline|'\n'
name|'image_uuid'
op|'='
string|"'cedef40a-ed67-4d10-800e-17455edce175'"
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'QuotaError'
op|','
name|'self'
op|'.'
name|'compute_api'
op|'.'
name|'create'
op|','
nl|'\n'
name|'self'
op|'.'
name|'context'
op|','
nl|'\n'
name|'min_count'
op|'='
number|'1'
op|','
nl|'\n'
name|'max_count'
op|'='
number|'1'
op|','
nl|'\n'
name|'instance_type'
op|'='
name|'inst_type'
op|','
nl|'\n'
name|'image_href'
op|'='
name|'image_uuid'
op|','
nl|'\n'
name|'metadata'
op|'='
name|'metadata'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_create_with_injected_files
dedent|''
name|'def'
name|'_create_with_injected_files'
op|'('
name|'self'
op|','
name|'files'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'api'
op|'='
name|'self'
op|'.'
name|'compute_api'
newline|'\n'
name|'inst_type'
op|'='
name|'flavors'
op|'.'
name|'get_flavor_by_name'
op|'('
string|"'m1.small'"
op|')'
newline|'\n'
name|'image_uuid'
op|'='
string|"'cedef40a-ed67-4d10-800e-17455edce175'"
newline|'\n'
name|'api'
op|'.'
name|'create'
op|'('
name|'self'
op|'.'
name|'context'
op|','
name|'min_count'
op|'='
number|'1'
op|','
name|'max_count'
op|'='
number|'1'
op|','
nl|'\n'
name|'instance_type'
op|'='
name|'inst_type'
op|','
name|'image_href'
op|'='
name|'image_uuid'
op|','
nl|'\n'
name|'injected_files'
op|'='
name|'files'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_no_injected_files
dedent|''
name|'def'
name|'test_no_injected_files'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'api'
op|'='
name|'self'
op|'.'
name|'compute_api'
newline|'\n'
name|'inst_type'
op|'='
name|'flavors'
op|'.'
name|'get_flavor_by_name'
op|'('
string|"'m1.small'"
op|')'
newline|'\n'
name|'image_uuid'
op|'='
string|"'cedef40a-ed67-4d10-800e-17455edce175'"
newline|'\n'
name|'api'
op|'.'
name|'create'
op|'('
name|'self'
op|'.'
name|'context'
op|','
nl|'\n'
name|'instance_type'
op|'='
name|'inst_type'
op|','
nl|'\n'
name|'image_href'
op|'='
name|'image_uuid'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_max_injected_files
dedent|''
name|'def'
name|'test_max_injected_files'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'files'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'i'
name|'in'
name|'xrange'
op|'('
name|'CONF'
op|'.'
name|'quota_injected_files'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'files'
op|'.'
name|'append'
op|'('
op|'('
string|"'/my/path%d'"
op|'%'
name|'i'
op|','
string|"'config = test\\n'"
op|')'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'_create_with_injected_files'
op|'('
name|'files'
op|')'
comment|'# no QuotaError'
newline|'\n'
nl|'\n'
DECL|member|test_too_many_injected_files
dedent|''
name|'def'
name|'test_too_many_injected_files'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'files'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'i'
name|'in'
name|'xrange'
op|'('
name|'CONF'
op|'.'
name|'quota_injected_files'
op|'+'
number|'1'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'files'
op|'.'
name|'append'
op|'('
op|'('
string|"'/my/path%d'"
op|'%'
name|'i'
op|','
string|"'my\\ncontent%d\\n'"
op|'%'
name|'i'
op|')'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'QuotaError'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_create_with_injected_files'
op|','
name|'files'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_max_injected_file_content_bytes
dedent|''
name|'def'
name|'test_max_injected_file_content_bytes'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'max'
op|'='
name|'CONF'
op|'.'
name|'quota_injected_file_content_bytes'
newline|'\n'
name|'content'
op|'='
string|"''"
op|'.'
name|'join'
op|'('
op|'['
string|"'a'"
name|'for'
name|'i'
name|'in'
name|'xrange'
op|'('
name|'max'
op|')'
op|']'
op|')'
newline|'\n'
name|'files'
op|'='
op|'['
op|'('
string|"'/test/path'"
op|','
name|'content'
op|')'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'_create_with_injected_files'
op|'('
name|'files'
op|')'
comment|'# no QuotaError'
newline|'\n'
nl|'\n'
DECL|member|test_too_many_injected_file_content_bytes
dedent|''
name|'def'
name|'test_too_many_injected_file_content_bytes'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'max'
op|'='
name|'CONF'
op|'.'
name|'quota_injected_file_content_bytes'
newline|'\n'
name|'content'
op|'='
string|"''"
op|'.'
name|'join'
op|'('
op|'['
string|"'a'"
name|'for'
name|'i'
name|'in'
name|'xrange'
op|'('
name|'max'
op|'+'
number|'1'
op|')'
op|']'
op|')'
newline|'\n'
name|'files'
op|'='
op|'['
op|'('
string|"'/test/path'"
op|','
name|'content'
op|')'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'QuotaError'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_create_with_injected_files'
op|','
name|'files'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_max_injected_file_path_bytes
dedent|''
name|'def'
name|'test_max_injected_file_path_bytes'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'max'
op|'='
name|'CONF'
op|'.'
name|'quota_injected_file_path_length'
newline|'\n'
name|'path'
op|'='
string|"''"
op|'.'
name|'join'
op|'('
op|'['
string|"'a'"
name|'for'
name|'i'
name|'in'
name|'xrange'
op|'('
name|'max'
op|')'
op|']'
op|')'
newline|'\n'
name|'files'
op|'='
op|'['
op|'('
name|'path'
op|','
string|"'config = quotatest'"
op|')'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'_create_with_injected_files'
op|'('
name|'files'
op|')'
comment|'# no QuotaError'
newline|'\n'
nl|'\n'
DECL|member|test_too_many_injected_file_path_bytes
dedent|''
name|'def'
name|'test_too_many_injected_file_path_bytes'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'max'
op|'='
name|'CONF'
op|'.'
name|'quota_injected_file_path_length'
newline|'\n'
name|'path'
op|'='
string|"''"
op|'.'
name|'join'
op|'('
op|'['
string|"'a'"
name|'for'
name|'i'
name|'in'
name|'xrange'
op|'('
name|'max'
op|'+'
number|'1'
op|')'
op|']'
op|')'
newline|'\n'
name|'files'
op|'='
op|'['
op|'('
name|'path'
op|','
string|"'config = quotatest'"
op|')'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'QuotaError'
op|','
nl|'\n'
name|'self'
op|'.'
name|'_create_with_injected_files'
op|','
name|'files'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_reservation_expire
dedent|''
name|'def'
name|'test_reservation_expire'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'useFixture'
op|'('
name|'test'
op|'.'
name|'TimeOverride'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|function|assertInstancesReserved
name|'def'
name|'assertInstancesReserved'
op|'('
name|'reserved'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'result'
op|'='
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'get_project_quotas'
op|'('
name|'self'
op|'.'
name|'context'
op|','
nl|'\n'
name|'self'
op|'.'
name|'context'
op|'.'
name|'project_id'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|'['
string|"'instances'"
op|']'
op|'['
string|"'reserved'"
op|']'
op|','
name|'reserved'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'reserve'
op|'('
name|'self'
op|'.'
name|'context'
op|','
nl|'\n'
name|'expire'
op|'='
number|'60'
op|','
nl|'\n'
name|'instances'
op|'='
number|'2'
op|')'
newline|'\n'
nl|'\n'
name|'assertInstancesReserved'
op|'('
number|'2'
op|')'
newline|'\n'
nl|'\n'
name|'timeutils'
op|'.'
name|'advance_time_seconds'
op|'('
number|'80'
op|')'
newline|'\n'
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'expire'
op|'('
name|'self'
op|'.'
name|'context'
op|')'
newline|'\n'
nl|'\n'
name|'assertInstancesReserved'
op|'('
number|'0'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|FakeContext
dedent|''
dedent|''
name|'class'
name|'FakeContext'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'project_id'
op|','
name|'quota_class'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'is_admin'
op|'='
name|'False'
newline|'\n'
name|'self'
op|'.'
name|'user_id'
op|'='
string|"'fake_user'"
newline|'\n'
name|'self'
op|'.'
name|'project_id'
op|'='
name|'project_id'
newline|'\n'
name|'self'
op|'.'
name|'quota_class'
op|'='
name|'quota_class'
newline|'\n'
name|'self'
op|'.'
name|'read_deleted'
op|'='
string|"'no'"
newline|'\n'
nl|'\n'
DECL|member|elevated
dedent|''
name|'def'
name|'elevated'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'elevated'
op|'='
name|'self'
op|'.'
name|'__class__'
op|'('
name|'self'
op|'.'
name|'project_id'
op|','
name|'self'
op|'.'
name|'quota_class'
op|')'
newline|'\n'
name|'elevated'
op|'.'
name|'is_admin'
op|'='
name|'True'
newline|'\n'
name|'return'
name|'elevated'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|FakeDriver
dedent|''
dedent|''
name|'class'
name|'FakeDriver'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'by_project'
op|'='
name|'None'
op|','
name|'by_user'
op|'='
name|'None'
op|','
name|'by_class'
op|'='
name|'None'
op|','
nl|'\n'
name|'reservations'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'called'
op|'='
op|'['
op|']'
newline|'\n'
name|'self'
op|'.'
name|'by_project'
op|'='
name|'by_project'
name|'or'
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'by_user'
op|'='
name|'by_user'
name|'or'
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'by_class'
op|'='
name|'by_class'
name|'or'
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'reservations'
op|'='
name|'reservations'
name|'or'
op|'['
op|']'
newline|'\n'
nl|'\n'
DECL|member|get_by_project_and_user
dedent|''
name|'def'
name|'get_by_project_and_user'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'project_id'
op|','
name|'user_id'
op|','
name|'resource'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'called'
op|'.'
name|'append'
op|'('
op|'('
string|"'get_by_project_and_user'"
op|','
nl|'\n'
name|'context'
op|','
name|'project_id'
op|','
name|'user_id'
op|','
name|'resource'
op|')'
op|')'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'by_user'
op|'['
name|'user_id'
op|']'
op|'['
name|'resource'
op|']'
newline|'\n'
dedent|''
name|'except'
name|'KeyError'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'exception'
op|'.'
name|'ProjectUserQuotaNotFound'
op|'('
name|'project_id'
op|'='
name|'project_id'
op|','
nl|'\n'
name|'user_id'
op|'='
name|'user_id'
op|')'
newline|'\n'
nl|'\n'
DECL|member|get_by_project
dedent|''
dedent|''
name|'def'
name|'get_by_project'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'project_id'
op|','
name|'resource'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'called'
op|'.'
name|'append'
op|'('
op|'('
string|"'get_by_project'"
op|','
name|'context'
op|','
name|'project_id'
op|','
name|'resource'
op|')'
op|')'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'by_project'
op|'['
name|'project_id'
op|']'
op|'['
name|'resource'
op|']'
newline|'\n'
dedent|''
name|'except'
name|'KeyError'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'exception'
op|'.'
name|'ProjectQuotaNotFound'
op|'('
name|'project_id'
op|'='
name|'project_id'
op|')'
newline|'\n'
nl|'\n'
DECL|member|get_by_class
dedent|''
dedent|''
name|'def'
name|'get_by_class'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'quota_class'
op|','
name|'resource'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'called'
op|'.'
name|'append'
op|'('
op|'('
string|"'get_by_class'"
op|','
name|'context'
op|','
name|'quota_class'
op|','
name|'resource'
op|')'
op|')'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'by_class'
op|'['
name|'quota_class'
op|']'
op|'['
name|'resource'
op|']'
newline|'\n'
dedent|''
name|'except'
name|'KeyError'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'exception'
op|'.'
name|'QuotaClassNotFound'
op|'('
name|'class_name'
op|'='
name|'quota_class'
op|')'
newline|'\n'
nl|'\n'
DECL|member|get_defaults
dedent|''
dedent|''
name|'def'
name|'get_defaults'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'resources'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'called'
op|'.'
name|'append'
op|'('
op|'('
string|"'get_defaults'"
op|','
name|'context'
op|','
name|'resources'
op|')'
op|')'
newline|'\n'
name|'return'
name|'resources'
newline|'\n'
nl|'\n'
DECL|member|get_class_quotas
dedent|''
name|'def'
name|'get_class_quotas'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'resources'
op|','
name|'quota_class'
op|','
nl|'\n'
name|'defaults'
op|'='
name|'True'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'called'
op|'.'
name|'append'
op|'('
op|'('
string|"'get_class_quotas'"
op|','
name|'context'
op|','
name|'resources'
op|','
nl|'\n'
name|'quota_class'
op|','
name|'defaults'
op|')'
op|')'
newline|'\n'
name|'return'
name|'resources'
newline|'\n'
nl|'\n'
DECL|member|get_user_quotas
dedent|''
name|'def'
name|'get_user_quotas'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'resources'
op|','
name|'project_id'
op|','
name|'user_id'
op|','
nl|'\n'
name|'quota_class'
op|'='
name|'None'
op|','
name|'defaults'
op|'='
name|'True'
op|','
name|'usages'
op|'='
name|'True'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'called'
op|'.'
name|'append'
op|'('
op|'('
string|"'get_user_quotas'"
op|','
name|'context'
op|','
name|'resources'
op|','
nl|'\n'
name|'project_id'
op|','
name|'user_id'
op|','
name|'quota_class'
op|','
name|'defaults'
op|','
nl|'\n'
name|'usages'
op|')'
op|')'
newline|'\n'
name|'return'
name|'resources'
newline|'\n'
nl|'\n'
DECL|member|get_project_quotas
dedent|''
name|'def'
name|'get_project_quotas'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'resources'
op|','
name|'project_id'
op|','
nl|'\n'
name|'quota_class'
op|'='
name|'None'
op|','
name|'defaults'
op|'='
name|'True'
op|','
name|'usages'
op|'='
name|'True'
op|','
nl|'\n'
name|'remains'
op|'='
name|'False'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'called'
op|'.'
name|'append'
op|'('
op|'('
string|"'get_project_quotas'"
op|','
name|'context'
op|','
name|'resources'
op|','
nl|'\n'
name|'project_id'
op|','
name|'quota_class'
op|','
name|'defaults'
op|','
name|'usages'
op|','
nl|'\n'
name|'remains'
op|')'
op|')'
newline|'\n'
name|'return'
name|'resources'
newline|'\n'
nl|'\n'
DECL|member|limit_check
dedent|''
name|'def'
name|'limit_check'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'resources'
op|','
name|'values'
op|','
name|'project_id'
op|'='
name|'None'
op|','
nl|'\n'
name|'user_id'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'called'
op|'.'
name|'append'
op|'('
op|'('
string|"'limit_check'"
op|','
name|'context'
op|','
name|'resources'
op|','
nl|'\n'
name|'values'
op|','
name|'project_id'
op|','
name|'user_id'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|reserve
dedent|''
name|'def'
name|'reserve'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'resources'
op|','
name|'deltas'
op|','
name|'expire'
op|'='
name|'None'
op|','
nl|'\n'
name|'project_id'
op|'='
name|'None'
op|','
name|'user_id'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'called'
op|'.'
name|'append'
op|'('
op|'('
string|"'reserve'"
op|','
name|'context'
op|','
name|'resources'
op|','
name|'deltas'
op|','
nl|'\n'
name|'expire'
op|','
name|'project_id'
op|','
name|'user_id'
op|')'
op|')'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'reservations'
newline|'\n'
nl|'\n'
DECL|member|commit
dedent|''
name|'def'
name|'commit'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'reservations'
op|','
name|'project_id'
op|'='
name|'None'
op|','
name|'user_id'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'called'
op|'.'
name|'append'
op|'('
op|'('
string|"'commit'"
op|','
name|'context'
op|','
name|'reservations'
op|','
name|'project_id'
op|','
nl|'\n'
name|'user_id'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|rollback
dedent|''
name|'def'
name|'rollback'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'reservations'
op|','
name|'project_id'
op|'='
name|'None'
op|','
name|'user_id'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'called'
op|'.'
name|'append'
op|'('
op|'('
string|"'rollback'"
op|','
name|'context'
op|','
name|'reservations'
op|','
name|'project_id'
op|','
nl|'\n'
name|'user_id'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|usage_reset
dedent|''
name|'def'
name|'usage_reset'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'resources'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'called'
op|'.'
name|'append'
op|'('
op|'('
string|"'usage_reset'"
op|','
name|'context'
op|','
name|'resources'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|destroy_all_by_project_and_user
dedent|''
name|'def'
name|'destroy_all_by_project_and_user'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'project_id'
op|','
name|'user_id'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'called'
op|'.'
name|'append'
op|'('
op|'('
string|"'destroy_all_by_project_and_user'"
op|','
name|'context'
op|','
nl|'\n'
name|'project_id'
op|','
name|'user_id'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|destroy_all_by_project
dedent|''
name|'def'
name|'destroy_all_by_project'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'project_id'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'called'
op|'.'
name|'append'
op|'('
op|'('
string|"'destroy_all_by_project'"
op|','
name|'context'
op|','
name|'project_id'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|expire
dedent|''
name|'def'
name|'expire'
op|'('
name|'self'
op|','
name|'context'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'called'
op|'.'
name|'append'
op|'('
op|'('
string|"'expire'"
op|','
name|'context'
op|')'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|BaseResourceTestCase
dedent|''
dedent|''
name|'class'
name|'BaseResourceTestCase'
op|'('
name|'test'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
DECL|member|test_no_flag
indent|'    '
name|'def'
name|'test_no_flag'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'resource'
op|'='
name|'quota'
op|'.'
name|'BaseResource'
op|'('
string|"'test_resource'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resource'
op|'.'
name|'name'
op|','
string|"'test_resource'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsNone'
op|'('
name|'resource'
op|'.'
name|'flag'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resource'
op|'.'
name|'default'
op|','
op|'-'
number|'1'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_with_flag
dedent|''
name|'def'
name|'test_with_flag'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# We know this flag exists, so use it...'
nl|'\n'
indent|'        '
name|'self'
op|'.'
name|'flags'
op|'('
name|'quota_instances'
op|'='
number|'10'
op|')'
newline|'\n'
name|'resource'
op|'='
name|'quota'
op|'.'
name|'BaseResource'
op|'('
string|"'test_resource'"
op|','
string|"'quota_instances'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resource'
op|'.'
name|'name'
op|','
string|"'test_resource'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resource'
op|'.'
name|'flag'
op|','
string|"'quota_instances'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resource'
op|'.'
name|'default'
op|','
number|'10'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_with_flag_no_quota
dedent|''
name|'def'
name|'test_with_flag_no_quota'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'flags'
op|'('
name|'quota_instances'
op|'='
op|'-'
number|'1'
op|')'
newline|'\n'
name|'resource'
op|'='
name|'quota'
op|'.'
name|'BaseResource'
op|'('
string|"'test_resource'"
op|','
string|"'quota_instances'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resource'
op|'.'
name|'name'
op|','
string|"'test_resource'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resource'
op|'.'
name|'flag'
op|','
string|"'quota_instances'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resource'
op|'.'
name|'default'
op|','
op|'-'
number|'1'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_quota_no_project_no_class
dedent|''
name|'def'
name|'test_quota_no_project_no_class'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'flags'
op|'('
name|'quota_instances'
op|'='
number|'10'
op|')'
newline|'\n'
name|'resource'
op|'='
name|'quota'
op|'.'
name|'BaseResource'
op|'('
string|"'test_resource'"
op|','
string|"'quota_instances'"
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
op|')'
newline|'\n'
name|'context'
op|'='
name|'FakeContext'
op|'('
name|'None'
op|','
name|'None'
op|')'
newline|'\n'
name|'quota_value'
op|'='
name|'resource'
op|'.'
name|'quota'
op|'('
name|'driver'
op|','
name|'context'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'quota_value'
op|','
number|'10'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_quota_with_project_no_class
dedent|''
name|'def'
name|'test_quota_with_project_no_class'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'flags'
op|'('
name|'quota_instances'
op|'='
number|'10'
op|')'
newline|'\n'
name|'resource'
op|'='
name|'quota'
op|'.'
name|'BaseResource'
op|'('
string|"'test_resource'"
op|','
string|"'quota_instances'"
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
name|'by_project'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'test_project'
op|'='
name|'dict'
op|'('
name|'test_resource'
op|'='
number|'15'
op|')'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
name|'context'
op|'='
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
name|'None'
op|')'
newline|'\n'
name|'quota_value'
op|'='
name|'resource'
op|'.'
name|'quota'
op|'('
name|'driver'
op|','
name|'context'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'quota_value'
op|','
number|'15'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_quota_no_project_with_class
dedent|''
name|'def'
name|'test_quota_no_project_with_class'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'flags'
op|'('
name|'quota_instances'
op|'='
number|'10'
op|')'
newline|'\n'
name|'resource'
op|'='
name|'quota'
op|'.'
name|'BaseResource'
op|'('
string|"'test_resource'"
op|','
string|"'quota_instances'"
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
name|'by_class'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'test_class'
op|'='
name|'dict'
op|'('
name|'test_resource'
op|'='
number|'20'
op|')'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
name|'context'
op|'='
name|'FakeContext'
op|'('
name|'None'
op|','
string|"'test_class'"
op|')'
newline|'\n'
name|'quota_value'
op|'='
name|'resource'
op|'.'
name|'quota'
op|'('
name|'driver'
op|','
name|'context'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'quota_value'
op|','
number|'20'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_quota_with_project_with_class
dedent|''
name|'def'
name|'test_quota_with_project_with_class'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'flags'
op|'('
name|'quota_instances'
op|'='
number|'10'
op|')'
newline|'\n'
name|'resource'
op|'='
name|'quota'
op|'.'
name|'BaseResource'
op|'('
string|"'test_resource'"
op|','
string|"'quota_instances'"
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
name|'by_project'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'test_project'
op|'='
name|'dict'
op|'('
name|'test_resource'
op|'='
number|'15'
op|')'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'by_class'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'test_class'
op|'='
name|'dict'
op|'('
name|'test_resource'
op|'='
number|'20'
op|')'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
name|'context'
op|'='
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
newline|'\n'
name|'quota_value'
op|'='
name|'resource'
op|'.'
name|'quota'
op|'('
name|'driver'
op|','
name|'context'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'quota_value'
op|','
number|'15'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_quota_override_project_with_class
dedent|''
name|'def'
name|'test_quota_override_project_with_class'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'flags'
op|'('
name|'quota_instances'
op|'='
number|'10'
op|')'
newline|'\n'
name|'resource'
op|'='
name|'quota'
op|'.'
name|'BaseResource'
op|'('
string|"'test_resource'"
op|','
string|"'quota_instances'"
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
name|'by_project'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'test_project'
op|'='
name|'dict'
op|'('
name|'test_resource'
op|'='
number|'15'
op|')'
op|','
nl|'\n'
name|'override_project'
op|'='
name|'dict'
op|'('
name|'test_resource'
op|'='
number|'20'
op|')'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
name|'context'
op|'='
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
newline|'\n'
name|'quota_value'
op|'='
name|'resource'
op|'.'
name|'quota'
op|'('
name|'driver'
op|','
name|'context'
op|','
nl|'\n'
name|'project_id'
op|'='
string|"'override_project'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'quota_value'
op|','
number|'20'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_quota_with_project_override_class
dedent|''
name|'def'
name|'test_quota_with_project_override_class'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'flags'
op|'('
name|'quota_instances'
op|'='
number|'10'
op|')'
newline|'\n'
name|'resource'
op|'='
name|'quota'
op|'.'
name|'BaseResource'
op|'('
string|"'test_resource'"
op|','
string|"'quota_instances'"
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
name|'by_class'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'test_class'
op|'='
name|'dict'
op|'('
name|'test_resource'
op|'='
number|'15'
op|')'
op|','
nl|'\n'
name|'override_class'
op|'='
name|'dict'
op|'('
name|'test_resource'
op|'='
number|'20'
op|')'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
name|'context'
op|'='
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
newline|'\n'
name|'quota_value'
op|'='
name|'resource'
op|'.'
name|'quota'
op|'('
name|'driver'
op|','
name|'context'
op|','
nl|'\n'
name|'quota_class'
op|'='
string|"'override_class'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'quota_value'
op|','
number|'20'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_valid_method_call_check_invalid_input
dedent|''
name|'def'
name|'test_valid_method_call_check_invalid_input'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'resources'
op|'='
op|'{'
string|"'dummy'"
op|':'
number|'1'
op|'}'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'InvalidQuotaMethodUsage'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'_valid_method_call_check_resources'
op|','
nl|'\n'
name|'resources'
op|','
string|"'limit'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_valid_method_call_check_invalid_method
dedent|''
name|'def'
name|'test_valid_method_call_check_invalid_method'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'resources'
op|'='
op|'{'
string|"'key_pairs'"
op|':'
number|'1'
op|'}'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'InvalidQuotaMethodUsage'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'_valid_method_call_check_resources'
op|','
nl|'\n'
name|'resources'
op|','
string|"'dummy'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_valid_method_call_check_multiple
dedent|''
name|'def'
name|'test_valid_method_call_check_multiple'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'resources'
op|'='
op|'{'
string|"'key_pairs'"
op|':'
number|'1'
op|','
string|"'dummy'"
op|':'
number|'2'
op|'}'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'InvalidQuotaMethodUsage'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'_valid_method_call_check_resources'
op|','
nl|'\n'
name|'resources'
op|','
string|"'check'"
op|')'
newline|'\n'
nl|'\n'
name|'resources'
op|'='
op|'{'
string|"'key_pairs'"
op|':'
number|'1'
op|','
string|"'instances'"
op|':'
number|'2'
op|','
string|"'dummy'"
op|':'
number|'3'
op|'}'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'InvalidQuotaMethodUsage'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'_valid_method_call_check_resources'
op|','
nl|'\n'
name|'resources'
op|','
string|"'check'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_valid_method_call_check_wrong_method_reserve
dedent|''
name|'def'
name|'test_valid_method_call_check_wrong_method_reserve'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'resources'
op|'='
op|'{'
string|"'key_pairs'"
op|':'
number|'1'
op|'}'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'InvalidQuotaMethodUsage'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'_valid_method_call_check_resources'
op|','
nl|'\n'
name|'resources'
op|','
string|"'reserve'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_valid_method_call_check_wrong_method_check
dedent|''
name|'def'
name|'test_valid_method_call_check_wrong_method_check'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'resources'
op|'='
op|'{'
string|"'fixed_ips'"
op|':'
number|'1'
op|'}'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'InvalidQuotaMethodUsage'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'_valid_method_call_check_resources'
op|','
nl|'\n'
name|'resources'
op|','
string|"'check'"
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|QuotaEngineTestCase
dedent|''
dedent|''
name|'class'
name|'QuotaEngineTestCase'
op|'('
name|'test'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
DECL|member|test_init
indent|'    '
name|'def'
name|'test_init'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'quota_obj'
op|'='
name|'quota'
op|'.'
name|'QuotaEngine'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'quota_obj'
op|'.'
name|'_resources'
op|','
op|'{'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'quota_obj'
op|'.'
name|'_driver'
op|','
name|'quota'
op|'.'
name|'DbQuotaDriver'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_init_override_string
dedent|''
name|'def'
name|'test_init_override_string'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'quota_obj'
op|'='
name|'quota'
op|'.'
name|'QuotaEngine'
op|'('
nl|'\n'
name|'quota_driver_class'
op|'='
string|"'nova.tests.unit.test_quota.FakeDriver'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'quota_obj'
op|'.'
name|'_resources'
op|','
op|'{'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertIsInstance'
op|'('
name|'quota_obj'
op|'.'
name|'_driver'
op|','
name|'FakeDriver'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_init_override_obj
dedent|''
name|'def'
name|'test_init_override_obj'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'quota_obj'
op|'='
name|'quota'
op|'.'
name|'QuotaEngine'
op|'('
name|'quota_driver_class'
op|'='
name|'FakeDriver'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'quota_obj'
op|'.'
name|'_resources'
op|','
op|'{'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'quota_obj'
op|'.'
name|'_driver'
op|','
name|'FakeDriver'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_register_resource
dedent|''
name|'def'
name|'test_register_resource'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'quota_obj'
op|'='
name|'quota'
op|'.'
name|'QuotaEngine'
op|'('
op|')'
newline|'\n'
name|'resource'
op|'='
name|'quota'
op|'.'
name|'AbsoluteResource'
op|'('
string|"'test_resource'"
op|')'
newline|'\n'
name|'quota_obj'
op|'.'
name|'register_resource'
op|'('
name|'resource'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'quota_obj'
op|'.'
name|'_resources'
op|','
name|'dict'
op|'('
name|'test_resource'
op|'='
name|'resource'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_register_resources
dedent|''
name|'def'
name|'test_register_resources'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'quota_obj'
op|'='
name|'quota'
op|'.'
name|'QuotaEngine'
op|'('
op|')'
newline|'\n'
name|'resources'
op|'='
op|'['
nl|'\n'
name|'quota'
op|'.'
name|'AbsoluteResource'
op|'('
string|"'test_resource1'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'AbsoluteResource'
op|'('
string|"'test_resource2'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'AbsoluteResource'
op|'('
string|"'test_resource3'"
op|')'
op|','
nl|'\n'
op|']'
newline|'\n'
name|'quota_obj'
op|'.'
name|'register_resources'
op|'('
name|'resources'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'quota_obj'
op|'.'
name|'_resources'
op|','
name|'dict'
op|'('
nl|'\n'
name|'test_resource1'
op|'='
name|'resources'
op|'['
number|'0'
op|']'
op|','
nl|'\n'
name|'test_resource2'
op|'='
name|'resources'
op|'['
number|'1'
op|']'
op|','
nl|'\n'
name|'test_resource3'
op|'='
name|'resources'
op|'['
number|'2'
op|']'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_by_project_and_user
dedent|''
name|'def'
name|'test_get_by_project_and_user'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
name|'by_user'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'fake_user'
op|'='
name|'dict'
op|'('
name|'test_resource'
op|'='
number|'42'
op|')'
op|')'
op|')'
newline|'\n'
name|'quota_obj'
op|'='
name|'quota'
op|'.'
name|'QuotaEngine'
op|'('
name|'quota_driver_class'
op|'='
name|'driver'
op|')'
newline|'\n'
name|'result'
op|'='
name|'quota_obj'
op|'.'
name|'get_by_project_and_user'
op|'('
name|'context'
op|','
string|"'test_project'"
op|','
nl|'\n'
string|"'fake_user'"
op|','
string|"'test_resource'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'driver'
op|'.'
name|'called'
op|','
op|'['
nl|'\n'
op|'('
string|"'get_by_project_and_user'"
op|','
name|'context'
op|','
string|"'test_project'"
op|','
nl|'\n'
string|"'fake_user'"
op|','
string|"'test_resource'"
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
number|'42'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_by_project
dedent|''
name|'def'
name|'test_get_by_project'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
name|'by_project'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'test_project'
op|'='
name|'dict'
op|'('
name|'test_resource'
op|'='
number|'42'
op|')'
op|')'
op|')'
newline|'\n'
name|'quota_obj'
op|'='
name|'quota'
op|'.'
name|'QuotaEngine'
op|'('
name|'quota_driver_class'
op|'='
name|'driver'
op|')'
newline|'\n'
name|'result'
op|'='
name|'quota_obj'
op|'.'
name|'get_by_project'
op|'('
name|'context'
op|','
string|"'test_project'"
op|','
nl|'\n'
string|"'test_resource'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'driver'
op|'.'
name|'called'
op|','
op|'['
nl|'\n'
op|'('
string|"'get_by_project'"
op|','
name|'context'
op|','
string|"'test_project'"
op|','
string|"'test_resource'"
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
number|'42'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_by_class
dedent|''
name|'def'
name|'test_get_by_class'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
name|'by_class'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'test_class'
op|'='
name|'dict'
op|'('
name|'test_resource'
op|'='
number|'42'
op|')'
op|')'
op|')'
newline|'\n'
name|'quota_obj'
op|'='
name|'quota'
op|'.'
name|'QuotaEngine'
op|'('
name|'quota_driver_class'
op|'='
name|'driver'
op|')'
newline|'\n'
name|'result'
op|'='
name|'quota_obj'
op|'.'
name|'get_by_class'
op|'('
name|'context'
op|','
string|"'test_class'"
op|','
string|"'test_resource'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'driver'
op|'.'
name|'called'
op|','
op|'['
nl|'\n'
op|'('
string|"'get_by_class'"
op|','
name|'context'
op|','
string|"'test_class'"
op|','
string|"'test_resource'"
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
number|'42'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_make_quota_obj
dedent|''
name|'def'
name|'_make_quota_obj'
op|'('
name|'self'
op|','
name|'driver'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'quota_obj'
op|'='
name|'quota'
op|'.'
name|'QuotaEngine'
op|'('
name|'quota_driver_class'
op|'='
name|'driver'
op|')'
newline|'\n'
name|'resources'
op|'='
op|'['
nl|'\n'
name|'quota'
op|'.'
name|'AbsoluteResource'
op|'('
string|"'test_resource4'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'AbsoluteResource'
op|'('
string|"'test_resource3'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'AbsoluteResource'
op|'('
string|"'test_resource2'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'AbsoluteResource'
op|'('
string|"'test_resource1'"
op|')'
op|','
nl|'\n'
op|']'
newline|'\n'
name|'quota_obj'
op|'.'
name|'register_resources'
op|'('
name|'resources'
op|')'
newline|'\n'
nl|'\n'
name|'return'
name|'quota_obj'
newline|'\n'
nl|'\n'
DECL|member|test_get_defaults
dedent|''
name|'def'
name|'test_get_defaults'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'FakeContext'
op|'('
name|'None'
op|','
name|'None'
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
op|')'
newline|'\n'
name|'quota_obj'
op|'='
name|'self'
op|'.'
name|'_make_quota_obj'
op|'('
name|'driver'
op|')'
newline|'\n'
name|'result'
op|'='
name|'quota_obj'
op|'.'
name|'get_defaults'
op|'('
name|'context'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'driver'
op|'.'
name|'called'
op|','
op|'['
nl|'\n'
op|'('
string|"'get_defaults'"
op|','
name|'context'
op|','
name|'quota_obj'
op|'.'
name|'_resources'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
name|'quota_obj'
op|'.'
name|'_resources'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_class_quotas
dedent|''
name|'def'
name|'test_get_class_quotas'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'FakeContext'
op|'('
name|'None'
op|','
name|'None'
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
op|')'
newline|'\n'
name|'quota_obj'
op|'='
name|'self'
op|'.'
name|'_make_quota_obj'
op|'('
name|'driver'
op|')'
newline|'\n'
name|'result1'
op|'='
name|'quota_obj'
op|'.'
name|'get_class_quotas'
op|'('
name|'context'
op|','
string|"'test_class'"
op|')'
newline|'\n'
name|'result2'
op|'='
name|'quota_obj'
op|'.'
name|'get_class_quotas'
op|'('
name|'context'
op|','
string|"'test_class'"
op|','
name|'False'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'driver'
op|'.'
name|'called'
op|','
op|'['
nl|'\n'
op|'('
string|"'get_class_quotas'"
op|','
name|'context'
op|','
name|'quota_obj'
op|'.'
name|'_resources'
op|','
nl|'\n'
string|"'test_class'"
op|','
name|'True'
op|')'
op|','
nl|'\n'
op|'('
string|"'get_class_quotas'"
op|','
name|'context'
op|','
name|'quota_obj'
op|'.'
name|'_resources'
op|','
nl|'\n'
string|"'test_class'"
op|','
name|'False'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result1'
op|','
name|'quota_obj'
op|'.'
name|'_resources'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result2'
op|','
name|'quota_obj'
op|'.'
name|'_resources'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_user_quotas
dedent|''
name|'def'
name|'test_get_user_quotas'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'FakeContext'
op|'('
name|'None'
op|','
name|'None'
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
op|')'
newline|'\n'
name|'quota_obj'
op|'='
name|'self'
op|'.'
name|'_make_quota_obj'
op|'('
name|'driver'
op|')'
newline|'\n'
name|'result1'
op|'='
name|'quota_obj'
op|'.'
name|'get_user_quotas'
op|'('
name|'context'
op|','
string|"'test_project'"
op|','
nl|'\n'
string|"'fake_user'"
op|')'
newline|'\n'
name|'result2'
op|'='
name|'quota_obj'
op|'.'
name|'get_user_quotas'
op|'('
name|'context'
op|','
string|"'test_project'"
op|','
nl|'\n'
string|"'fake_user'"
op|','
nl|'\n'
name|'quota_class'
op|'='
string|"'test_class'"
op|','
nl|'\n'
name|'defaults'
op|'='
name|'False'
op|','
nl|'\n'
name|'usages'
op|'='
name|'False'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'driver'
op|'.'
name|'called'
op|','
op|'['
nl|'\n'
op|'('
string|"'get_user_quotas'"
op|','
name|'context'
op|','
name|'quota_obj'
op|'.'
name|'_resources'
op|','
nl|'\n'
string|"'test_project'"
op|','
string|"'fake_user'"
op|','
name|'None'
op|','
name|'True'
op|','
name|'True'
op|')'
op|','
nl|'\n'
op|'('
string|"'get_user_quotas'"
op|','
name|'context'
op|','
name|'quota_obj'
op|'.'
name|'_resources'
op|','
nl|'\n'
string|"'test_project'"
op|','
string|"'fake_user'"
op|','
string|"'test_class'"
op|','
name|'False'
op|','
name|'False'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result1'
op|','
name|'quota_obj'
op|'.'
name|'_resources'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result2'
op|','
name|'quota_obj'
op|'.'
name|'_resources'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_project_quotas
dedent|''
name|'def'
name|'test_get_project_quotas'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'FakeContext'
op|'('
name|'None'
op|','
name|'None'
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
op|')'
newline|'\n'
name|'quota_obj'
op|'='
name|'self'
op|'.'
name|'_make_quota_obj'
op|'('
name|'driver'
op|')'
newline|'\n'
name|'result1'
op|'='
name|'quota_obj'
op|'.'
name|'get_project_quotas'
op|'('
name|'context'
op|','
string|"'test_project'"
op|')'
newline|'\n'
name|'result2'
op|'='
name|'quota_obj'
op|'.'
name|'get_project_quotas'
op|'('
name|'context'
op|','
string|"'test_project'"
op|','
nl|'\n'
name|'quota_class'
op|'='
string|"'test_class'"
op|','
nl|'\n'
name|'defaults'
op|'='
name|'False'
op|','
nl|'\n'
name|'usages'
op|'='
name|'False'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'driver'
op|'.'
name|'called'
op|','
op|'['
nl|'\n'
op|'('
string|"'get_project_quotas'"
op|','
name|'context'
op|','
name|'quota_obj'
op|'.'
name|'_resources'
op|','
nl|'\n'
string|"'test_project'"
op|','
name|'None'
op|','
name|'True'
op|','
name|'True'
op|','
name|'False'
op|')'
op|','
nl|'\n'
op|'('
string|"'get_project_quotas'"
op|','
name|'context'
op|','
name|'quota_obj'
op|'.'
name|'_resources'
op|','
nl|'\n'
string|"'test_project'"
op|','
string|"'test_class'"
op|','
name|'False'
op|','
name|'False'
op|','
name|'False'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result1'
op|','
name|'quota_obj'
op|'.'
name|'_resources'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result2'
op|','
name|'quota_obj'
op|'.'
name|'_resources'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_count_no_resource
dedent|''
name|'def'
name|'test_count_no_resource'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'FakeContext'
op|'('
name|'None'
op|','
name|'None'
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
op|')'
newline|'\n'
name|'quota_obj'
op|'='
name|'self'
op|'.'
name|'_make_quota_obj'
op|'('
name|'driver'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'QuotaResourceUnknown'
op|','
nl|'\n'
name|'quota_obj'
op|'.'
name|'count'
op|','
name|'context'
op|','
string|"'test_resource5'"
op|','
nl|'\n'
name|'True'
op|','
name|'foo'
op|'='
string|"'bar'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_count_wrong_resource
dedent|''
name|'def'
name|'test_count_wrong_resource'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'FakeContext'
op|'('
name|'None'
op|','
name|'None'
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
op|')'
newline|'\n'
name|'quota_obj'
op|'='
name|'self'
op|'.'
name|'_make_quota_obj'
op|'('
name|'driver'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'QuotaResourceUnknown'
op|','
nl|'\n'
name|'quota_obj'
op|'.'
name|'count'
op|','
name|'context'
op|','
string|"'test_resource1'"
op|','
nl|'\n'
name|'True'
op|','
name|'foo'
op|'='
string|"'bar'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_count
dedent|''
name|'def'
name|'test_count'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|function|fake_count
indent|'        '
name|'def'
name|'fake_count'
op|'('
name|'context'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'args'
op|','
op|'('
name|'True'
op|','
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'kwargs'
op|','
name|'dict'
op|'('
name|'foo'
op|'='
string|"'bar'"
op|')'
op|')'
newline|'\n'
name|'return'
number|'5'
newline|'\n'
nl|'\n'
dedent|''
name|'context'
op|'='
name|'FakeContext'
op|'('
name|'None'
op|','
name|'None'
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
op|')'
newline|'\n'
name|'quota_obj'
op|'='
name|'self'
op|'.'
name|'_make_quota_obj'
op|'('
name|'driver'
op|')'
newline|'\n'
name|'quota_obj'
op|'.'
name|'register_resource'
op|'('
name|'quota'
op|'.'
name|'CountableResource'
op|'('
string|"'test_resource5'"
op|','
nl|'\n'
name|'fake_count'
op|')'
op|')'
newline|'\n'
name|'result'
op|'='
name|'quota_obj'
op|'.'
name|'count'
op|'('
name|'context'
op|','
string|"'test_resource5'"
op|','
name|'True'
op|','
name|'foo'
op|'='
string|"'bar'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
number|'5'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_limit_check
dedent|''
name|'def'
name|'test_limit_check'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'FakeContext'
op|'('
name|'None'
op|','
name|'None'
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
op|')'
newline|'\n'
name|'quota_obj'
op|'='
name|'self'
op|'.'
name|'_make_quota_obj'
op|'('
name|'driver'
op|')'
newline|'\n'
name|'quota_obj'
op|'.'
name|'limit_check'
op|'('
name|'context'
op|','
name|'test_resource1'
op|'='
number|'4'
op|','
name|'test_resource2'
op|'='
number|'3'
op|','
nl|'\n'
name|'test_resource3'
op|'='
number|'2'
op|','
name|'test_resource4'
op|'='
number|'1'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'driver'
op|'.'
name|'called'
op|','
op|'['
nl|'\n'
op|'('
string|"'limit_check'"
op|','
name|'context'
op|','
name|'quota_obj'
op|'.'
name|'_resources'
op|','
name|'dict'
op|'('
nl|'\n'
name|'test_resource1'
op|'='
number|'4'
op|','
nl|'\n'
name|'test_resource2'
op|'='
number|'3'
op|','
nl|'\n'
name|'test_resource3'
op|'='
number|'2'
op|','
nl|'\n'
name|'test_resource4'
op|'='
number|'1'
op|','
nl|'\n'
op|')'
op|','
name|'None'
op|','
name|'None'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_reserve
dedent|''
name|'def'
name|'test_reserve'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'FakeContext'
op|'('
name|'None'
op|','
name|'None'
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
name|'reservations'
op|'='
op|'['
nl|'\n'
string|"'resv-01'"
op|','
string|"'resv-02'"
op|','
string|"'resv-03'"
op|','
string|"'resv-04'"
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'quota_obj'
op|'='
name|'self'
op|'.'
name|'_make_quota_obj'
op|'('
name|'driver'
op|')'
newline|'\n'
name|'result1'
op|'='
name|'quota_obj'
op|'.'
name|'reserve'
op|'('
name|'context'
op|','
name|'test_resource1'
op|'='
number|'4'
op|','
nl|'\n'
name|'test_resource2'
op|'='
number|'3'
op|','
name|'test_resource3'
op|'='
number|'2'
op|','
nl|'\n'
name|'test_resource4'
op|'='
number|'1'
op|')'
newline|'\n'
name|'result2'
op|'='
name|'quota_obj'
op|'.'
name|'reserve'
op|'('
name|'context'
op|','
name|'expire'
op|'='
number|'3600'
op|','
nl|'\n'
name|'test_resource1'
op|'='
number|'1'
op|','
name|'test_resource2'
op|'='
number|'2'
op|','
nl|'\n'
name|'test_resource3'
op|'='
number|'3'
op|','
name|'test_resource4'
op|'='
number|'4'
op|')'
newline|'\n'
name|'result3'
op|'='
name|'quota_obj'
op|'.'
name|'reserve'
op|'('
name|'context'
op|','
name|'project_id'
op|'='
string|"'fake_project'"
op|','
nl|'\n'
name|'test_resource1'
op|'='
number|'1'
op|','
name|'test_resource2'
op|'='
number|'2'
op|','
nl|'\n'
name|'test_resource3'
op|'='
number|'3'
op|','
name|'test_resource4'
op|'='
number|'4'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'driver'
op|'.'
name|'called'
op|','
op|'['
nl|'\n'
op|'('
string|"'reserve'"
op|','
name|'context'
op|','
name|'quota_obj'
op|'.'
name|'_resources'
op|','
name|'dict'
op|'('
nl|'\n'
name|'test_resource1'
op|'='
number|'4'
op|','
nl|'\n'
name|'test_resource2'
op|'='
number|'3'
op|','
nl|'\n'
name|'test_resource3'
op|'='
number|'2'
op|','
nl|'\n'
name|'test_resource4'
op|'='
number|'1'
op|','
nl|'\n'
op|')'
op|','
name|'None'
op|','
name|'None'
op|','
name|'None'
op|')'
op|','
nl|'\n'
op|'('
string|"'reserve'"
op|','
name|'context'
op|','
name|'quota_obj'
op|'.'
name|'_resources'
op|','
name|'dict'
op|'('
nl|'\n'
name|'test_resource1'
op|'='
number|'1'
op|','
nl|'\n'
name|'test_resource2'
op|'='
number|'2'
op|','
nl|'\n'
name|'test_resource3'
op|'='
number|'3'
op|','
nl|'\n'
name|'test_resource4'
op|'='
number|'4'
op|','
nl|'\n'
op|')'
op|','
number|'3600'
op|','
name|'None'
op|','
name|'None'
op|')'
op|','
nl|'\n'
op|'('
string|"'reserve'"
op|','
name|'context'
op|','
name|'quota_obj'
op|'.'
name|'_resources'
op|','
name|'dict'
op|'('
nl|'\n'
name|'test_resource1'
op|'='
number|'1'
op|','
nl|'\n'
name|'test_resource2'
op|'='
number|'2'
op|','
nl|'\n'
name|'test_resource3'
op|'='
number|'3'
op|','
nl|'\n'
name|'test_resource4'
op|'='
number|'4'
op|','
nl|'\n'
op|')'
op|','
name|'None'
op|','
string|"'fake_project'"
op|','
name|'None'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result1'
op|','
op|'['
nl|'\n'
string|"'resv-01'"
op|','
string|"'resv-02'"
op|','
string|"'resv-03'"
op|','
string|"'resv-04'"
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result2'
op|','
op|'['
nl|'\n'
string|"'resv-01'"
op|','
string|"'resv-02'"
op|','
string|"'resv-03'"
op|','
string|"'resv-04'"
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result3'
op|','
op|'['
nl|'\n'
string|"'resv-01'"
op|','
string|"'resv-02'"
op|','
string|"'resv-03'"
op|','
string|"'resv-04'"
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_commit
dedent|''
name|'def'
name|'test_commit'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'FakeContext'
op|'('
name|'None'
op|','
name|'None'
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
op|')'
newline|'\n'
name|'quota_obj'
op|'='
name|'self'
op|'.'
name|'_make_quota_obj'
op|'('
name|'driver'
op|')'
newline|'\n'
name|'quota_obj'
op|'.'
name|'commit'
op|'('
name|'context'
op|','
op|'['
string|"'resv-01'"
op|','
string|"'resv-02'"
op|','
string|"'resv-03'"
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'driver'
op|'.'
name|'called'
op|','
op|'['
nl|'\n'
op|'('
string|"'commit'"
op|','
name|'context'
op|','
op|'['
string|"'resv-01'"
op|','
string|"'resv-02'"
op|','
string|"'resv-03'"
op|']'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_rollback
dedent|''
name|'def'
name|'test_rollback'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'FakeContext'
op|'('
name|'None'
op|','
name|'None'
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
op|')'
newline|'\n'
name|'quota_obj'
op|'='
name|'self'
op|'.'
name|'_make_quota_obj'
op|'('
name|'driver'
op|')'
newline|'\n'
name|'quota_obj'
op|'.'
name|'rollback'
op|'('
name|'context'
op|','
op|'['
string|"'resv-01'"
op|','
string|"'resv-02'"
op|','
string|"'resv-03'"
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'driver'
op|'.'
name|'called'
op|','
op|'['
nl|'\n'
op|'('
string|"'rollback'"
op|','
name|'context'
op|','
op|'['
string|"'resv-01'"
op|','
string|"'resv-02'"
op|','
string|"'resv-03'"
op|']'
op|','
name|'None'
op|','
nl|'\n'
name|'None'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_usage_reset
dedent|''
name|'def'
name|'test_usage_reset'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'FakeContext'
op|'('
name|'None'
op|','
name|'None'
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
op|')'
newline|'\n'
name|'quota_obj'
op|'='
name|'self'
op|'.'
name|'_make_quota_obj'
op|'('
name|'driver'
op|')'
newline|'\n'
name|'quota_obj'
op|'.'
name|'usage_reset'
op|'('
name|'context'
op|','
op|'['
string|"'res1'"
op|','
string|"'res2'"
op|','
string|"'res3'"
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'driver'
op|'.'
name|'called'
op|','
op|'['
nl|'\n'
op|'('
string|"'usage_reset'"
op|','
name|'context'
op|','
op|'['
string|"'res1'"
op|','
string|"'res2'"
op|','
string|"'res3'"
op|']'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_destroy_all_by_project_and_user
dedent|''
name|'def'
name|'test_destroy_all_by_project_and_user'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'FakeContext'
op|'('
name|'None'
op|','
name|'None'
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
op|')'
newline|'\n'
name|'quota_obj'
op|'='
name|'self'
op|'.'
name|'_make_quota_obj'
op|'('
name|'driver'
op|')'
newline|'\n'
name|'quota_obj'
op|'.'
name|'destroy_all_by_project_and_user'
op|'('
name|'context'
op|','
nl|'\n'
string|"'test_project'"
op|','
string|"'fake_user'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'driver'
op|'.'
name|'called'
op|','
op|'['
nl|'\n'
op|'('
string|"'destroy_all_by_project_and_user'"
op|','
name|'context'
op|','
string|"'test_project'"
op|','
nl|'\n'
string|"'fake_user'"
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_destroy_all_by_project
dedent|''
name|'def'
name|'test_destroy_all_by_project'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'FakeContext'
op|'('
name|'None'
op|','
name|'None'
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
op|')'
newline|'\n'
name|'quota_obj'
op|'='
name|'self'
op|'.'
name|'_make_quota_obj'
op|'('
name|'driver'
op|')'
newline|'\n'
name|'quota_obj'
op|'.'
name|'destroy_all_by_project'
op|'('
name|'context'
op|','
string|"'test_project'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'driver'
op|'.'
name|'called'
op|','
op|'['
nl|'\n'
op|'('
string|"'destroy_all_by_project'"
op|','
name|'context'
op|','
string|"'test_project'"
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_expire
dedent|''
name|'def'
name|'test_expire'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'FakeContext'
op|'('
name|'None'
op|','
name|'None'
op|')'
newline|'\n'
name|'driver'
op|'='
name|'FakeDriver'
op|'('
op|')'
newline|'\n'
name|'quota_obj'
op|'='
name|'self'
op|'.'
name|'_make_quota_obj'
op|'('
name|'driver'
op|')'
newline|'\n'
name|'quota_obj'
op|'.'
name|'expire'
op|'('
name|'context'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'driver'
op|'.'
name|'called'
op|','
op|'['
nl|'\n'
op|'('
string|"'expire'"
op|','
name|'context'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_resources
dedent|''
name|'def'
name|'test_resources'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'quota_obj'
op|'='
name|'self'
op|'.'
name|'_make_quota_obj'
op|'('
name|'None'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'quota_obj'
op|'.'
name|'resources'
op|','
nl|'\n'
op|'['
string|"'test_resource1'"
op|','
string|"'test_resource2'"
op|','
nl|'\n'
string|"'test_resource3'"
op|','
string|"'test_resource4'"
op|']'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|DbQuotaDriverTestCase
dedent|''
dedent|''
name|'class'
name|'DbQuotaDriverTestCase'
op|'('
name|'test'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'DbQuotaDriverTestCase'
op|','
name|'self'
op|')'
op|'.'
name|'setUp'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'flags'
op|'('
name|'quota_instances'
op|'='
number|'10'
op|','
nl|'\n'
name|'quota_cores'
op|'='
number|'20'
op|','
nl|'\n'
name|'quota_ram'
op|'='
number|'50'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'quota_floating_ips'
op|'='
number|'10'
op|','
nl|'\n'
name|'quota_fixed_ips'
op|'='
number|'10'
op|','
nl|'\n'
name|'quota_metadata_items'
op|'='
number|'128'
op|','
nl|'\n'
name|'quota_injected_files'
op|'='
number|'5'
op|','
nl|'\n'
name|'quota_injected_file_content_bytes'
op|'='
number|'10'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'quota_injected_file_path_length'
op|'='
number|'255'
op|','
nl|'\n'
name|'quota_security_groups'
op|'='
number|'10'
op|','
nl|'\n'
name|'quota_security_group_rules'
op|'='
number|'20'
op|','
nl|'\n'
name|'quota_server_groups'
op|'='
number|'10'
op|','
nl|'\n'
name|'quota_server_group_members'
op|'='
number|'10'
op|','
nl|'\n'
name|'reservation_expire'
op|'='
number|'86400'
op|','
nl|'\n'
name|'until_refresh'
op|'='
number|'0'
op|','
nl|'\n'
name|'max_age'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'='
name|'quota'
op|'.'
name|'DbQuotaDriver'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'calls'
op|'='
op|'['
op|']'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'useFixture'
op|'('
name|'test'
op|'.'
name|'TimeOverride'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_defaults
dedent|''
name|'def'
name|'test_get_defaults'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# Use our pre-defined resources'
nl|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_quota_class_get_default'
op|'('
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_defaults'
op|'('
name|'None'
op|','
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
name|'dict'
op|'('
nl|'\n'
name|'instances'
op|'='
number|'5'
op|','
nl|'\n'
name|'cores'
op|'='
number|'20'
op|','
nl|'\n'
name|'ram'
op|'='
number|'25'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'floating_ips'
op|'='
number|'10'
op|','
nl|'\n'
name|'fixed_ips'
op|'='
number|'10'
op|','
nl|'\n'
name|'metadata_items'
op|'='
number|'64'
op|','
nl|'\n'
name|'injected_files'
op|'='
number|'5'
op|','
nl|'\n'
name|'injected_file_content_bytes'
op|'='
number|'5'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'injected_file_path_bytes'
op|'='
number|'255'
op|','
nl|'\n'
name|'security_groups'
op|'='
number|'10'
op|','
nl|'\n'
name|'security_group_rules'
op|'='
number|'20'
op|','
nl|'\n'
name|'key_pairs'
op|'='
number|'100'
op|','
nl|'\n'
name|'server_groups'
op|'='
number|'10'
op|','
nl|'\n'
name|'server_group_members'
op|'='
number|'10'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_stub_quota_class_get_default
dedent|''
name|'def'
name|'_stub_quota_class_get_default'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# Stub out quota_class_get_default'
nl|'\n'
DECL|function|fake_qcgd
indent|'        '
name|'def'
name|'fake_qcgd'
op|'('
name|'context'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'calls'
op|'.'
name|'append'
op|'('
string|"'quota_class_get_default'"
op|')'
newline|'\n'
name|'return'
name|'dict'
op|'('
nl|'\n'
name|'instances'
op|'='
number|'5'
op|','
nl|'\n'
name|'ram'
op|'='
number|'25'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'metadata_items'
op|'='
number|'64'
op|','
nl|'\n'
name|'injected_file_content_bytes'
op|'='
number|'5'
op|'*'
number|'1024'
op|','
nl|'\n'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'db'
op|','
string|"'quota_class_get_default'"
op|','
name|'fake_qcgd'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_stub_quota_class_get_all_by_name
dedent|''
name|'def'
name|'_stub_quota_class_get_all_by_name'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# Stub out quota_class_get_all_by_name'
nl|'\n'
DECL|function|fake_qcgabn
indent|'        '
name|'def'
name|'fake_qcgabn'
op|'('
name|'context'
op|','
name|'quota_class'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'calls'
op|'.'
name|'append'
op|'('
string|"'quota_class_get_all_by_name'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'quota_class'
op|','
string|"'test_class'"
op|')'
newline|'\n'
name|'return'
name|'dict'
op|'('
nl|'\n'
name|'instances'
op|'='
number|'5'
op|','
nl|'\n'
name|'ram'
op|'='
number|'25'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'metadata_items'
op|'='
number|'64'
op|','
nl|'\n'
name|'injected_file_content_bytes'
op|'='
number|'5'
op|'*'
number|'1024'
op|','
nl|'\n'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'db'
op|','
string|"'quota_class_get_all_by_name'"
op|','
name|'fake_qcgabn'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_class_quotas
dedent|''
name|'def'
name|'test_get_class_quotas'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_quota_class_get_all_by_name'
op|'('
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_class_quotas'
op|'('
name|'None'
op|','
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
string|"'test_class'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
string|"'quota_class_get_all_by_name'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
name|'dict'
op|'('
nl|'\n'
name|'instances'
op|'='
number|'5'
op|','
nl|'\n'
name|'cores'
op|'='
number|'20'
op|','
nl|'\n'
name|'ram'
op|'='
number|'25'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'floating_ips'
op|'='
number|'10'
op|','
nl|'\n'
name|'fixed_ips'
op|'='
number|'10'
op|','
nl|'\n'
name|'metadata_items'
op|'='
number|'64'
op|','
nl|'\n'
name|'injected_files'
op|'='
number|'5'
op|','
nl|'\n'
name|'injected_file_content_bytes'
op|'='
number|'5'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'injected_file_path_bytes'
op|'='
number|'255'
op|','
nl|'\n'
name|'security_groups'
op|'='
number|'10'
op|','
nl|'\n'
name|'security_group_rules'
op|'='
number|'20'
op|','
nl|'\n'
name|'key_pairs'
op|'='
number|'100'
op|','
nl|'\n'
name|'server_groups'
op|'='
number|'10'
op|','
nl|'\n'
name|'server_group_members'
op|'='
number|'10'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_class_quotas_no_defaults
dedent|''
name|'def'
name|'test_get_class_quotas_no_defaults'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_quota_class_get_all_by_name'
op|'('
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_class_quotas'
op|'('
name|'None'
op|','
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
string|"'test_class'"
op|','
name|'False'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
string|"'quota_class_get_all_by_name'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
name|'dict'
op|'('
nl|'\n'
name|'instances'
op|'='
number|'5'
op|','
nl|'\n'
name|'ram'
op|'='
number|'25'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'metadata_items'
op|'='
number|'64'
op|','
nl|'\n'
name|'injected_file_content_bytes'
op|'='
number|'5'
op|'*'
number|'1024'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_stub_get_by_project_and_user
dedent|''
name|'def'
name|'_stub_get_by_project_and_user'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|function|fake_qgabpau
indent|'        '
name|'def'
name|'fake_qgabpau'
op|'('
name|'context'
op|','
name|'project_id'
op|','
name|'user_id'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'calls'
op|'.'
name|'append'
op|'('
string|"'quota_get_all_by_project_and_user'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'project_id'
op|','
string|"'test_project'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'user_id'
op|','
string|"'fake_user'"
op|')'
newline|'\n'
name|'return'
name|'dict'
op|'('
nl|'\n'
name|'cores'
op|'='
number|'10'
op|','
nl|'\n'
name|'injected_files'
op|'='
number|'2'
op|','
nl|'\n'
name|'injected_file_path_bytes'
op|'='
number|'127'
op|','
nl|'\n'
op|')'
newline|'\n'
nl|'\n'
DECL|function|fake_qgabp
dedent|''
name|'def'
name|'fake_qgabp'
op|'('
name|'context'
op|','
name|'project_id'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'calls'
op|'.'
name|'append'
op|'('
string|"'quota_get_all_by_project'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'project_id'
op|','
string|"'test_project'"
op|')'
newline|'\n'
name|'return'
op|'{'
nl|'\n'
string|"'cores'"
op|':'
number|'10'
op|','
nl|'\n'
string|"'injected_files'"
op|':'
number|'2'
op|','
nl|'\n'
string|"'injected_file_path_bytes'"
op|':'
number|'127'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
DECL|function|fake_qugabpau
dedent|''
name|'def'
name|'fake_qugabpau'
op|'('
name|'context'
op|','
name|'project_id'
op|','
name|'user_id'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'calls'
op|'.'
name|'append'
op|'('
string|"'quota_usage_get_all_by_project_and_user'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'project_id'
op|','
string|"'test_project'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'user_id'
op|','
string|"'fake_user'"
op|')'
newline|'\n'
name|'return'
name|'dict'
op|'('
nl|'\n'
name|'instances'
op|'='
name|'dict'
op|'('
name|'in_use'
op|'='
number|'2'
op|','
name|'reserved'
op|'='
number|'2'
op|')'
op|','
nl|'\n'
name|'cores'
op|'='
name|'dict'
op|'('
name|'in_use'
op|'='
number|'4'
op|','
name|'reserved'
op|'='
number|'4'
op|')'
op|','
nl|'\n'
name|'ram'
op|'='
name|'dict'
op|'('
name|'in_use'
op|'='
number|'10'
op|'*'
number|'1024'
op|','
name|'reserved'
op|'='
number|'0'
op|')'
op|','
nl|'\n'
name|'floating_ips'
op|'='
name|'dict'
op|'('
name|'in_use'
op|'='
number|'2'
op|','
name|'reserved'
op|'='
number|'0'
op|')'
op|','
nl|'\n'
name|'metadata_items'
op|'='
name|'dict'
op|'('
name|'in_use'
op|'='
number|'0'
op|','
name|'reserved'
op|'='
number|'0'
op|')'
op|','
nl|'\n'
name|'injected_files'
op|'='
name|'dict'
op|'('
name|'in_use'
op|'='
number|'0'
op|','
name|'reserved'
op|'='
number|'0'
op|')'
op|','
nl|'\n'
name|'injected_file_content_bytes'
op|'='
name|'dict'
op|'('
name|'in_use'
op|'='
number|'0'
op|','
name|'reserved'
op|'='
number|'0'
op|')'
op|','
nl|'\n'
name|'injected_file_path_bytes'
op|'='
name|'dict'
op|'('
name|'in_use'
op|'='
number|'0'
op|','
name|'reserved'
op|'='
number|'0'
op|')'
op|','
nl|'\n'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'db'
op|','
string|"'quota_get_all_by_project_and_user'"
op|','
name|'fake_qgabpau'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'db'
op|','
string|"'quota_get_all_by_project'"
op|','
name|'fake_qgabp'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'db'
op|','
string|"'quota_usage_get_all_by_project_and_user'"
op|','
nl|'\n'
name|'fake_qugabpau'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'_stub_quota_class_get_all_by_name'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_user_quotas
dedent|''
name|'def'
name|'test_get_user_quotas'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'maxDiff'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'_stub_get_by_project_and_user'
op|'('
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_user_quotas'
op|'('
nl|'\n'
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
string|"'test_project'"
op|','
string|"'fake_user'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
string|"'quota_get_all_by_project_and_user'"
op|','
nl|'\n'
string|"'quota_get_all_by_project'"
op|','
nl|'\n'
string|"'quota_usage_get_all_by_project_and_user'"
op|','
nl|'\n'
string|"'quota_class_get_all_by_name'"
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
name|'dict'
op|'('
nl|'\n'
name|'instances'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'5'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'2'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'2'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'cores'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'4'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'4'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'ram'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'25'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'10'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'floating_ips'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'2'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'fixed_ips'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'metadata_items'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'64'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_files'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'2'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_file_content_bytes'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'5'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_file_path_bytes'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'127'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'security_groups'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'security_group_rules'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'20'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'key_pairs'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'100'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'server_groups'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'server_group_members'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_stub_get_by_project_and_user_specific
dedent|''
name|'def'
name|'_stub_get_by_project_and_user_specific'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|function|fake_quota_get
indent|'        '
name|'def'
name|'fake_quota_get'
op|'('
name|'context'
op|','
name|'project_id'
op|','
name|'resource'
op|','
name|'user_id'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'calls'
op|'.'
name|'append'
op|'('
string|"'quota_get'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'project_id'
op|','
string|"'test_project'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'user_id'
op|','
string|"'fake_user'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'resource'
op|','
string|"'test_resource'"
op|')'
newline|'\n'
name|'return'
name|'dict'
op|'('
nl|'\n'
name|'test_resource'
op|'='
name|'dict'
op|'('
name|'in_use'
op|'='
number|'20'
op|','
name|'reserved'
op|'='
number|'10'
op|')'
op|','
nl|'\n'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'db'
op|','
string|"'quota_get'"
op|','
name|'fake_quota_get'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_by_project_and_user
dedent|''
name|'def'
name|'test_get_by_project_and_user'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_by_project_and_user_specific'
op|'('
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_by_project_and_user'
op|'('
nl|'\n'
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
string|"'test_project'"
op|','
string|"'fake_user'"
op|','
string|"'test_resource'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
string|"'quota_get'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
name|'dict'
op|'('
nl|'\n'
name|'test_resource'
op|'='
name|'dict'
op|'('
name|'in_use'
op|'='
number|'20'
op|','
name|'reserved'
op|'='
number|'10'
op|')'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_stub_get_by_project
dedent|''
name|'def'
name|'_stub_get_by_project'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|function|fake_qgabp
indent|'        '
name|'def'
name|'fake_qgabp'
op|'('
name|'context'
op|','
name|'project_id'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'calls'
op|'.'
name|'append'
op|'('
string|"'quota_get_all_by_project'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'project_id'
op|','
string|"'test_project'"
op|')'
newline|'\n'
name|'return'
name|'dict'
op|'('
nl|'\n'
name|'cores'
op|'='
number|'10'
op|','
nl|'\n'
name|'injected_files'
op|'='
number|'2'
op|','
nl|'\n'
name|'injected_file_path_bytes'
op|'='
number|'127'
op|','
nl|'\n'
op|')'
newline|'\n'
nl|'\n'
DECL|function|fake_qugabp
dedent|''
name|'def'
name|'fake_qugabp'
op|'('
name|'context'
op|','
name|'project_id'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'calls'
op|'.'
name|'append'
op|'('
string|"'quota_usage_get_all_by_project'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'project_id'
op|','
string|"'test_project'"
op|')'
newline|'\n'
name|'return'
name|'dict'
op|'('
nl|'\n'
name|'instances'
op|'='
name|'dict'
op|'('
name|'in_use'
op|'='
number|'2'
op|','
name|'reserved'
op|'='
number|'2'
op|')'
op|','
nl|'\n'
name|'cores'
op|'='
name|'dict'
op|'('
name|'in_use'
op|'='
number|'4'
op|','
name|'reserved'
op|'='
number|'4'
op|')'
op|','
nl|'\n'
name|'ram'
op|'='
name|'dict'
op|'('
name|'in_use'
op|'='
number|'10'
op|'*'
number|'1024'
op|','
name|'reserved'
op|'='
number|'0'
op|')'
op|','
nl|'\n'
name|'floating_ips'
op|'='
name|'dict'
op|'('
name|'in_use'
op|'='
number|'2'
op|','
name|'reserved'
op|'='
number|'0'
op|')'
op|','
nl|'\n'
name|'metadata_items'
op|'='
name|'dict'
op|'('
name|'in_use'
op|'='
number|'0'
op|','
name|'reserved'
op|'='
number|'0'
op|')'
op|','
nl|'\n'
name|'injected_files'
op|'='
name|'dict'
op|'('
name|'in_use'
op|'='
number|'0'
op|','
name|'reserved'
op|'='
number|'0'
op|')'
op|','
nl|'\n'
name|'injected_file_content_bytes'
op|'='
name|'dict'
op|'('
name|'in_use'
op|'='
number|'0'
op|','
name|'reserved'
op|'='
number|'0'
op|')'
op|','
nl|'\n'
name|'injected_file_path_bytes'
op|'='
name|'dict'
op|'('
name|'in_use'
op|'='
number|'0'
op|','
name|'reserved'
op|'='
number|'0'
op|')'
op|','
nl|'\n'
op|')'
newline|'\n'
nl|'\n'
DECL|function|fake_quota_get_all
dedent|''
name|'def'
name|'fake_quota_get_all'
op|'('
name|'context'
op|','
name|'project_id'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'calls'
op|'.'
name|'append'
op|'('
string|"'quota_get_all'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'project_id'
op|','
string|"'test_project'"
op|')'
newline|'\n'
name|'return'
op|'['
name|'sqa_models'
op|'.'
name|'ProjectUserQuota'
op|'('
name|'resource'
op|'='
string|"'instances'"
op|','
nl|'\n'
name|'hard_limit'
op|'='
number|'5'
op|')'
op|','
nl|'\n'
name|'sqa_models'
op|'.'
name|'ProjectUserQuota'
op|'('
name|'resource'
op|'='
string|"'cores'"
op|','
nl|'\n'
name|'hard_limit'
op|'='
number|'2'
op|')'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'db'
op|','
string|"'quota_get_all_by_project'"
op|','
name|'fake_qgabp'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'db'
op|','
string|"'quota_usage_get_all_by_project'"
op|','
name|'fake_qugabp'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'db'
op|','
string|"'quota_get_all'"
op|','
name|'fake_quota_get_all'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'_stub_quota_class_get_all_by_name'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_stub_quota_class_get_default'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_project_quotas
dedent|''
name|'def'
name|'test_get_project_quotas'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'maxDiff'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'_stub_get_by_project'
op|'('
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_project_quotas'
op|'('
nl|'\n'
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
string|"'test_project'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
string|"'quota_get_all_by_project'"
op|','
nl|'\n'
string|"'quota_usage_get_all_by_project'"
op|','
nl|'\n'
string|"'quota_class_get_all_by_name'"
op|','
nl|'\n'
string|"'quota_class_get_default'"
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
name|'dict'
op|'('
nl|'\n'
name|'instances'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'5'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'2'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'2'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'cores'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'4'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'4'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'ram'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'25'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'10'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'floating_ips'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'2'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'fixed_ips'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'metadata_items'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'64'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_files'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'2'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_file_content_bytes'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'5'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_file_path_bytes'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'127'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'security_groups'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'security_group_rules'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'20'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'key_pairs'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'100'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'server_groups'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'server_group_members'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_project_quotas_with_remains
dedent|''
name|'def'
name|'test_get_project_quotas_with_remains'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'maxDiff'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'_stub_get_by_project'
op|'('
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_project_quotas'
op|'('
nl|'\n'
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
string|"'test_project'"
op|','
name|'remains'
op|'='
name|'True'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
string|"'quota_get_all_by_project'"
op|','
nl|'\n'
string|"'quota_usage_get_all_by_project'"
op|','
nl|'\n'
string|"'quota_class_get_all_by_name'"
op|','
nl|'\n'
string|"'quota_class_get_default'"
op|','
nl|'\n'
string|"'quota_get_all'"
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
name|'dict'
op|'('
nl|'\n'
name|'instances'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'5'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'2'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'2'
op|','
nl|'\n'
name|'remains'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'cores'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'4'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'4'
op|','
nl|'\n'
name|'remains'
op|'='
number|'8'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'ram'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'25'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'10'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
name|'remains'
op|'='
number|'25'
op|'*'
number|'1024'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'floating_ips'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'2'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
name|'remains'
op|'='
number|'10'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'fixed_ips'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
name|'remains'
op|'='
number|'10'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'metadata_items'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'64'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
name|'remains'
op|'='
number|'64'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_files'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'2'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
name|'remains'
op|'='
number|'2'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_file_content_bytes'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'5'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
name|'remains'
op|'='
number|'5'
op|'*'
number|'1024'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_file_path_bytes'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'127'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
name|'remains'
op|'='
number|'127'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'security_groups'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
name|'remains'
op|'='
number|'10'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'security_group_rules'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'20'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
name|'remains'
op|'='
number|'20'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'key_pairs'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'100'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
name|'remains'
op|'='
number|'100'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'server_groups'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
name|'remains'
op|'='
number|'10'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'server_group_members'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
name|'remains'
op|'='
number|'10'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_user_quotas_alt_context_no_class
dedent|''
name|'def'
name|'test_get_user_quotas_alt_context_no_class'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'maxDiff'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'_stub_get_by_project_and_user'
op|'('
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_user_quotas'
op|'('
nl|'\n'
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
name|'None'
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
string|"'test_project'"
op|','
string|"'fake_user'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
string|"'quota_get_all_by_project_and_user'"
op|','
nl|'\n'
string|"'quota_get_all_by_project'"
op|','
nl|'\n'
string|"'quota_usage_get_all_by_project_and_user'"
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
name|'dict'
op|'('
nl|'\n'
name|'instances'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'2'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'2'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'cores'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'4'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'4'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'ram'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'50'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'10'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'floating_ips'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'2'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'fixed_ips'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'metadata_items'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'128'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_files'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'2'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_file_content_bytes'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_file_path_bytes'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'127'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'security_groups'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'security_group_rules'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'20'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'key_pairs'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'100'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'server_groups'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'server_group_members'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_project_quotas_alt_context_no_class
dedent|''
name|'def'
name|'test_get_project_quotas_alt_context_no_class'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'maxDiff'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'_stub_get_by_project'
op|'('
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_project_quotas'
op|'('
nl|'\n'
name|'FakeContext'
op|'('
string|"'other_project'"
op|','
string|"'other_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
string|"'test_project'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
string|"'quota_get_all_by_project'"
op|','
nl|'\n'
string|"'quota_usage_get_all_by_project'"
op|','
nl|'\n'
string|"'quota_class_get_default'"
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
name|'dict'
op|'('
nl|'\n'
name|'instances'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'5'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'2'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'2'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'cores'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'4'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'4'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'ram'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'25'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'10'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'floating_ips'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'2'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'fixed_ips'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'metadata_items'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'64'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_files'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'2'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_file_content_bytes'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'5'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_file_path_bytes'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'127'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'security_groups'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'security_group_rules'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'20'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'key_pairs'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'100'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'server_groups'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'server_group_members'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_user_quotas_alt_context_with_class
dedent|''
name|'def'
name|'test_get_user_quotas_alt_context_with_class'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'maxDiff'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'_stub_get_by_project_and_user'
op|'('
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_user_quotas'
op|'('
nl|'\n'
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
string|"'test_project'"
op|','
string|"'fake_user'"
op|','
nl|'\n'
name|'quota_class'
op|'='
string|"'test_class'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
string|"'quota_get_all_by_project_and_user'"
op|','
nl|'\n'
string|"'quota_get_all_by_project'"
op|','
nl|'\n'
string|"'quota_usage_get_all_by_project_and_user'"
op|','
nl|'\n'
string|"'quota_class_get_all_by_name'"
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
name|'dict'
op|'('
nl|'\n'
name|'instances'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'5'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'2'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'2'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'cores'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'4'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'4'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'ram'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'25'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'10'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'floating_ips'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'2'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'fixed_ips'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'metadata_items'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'64'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_files'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'2'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_file_content_bytes'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'5'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_file_path_bytes'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'127'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'security_groups'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'security_group_rules'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'20'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'key_pairs'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'100'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'server_groups'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'server_group_members'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_project_quotas_alt_context_with_class
dedent|''
name|'def'
name|'test_get_project_quotas_alt_context_with_class'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'maxDiff'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'_stub_get_by_project'
op|'('
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_project_quotas'
op|'('
nl|'\n'
name|'FakeContext'
op|'('
string|"'other_project'"
op|','
string|"'other_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
string|"'test_project'"
op|','
name|'quota_class'
op|'='
string|"'test_class'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
string|"'quota_get_all_by_project'"
op|','
nl|'\n'
string|"'quota_usage_get_all_by_project'"
op|','
nl|'\n'
string|"'quota_class_get_all_by_name'"
op|','
nl|'\n'
string|"'quota_class_get_default'"
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
name|'dict'
op|'('
nl|'\n'
name|'instances'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'5'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'2'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'2'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'cores'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'4'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'4'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'ram'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'25'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'10'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'floating_ips'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'2'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'fixed_ips'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'metadata_items'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'64'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_files'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'2'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_file_content_bytes'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'5'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_file_path_bytes'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'127'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'security_groups'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'security_group_rules'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'20'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'key_pairs'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'100'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'server_groups'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'server_group_members'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_user_quotas_no_defaults
dedent|''
name|'def'
name|'test_get_user_quotas_no_defaults'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_by_project_and_user'
op|'('
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_user_quotas'
op|'('
nl|'\n'
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
string|"'test_project'"
op|','
string|"'fake_user'"
op|','
nl|'\n'
name|'defaults'
op|'='
name|'False'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
string|"'quota_get_all_by_project_and_user'"
op|','
nl|'\n'
string|"'quota_get_all_by_project'"
op|','
nl|'\n'
string|"'quota_usage_get_all_by_project_and_user'"
op|','
nl|'\n'
string|"'quota_class_get_all_by_name'"
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
name|'dict'
op|'('
nl|'\n'
name|'cores'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'4'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'4'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_files'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'2'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_file_path_bytes'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'127'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_project_quotas_no_defaults
dedent|''
name|'def'
name|'test_get_project_quotas_no_defaults'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_by_project'
op|'('
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_project_quotas'
op|'('
nl|'\n'
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
string|"'test_project'"
op|','
name|'defaults'
op|'='
name|'False'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
string|"'quota_get_all_by_project'"
op|','
nl|'\n'
string|"'quota_usage_get_all_by_project'"
op|','
nl|'\n'
string|"'quota_class_get_all_by_name'"
op|','
nl|'\n'
string|"'quota_class_get_default'"
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
name|'dict'
op|'('
nl|'\n'
name|'cores'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'4'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'4'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_files'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'2'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_file_path_bytes'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'127'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'0'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_user_quotas_no_usages
dedent|''
name|'def'
name|'test_get_user_quotas_no_usages'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_by_project_and_user'
op|'('
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_user_quotas'
op|'('
nl|'\n'
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
string|"'test_project'"
op|','
string|"'fake_user'"
op|','
name|'usages'
op|'='
name|'False'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
string|"'quota_get_all_by_project_and_user'"
op|','
nl|'\n'
string|"'quota_get_all_by_project'"
op|','
nl|'\n'
string|"'quota_class_get_all_by_name'"
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
name|'dict'
op|'('
nl|'\n'
name|'instances'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'5'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'cores'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'ram'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'25'
op|'*'
number|'1024'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'floating_ips'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'fixed_ips'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'metadata_items'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'64'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_files'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'2'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_file_content_bytes'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'5'
op|'*'
number|'1024'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_file_path_bytes'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'127'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'security_groups'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'security_group_rules'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'20'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'key_pairs'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'100'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'server_groups'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'server_group_members'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_project_quotas_no_usages
dedent|''
name|'def'
name|'test_get_project_quotas_no_usages'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_by_project'
op|'('
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_project_quotas'
op|'('
nl|'\n'
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
string|"'test_project'"
op|','
name|'usages'
op|'='
name|'False'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
string|"'quota_get_all_by_project'"
op|','
nl|'\n'
string|"'quota_class_get_all_by_name'"
op|','
nl|'\n'
string|"'quota_class_get_default'"
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
name|'dict'
op|'('
nl|'\n'
name|'instances'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'5'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'cores'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'ram'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'25'
op|'*'
number|'1024'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'floating_ips'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'fixed_ips'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'metadata_items'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'64'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_files'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'2'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_file_content_bytes'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'5'
op|'*'
number|'1024'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'injected_file_path_bytes'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'127'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'security_groups'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'security_group_rules'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'20'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'key_pairs'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'100'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'server_groups'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
name|'server_group_members'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'limit'
op|'='
number|'10'
op|','
nl|'\n'
op|')'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_stub_get_settable_quotas
dedent|''
name|'def'
name|'_stub_get_settable_quotas'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|function|fake_quota_get_all_by_project
indent|'        '
name|'def'
name|'fake_quota_get_all_by_project'
op|'('
name|'context'
op|','
name|'project_id'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'calls'
op|'.'
name|'append'
op|'('
string|"'quota_get_all_by_project'"
op|')'
newline|'\n'
name|'return'
op|'{'
string|"'floating_ips'"
op|':'
number|'20'
op|'}'
newline|'\n'
nl|'\n'
DECL|function|fake_get_project_quotas
dedent|''
name|'def'
name|'fake_get_project_quotas'
op|'('
name|'context'
op|','
name|'resources'
op|','
name|'project_id'
op|','
nl|'\n'
name|'quota_class'
op|'='
name|'None'
op|','
name|'defaults'
op|'='
name|'True'
op|','
nl|'\n'
name|'usages'
op|'='
name|'True'
op|','
name|'remains'
op|'='
name|'False'
op|','
nl|'\n'
name|'project_quotas'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'calls'
op|'.'
name|'append'
op|'('
string|"'get_project_quotas'"
op|')'
newline|'\n'
name|'result'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'for'
name|'k'
op|','
name|'v'
name|'in'
name|'resources'
op|'.'
name|'items'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'limit'
op|'='
name|'v'
op|'.'
name|'default'
newline|'\n'
name|'reserved'
op|'='
number|'0'
newline|'\n'
name|'if'
name|'k'
op|'=='
string|"'instances'"
op|':'
newline|'\n'
indent|'                    '
name|'remains'
op|'='
name|'v'
op|'.'
name|'default'
op|'-'
number|'5'
newline|'\n'
name|'in_use'
op|'='
number|'1'
newline|'\n'
dedent|''
name|'elif'
name|'k'
op|'=='
string|"'cores'"
op|':'
newline|'\n'
indent|'                    '
name|'remains'
op|'='
op|'-'
number|'1'
newline|'\n'
name|'in_use'
op|'='
number|'5'
newline|'\n'
name|'limit'
op|'='
op|'-'
number|'1'
newline|'\n'
dedent|''
name|'elif'
name|'k'
op|'=='
string|"'floating_ips'"
op|':'
newline|'\n'
indent|'                    '
name|'remains'
op|'='
number|'20'
newline|'\n'
name|'in_use'
op|'='
number|'0'
newline|'\n'
name|'limit'
op|'='
number|'20'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                    '
name|'remains'
op|'='
name|'v'
op|'.'
name|'default'
newline|'\n'
name|'in_use'
op|'='
number|'0'
newline|'\n'
dedent|''
name|'result'
op|'['
name|'k'
op|']'
op|'='
op|'{'
string|"'limit'"
op|':'
name|'limit'
op|','
string|"'in_use'"
op|':'
name|'in_use'
op|','
nl|'\n'
string|"'reserved'"
op|':'
name|'reserved'
op|','
string|"'remains'"
op|':'
name|'remains'
op|'}'
newline|'\n'
dedent|''
name|'return'
name|'result'
newline|'\n'
nl|'\n'
DECL|function|fake_process_quotas_in_get_user_quotas
dedent|''
name|'def'
name|'fake_process_quotas_in_get_user_quotas'
op|'('
name|'context'
op|','
name|'resources'
op|','
nl|'\n'
name|'project_id'
op|','
name|'quotas'
op|','
nl|'\n'
name|'quota_class'
op|'='
name|'None'
op|','
nl|'\n'
name|'defaults'
op|'='
name|'True'
op|','
name|'usages'
op|'='
name|'None'
op|','
nl|'\n'
name|'remains'
op|'='
name|'False'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'calls'
op|'.'
name|'append'
op|'('
string|"'_process_quotas'"
op|')'
newline|'\n'
name|'result'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'for'
name|'k'
op|','
name|'v'
name|'in'
name|'resources'
op|'.'
name|'items'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'reserved'
op|'='
number|'0'
newline|'\n'
name|'if'
name|'k'
op|'=='
string|"'instances'"
op|':'
newline|'\n'
indent|'                    '
name|'in_use'
op|'='
number|'1'
newline|'\n'
dedent|''
name|'elif'
name|'k'
op|'=='
string|"'cores'"
op|':'
newline|'\n'
indent|'                    '
name|'in_use'
op|'='
number|'5'
newline|'\n'
name|'reserved'
op|'='
number|'10'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                    '
name|'in_use'
op|'='
number|'0'
newline|'\n'
dedent|''
name|'result'
op|'['
name|'k'
op|']'
op|'='
op|'{'
string|"'limit'"
op|':'
name|'v'
op|'.'
name|'default'
op|','
nl|'\n'
string|"'in_use'"
op|':'
name|'in_use'
op|','
string|"'reserved'"
op|':'
name|'reserved'
op|'}'
newline|'\n'
dedent|''
name|'return'
name|'result'
newline|'\n'
nl|'\n'
DECL|function|fake_qgabpau
dedent|''
name|'def'
name|'fake_qgabpau'
op|'('
name|'context'
op|','
name|'project_id'
op|','
name|'user_id'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'calls'
op|'.'
name|'append'
op|'('
string|"'quota_get_all_by_project_and_user'"
op|')'
newline|'\n'
name|'return'
op|'{'
string|"'instances'"
op|':'
number|'2'
op|','
string|"'cores'"
op|':'
op|'-'
number|'1'
op|'}'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'db'
op|','
string|"'quota_get_all_by_project'"
op|','
nl|'\n'
name|'fake_quota_get_all_by_project'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'self'
op|'.'
name|'driver'
op|','
string|"'get_project_quotas'"
op|','
nl|'\n'
name|'fake_get_project_quotas'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'self'
op|'.'
name|'driver'
op|','
string|"'_process_quotas'"
op|','
nl|'\n'
name|'fake_process_quotas_in_get_user_quotas'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'db'
op|','
string|"'quota_get_all_by_project_and_user'"
op|','
nl|'\n'
name|'fake_qgabpau'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_settable_quotas_with_user
dedent|''
name|'def'
name|'test_get_settable_quotas_with_user'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_settable_quotas'
op|'('
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_settable_quotas'
op|'('
nl|'\n'
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
string|"'test_project'"
op|','
name|'user_id'
op|'='
string|"'test_user'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
string|"'quota_get_all_by_project'"
op|','
nl|'\n'
string|"'get_project_quotas'"
op|','
nl|'\n'
string|"'quota_get_all_by_project_and_user'"
op|','
nl|'\n'
string|"'_process_quotas'"
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
op|'{'
nl|'\n'
string|"'instances'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'1'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'7'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'cores'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'15'
op|','
nl|'\n'
string|"'maximum'"
op|':'
op|'-'
number|'1'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'ram'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'50'
op|'*'
number|'1024'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'floating_ips'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'20'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'fixed_ips'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'10'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'metadata_items'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'128'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'injected_files'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'5'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'injected_file_content_bytes'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'10'
op|'*'
number|'1024'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'injected_file_path_bytes'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'255'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'security_groups'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'10'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'security_group_rules'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'20'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'key_pairs'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'100'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'server_groups'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'10'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'server_group_members'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'10'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_settable_quotas_without_user
dedent|''
name|'def'
name|'test_get_settable_quotas_without_user'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_settable_quotas'
op|'('
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_settable_quotas'
op|'('
nl|'\n'
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
string|"'test_project'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
string|"'quota_get_all_by_project'"
op|','
nl|'\n'
string|"'get_project_quotas'"
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
op|'{'
nl|'\n'
string|"'instances'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'5'
op|','
nl|'\n'
string|"'maximum'"
op|':'
op|'-'
number|'1'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'cores'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'5'
op|','
nl|'\n'
string|"'maximum'"
op|':'
op|'-'
number|'1'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'ram'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
op|'-'
number|'1'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'floating_ips'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
op|'-'
number|'1'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'fixed_ips'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
op|'-'
number|'1'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'metadata_items'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
op|'-'
number|'1'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'injected_files'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
op|'-'
number|'1'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'injected_file_content_bytes'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
op|'-'
number|'1'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'injected_file_path_bytes'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
op|'-'
number|'1'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'security_groups'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
op|'-'
number|'1'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'security_group_rules'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
op|'-'
number|'1'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'key_pairs'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
op|'-'
number|'1'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'server_groups'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
op|'-'
number|'1'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'server_group_members'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
op|'-'
number|'1'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_settable_quotas_by_user_with_unlimited_value
dedent|''
name|'def'
name|'test_get_settable_quotas_by_user_with_unlimited_value'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_settable_quotas'
op|'('
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_settable_quotas'
op|'('
nl|'\n'
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
string|"'test_project'"
op|','
name|'user_id'
op|'='
string|"'test_user'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
string|"'quota_get_all_by_project'"
op|','
nl|'\n'
string|"'get_project_quotas'"
op|','
nl|'\n'
string|"'quota_get_all_by_project_and_user'"
op|','
nl|'\n'
string|"'_process_quotas'"
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
op|'{'
nl|'\n'
string|"'instances'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'1'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'7'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'cores'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'15'
op|','
nl|'\n'
string|"'maximum'"
op|':'
op|'-'
number|'1'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'ram'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'50'
op|'*'
number|'1024'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'floating_ips'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'20'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'fixed_ips'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'10'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'metadata_items'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'128'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'injected_files'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'5'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'injected_file_content_bytes'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'10'
op|'*'
number|'1024'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'injected_file_path_bytes'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'255'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'security_groups'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'10'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'security_group_rules'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'20'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'key_pairs'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'100'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'server_groups'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'10'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'server_group_members'"
op|':'
op|'{'
nl|'\n'
string|"'minimum'"
op|':'
number|'0'
op|','
nl|'\n'
string|"'maximum'"
op|':'
number|'10'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_stub_get_project_quotas
dedent|''
name|'def'
name|'_stub_get_project_quotas'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|function|fake_get_project_quotas
indent|'        '
name|'def'
name|'fake_get_project_quotas'
op|'('
name|'context'
op|','
name|'resources'
op|','
name|'project_id'
op|','
nl|'\n'
name|'quota_class'
op|'='
name|'None'
op|','
name|'defaults'
op|'='
name|'True'
op|','
nl|'\n'
name|'usages'
op|'='
name|'True'
op|','
name|'remains'
op|'='
name|'False'
op|','
nl|'\n'
name|'project_quotas'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'calls'
op|'.'
name|'append'
op|'('
string|"'get_project_quotas'"
op|')'
newline|'\n'
name|'return'
name|'dict'
op|'('
op|'('
name|'k'
op|','
name|'dict'
op|'('
name|'limit'
op|'='
name|'v'
op|'.'
name|'default'
op|')'
op|')'
nl|'\n'
name|'for'
name|'k'
op|','
name|'v'
name|'in'
name|'resources'
op|'.'
name|'items'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'self'
op|'.'
name|'driver'
op|','
string|"'get_project_quotas'"
op|','
nl|'\n'
name|'fake_get_project_quotas'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_quotas_has_sync_unknown
dedent|''
name|'def'
name|'test_get_quotas_has_sync_unknown'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_project_quotas'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'QuotaResourceUnknown'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_get_quotas'
op|','
nl|'\n'
name|'None'
op|','
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
op|'['
string|"'unknown'"
op|']'
op|','
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_quotas_no_sync_unknown
dedent|''
name|'def'
name|'test_get_quotas_no_sync_unknown'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_project_quotas'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'QuotaResourceUnknown'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_get_quotas'
op|','
nl|'\n'
name|'None'
op|','
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
op|'['
string|"'unknown'"
op|']'
op|','
name|'False'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_quotas_has_sync_no_sync_resource
dedent|''
name|'def'
name|'test_get_quotas_has_sync_no_sync_resource'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_project_quotas'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'QuotaResourceUnknown'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_get_quotas'
op|','
nl|'\n'
name|'None'
op|','
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
op|'['
string|"'metadata_items'"
op|']'
op|','
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_quotas_no_sync_has_sync_resource
dedent|''
name|'def'
name|'test_get_quotas_no_sync_has_sync_resource'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_project_quotas'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'QuotaResourceUnknown'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_get_quotas'
op|','
nl|'\n'
name|'None'
op|','
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
op|'['
string|"'instances'"
op|']'
op|','
name|'False'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_quotas_has_sync
dedent|''
name|'def'
name|'test_get_quotas_has_sync'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_project_quotas'
op|'('
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_get_quotas'
op|'('
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
nl|'\n'
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
op|'['
string|"'instances'"
op|','
string|"'cores'"
op|','
string|"'ram'"
op|','
nl|'\n'
string|"'floating_ips'"
op|','
string|"'security_groups'"
op|','
nl|'\n'
string|"'server_groups'"
op|']'
op|','
nl|'\n'
name|'True'
op|','
nl|'\n'
name|'project_id'
op|'='
string|"'test_project'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
string|"'get_project_quotas'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
name|'dict'
op|'('
nl|'\n'
name|'instances'
op|'='
number|'10'
op|','
nl|'\n'
name|'cores'
op|'='
number|'20'
op|','
nl|'\n'
name|'ram'
op|'='
number|'50'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'floating_ips'
op|'='
number|'10'
op|','
nl|'\n'
name|'security_groups'
op|'='
number|'10'
op|','
nl|'\n'
name|'server_groups'
op|'='
number|'10'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_quotas_no_sync
dedent|''
name|'def'
name|'test_get_quotas_no_sync'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_project_quotas'
op|'('
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'_get_quotas'
op|'('
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
nl|'\n'
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
op|'['
string|"'metadata_items'"
op|','
string|"'injected_files'"
op|','
nl|'\n'
string|"'injected_file_content_bytes'"
op|','
nl|'\n'
string|"'injected_file_path_bytes'"
op|','
nl|'\n'
string|"'security_group_rules'"
op|','
nl|'\n'
string|"'server_group_members'"
op|']'
op|','
name|'False'
op|','
nl|'\n'
name|'project_id'
op|'='
string|"'test_project'"
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
string|"'get_project_quotas'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
name|'dict'
op|'('
nl|'\n'
name|'metadata_items'
op|'='
number|'128'
op|','
nl|'\n'
name|'injected_files'
op|'='
number|'5'
op|','
nl|'\n'
name|'injected_file_content_bytes'
op|'='
number|'10'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'injected_file_path_bytes'
op|'='
number|'255'
op|','
nl|'\n'
name|'security_group_rules'
op|'='
number|'20'
op|','
nl|'\n'
name|'server_group_members'
op|'='
number|'10'
op|','
nl|'\n'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_limit_check_under
dedent|''
name|'def'
name|'test_limit_check_under'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_project_quotas'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'InvalidQuotaValue'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'limit_check'
op|','
nl|'\n'
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
name|'dict'
op|'('
name|'metadata_items'
op|'='
op|'-'
number|'1'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_limit_check_over
dedent|''
name|'def'
name|'test_limit_check_over'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_project_quotas'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'OverQuota'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'limit_check'
op|','
nl|'\n'
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
name|'dict'
op|'('
name|'metadata_items'
op|'='
number|'129'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_limit_check_project_overs
dedent|''
name|'def'
name|'test_limit_check_project_overs'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_project_quotas'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'OverQuota'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'limit_check'
op|','
nl|'\n'
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
name|'dict'
op|'('
name|'injected_file_content_bytes'
op|'='
number|'10241'
op|','
nl|'\n'
name|'injected_file_path_bytes'
op|'='
number|'256'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_limit_check_unlimited
dedent|''
name|'def'
name|'test_limit_check_unlimited'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'flags'
op|'('
name|'quota_metadata_items'
op|'='
op|'-'
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_stub_get_project_quotas'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'limit_check'
op|'('
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
name|'dict'
op|'('
name|'metadata_items'
op|'='
number|'32767'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_limit_check
dedent|''
name|'def'
name|'test_limit_check'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_project_quotas'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'limit_check'
op|'('
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
name|'dict'
op|'('
name|'metadata_items'
op|'='
number|'128'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_stub_quota_reserve
dedent|''
name|'def'
name|'_stub_quota_reserve'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|function|fake_quota_reserve
indent|'        '
name|'def'
name|'fake_quota_reserve'
op|'('
name|'context'
op|','
name|'resources'
op|','
name|'quotas'
op|','
name|'user_quotas'
op|','
name|'deltas'
op|','
nl|'\n'
name|'expire'
op|','
name|'until_refresh'
op|','
name|'max_age'
op|','
name|'project_id'
op|'='
name|'None'
op|','
nl|'\n'
name|'user_id'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'calls'
op|'.'
name|'append'
op|'('
op|'('
string|"'quota_reserve'"
op|','
name|'expire'
op|','
name|'until_refresh'
op|','
nl|'\n'
name|'max_age'
op|')'
op|')'
newline|'\n'
name|'return'
op|'['
string|"'resv-1'"
op|','
string|"'resv-2'"
op|','
string|"'resv-3'"
op|']'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'db'
op|','
string|"'quota_reserve'"
op|','
name|'fake_quota_reserve'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_reserve_bad_expire
dedent|''
name|'def'
name|'test_reserve_bad_expire'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_project_quotas'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_stub_quota_reserve'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'exception'
op|'.'
name|'InvalidReservationExpiration'
op|','
nl|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'reserve'
op|','
nl|'\n'
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
name|'dict'
op|'('
name|'instances'
op|'='
number|'2'
op|')'
op|','
name|'expire'
op|'='
string|"'invalid'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_reserve_default_expire
dedent|''
name|'def'
name|'test_reserve_default_expire'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_project_quotas'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_stub_quota_reserve'
op|'('
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'reserve'
op|'('
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
name|'dict'
op|'('
name|'instances'
op|'='
number|'2'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'expire'
op|'='
name|'timeutils'
op|'.'
name|'utcnow'
op|'('
op|')'
op|'+'
name|'datetime'
op|'.'
name|'timedelta'
op|'('
name|'seconds'
op|'='
number|'86400'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
string|"'get_project_quotas'"
op|','
nl|'\n'
op|'('
string|"'quota_reserve'"
op|','
name|'expire'
op|','
number|'0'
op|','
number|'0'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
op|'['
string|"'resv-1'"
op|','
string|"'resv-2'"
op|','
string|"'resv-3'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_reserve_int_expire
dedent|''
name|'def'
name|'test_reserve_int_expire'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_project_quotas'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_stub_quota_reserve'
op|'('
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'reserve'
op|'('
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
name|'dict'
op|'('
name|'instances'
op|'='
number|'2'
op|')'
op|','
name|'expire'
op|'='
number|'3600'
op|')'
newline|'\n'
nl|'\n'
name|'expire'
op|'='
name|'timeutils'
op|'.'
name|'utcnow'
op|'('
op|')'
op|'+'
name|'datetime'
op|'.'
name|'timedelta'
op|'('
name|'seconds'
op|'='
number|'3600'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
string|"'get_project_quotas'"
op|','
nl|'\n'
op|'('
string|"'quota_reserve'"
op|','
name|'expire'
op|','
number|'0'
op|','
number|'0'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
op|'['
string|"'resv-1'"
op|','
string|"'resv-2'"
op|','
string|"'resv-3'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_reserve_timedelta_expire
dedent|''
name|'def'
name|'test_reserve_timedelta_expire'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_project_quotas'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_stub_quota_reserve'
op|'('
op|')'
newline|'\n'
name|'expire_delta'
op|'='
name|'datetime'
op|'.'
name|'timedelta'
op|'('
name|'seconds'
op|'='
number|'60'
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'reserve'
op|'('
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
name|'dict'
op|'('
name|'instances'
op|'='
number|'2'
op|')'
op|','
name|'expire'
op|'='
name|'expire_delta'
op|')'
newline|'\n'
nl|'\n'
name|'expire'
op|'='
name|'timeutils'
op|'.'
name|'utcnow'
op|'('
op|')'
op|'+'
name|'expire_delta'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
string|"'get_project_quotas'"
op|','
nl|'\n'
op|'('
string|"'quota_reserve'"
op|','
name|'expire'
op|','
number|'0'
op|','
number|'0'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
op|'['
string|"'resv-1'"
op|','
string|"'resv-2'"
op|','
string|"'resv-3'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_reserve_datetime_expire
dedent|''
name|'def'
name|'test_reserve_datetime_expire'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_project_quotas'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_stub_quota_reserve'
op|'('
op|')'
newline|'\n'
name|'expire'
op|'='
name|'timeutils'
op|'.'
name|'utcnow'
op|'('
op|')'
op|'+'
name|'datetime'
op|'.'
name|'timedelta'
op|'('
name|'seconds'
op|'='
number|'120'
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'reserve'
op|'('
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
name|'dict'
op|'('
name|'instances'
op|'='
number|'2'
op|')'
op|','
name|'expire'
op|'='
name|'expire'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
string|"'get_project_quotas'"
op|','
nl|'\n'
op|'('
string|"'quota_reserve'"
op|','
name|'expire'
op|','
number|'0'
op|','
number|'0'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
op|'['
string|"'resv-1'"
op|','
string|"'resv-2'"
op|','
string|"'resv-3'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_reserve_until_refresh
dedent|''
name|'def'
name|'test_reserve_until_refresh'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_project_quotas'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_stub_quota_reserve'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'flags'
op|'('
name|'until_refresh'
op|'='
number|'500'
op|')'
newline|'\n'
name|'expire'
op|'='
name|'timeutils'
op|'.'
name|'utcnow'
op|'('
op|')'
op|'+'
name|'datetime'
op|'.'
name|'timedelta'
op|'('
name|'seconds'
op|'='
number|'120'
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'reserve'
op|'('
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
name|'dict'
op|'('
name|'instances'
op|'='
number|'2'
op|')'
op|','
name|'expire'
op|'='
name|'expire'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
string|"'get_project_quotas'"
op|','
nl|'\n'
op|'('
string|"'quota_reserve'"
op|','
name|'expire'
op|','
number|'500'
op|','
number|'0'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
op|'['
string|"'resv-1'"
op|','
string|"'resv-2'"
op|','
string|"'resv-3'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_reserve_max_age
dedent|''
name|'def'
name|'test_reserve_max_age'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_stub_get_project_quotas'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_stub_quota_reserve'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'flags'
op|'('
name|'max_age'
op|'='
number|'86400'
op|')'
newline|'\n'
name|'expire'
op|'='
name|'timeutils'
op|'.'
name|'utcnow'
op|'('
op|')'
op|'+'
name|'datetime'
op|'.'
name|'timedelta'
op|'('
name|'seconds'
op|'='
number|'120'
op|')'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'reserve'
op|'('
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
name|'dict'
op|'('
name|'instances'
op|'='
number|'2'
op|')'
op|','
name|'expire'
op|'='
name|'expire'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'calls'
op|','
op|'['
nl|'\n'
string|"'get_project_quotas'"
op|','
nl|'\n'
op|'('
string|"'quota_reserve'"
op|','
name|'expire'
op|','
number|'0'
op|','
number|'86400'
op|')'
op|','
nl|'\n'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
op|'['
string|"'resv-1'"
op|','
string|"'resv-2'"
op|','
string|"'resv-3'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_usage_reset
dedent|''
name|'def'
name|'test_usage_reset'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'calls'
op|'='
op|'['
op|']'
newline|'\n'
nl|'\n'
DECL|function|fake_quota_usage_update
name|'def'
name|'fake_quota_usage_update'
op|'('
name|'context'
op|','
name|'project_id'
op|','
name|'user_id'
op|','
name|'resource'
op|','
nl|'\n'
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'calls'
op|'.'
name|'append'
op|'('
op|'('
string|"'quota_usage_update'"
op|','
name|'context'
op|','
name|'project_id'
op|','
name|'user_id'
op|','
nl|'\n'
name|'resource'
op|','
name|'kwargs'
op|')'
op|')'
newline|'\n'
name|'if'
name|'resource'
op|'=='
string|"'nonexist'"
op|':'
newline|'\n'
indent|'                '
name|'raise'
name|'exception'
op|'.'
name|'QuotaUsageNotFound'
op|'('
name|'project_id'
op|'='
name|'project_id'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'db'
op|','
string|"'quota_usage_update'"
op|','
name|'fake_quota_usage_update'
op|')'
newline|'\n'
nl|'\n'
name|'ctx'
op|'='
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
newline|'\n'
name|'resources'
op|'='
op|'['
string|"'res1'"
op|','
string|"'res2'"
op|','
string|"'nonexist'"
op|','
string|"'res4'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'driver'
op|'.'
name|'usage_reset'
op|'('
name|'ctx'
op|','
name|'resources'
op|')'
newline|'\n'
nl|'\n'
comment|'# Make sure we had some calls'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'calls'
op|')'
op|','
name|'len'
op|'('
name|'resources'
op|')'
op|')'
newline|'\n'
nl|'\n'
comment|'# Extract the elevated context that was used and do some'
nl|'\n'
comment|'# sanity checks'
nl|'\n'
name|'elevated'
op|'='
name|'calls'
op|'['
number|'0'
op|']'
op|'['
number|'1'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'elevated'
op|'.'
name|'project_id'
op|','
name|'ctx'
op|'.'
name|'project_id'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'elevated'
op|'.'
name|'quota_class'
op|','
name|'ctx'
op|'.'
name|'quota_class'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'elevated'
op|'.'
name|'is_admin'
op|','
name|'True'
op|')'
newline|'\n'
nl|'\n'
comment|'# Now check that all the expected calls were made'
nl|'\n'
name|'exemplar'
op|'='
op|'['
op|'('
string|"'quota_usage_update'"
op|','
name|'elevated'
op|','
string|"'test_project'"
op|','
nl|'\n'
string|"'fake_user'"
op|','
name|'res'
op|','
name|'dict'
op|'('
name|'in_use'
op|'='
op|'-'
number|'1'
op|')'
op|')'
name|'for'
name|'res'
name|'in'
name|'resources'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'calls'
op|','
name|'exemplar'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|FakeSession
dedent|''
dedent|''
name|'class'
name|'FakeSession'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|begin
indent|'    '
name|'def'
name|'begin'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
newline|'\n'
nl|'\n'
DECL|member|add
dedent|''
name|'def'
name|'add'
op|'('
name|'self'
op|','
name|'instance'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pass'
newline|'\n'
nl|'\n'
DECL|member|__enter__
dedent|''
name|'def'
name|'__enter__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
newline|'\n'
nl|'\n'
DECL|member|__exit__
dedent|''
name|'def'
name|'__exit__'
op|'('
name|'self'
op|','
name|'exc_type'
op|','
name|'exc_value'
op|','
name|'exc_traceback'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'False'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|FakeUsage
dedent|''
dedent|''
name|'class'
name|'FakeUsage'
op|'('
name|'sqa_models'
op|'.'
name|'QuotaUsage'
op|')'
op|':'
newline|'\n'
DECL|member|save
indent|'    '
name|'def'
name|'save'
op|'('
name|'self'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pass'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|QuotaReserveSqlAlchemyTestCase
dedent|''
dedent|''
name|'class'
name|'QuotaReserveSqlAlchemyTestCase'
op|'('
name|'test'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
comment|'# nova.db.sqlalchemy.api.quota_reserve is so complex it needs its'
nl|'\n'
comment|"# own test case, and since it's a quota manipulator, this is the"
nl|'\n'
comment|'# best place to put it...'
nl|'\n'
nl|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'QuotaReserveSqlAlchemyTestCase'
op|','
name|'self'
op|')'
op|'.'
name|'setUp'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'sync_called'
op|'='
name|'set'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'quotas'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'instances'
op|'='
number|'5'
op|','
nl|'\n'
name|'cores'
op|'='
number|'10'
op|','
nl|'\n'
name|'ram'
op|'='
number|'10'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'fixed_ips'
op|'='
number|'5'
op|','
nl|'\n'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'deltas'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'instances'
op|'='
number|'2'
op|','
nl|'\n'
name|'cores'
op|'='
number|'4'
op|','
nl|'\n'
name|'ram'
op|'='
number|'2'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'fixed_ips'
op|'='
number|'2'
op|','
nl|'\n'
op|')'
newline|'\n'
nl|'\n'
DECL|function|make_sync
name|'def'
name|'make_sync'
op|'('
name|'res_name'
op|')'
op|':'
newline|'\n'
DECL|function|sync
indent|'            '
name|'def'
name|'sync'
op|'('
name|'context'
op|','
name|'project_id'
op|','
name|'user_id'
op|','
name|'session'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'sync_called'
op|'.'
name|'add'
op|'('
name|'res_name'
op|')'
newline|'\n'
name|'if'
name|'res_name'
name|'in'
name|'self'
op|'.'
name|'usages'
op|':'
newline|'\n'
indent|'                    '
name|'if'
name|'self'
op|'.'
name|'usages'
op|'['
name|'res_name'
op|']'
op|'.'
name|'in_use'
op|'<'
number|'0'
op|':'
newline|'\n'
indent|'                        '
name|'return'
op|'{'
name|'res_name'
op|':'
number|'2'
op|'}'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                        '
name|'return'
op|'{'
name|'res_name'
op|':'
name|'self'
op|'.'
name|'usages'
op|'['
name|'res_name'
op|']'
op|'.'
name|'in_use'
op|'-'
number|'1'
op|'}'
newline|'\n'
dedent|''
dedent|''
name|'return'
op|'{'
name|'res_name'
op|':'
number|'0'
op|'}'
newline|'\n'
dedent|''
name|'return'
name|'sync'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'resources'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
name|'_existing_quota_sync_func_dict'
op|'='
name|'dict'
op|'('
name|'sqa_api'
op|'.'
name|'QUOTA_SYNC_FUNCTIONS'
op|')'
newline|'\n'
nl|'\n'
DECL|function|restore_sync_functions
name|'def'
name|'restore_sync_functions'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'sqa_api'
op|'.'
name|'QUOTA_SYNC_FUNCTIONS'
op|'.'
name|'clear'
op|'('
op|')'
newline|'\n'
name|'sqa_api'
op|'.'
name|'QUOTA_SYNC_FUNCTIONS'
op|'.'
name|'update'
op|'('
name|'_existing_quota_sync_func_dict'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'addCleanup'
op|'('
name|'restore_sync_functions'
op|')'
newline|'\n'
nl|'\n'
name|'for'
name|'res_name'
name|'in'
op|'('
string|"'instances'"
op|','
string|"'cores'"
op|','
string|"'ram'"
op|','
string|"'fixed_ips'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'method_name'
op|'='
string|"'_sync_%s'"
op|'%'
name|'res_name'
newline|'\n'
name|'sqa_api'
op|'.'
name|'QUOTA_SYNC_FUNCTIONS'
op|'['
name|'method_name'
op|']'
op|'='
name|'make_sync'
op|'('
name|'res_name'
op|')'
newline|'\n'
name|'res'
op|'='
name|'quota'
op|'.'
name|'ReservableResource'
op|'('
name|'res_name'
op|','
string|"'_sync_%s'"
op|'%'
name|'res_name'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'resources'
op|'['
name|'res_name'
op|']'
op|'='
name|'res'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'expire'
op|'='
name|'timeutils'
op|'.'
name|'utcnow'
op|'('
op|')'
op|'+'
name|'datetime'
op|'.'
name|'timedelta'
op|'('
name|'seconds'
op|'='
number|'3600'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'usages'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'usages_created'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'reservations_created'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'='
op|'['
nl|'\n'
name|'dict'
op|'('
name|'resource'
op|'='
string|"'instances'"
op|','
nl|'\n'
name|'project_id'
op|'='
string|"'test_project'"
op|','
nl|'\n'
name|'user_id'
op|'='
string|"'fake_user'"
op|','
nl|'\n'
name|'in_use'
op|'='
number|'2'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'2'
op|','
nl|'\n'
name|'until_refresh'
op|'='
name|'None'
op|')'
op|','
nl|'\n'
name|'dict'
op|'('
name|'resource'
op|'='
string|"'cores'"
op|','
nl|'\n'
name|'project_id'
op|'='
string|"'test_project'"
op|','
nl|'\n'
name|'user_id'
op|'='
string|"'fake_user'"
op|','
nl|'\n'
name|'in_use'
op|'='
number|'2'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'4'
op|','
nl|'\n'
name|'until_refresh'
op|'='
name|'None'
op|')'
op|','
nl|'\n'
name|'dict'
op|'('
name|'resource'
op|'='
string|"'ram'"
op|','
nl|'\n'
name|'project_id'
op|'='
string|"'test_project'"
op|','
nl|'\n'
name|'user_id'
op|'='
string|"'fake_user'"
op|','
nl|'\n'
name|'in_use'
op|'='
number|'2'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'2'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'until_refresh'
op|'='
name|'None'
op|')'
op|','
nl|'\n'
name|'dict'
op|'('
name|'resource'
op|'='
string|"'fixed_ips'"
op|','
nl|'\n'
name|'project_id'
op|'='
string|"'test_project'"
op|','
nl|'\n'
name|'user_id'
op|'='
name|'None'
op|','
nl|'\n'
name|'in_use'
op|'='
number|'2'
op|','
nl|'\n'
name|'reserved'
op|'='
number|'2'
op|','
nl|'\n'
name|'until_refresh'
op|'='
name|'None'
op|')'
op|','
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
DECL|function|fake_get_session
name|'def'
name|'fake_get_session'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'FakeSession'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|function|fake_get_project_user_quota_usages
dedent|''
name|'def'
name|'fake_get_project_user_quota_usages'
op|'('
name|'context'
op|','
name|'session'
op|','
name|'project_id'
op|','
nl|'\n'
name|'user_id'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'usages'
op|'.'
name|'copy'
op|'('
op|')'
op|','
name|'self'
op|'.'
name|'usages'
op|'.'
name|'copy'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|function|fake_quota_usage_create
dedent|''
name|'def'
name|'fake_quota_usage_create'
op|'('
name|'project_id'
op|','
name|'user_id'
op|','
name|'resource'
op|','
nl|'\n'
name|'in_use'
op|','
name|'reserved'
op|','
name|'until_refresh'
op|','
nl|'\n'
name|'session'
op|'='
name|'None'
op|','
name|'save'
op|'='
name|'True'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'quota_usage_ref'
op|'='
name|'self'
op|'.'
name|'_make_quota_usage'
op|'('
nl|'\n'
name|'project_id'
op|','
name|'user_id'
op|','
name|'resource'
op|','
name|'in_use'
op|','
name|'reserved'
op|','
name|'until_refresh'
op|','
nl|'\n'
name|'timeutils'
op|'.'
name|'utcnow'
op|'('
op|')'
op|','
name|'timeutils'
op|'.'
name|'utcnow'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'usages_created'
op|'['
name|'resource'
op|']'
op|'='
name|'quota_usage_ref'
newline|'\n'
nl|'\n'
name|'return'
name|'quota_usage_ref'
newline|'\n'
nl|'\n'
DECL|function|fake_reservation_create
dedent|''
name|'def'
name|'fake_reservation_create'
op|'('
name|'uuid'
op|','
name|'usage_id'
op|','
name|'project_id'
op|','
nl|'\n'
name|'user_id'
op|','
name|'resource'
op|','
name|'delta'
op|','
name|'expire'
op|','
nl|'\n'
name|'session'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'reservation_ref'
op|'='
name|'self'
op|'.'
name|'_make_reservation'
op|'('
nl|'\n'
name|'uuid'
op|','
name|'usage_id'
op|','
name|'project_id'
op|','
name|'user_id'
op|','
name|'resource'
op|','
name|'delta'
op|','
name|'expire'
op|','
nl|'\n'
name|'timeutils'
op|'.'
name|'utcnow'
op|'('
op|')'
op|','
name|'timeutils'
op|'.'
name|'utcnow'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'reservations_created'
op|'['
name|'resource'
op|']'
op|'='
name|'reservation_ref'
newline|'\n'
nl|'\n'
name|'return'
name|'reservation_ref'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'sqa_api'
op|','
string|"'get_session'"
op|','
name|'fake_get_session'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'sqa_api'
op|','
string|"'_get_project_user_quota_usages'"
op|','
nl|'\n'
name|'fake_get_project_user_quota_usages'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'sqa_api'
op|','
string|"'_quota_usage_create'"
op|','
name|'fake_quota_usage_create'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'sqa_api'
op|','
string|"'_reservation_create'"
op|','
name|'fake_reservation_create'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'useFixture'
op|'('
name|'test'
op|'.'
name|'TimeOverride'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_make_quota_usage
dedent|''
name|'def'
name|'_make_quota_usage'
op|'('
name|'self'
op|','
name|'project_id'
op|','
name|'user_id'
op|','
name|'resource'
op|','
name|'in_use'
op|','
nl|'\n'
name|'reserved'
op|','
name|'until_refresh'
op|','
name|'created_at'
op|','
name|'updated_at'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'quota_usage_ref'
op|'='
name|'FakeUsage'
op|'('
op|')'
newline|'\n'
name|'quota_usage_ref'
op|'.'
name|'id'
op|'='
name|'len'
op|'('
name|'self'
op|'.'
name|'usages'
op|')'
op|'+'
name|'len'
op|'('
name|'self'
op|'.'
name|'usages_created'
op|')'
newline|'\n'
name|'quota_usage_ref'
op|'.'
name|'project_id'
op|'='
name|'project_id'
newline|'\n'
name|'quota_usage_ref'
op|'.'
name|'user_id'
op|'='
name|'user_id'
newline|'\n'
name|'quota_usage_ref'
op|'.'
name|'resource'
op|'='
name|'resource'
newline|'\n'
name|'quota_usage_ref'
op|'.'
name|'in_use'
op|'='
name|'in_use'
newline|'\n'
name|'quota_usage_ref'
op|'.'
name|'reserved'
op|'='
name|'reserved'
newline|'\n'
name|'quota_usage_ref'
op|'.'
name|'until_refresh'
op|'='
name|'until_refresh'
newline|'\n'
name|'quota_usage_ref'
op|'.'
name|'created_at'
op|'='
name|'created_at'
newline|'\n'
name|'quota_usage_ref'
op|'.'
name|'updated_at'
op|'='
name|'updated_at'
newline|'\n'
name|'quota_usage_ref'
op|'.'
name|'deleted_at'
op|'='
name|'None'
newline|'\n'
name|'quota_usage_ref'
op|'.'
name|'deleted'
op|'='
name|'False'
newline|'\n'
nl|'\n'
name|'return'
name|'quota_usage_ref'
newline|'\n'
nl|'\n'
DECL|member|init_usage
dedent|''
name|'def'
name|'init_usage'
op|'('
name|'self'
op|','
name|'project_id'
op|','
name|'user_id'
op|','
name|'resource'
op|','
name|'in_use'
op|','
name|'reserved'
op|'='
number|'0'
op|','
nl|'\n'
name|'until_refresh'
op|'='
name|'None'
op|','
name|'created_at'
op|'='
name|'None'
op|','
name|'updated_at'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'created_at'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'created_at'
op|'='
name|'timeutils'
op|'.'
name|'utcnow'
op|'('
op|')'
newline|'\n'
dedent|''
name|'if'
name|'updated_at'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'updated_at'
op|'='
name|'timeutils'
op|'.'
name|'utcnow'
op|'('
op|')'
newline|'\n'
dedent|''
name|'if'
name|'resource'
op|'=='
string|"'fixed_ips'"
op|':'
newline|'\n'
indent|'            '
name|'user_id'
op|'='
name|'None'
newline|'\n'
nl|'\n'
dedent|''
name|'quota_usage_ref'
op|'='
name|'self'
op|'.'
name|'_make_quota_usage'
op|'('
name|'project_id'
op|','
name|'user_id'
op|','
name|'resource'
op|','
nl|'\n'
name|'in_use'
op|','
name|'reserved'
op|','
nl|'\n'
name|'until_refresh'
op|','
nl|'\n'
name|'created_at'
op|','
name|'updated_at'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'usages'
op|'['
name|'resource'
op|']'
op|'='
name|'quota_usage_ref'
newline|'\n'
nl|'\n'
DECL|member|compare_usage
dedent|''
name|'def'
name|'compare_usage'
op|'('
name|'self'
op|','
name|'usage_dict'
op|','
name|'expected'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'for'
name|'usage'
name|'in'
name|'expected'
op|':'
newline|'\n'
indent|'            '
name|'resource'
op|'='
name|'usage'
op|'['
string|"'resource'"
op|']'
newline|'\n'
name|'for'
name|'key'
op|','
name|'value'
name|'in'
name|'usage'
op|'.'
name|'items'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'actual'
op|'='
name|'getattr'
op|'('
name|'usage_dict'
op|'['
name|'resource'
op|']'
op|','
name|'key'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'actual'
op|','
name|'value'
op|','
nl|'\n'
string|'"%s != %s on usage for resource %s"'
op|'%'
nl|'\n'
op|'('
name|'actual'
op|','
name|'value'
op|','
name|'resource'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_make_reservation
dedent|''
dedent|''
dedent|''
name|'def'
name|'_make_reservation'
op|'('
name|'self'
op|','
name|'uuid'
op|','
name|'usage_id'
op|','
name|'project_id'
op|','
name|'user_id'
op|','
name|'resource'
op|','
nl|'\n'
name|'delta'
op|','
name|'expire'
op|','
name|'created_at'
op|','
name|'updated_at'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'reservation_ref'
op|'='
name|'sqa_models'
op|'.'
name|'Reservation'
op|'('
op|')'
newline|'\n'
name|'reservation_ref'
op|'.'
name|'id'
op|'='
name|'len'
op|'('
name|'self'
op|'.'
name|'reservations_created'
op|')'
newline|'\n'
name|'reservation_ref'
op|'.'
name|'uuid'
op|'='
name|'uuid'
newline|'\n'
name|'reservation_ref'
op|'.'
name|'usage_id'
op|'='
name|'usage_id'
newline|'\n'
name|'reservation_ref'
op|'.'
name|'project_id'
op|'='
name|'project_id'
newline|'\n'
name|'reservation_ref'
op|'.'
name|'user_id'
op|'='
name|'user_id'
newline|'\n'
name|'reservation_ref'
op|'.'
name|'resource'
op|'='
name|'resource'
newline|'\n'
name|'reservation_ref'
op|'.'
name|'delta'
op|'='
name|'delta'
newline|'\n'
name|'reservation_ref'
op|'.'
name|'expire'
op|'='
name|'expire'
newline|'\n'
name|'reservation_ref'
op|'.'
name|'created_at'
op|'='
name|'created_at'
newline|'\n'
name|'reservation_ref'
op|'.'
name|'updated_at'
op|'='
name|'updated_at'
newline|'\n'
name|'reservation_ref'
op|'.'
name|'deleted_at'
op|'='
name|'None'
newline|'\n'
name|'reservation_ref'
op|'.'
name|'deleted'
op|'='
name|'False'
newline|'\n'
nl|'\n'
name|'return'
name|'reservation_ref'
newline|'\n'
nl|'\n'
DECL|member|compare_reservation
dedent|''
name|'def'
name|'compare_reservation'
op|'('
name|'self'
op|','
name|'reservations'
op|','
name|'expected'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'reservations'
op|'='
name|'set'
op|'('
name|'reservations'
op|')'
newline|'\n'
name|'for'
name|'resv'
name|'in'
name|'expected'
op|':'
newline|'\n'
indent|'            '
name|'resource'
op|'='
name|'resv'
op|'['
string|"'resource'"
op|']'
newline|'\n'
name|'resv_obj'
op|'='
name|'self'
op|'.'
name|'reservations_created'
op|'['
name|'resource'
op|']'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertIn'
op|'('
name|'resv_obj'
op|'.'
name|'uuid'
op|','
name|'reservations'
op|')'
newline|'\n'
name|'reservations'
op|'.'
name|'discard'
op|'('
name|'resv_obj'
op|'.'
name|'uuid'
op|')'
newline|'\n'
nl|'\n'
name|'for'
name|'key'
op|','
name|'value'
name|'in'
name|'resv'
op|'.'
name|'items'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'actual'
op|'='
name|'getattr'
op|'('
name|'resv_obj'
op|','
name|'key'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'actual'
op|','
name|'value'
op|','
nl|'\n'
string|'"%s != %s on reservation for resource %s"'
op|'%'
nl|'\n'
op|'('
name|'actual'
op|','
name|'value'
op|','
name|'resource'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'reservations'
op|')'
op|','
number|'0'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_update_reservations_list
dedent|''
name|'def'
name|'_update_reservations_list'
op|'('
name|'self'
op|','
name|'usage_id_change'
op|'='
name|'False'
op|','
nl|'\n'
name|'delta_change'
op|'='
name|'False'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'reservations_list'
op|'='
op|'['
nl|'\n'
name|'dict'
op|'('
name|'resource'
op|'='
string|"'instances'"
op|','
nl|'\n'
name|'project_id'
op|'='
string|"'test_project'"
op|','
nl|'\n'
name|'delta'
op|'='
number|'2'
op|')'
op|','
nl|'\n'
name|'dict'
op|'('
name|'resource'
op|'='
string|"'cores'"
op|','
nl|'\n'
name|'project_id'
op|'='
string|"'test_project'"
op|','
nl|'\n'
name|'delta'
op|'='
number|'4'
op|')'
op|','
nl|'\n'
name|'dict'
op|'('
name|'resource'
op|'='
string|"'ram'"
op|','
nl|'\n'
name|'delta'
op|'='
number|'2'
op|'*'
number|'1024'
op|')'
op|','
nl|'\n'
name|'dict'
op|'('
name|'resource'
op|'='
string|"'fixed_ips'"
op|','
nl|'\n'
name|'project_id'
op|'='
string|"'test_project'"
op|','
nl|'\n'
name|'delta'
op|'='
number|'2'
op|')'
op|','
nl|'\n'
op|']'
newline|'\n'
name|'if'
name|'usage_id_change'
op|':'
newline|'\n'
indent|'            '
name|'reservations_list'
op|'['
number|'0'
op|']'
op|'['
string|'"usage_id"'
op|']'
op|'='
name|'self'
op|'.'
name|'usages_created'
op|'['
string|"'instances'"
op|']'
newline|'\n'
name|'reservations_list'
op|'['
number|'1'
op|']'
op|'['
string|'"usage_id"'
op|']'
op|'='
name|'self'
op|'.'
name|'usages_created'
op|'['
string|"'cores'"
op|']'
newline|'\n'
name|'reservations_list'
op|'['
number|'2'
op|']'
op|'['
string|'"usage_id"'
op|']'
op|'='
name|'self'
op|'.'
name|'usages_created'
op|'['
string|"'ram'"
op|']'
newline|'\n'
name|'reservations_list'
op|'['
number|'3'
op|']'
op|'['
string|'"usage_id"'
op|']'
op|'='
name|'self'
op|'.'
name|'usages_created'
op|'['
string|"'fixed_ips'"
op|']'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'reservations_list'
op|'['
number|'0'
op|']'
op|'['
string|'"usage_id"'
op|']'
op|'='
name|'self'
op|'.'
name|'usages'
op|'['
string|"'instances'"
op|']'
newline|'\n'
name|'reservations_list'
op|'['
number|'1'
op|']'
op|'['
string|'"usage_id"'
op|']'
op|'='
name|'self'
op|'.'
name|'usages'
op|'['
string|"'cores'"
op|']'
newline|'\n'
name|'reservations_list'
op|'['
number|'2'
op|']'
op|'['
string|'"usage_id"'
op|']'
op|'='
name|'self'
op|'.'
name|'usages'
op|'['
string|"'ram'"
op|']'
newline|'\n'
name|'reservations_list'
op|'['
number|'3'
op|']'
op|'['
string|'"usage_id"'
op|']'
op|'='
name|'self'
op|'.'
name|'usages'
op|'['
string|"'fixed_ips'"
op|']'
newline|'\n'
dedent|''
name|'if'
name|'delta_change'
op|':'
newline|'\n'
indent|'            '
name|'reservations_list'
op|'['
number|'0'
op|']'
op|'['
string|'"delta"'
op|']'
op|'='
op|'-'
number|'2'
newline|'\n'
name|'reservations_list'
op|'['
number|'1'
op|']'
op|'['
string|'"delta"'
op|']'
op|'='
op|'-'
number|'4'
newline|'\n'
name|'reservations_list'
op|'['
number|'2'
op|']'
op|'['
string|'"delta"'
op|']'
op|'='
op|'-'
number|'2'
op|'*'
number|'1024'
newline|'\n'
name|'reservations_list'
op|'['
number|'3'
op|']'
op|'['
string|'"delta"'
op|']'
op|'='
op|'-'
number|'2'
newline|'\n'
dedent|''
name|'return'
name|'reservations_list'
newline|'\n'
nl|'\n'
DECL|member|_init_usages
dedent|''
name|'def'
name|'_init_usages'
op|'('
name|'self'
op|','
op|'*'
name|'in_use'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'for'
name|'i'
op|','
name|'option'
name|'in'
name|'enumerate'
op|'('
op|'('
string|"'instances'"
op|','
string|"'cores'"
op|','
string|"'ram'"
op|','
string|"'fixed_ips'"
op|')'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'init_usage'
op|'('
string|"'test_project'"
op|','
string|"'fake_user'"
op|','
nl|'\n'
name|'option'
op|','
name|'in_use'
op|'['
name|'i'
op|']'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_quota_reserve_create_usages
dedent|''
name|'def'
name|'test_quota_reserve_create_usages'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'FakeContext'
op|'('
string|"'test_project'"
op|','
string|"'test_class'"
op|')'
newline|'\n'
name|'result'
op|'='
name|'sqa_api'
op|'.'
name|'quota_reserve'
op|'('
name|'context'
op|','
name|'self'
op|'.'
name|'resources'
op|','
name|'self'
op|'.'
name|'quotas'
op|','
nl|'\n'
name|'self'
op|'.'
name|'quotas'
op|','
name|'self'
op|'.'
name|'deltas'
op|','
name|'self'
op|'.'
name|'expire'
op|','
nl|'\n'
number|'0'
op|','
number|'0'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'sync_called'
op|','
name|'set'
op|'('
op|'['
string|"'instances'"
op|','
string|"'cores'"
op|','
nl|'\n'
string|"'ram'"
op|','
string|"'fixed_ips'"
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'0'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'1'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'2'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'3'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'compare_usage'
op|'('
name|'self'
op|'.'
name|'usages_created'
op|','
name|'self'
op|'.'
name|'usages_list'
op|')'
newline|'\n'
name|'reservations_list'
op|'='
name|'self'
op|'.'
name|'_update_reservations_list'
op|'('
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'compare_reservation'
op|'('
name|'result'
op|','
name|'reservations_list'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_quota_reserve_negative_in_use
dedent|''
name|'def'
name|'test_quota_reserve_negative_in_use'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'self'
op|'.'
name|'_init_usages'
op|'('
op|'-'
number|'1'
op|','
op|'-'
number|'1'
op|','
op|'-'
number|'1'
op|','
op|'-'
number|'1'
op|','
name|'until_refresh'
op|'='
number|'1'
op|')'
newline|'\n'
name|'result'
op|'='
name|'sqa_api'
op|'.'
name|'quota_reserve'
op|'('
name|'context'
op|','
name|'self'
op|'.'
name|'resources'
op|','
name|'self'
op|'.'
name|'quotas'
op|','
nl|'\n'
name|'self'
op|'.'
name|'quotas'
op|','
name|'self'
op|'.'
name|'deltas'
op|','
name|'self'
op|'.'
name|'expire'
op|','
nl|'\n'
number|'5'
op|','
number|'0'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'sync_called'
op|','
name|'set'
op|'('
op|'['
string|"'instances'"
op|','
string|"'cores'"
op|','
nl|'\n'
string|"'ram'"
op|','
string|"'fixed_ips'"
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'0'
op|']'
op|'['
string|'"until_refresh"'
op|']'
op|'='
number|'5'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'1'
op|']'
op|'['
string|'"until_refresh"'
op|']'
op|'='
number|'5'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'2'
op|']'
op|'['
string|'"until_refresh"'
op|']'
op|'='
number|'5'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'3'
op|']'
op|'['
string|'"until_refresh"'
op|']'
op|'='
number|'5'
newline|'\n'
name|'self'
op|'.'
name|'compare_usage'
op|'('
name|'self'
op|'.'
name|'usages'
op|','
name|'self'
op|'.'
name|'usages_list'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'usages_created'
op|','
op|'{'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'compare_reservation'
op|'('
name|'result'
op|','
name|'self'
op|'.'
name|'_update_reservations_list'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_quota_reserve_until_refresh
dedent|''
name|'def'
name|'test_quota_reserve_until_refresh'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'self'
op|'.'
name|'_init_usages'
op|'('
number|'3'
op|','
number|'3'
op|','
number|'3'
op|','
number|'3'
op|','
name|'until_refresh'
op|'='
number|'1'
op|')'
newline|'\n'
name|'result'
op|'='
name|'sqa_api'
op|'.'
name|'quota_reserve'
op|'('
name|'context'
op|','
name|'self'
op|'.'
name|'resources'
op|','
name|'self'
op|'.'
name|'quotas'
op|','
nl|'\n'
name|'self'
op|'.'
name|'quotas'
op|','
name|'self'
op|'.'
name|'deltas'
op|','
name|'self'
op|'.'
name|'expire'
op|','
nl|'\n'
number|'5'
op|','
number|'0'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'sync_called'
op|','
name|'set'
op|'('
op|'['
string|"'instances'"
op|','
string|"'cores'"
op|','
nl|'\n'
string|"'ram'"
op|','
string|"'fixed_ips'"
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'0'
op|']'
op|'['
string|'"until_refresh"'
op|']'
op|'='
number|'5'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'1'
op|']'
op|'['
string|'"until_refresh"'
op|']'
op|'='
number|'5'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'2'
op|']'
op|'['
string|'"until_refresh"'
op|']'
op|'='
number|'5'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'3'
op|']'
op|'['
string|'"until_refresh"'
op|']'
op|'='
number|'5'
newline|'\n'
name|'self'
op|'.'
name|'compare_usage'
op|'('
name|'self'
op|'.'
name|'usages'
op|','
name|'self'
op|'.'
name|'usages_list'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'usages_created'
op|','
op|'{'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'compare_reservation'
op|'('
name|'result'
op|','
name|'self'
op|'.'
name|'_update_reservations_list'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_quota_reserve_max_age
dedent|''
name|'def'
name|'test_quota_reserve_max_age'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'max_age'
op|'='
number|'3600'
newline|'\n'
name|'record_created'
op|'='
op|'('
name|'timeutils'
op|'.'
name|'utcnow'
op|'('
op|')'
op|'-'
nl|'\n'
name|'datetime'
op|'.'
name|'timedelta'
op|'('
name|'seconds'
op|'='
name|'max_age'
op|')'
op|')'
newline|'\n'
name|'context'
op|'='
name|'self'
op|'.'
name|'_init_usages'
op|'('
number|'3'
op|','
number|'3'
op|','
number|'3'
op|','
number|'3'
op|','
name|'created_at'
op|'='
name|'record_created'
op|','
nl|'\n'
name|'updated_at'
op|'='
name|'record_created'
op|')'
newline|'\n'
name|'result'
op|'='
name|'sqa_api'
op|'.'
name|'quota_reserve'
op|'('
name|'context'
op|','
name|'self'
op|'.'
name|'resources'
op|','
name|'self'
op|'.'
name|'quotas'
op|','
nl|'\n'
name|'self'
op|'.'
name|'quotas'
op|','
name|'self'
op|'.'
name|'deltas'
op|','
name|'self'
op|'.'
name|'expire'
op|','
nl|'\n'
number|'0'
op|','
name|'max_age'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'sync_called'
op|','
name|'set'
op|'('
op|'['
string|"'instances'"
op|','
string|"'cores'"
op|','
nl|'\n'
string|"'ram'"
op|','
string|"'fixed_ips'"
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'compare_usage'
op|'('
name|'self'
op|'.'
name|'usages'
op|','
name|'self'
op|'.'
name|'usages_list'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'usages_created'
op|','
op|'{'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'compare_reservation'
op|'('
name|'result'
op|','
name|'self'
op|'.'
name|'_update_reservations_list'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_quota_reserve_no_refresh
dedent|''
name|'def'
name|'test_quota_reserve_no_refresh'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'self'
op|'.'
name|'_init_usages'
op|'('
number|'3'
op|','
number|'3'
op|','
number|'3'
op|','
number|'3'
op|')'
newline|'\n'
name|'result'
op|'='
name|'sqa_api'
op|'.'
name|'quota_reserve'
op|'('
name|'context'
op|','
name|'self'
op|'.'
name|'resources'
op|','
name|'self'
op|'.'
name|'quotas'
op|','
nl|'\n'
name|'self'
op|'.'
name|'quotas'
op|','
name|'self'
op|'.'
name|'deltas'
op|','
name|'self'
op|'.'
name|'expire'
op|','
nl|'\n'
number|'0'
op|','
number|'0'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'sync_called'
op|','
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'0'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'3'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'1'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'3'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'2'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'3'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'3'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'3'
newline|'\n'
name|'self'
op|'.'
name|'compare_usage'
op|'('
name|'self'
op|'.'
name|'usages'
op|','
name|'self'
op|'.'
name|'usages_list'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'usages_created'
op|','
op|'{'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'compare_reservation'
op|'('
name|'result'
op|','
name|'self'
op|'.'
name|'_update_reservations_list'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_quota_reserve_unders
dedent|''
name|'def'
name|'test_quota_reserve_unders'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'self'
op|'.'
name|'_init_usages'
op|'('
number|'1'
op|','
number|'3'
op|','
number|'1'
op|'*'
number|'1024'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'deltas'
op|'['
string|'"instances"'
op|']'
op|'='
op|'-'
number|'2'
newline|'\n'
name|'self'
op|'.'
name|'deltas'
op|'['
string|'"cores"'
op|']'
op|'='
op|'-'
number|'4'
newline|'\n'
name|'self'
op|'.'
name|'deltas'
op|'['
string|'"ram"'
op|']'
op|'='
op|'-'
number|'2'
op|'*'
number|'1024'
newline|'\n'
name|'self'
op|'.'
name|'deltas'
op|'['
string|'"fixed_ips"'
op|']'
op|'='
op|'-'
number|'2'
newline|'\n'
name|'result'
op|'='
name|'sqa_api'
op|'.'
name|'quota_reserve'
op|'('
name|'context'
op|','
name|'self'
op|'.'
name|'resources'
op|','
name|'self'
op|'.'
name|'quotas'
op|','
nl|'\n'
name|'self'
op|'.'
name|'quotas'
op|','
name|'self'
op|'.'
name|'deltas'
op|','
name|'self'
op|'.'
name|'expire'
op|','
nl|'\n'
number|'0'
op|','
number|'0'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'sync_called'
op|','
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'0'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'0'
op|']'
op|'['
string|'"reserved"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'1'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'3'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'1'
op|']'
op|'['
string|'"reserved"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'2'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'1'
op|'*'
number|'1024'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'2'
op|']'
op|'['
string|'"reserved"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'3'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'3'
op|']'
op|'['
string|'"reserved"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'compare_usage'
op|'('
name|'self'
op|'.'
name|'usages'
op|','
name|'self'
op|'.'
name|'usages_list'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'usages_created'
op|','
op|'{'
op|'}'
op|')'
newline|'\n'
name|'reservations_list'
op|'='
name|'self'
op|'.'
name|'_update_reservations_list'
op|'('
name|'False'
op|','
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'compare_reservation'
op|'('
name|'result'
op|','
name|'reservations_list'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_quota_reserve_overs
dedent|''
name|'def'
name|'test_quota_reserve_overs'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'self'
op|'.'
name|'_init_usages'
op|'('
number|'4'
op|','
number|'8'
op|','
number|'10'
op|'*'
number|'1024'
op|','
number|'4'
op|')'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'sqa_api'
op|'.'
name|'quota_reserve'
op|'('
name|'context'
op|','
name|'self'
op|'.'
name|'resources'
op|','
name|'self'
op|'.'
name|'quotas'
op|','
nl|'\n'
name|'self'
op|'.'
name|'quotas'
op|','
name|'self'
op|'.'
name|'deltas'
op|','
name|'self'
op|'.'
name|'expire'
op|','
number|'0'
op|','
number|'0'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'exception'
op|'.'
name|'OverQuota'
name|'as'
name|'e'
op|':'
newline|'\n'
indent|'            '
name|'expected_kwargs'
op|'='
op|'{'
string|"'code'"
op|':'
number|'500'
op|','
nl|'\n'
string|"'usages'"
op|':'
op|'{'
string|"'instances'"
op|':'
op|'{'
string|"'reserved'"
op|':'
number|'0'
op|','
string|"'in_use'"
op|':'
number|'4'
op|'}'
op|','
nl|'\n'
string|"'ram'"
op|':'
op|'{'
string|"'reserved'"
op|':'
number|'0'
op|','
string|"'in_use'"
op|':'
number|'10240'
op|'}'
op|','
nl|'\n'
string|"'fixed_ips'"
op|':'
op|'{'
string|"'reserved'"
op|':'
number|'0'
op|','
string|"'in_use'"
op|':'
number|'4'
op|'}'
op|','
nl|'\n'
string|"'cores'"
op|':'
op|'{'
string|"'reserved'"
op|':'
number|'0'
op|','
string|"'in_use'"
op|':'
number|'8'
op|'}'
op|'}'
op|','
nl|'\n'
string|"'overs'"
op|':'
op|'['
string|"'cores'"
op|','
string|"'fixed_ips'"
op|','
string|"'instances'"
op|','
string|"'ram'"
op|']'
op|','
nl|'\n'
string|"'quotas'"
op|':'
op|'{'
string|"'cores'"
op|':'
number|'10'
op|','
string|"'ram'"
op|':'
number|'10240'
op|','
nl|'\n'
string|"'fixed_ips'"
op|':'
number|'5'
op|','
string|"'instances'"
op|':'
number|'5'
op|'}'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'e'
op|'.'
name|'kwargs'
op|','
name|'expected_kwargs'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'fail'
op|'('
string|"'Expected OverQuota failure'"
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'sync_called'
op|','
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'0'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'4'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'0'
op|']'
op|'['
string|'"reserved"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'1'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'8'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'1'
op|']'
op|'['
string|'"reserved"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'2'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'10'
op|'*'
number|'1024'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'2'
op|']'
op|'['
string|'"reserved"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'3'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'4'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'3'
op|']'
op|'['
string|'"reserved"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'compare_usage'
op|'('
name|'self'
op|'.'
name|'usages'
op|','
name|'self'
op|'.'
name|'usages_list'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'usages_created'
op|','
op|'{'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'reservations_created'
op|','
op|'{'
op|'}'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_quota_reserve_cores_unlimited
dedent|''
name|'def'
name|'test_quota_reserve_cores_unlimited'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# Requesting 8 cores, quota_cores set to unlimited:'
nl|'\n'
indent|'        '
name|'self'
op|'.'
name|'flags'
op|'('
name|'quota_cores'
op|'='
op|'-'
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_init_usages'
op|'('
number|'1'
op|','
number|'8'
op|','
number|'1'
op|'*'
number|'1024'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'sync_called'
op|','
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'0'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'0'
op|']'
op|'['
string|'"reserved"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'1'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'8'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'1'
op|']'
op|'['
string|'"reserved"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'2'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'1'
op|'*'
number|'1024'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'2'
op|']'
op|'['
string|'"reserved"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'3'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'3'
op|']'
op|'['
string|'"reserved"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'compare_usage'
op|'('
name|'self'
op|'.'
name|'usages'
op|','
name|'self'
op|'.'
name|'usages_list'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'usages_created'
op|','
op|'{'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'reservations_created'
op|','
op|'{'
op|'}'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_quota_reserve_ram_unlimited
dedent|''
name|'def'
name|'test_quota_reserve_ram_unlimited'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# Requesting 10*1024 ram, quota_ram set to unlimited:'
nl|'\n'
indent|'        '
name|'self'
op|'.'
name|'flags'
op|'('
name|'quota_ram'
op|'='
op|'-'
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_init_usages'
op|'('
number|'1'
op|','
number|'1'
op|','
number|'10'
op|'*'
number|'1024'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'sync_called'
op|','
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'0'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'0'
op|']'
op|'['
string|'"reserved"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'1'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'1'
op|']'
op|'['
string|'"reserved"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'2'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'10'
op|'*'
number|'1024'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'2'
op|']'
op|'['
string|'"reserved"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'3'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'3'
op|']'
op|'['
string|'"reserved"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'compare_usage'
op|'('
name|'self'
op|'.'
name|'usages'
op|','
name|'self'
op|'.'
name|'usages_list'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'usages_created'
op|','
op|'{'
op|'}'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'reservations_created'
op|','
op|'{'
op|'}'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_quota_reserve_reduction
dedent|''
name|'def'
name|'test_quota_reserve_reduction'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'context'
op|'='
name|'self'
op|'.'
name|'_init_usages'
op|'('
number|'10'
op|','
number|'20'
op|','
number|'20'
op|'*'
number|'1024'
op|','
number|'10'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'deltas'
op|'['
string|'"instances"'
op|']'
op|'='
op|'-'
number|'2'
newline|'\n'
name|'self'
op|'.'
name|'deltas'
op|'['
string|'"cores"'
op|']'
op|'='
op|'-'
number|'4'
newline|'\n'
name|'self'
op|'.'
name|'deltas'
op|'['
string|'"ram"'
op|']'
op|'='
op|'-'
number|'2'
op|'*'
number|'1024'
newline|'\n'
name|'self'
op|'.'
name|'deltas'
op|'['
string|'"fixed_ips"'
op|']'
op|'='
op|'-'
number|'2'
newline|'\n'
name|'result'
op|'='
name|'sqa_api'
op|'.'
name|'quota_reserve'
op|'('
name|'context'
op|','
name|'self'
op|'.'
name|'resources'
op|','
name|'self'
op|'.'
name|'quotas'
op|','
nl|'\n'
name|'self'
op|'.'
name|'quotas'
op|','
name|'self'
op|'.'
name|'deltas'
op|','
name|'self'
op|'.'
name|'expire'
op|','
nl|'\n'
number|'0'
op|','
number|'0'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'sync_called'
op|','
name|'set'
op|'('
op|'['
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'0'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'10'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'0'
op|']'
op|'['
string|'"reserved"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'1'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'20'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'1'
op|']'
op|'['
string|'"reserved"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'2'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'20'
op|'*'
number|'1024'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'2'
op|']'
op|'['
string|'"reserved"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'3'
op|']'
op|'['
string|'"in_use"'
op|']'
op|'='
number|'10'
newline|'\n'
name|'self'
op|'.'
name|'usages_list'
op|'['
number|'3'
op|']'
op|'['
string|'"reserved"'
op|']'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'compare_usage'
op|'('
name|'self'
op|'.'
name|'usages'
op|','
name|'self'
op|'.'
name|'usages_list'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'usages_created'
op|','
op|'{'
op|'}'
op|')'
newline|'\n'
name|'reservations_list'
op|'='
name|'self'
op|'.'
name|'_update_reservations_list'
op|'('
name|'False'
op|','
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'compare_reservation'
op|'('
name|'result'
op|','
name|'reservations_list'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|NoopQuotaDriverTestCase
dedent|''
dedent|''
name|'class'
name|'NoopQuotaDriverTestCase'
op|'('
name|'test'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'NoopQuotaDriverTestCase'
op|','
name|'self'
op|')'
op|'.'
name|'setUp'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'flags'
op|'('
name|'quota_instances'
op|'='
number|'10'
op|','
nl|'\n'
name|'quota_cores'
op|'='
number|'20'
op|','
nl|'\n'
name|'quota_ram'
op|'='
number|'50'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'quota_floating_ips'
op|'='
number|'10'
op|','
nl|'\n'
name|'quota_metadata_items'
op|'='
number|'128'
op|','
nl|'\n'
name|'quota_injected_files'
op|'='
number|'5'
op|','
nl|'\n'
name|'quota_injected_file_content_bytes'
op|'='
number|'10'
op|'*'
number|'1024'
op|','
nl|'\n'
name|'quota_injected_file_path_length'
op|'='
number|'255'
op|','
nl|'\n'
name|'quota_security_groups'
op|'='
number|'10'
op|','
nl|'\n'
name|'quota_security_group_rules'
op|'='
number|'20'
op|','
nl|'\n'
name|'reservation_expire'
op|'='
number|'86400'
op|','
nl|'\n'
name|'until_refresh'
op|'='
number|'0'
op|','
nl|'\n'
name|'max_age'
op|'='
number|'0'
op|','
nl|'\n'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'expected_with_usages'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'expected_without_usages'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'expected_without_dict'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'expected_settable_quotas'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'for'
name|'r'
name|'in'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'expected_with_usages'
op|'['
name|'r'
op|']'
op|'='
name|'dict'
op|'('
name|'limit'
op|'='
op|'-'
number|'1'
op|','
nl|'\n'
name|'in_use'
op|'='
op|'-'
number|'1'
op|','
nl|'\n'
name|'reserved'
op|'='
op|'-'
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'expected_without_usages'
op|'['
name|'r'
op|']'
op|'='
name|'dict'
op|'('
name|'limit'
op|'='
op|'-'
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'expected_without_dict'
op|'['
name|'r'
op|']'
op|'='
op|'-'
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'expected_settable_quotas'
op|'['
name|'r'
op|']'
op|'='
name|'dict'
op|'('
name|'minimum'
op|'='
number|'0'
op|','
name|'maximum'
op|'='
op|'-'
number|'1'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'driver'
op|'='
name|'quota'
op|'.'
name|'NoopQuotaDriver'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_defaults
dedent|''
name|'def'
name|'test_get_defaults'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# Use our pre-defined resources'
nl|'\n'
indent|'        '
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_defaults'
op|'('
name|'None'
op|','
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'expected_without_dict'
op|','
name|'result'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_class_quotas
dedent|''
name|'def'
name|'test_get_class_quotas'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_class_quotas'
op|'('
name|'None'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
string|"'test_class'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'expected_without_dict'
op|','
name|'result'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_class_quotas_no_defaults
dedent|''
name|'def'
name|'test_get_class_quotas_no_defaults'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_class_quotas'
op|'('
name|'None'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
string|"'test_class'"
op|','
nl|'\n'
name|'False'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'expected_without_dict'
op|','
name|'result'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_project_quotas
dedent|''
name|'def'
name|'test_get_project_quotas'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_project_quotas'
op|'('
name|'None'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
string|"'test_project'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'expected_with_usages'
op|','
name|'result'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_user_quotas
dedent|''
name|'def'
name|'test_get_user_quotas'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_user_quotas'
op|'('
name|'None'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
string|"'test_project'"
op|','
nl|'\n'
string|"'fake_user'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'expected_with_usages'
op|','
name|'result'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_project_quotas_no_defaults
dedent|''
name|'def'
name|'test_get_project_quotas_no_defaults'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_project_quotas'
op|'('
name|'None'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
string|"'test_project'"
op|','
nl|'\n'
name|'defaults'
op|'='
name|'False'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'expected_with_usages'
op|','
name|'result'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_user_quotas_no_defaults
dedent|''
name|'def'
name|'test_get_user_quotas_no_defaults'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_user_quotas'
op|'('
name|'None'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
string|"'test_project'"
op|','
nl|'\n'
string|"'fake_user'"
op|','
nl|'\n'
name|'defaults'
op|'='
name|'False'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'expected_with_usages'
op|','
name|'result'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_project_quotas_no_usages
dedent|''
name|'def'
name|'test_get_project_quotas_no_usages'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_project_quotas'
op|'('
name|'None'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
string|"'test_project'"
op|','
nl|'\n'
name|'usages'
op|'='
name|'False'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'expected_without_usages'
op|','
name|'result'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_user_quotas_no_usages
dedent|''
name|'def'
name|'test_get_user_quotas_no_usages'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_user_quotas'
op|'('
name|'None'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
string|"'test_project'"
op|','
nl|'\n'
string|"'fake_user'"
op|','
nl|'\n'
name|'usages'
op|'='
name|'False'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'expected_without_usages'
op|','
name|'result'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_settable_quotas_with_user
dedent|''
name|'def'
name|'test_get_settable_quotas_with_user'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_settable_quotas'
op|'('
name|'None'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
string|"'test_project'"
op|','
nl|'\n'
string|"'fake_user'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'expected_settable_quotas'
op|','
name|'result'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_settable_quotas_without_user
dedent|''
name|'def'
name|'test_get_settable_quotas_without_user'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'result'
op|'='
name|'self'
op|'.'
name|'driver'
op|'.'
name|'get_settable_quotas'
op|'('
name|'None'
op|','
nl|'\n'
name|'quota'
op|'.'
name|'QUOTAS'
op|'.'
name|'_resources'
op|','
nl|'\n'
string|"'test_project'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'expected_settable_quotas'
op|','
name|'result'
op|')'
newline|'\n'
dedent|''
dedent|''
endmarker|''
end_unit
