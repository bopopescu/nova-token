begin_unit
comment|'# Copyright 2010 OpenStack Foundation'
nl|'\n'
comment|'# All Rights Reserved.'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#    Licensed under the Apache License, Version 2.0 (the "License"); you may'
nl|'\n'
comment|'#    not use this file except in compliance with the License. You may obtain'
nl|'\n'
comment|'#    a copy of the License at'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#         http://www.apache.org/licenses/LICENSE-2.0'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#    Unless required by applicable law or agreed to in writing, software'
nl|'\n'
comment|'#    distributed under the License is distributed on an "AS IS" BASIS, WITHOUT'
nl|'\n'
comment|'#    WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the'
nl|'\n'
comment|'#    License for the specific language governing permissions and limitations'
nl|'\n'
comment|'#    under the License.'
nl|'\n'
nl|'\n'
name|'import'
name|'datetime'
newline|'\n'
name|'import'
name|'uuid'
newline|'\n'
nl|'\n'
name|'from'
name|'oslo_serialization'
name|'import'
name|'jsonutils'
newline|'\n'
name|'from'
name|'oslo_utils'
name|'import'
name|'netutils'
newline|'\n'
name|'from'
name|'oslo_utils'
name|'import'
name|'timeutils'
newline|'\n'
name|'import'
name|'routes'
newline|'\n'
name|'import'
name|'six'
newline|'\n'
name|'from'
name|'six'
op|'.'
name|'moves'
name|'import'
name|'range'
newline|'\n'
name|'import'
name|'webob'
newline|'\n'
name|'import'
name|'webob'
op|'.'
name|'dec'
newline|'\n'
name|'import'
name|'webob'
op|'.'
name|'request'
newline|'\n'
nl|'\n'
name|'from'
name|'nova'
op|'.'
name|'api'
name|'import'
name|'auth'
name|'as'
name|'api_auth'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'api'
name|'import'
name|'openstack'
name|'as'
name|'openstack_api'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'api'
op|'.'
name|'openstack'
name|'import'
name|'api_version_request'
name|'as'
name|'api_version'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'api'
op|'.'
name|'openstack'
name|'import'
name|'auth'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'api'
op|'.'
name|'openstack'
name|'import'
name|'compute'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'api'
op|'.'
name|'openstack'
op|'.'
name|'compute'
op|'.'
name|'legacy_v2'
name|'import'
name|'limits'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'api'
op|'.'
name|'openstack'
op|'.'
name|'compute'
name|'import'
name|'versions'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'api'
op|'.'
name|'openstack'
name|'import'
name|'urlmap'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'api'
op|'.'
name|'openstack'
name|'import'
name|'wsgi'
name|'as'
name|'os_wsgi'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'compute'
name|'import'
name|'api'
name|'as'
name|'compute_api'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'compute'
name|'import'
name|'flavors'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'compute'
name|'import'
name|'vm_states'
newline|'\n'
name|'from'
name|'nova'
name|'import'
name|'context'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'db'
op|'.'
name|'sqlalchemy'
name|'import'
name|'models'
newline|'\n'
name|'from'
name|'nova'
name|'import'
name|'exception'
name|'as'
name|'exc'
newline|'\n'
name|'import'
name|'nova'
op|'.'
name|'netconf'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'network'
name|'import'
name|'api'
name|'as'
name|'network_api'
newline|'\n'
name|'from'
name|'nova'
name|'import'
name|'objects'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'objects'
name|'import'
name|'base'
newline|'\n'
name|'from'
name|'nova'
name|'import'
name|'quota'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'tests'
op|'.'
name|'unit'
name|'import'
name|'fake_block_device'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'tests'
op|'.'
name|'unit'
name|'import'
name|'fake_network'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'tests'
op|'.'
name|'unit'
op|'.'
name|'objects'
name|'import'
name|'test_keypair'
newline|'\n'
name|'from'
name|'nova'
name|'import'
name|'utils'
newline|'\n'
name|'from'
name|'nova'
name|'import'
name|'wsgi'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|variable|QUOTAS
name|'QUOTAS'
op|'='
name|'quota'
op|'.'
name|'QUOTAS'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|variable|FAKE_UUID
name|'FAKE_UUID'
op|'='
string|"'aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa'"
newline|'\n'
DECL|variable|FAKE_UUIDS
name|'FAKE_UUIDS'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
nl|'\n'
op|'@'
name|'webob'
op|'.'
name|'dec'
op|'.'
name|'wsgify'
newline|'\n'
DECL|function|fake_wsgi
name|'def'
name|'fake_wsgi'
op|'('
name|'self'
op|','
name|'req'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'return'
name|'self'
op|'.'
name|'application'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|wsgi_app
dedent|''
name|'def'
name|'wsgi_app'
op|'('
name|'inner_app_v2'
op|'='
name|'None'
op|','
name|'fake_auth_context'
op|'='
name|'None'
op|','
nl|'\n'
name|'use_no_auth'
op|'='
name|'False'
op|','
name|'ext_mgr'
op|'='
name|'None'
op|','
name|'init_only'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'if'
name|'not'
name|'inner_app_v2'
op|':'
newline|'\n'
indent|'        '
name|'inner_app_v2'
op|'='
name|'compute'
op|'.'
name|'APIRouter'
op|'('
name|'ext_mgr'
op|','
name|'init_only'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'use_no_auth'
op|':'
newline|'\n'
indent|'        '
name|'api_v2'
op|'='
name|'openstack_api'
op|'.'
name|'FaultWrapper'
op|'('
name|'auth'
op|'.'
name|'NoAuthMiddleware'
op|'('
nl|'\n'
name|'limits'
op|'.'
name|'RateLimitingMiddleware'
op|'('
name|'inner_app_v2'
op|')'
op|')'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'fake_auth_context'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'ctxt'
op|'='
name|'fake_auth_context'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'ctxt'
op|'='
name|'context'
op|'.'
name|'RequestContext'
op|'('
string|"'fake'"
op|','
string|"'fake'"
op|','
name|'auth_token'
op|'='
name|'True'
op|')'
newline|'\n'
dedent|''
name|'api_v2'
op|'='
name|'openstack_api'
op|'.'
name|'FaultWrapper'
op|'('
name|'api_auth'
op|'.'
name|'InjectContext'
op|'('
name|'ctxt'
op|','
nl|'\n'
name|'limits'
op|'.'
name|'RateLimitingMiddleware'
op|'('
name|'inner_app_v2'
op|')'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'mapper'
op|'='
name|'urlmap'
op|'.'
name|'URLMap'
op|'('
op|')'
newline|'\n'
name|'mapper'
op|'['
string|"'/v2'"
op|']'
op|'='
name|'api_v2'
newline|'\n'
name|'mapper'
op|'['
string|"'/v1.1'"
op|']'
op|'='
name|'api_v2'
newline|'\n'
name|'mapper'
op|'['
string|"'/'"
op|']'
op|'='
name|'openstack_api'
op|'.'
name|'FaultWrapper'
op|'('
name|'versions'
op|'.'
name|'Versions'
op|'('
op|')'
op|')'
newline|'\n'
name|'return'
name|'mapper'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|wsgi_app_v21
dedent|''
name|'def'
name|'wsgi_app_v21'
op|'('
name|'inner_app_v21'
op|'='
name|'None'
op|','
name|'fake_auth_context'
op|'='
name|'None'
op|','
nl|'\n'
name|'use_no_auth'
op|'='
name|'False'
op|','
name|'ext_mgr'
op|'='
name|'None'
op|','
name|'init_only'
op|'='
name|'None'
op|','
name|'v2_compatible'
op|'='
name|'False'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'if'
name|'not'
name|'inner_app_v21'
op|':'
newline|'\n'
indent|'        '
name|'inner_app_v21'
op|'='
name|'compute'
op|'.'
name|'APIRouterV21'
op|'('
name|'init_only'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'v2_compatible'
op|':'
newline|'\n'
indent|'        '
name|'inner_app_v21'
op|'='
name|'openstack_api'
op|'.'
name|'LegacyV2CompatibleWrapper'
op|'('
name|'inner_app_v21'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'use_no_auth'
op|':'
newline|'\n'
indent|'        '
name|'api_v21'
op|'='
name|'openstack_api'
op|'.'
name|'FaultWrapper'
op|'('
name|'auth'
op|'.'
name|'NoAuthMiddleware'
op|'('
nl|'\n'
name|'limits'
op|'.'
name|'RateLimitingMiddleware'
op|'('
name|'inner_app_v21'
op|')'
op|')'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'fake_auth_context'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'ctxt'
op|'='
name|'fake_auth_context'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'ctxt'
op|'='
name|'context'
op|'.'
name|'RequestContext'
op|'('
string|"'fake'"
op|','
string|"'fake'"
op|','
name|'auth_token'
op|'='
name|'True'
op|')'
newline|'\n'
dedent|''
name|'api_v21'
op|'='
name|'openstack_api'
op|'.'
name|'FaultWrapper'
op|'('
name|'api_auth'
op|'.'
name|'InjectContext'
op|'('
name|'ctxt'
op|','
nl|'\n'
name|'limits'
op|'.'
name|'RateLimitingMiddleware'
op|'('
name|'inner_app_v21'
op|')'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'mapper'
op|'='
name|'urlmap'
op|'.'
name|'URLMap'
op|'('
op|')'
newline|'\n'
name|'mapper'
op|'['
string|"'/v2'"
op|']'
op|'='
name|'api_v21'
newline|'\n'
name|'mapper'
op|'['
string|"'/v2.1'"
op|']'
op|'='
name|'api_v21'
newline|'\n'
name|'mapper'
op|'['
string|"'/'"
op|']'
op|'='
name|'openstack_api'
op|'.'
name|'FaultWrapper'
op|'('
name|'versions'
op|'.'
name|'Versions'
op|'('
op|')'
op|')'
newline|'\n'
name|'return'
name|'mapper'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_out_key_pair_funcs
dedent|''
name|'def'
name|'stub_out_key_pair_funcs'
op|'('
name|'stubs'
op|','
name|'have_key_pair'
op|'='
name|'True'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
DECL|function|key_pair
indent|'    '
name|'def'
name|'key_pair'
op|'('
name|'context'
op|','
name|'user_id'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
op|'['
name|'dict'
op|'('
name|'test_keypair'
op|'.'
name|'fake_keypair'
op|','
nl|'\n'
name|'name'
op|'='
string|"'key'"
op|','
name|'public_key'
op|'='
string|"'public_key'"
op|','
op|'**'
name|'kwargs'
op|')'
op|']'
newline|'\n'
nl|'\n'
DECL|function|one_key_pair
dedent|''
name|'def'
name|'one_key_pair'
op|'('
name|'context'
op|','
name|'user_id'
op|','
name|'name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'name'
op|'=='
string|"'key'"
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'dict'
op|'('
name|'test_keypair'
op|'.'
name|'fake_keypair'
op|','
nl|'\n'
name|'name'
op|'='
string|"'key'"
op|','
name|'public_key'
op|'='
string|"'public_key'"
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'exc'
op|'.'
name|'KeypairNotFound'
op|'('
name|'user_id'
op|'='
name|'user_id'
op|','
name|'name'
op|'='
name|'name'
op|')'
newline|'\n'
nl|'\n'
DECL|function|no_key_pair
dedent|''
dedent|''
name|'def'
name|'no_key_pair'
op|'('
name|'context'
op|','
name|'user_id'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
op|'['
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'have_key_pair'
op|':'
newline|'\n'
indent|'        '
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'key_pair_get_all_by_user'"
op|','
name|'key_pair'
op|')'
newline|'\n'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'key_pair_get'"
op|','
name|'one_key_pair'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'        '
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'key_pair_get_all_by_user'"
op|','
name|'no_key_pair'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_out_rate_limiting
dedent|''
dedent|''
name|'def'
name|'stub_out_rate_limiting'
op|'('
name|'stubs'
op|')'
op|':'
newline|'\n'
DECL|function|fake_rate_init
indent|'    '
name|'def'
name|'fake_rate_init'
op|'('
name|'self'
op|','
name|'app'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'limits'
op|'.'
name|'RateLimitingMiddleware'
op|','
name|'self'
op|')'
op|'.'
name|'__init__'
op|'('
name|'app'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'application'
op|'='
name|'app'
newline|'\n'
nl|'\n'
dedent|''
name|'v2_limits'
op|'='
name|'nova'
op|'.'
name|'api'
op|'.'
name|'openstack'
op|'.'
name|'compute'
op|'.'
name|'legacy_v2'
op|'.'
name|'limits'
newline|'\n'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'v2_limits'
op|'.'
name|'RateLimitingMiddleware'
op|','
string|"'__init__'"
op|','
name|'fake_rate_init'
op|')'
newline|'\n'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'v2_limits'
op|'.'
name|'RateLimitingMiddleware'
op|','
string|"'__call__'"
op|','
name|'fake_wsgi'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_out_instance_quota
dedent|''
name|'def'
name|'stub_out_instance_quota'
op|'('
name|'stubs'
op|','
name|'allowed'
op|','
name|'quota'
op|','
name|'resource'
op|'='
string|"'instances'"
op|')'
op|':'
newline|'\n'
DECL|function|fake_reserve
indent|'    '
name|'def'
name|'fake_reserve'
op|'('
name|'context'
op|','
op|'**'
name|'deltas'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'requested'
op|'='
name|'deltas'
op|'.'
name|'pop'
op|'('
name|'resource'
op|','
number|'0'
op|')'
newline|'\n'
name|'if'
name|'requested'
op|'>'
name|'allowed'
op|':'
newline|'\n'
indent|'            '
name|'quotas'
op|'='
name|'dict'
op|'('
name|'instances'
op|'='
number|'1'
op|','
name|'cores'
op|'='
number|'1'
op|','
name|'ram'
op|'='
number|'1'
op|')'
newline|'\n'
name|'quotas'
op|'['
name|'resource'
op|']'
op|'='
name|'quota'
newline|'\n'
name|'usages'
op|'='
name|'dict'
op|'('
name|'instances'
op|'='
name|'dict'
op|'('
name|'in_use'
op|'='
number|'0'
op|','
name|'reserved'
op|'='
number|'0'
op|')'
op|','
nl|'\n'
name|'cores'
op|'='
name|'dict'
op|'('
name|'in_use'
op|'='
number|'0'
op|','
name|'reserved'
op|'='
number|'0'
op|')'
op|','
nl|'\n'
name|'ram'
op|'='
name|'dict'
op|'('
name|'in_use'
op|'='
number|'0'
op|','
name|'reserved'
op|'='
number|'0'
op|')'
op|')'
newline|'\n'
name|'usages'
op|'['
name|'resource'
op|']'
op|'['
string|"'in_use'"
op|']'
op|'='
op|'('
name|'quotas'
op|'['
name|'resource'
op|']'
op|'*'
number|'9'
op|'//'
number|'10'
op|'-'
name|'allowed'
op|')'
newline|'\n'
name|'usages'
op|'['
name|'resource'
op|']'
op|'['
string|"'reserved'"
op|']'
op|'='
name|'quotas'
op|'['
name|'resource'
op|']'
op|'//'
number|'10'
newline|'\n'
name|'raise'
name|'exc'
op|'.'
name|'OverQuota'
op|'('
name|'overs'
op|'='
op|'['
name|'resource'
op|']'
op|','
name|'quotas'
op|'='
name|'quotas'
op|','
nl|'\n'
name|'usages'
op|'='
name|'usages'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'QUOTAS'
op|','
string|"'reserve'"
op|','
name|'fake_reserve'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_out_networking
dedent|''
name|'def'
name|'stub_out_networking'
op|'('
name|'stubs'
op|')'
op|':'
newline|'\n'
DECL|function|get_my_ip
indent|'    '
name|'def'
name|'get_my_ip'
op|'('
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
string|"'127.0.0.1'"
newline|'\n'
dedent|''
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'netutils'
op|','
string|"'get_my_ipv4'"
op|','
name|'get_my_ip'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_out_compute_api_snapshot
dedent|''
name|'def'
name|'stub_out_compute_api_snapshot'
op|'('
name|'stubs'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|function|snapshot
indent|'    '
name|'def'
name|'snapshot'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'instance'
op|','
name|'name'
op|','
name|'extra_properties'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
comment|'# emulate glance rejecting image names which are too long'
nl|'\n'
indent|'        '
name|'if'
name|'len'
op|'('
name|'name'
op|')'
op|'>'
number|'256'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'exc'
op|'.'
name|'Invalid'
newline|'\n'
dedent|''
name|'return'
name|'dict'
op|'('
name|'id'
op|'='
string|"'123'"
op|','
name|'status'
op|'='
string|"'ACTIVE'"
op|','
name|'name'
op|'='
name|'name'
op|','
nl|'\n'
name|'properties'
op|'='
name|'extra_properties'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'compute_api'
op|'.'
name|'API'
op|','
string|"'snapshot'"
op|','
name|'snapshot'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|stub_out_compute_api_backup
dedent|''
name|'class'
name|'stub_out_compute_api_backup'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'stubs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'stubs'
op|'='
name|'stubs'
newline|'\n'
name|'self'
op|'.'
name|'extra_props_last_call'
op|'='
name|'None'
newline|'\n'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'compute_api'
op|'.'
name|'API'
op|','
string|"'backup'"
op|','
name|'self'
op|'.'
name|'backup'
op|')'
newline|'\n'
nl|'\n'
DECL|member|backup
dedent|''
name|'def'
name|'backup'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'instance'
op|','
name|'name'
op|','
name|'backup_type'
op|','
name|'rotation'
op|','
nl|'\n'
name|'extra_properties'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'extra_props_last_call'
op|'='
name|'extra_properties'
newline|'\n'
name|'props'
op|'='
name|'dict'
op|'('
name|'backup_type'
op|'='
name|'backup_type'
op|','
nl|'\n'
name|'rotation'
op|'='
name|'rotation'
op|')'
newline|'\n'
name|'props'
op|'.'
name|'update'
op|'('
name|'extra_properties'
name|'or'
op|'{'
op|'}'
op|')'
newline|'\n'
name|'return'
name|'dict'
op|'('
name|'id'
op|'='
string|"'123'"
op|','
name|'status'
op|'='
string|"'ACTIVE'"
op|','
name|'name'
op|'='
name|'name'
op|','
name|'properties'
op|'='
name|'props'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_out_nw_api_get_instance_nw_info
dedent|''
dedent|''
name|'def'
name|'stub_out_nw_api_get_instance_nw_info'
op|'('
name|'stubs'
op|','
name|'num_networks'
op|'='
number|'1'
op|','
name|'func'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'fake_network'
op|'.'
name|'stub_out_nw_api_get_instance_nw_info'
op|'('
name|'stubs'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_out_nw_api
dedent|''
name|'def'
name|'stub_out_nw_api'
op|'('
name|'stubs'
op|','
name|'cls'
op|'='
name|'None'
op|','
name|'private'
op|'='
name|'None'
op|','
name|'publics'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'if'
name|'not'
name|'private'
op|':'
newline|'\n'
indent|'        '
name|'private'
op|'='
string|"'192.168.0.3'"
newline|'\n'
dedent|''
name|'if'
name|'not'
name|'publics'
op|':'
newline|'\n'
indent|'        '
name|'publics'
op|'='
op|'['
string|"'1.2.3.4'"
op|']'
newline|'\n'
nl|'\n'
DECL|class|Fake
dedent|''
name|'class'
name|'Fake'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'        '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'skip_policy_check'
op|'='
name|'False'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'pass'
newline|'\n'
nl|'\n'
DECL|member|get_instance_nw_info
dedent|''
name|'def'
name|'get_instance_nw_info'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'pass'
newline|'\n'
nl|'\n'
DECL|member|get_floating_ips_by_fixed_address
dedent|''
name|'def'
name|'get_floating_ips_by_fixed_address'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'publics'
newline|'\n'
nl|'\n'
DECL|member|validate_networks
dedent|''
name|'def'
name|'validate_networks'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'networks'
op|','
name|'max_count'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'max_count'
newline|'\n'
nl|'\n'
DECL|member|create_pci_requests_for_sriov_ports
dedent|''
name|'def'
name|'create_pci_requests_for_sriov_ports'
op|'('
name|'self'
op|','
name|'context'
op|','
nl|'\n'
name|'system_metadata'
op|','
nl|'\n'
name|'requested_networks'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'pass'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'if'
name|'cls'
name|'is'
name|'None'
op|':'
newline|'\n'
DECL|variable|cls
indent|'        '
name|'cls'
op|'='
name|'Fake'
newline|'\n'
dedent|''
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'network_api'
op|','
string|"'API'"
op|','
name|'cls'
op|')'
newline|'\n'
name|'fake_network'
op|'.'
name|'stub_out_nw_api_get_instance_nw_info'
op|'('
name|'stubs'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|FakeToken
dedent|''
name|'class'
name|'FakeToken'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|variable|id_count
indent|'    '
name|'id_count'
op|'='
number|'0'
newline|'\n'
nl|'\n'
DECL|member|__getitem__
name|'def'
name|'__getitem__'
op|'('
name|'self'
op|','
name|'key'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'getattr'
op|'('
name|'self'
op|','
name|'key'
op|')'
newline|'\n'
nl|'\n'
DECL|member|__init__
dedent|''
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'FakeToken'
op|'.'
name|'id_count'
op|'+='
number|'1'
newline|'\n'
name|'self'
op|'.'
name|'id'
op|'='
name|'FakeToken'
op|'.'
name|'id_count'
newline|'\n'
name|'for'
name|'k'
op|','
name|'v'
name|'in'
name|'six'
op|'.'
name|'iteritems'
op|'('
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'setattr'
op|'('
name|'self'
op|','
name|'k'
op|','
name|'v'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|FakeRequestContext
dedent|''
dedent|''
dedent|''
name|'class'
name|'FakeRequestContext'
op|'('
name|'context'
op|'.'
name|'RequestContext'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'kwargs'
op|'['
string|"'auth_token'"
op|']'
op|'='
name|'kwargs'
op|'.'
name|'get'
op|'('
string|"'auth_token'"
op|','
string|"'fake_auth_token'"
op|')'
newline|'\n'
name|'super'
op|'('
name|'FakeRequestContext'
op|','
name|'self'
op|')'
op|'.'
name|'__init__'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|HTTPRequest
dedent|''
dedent|''
name|'class'
name|'HTTPRequest'
op|'('
name|'os_wsgi'
op|'.'
name|'Request'
op|')'
op|':'
newline|'\n'
nl|'\n'
indent|'    '
op|'@'
name|'staticmethod'
newline|'\n'
DECL|member|blank
name|'def'
name|'blank'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'kwargs'
op|'['
string|"'base_url'"
op|']'
op|'='
string|"'http://localhost/v2'"
newline|'\n'
name|'use_admin_context'
op|'='
name|'kwargs'
op|'.'
name|'pop'
op|'('
string|"'use_admin_context'"
op|','
name|'False'
op|')'
newline|'\n'
name|'version'
op|'='
name|'kwargs'
op|'.'
name|'pop'
op|'('
string|"'version'"
op|','
name|'os_wsgi'
op|'.'
name|'DEFAULT_API_VERSION'
op|')'
newline|'\n'
name|'out'
op|'='
name|'os_wsgi'
op|'.'
name|'Request'
op|'.'
name|'blank'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
name|'out'
op|'.'
name|'environ'
op|'['
string|"'nova.context'"
op|']'
op|'='
name|'FakeRequestContext'
op|'('
string|"'fake_user'"
op|','
string|"'fake'"
op|','
nl|'\n'
name|'is_admin'
op|'='
name|'use_admin_context'
op|')'
newline|'\n'
name|'out'
op|'.'
name|'api_version_request'
op|'='
name|'api_version'
op|'.'
name|'APIVersionRequest'
op|'('
name|'version'
op|')'
newline|'\n'
name|'return'
name|'out'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|HTTPRequestV21
dedent|''
dedent|''
name|'class'
name|'HTTPRequestV21'
op|'('
name|'os_wsgi'
op|'.'
name|'Request'
op|')'
op|':'
newline|'\n'
nl|'\n'
indent|'    '
op|'@'
name|'staticmethod'
newline|'\n'
DECL|member|blank
name|'def'
name|'blank'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'kwargs'
op|'['
string|"'base_url'"
op|']'
op|'='
string|"'http://localhost/v2'"
newline|'\n'
name|'use_admin_context'
op|'='
name|'kwargs'
op|'.'
name|'pop'
op|'('
string|"'use_admin_context'"
op|','
name|'False'
op|')'
newline|'\n'
name|'version'
op|'='
name|'kwargs'
op|'.'
name|'pop'
op|'('
string|"'version'"
op|','
name|'os_wsgi'
op|'.'
name|'DEFAULT_API_VERSION'
op|')'
newline|'\n'
name|'out'
op|'='
name|'os_wsgi'
op|'.'
name|'Request'
op|'.'
name|'blank'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
name|'out'
op|'.'
name|'api_version_request'
op|'='
name|'api_version'
op|'.'
name|'APIVersionRequest'
op|'('
name|'version'
op|')'
newline|'\n'
name|'out'
op|'.'
name|'environ'
op|'['
string|"'nova.context'"
op|']'
op|'='
name|'FakeRequestContext'
op|'('
string|"'fake_user'"
op|','
string|"'fake'"
op|','
nl|'\n'
name|'is_admin'
op|'='
name|'use_admin_context'
op|')'
newline|'\n'
name|'return'
name|'out'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TestRouter
dedent|''
dedent|''
name|'class'
name|'TestRouter'
op|'('
name|'wsgi'
op|'.'
name|'Router'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'controller'
op|','
name|'mapper'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'not'
name|'mapper'
op|':'
newline|'\n'
indent|'            '
name|'mapper'
op|'='
name|'routes'
op|'.'
name|'Mapper'
op|'('
op|')'
newline|'\n'
dedent|''
name|'mapper'
op|'.'
name|'resource'
op|'('
string|'"test"'
op|','
string|'"tests"'
op|','
nl|'\n'
name|'controller'
op|'='
name|'os_wsgi'
op|'.'
name|'Resource'
op|'('
name|'controller'
op|')'
op|')'
newline|'\n'
name|'super'
op|'('
name|'TestRouter'
op|','
name|'self'
op|')'
op|'.'
name|'__init__'
op|'('
name|'mapper'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TestRouterV21
dedent|''
dedent|''
name|'class'
name|'TestRouterV21'
op|'('
name|'wsgi'
op|'.'
name|'Router'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'controller'
op|','
name|'mapper'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'not'
name|'mapper'
op|':'
newline|'\n'
indent|'            '
name|'mapper'
op|'='
name|'routes'
op|'.'
name|'Mapper'
op|'('
op|')'
newline|'\n'
dedent|''
name|'mapper'
op|'.'
name|'resource'
op|'('
string|'"test"'
op|','
string|'"tests"'
op|','
nl|'\n'
name|'controller'
op|'='
name|'os_wsgi'
op|'.'
name|'ResourceV21'
op|'('
name|'controller'
op|')'
op|')'
newline|'\n'
name|'super'
op|'('
name|'TestRouterV21'
op|','
name|'self'
op|')'
op|'.'
name|'__init__'
op|'('
name|'mapper'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|FakeAuthDatabase
dedent|''
dedent|''
name|'class'
name|'FakeAuthDatabase'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|variable|data
indent|'    '
name|'data'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
op|'@'
name|'staticmethod'
newline|'\n'
DECL|member|auth_token_get
name|'def'
name|'auth_token_get'
op|'('
name|'context'
op|','
name|'token_hash'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'FakeAuthDatabase'
op|'.'
name|'data'
op|'.'
name|'get'
op|'('
name|'token_hash'
op|','
name|'None'
op|')'
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'staticmethod'
newline|'\n'
DECL|member|auth_token_create
name|'def'
name|'auth_token_create'
op|'('
name|'context'
op|','
name|'token'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'fake_token'
op|'='
name|'FakeToken'
op|'('
name|'created_at'
op|'='
name|'timeutils'
op|'.'
name|'utcnow'
op|'('
op|')'
op|','
op|'**'
name|'token'
op|')'
newline|'\n'
name|'FakeAuthDatabase'
op|'.'
name|'data'
op|'['
name|'fake_token'
op|'.'
name|'token_hash'
op|']'
op|'='
name|'fake_token'
newline|'\n'
name|'FakeAuthDatabase'
op|'.'
name|'data'
op|'['
string|"'id_%i'"
op|'%'
name|'fake_token'
op|'.'
name|'id'
op|']'
op|'='
name|'fake_token'
newline|'\n'
name|'return'
name|'fake_token'
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'staticmethod'
newline|'\n'
DECL|member|auth_token_destroy
name|'def'
name|'auth_token_destroy'
op|'('
name|'context'
op|','
name|'token_id'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'token'
op|'='
name|'FakeAuthDatabase'
op|'.'
name|'data'
op|'.'
name|'get'
op|'('
string|"'id_%i'"
op|'%'
name|'token_id'
op|')'
newline|'\n'
name|'if'
name|'token'
name|'and'
name|'token'
op|'.'
name|'token_hash'
name|'in'
name|'FakeAuthDatabase'
op|'.'
name|'data'
op|':'
newline|'\n'
indent|'            '
name|'del'
name|'FakeAuthDatabase'
op|'.'
name|'data'
op|'['
name|'token'
op|'.'
name|'token_hash'
op|']'
newline|'\n'
name|'del'
name|'FakeAuthDatabase'
op|'.'
name|'data'
op|'['
string|"'id_%i'"
op|'%'
name|'token_id'
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|create_info_cache
dedent|''
dedent|''
dedent|''
name|'def'
name|'create_info_cache'
op|'('
name|'nw_cache'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'if'
name|'nw_cache'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'        '
name|'pub0'
op|'='
op|'('
string|"'192.168.1.100'"
op|','
op|')'
newline|'\n'
name|'pub1'
op|'='
op|'('
string|"'2001:db8:0:1::1'"
op|','
op|')'
newline|'\n'
nl|'\n'
DECL|function|_ip
name|'def'
name|'_ip'
op|'('
name|'ip'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
op|'{'
string|"'address'"
op|':'
name|'ip'
op|','
string|"'type'"
op|':'
string|"'fixed'"
op|'}'
newline|'\n'
nl|'\n'
dedent|''
name|'nw_cache'
op|'='
op|'['
nl|'\n'
op|'{'
string|"'address'"
op|':'
string|"'aa:aa:aa:aa:aa:aa'"
op|','
nl|'\n'
string|"'id'"
op|':'
number|'1'
op|','
nl|'\n'
string|"'network'"
op|':'
op|'{'
string|"'bridge'"
op|':'
string|"'br0'"
op|','
nl|'\n'
string|"'id'"
op|':'
number|'1'
op|','
nl|'\n'
string|"'label'"
op|':'
string|"'test1'"
op|','
nl|'\n'
string|"'subnets'"
op|':'
op|'['
op|'{'
string|"'cidr'"
op|':'
string|"'192.168.1.0/24'"
op|','
nl|'\n'
string|"'ips'"
op|':'
op|'['
name|'_ip'
op|'('
name|'ip'
op|')'
name|'for'
name|'ip'
name|'in'
name|'pub0'
op|']'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'cidr'"
op|':'
string|"'b33f::/64'"
op|','
nl|'\n'
string|"'ips'"
op|':'
op|'['
name|'_ip'
op|'('
name|'ip'
op|')'
name|'for'
name|'ip'
name|'in'
name|'pub1'
op|']'
op|'}'
op|']'
op|'}'
op|'}'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'not'
name|'isinstance'
op|'('
name|'nw_cache'
op|','
name|'six'
op|'.'
name|'string_types'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'nw_cache'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'nw_cache'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'return'
op|'{'
nl|'\n'
string|'"info_cache"'
op|':'
op|'{'
nl|'\n'
string|'"network_info"'
op|':'
name|'nw_cache'
op|','
nl|'\n'
string|'"deleted"'
op|':'
name|'False'
op|','
nl|'\n'
string|'"created_at"'
op|':'
name|'None'
op|','
nl|'\n'
string|'"deleted_at"'
op|':'
name|'None'
op|','
nl|'\n'
string|'"updated_at"'
op|':'
name|'None'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|get_fake_uuid
dedent|''
name|'def'
name|'get_fake_uuid'
op|'('
name|'token'
op|'='
number|'0'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'if'
name|'token'
name|'not'
name|'in'
name|'FAKE_UUIDS'
op|':'
newline|'\n'
indent|'        '
name|'FAKE_UUIDS'
op|'['
name|'token'
op|']'
op|'='
name|'str'
op|'('
name|'uuid'
op|'.'
name|'uuid4'
op|'('
op|')'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'FAKE_UUIDS'
op|'['
name|'token'
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|fake_instance_get
dedent|''
name|'def'
name|'fake_instance_get'
op|'('
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
DECL|function|_return_server
indent|'    '
name|'def'
name|'_return_server'
op|'('
name|'context'
op|','
name|'uuid'
op|','
name|'columns_to_join'
op|'='
name|'None'
op|','
name|'use_slave'
op|'='
name|'False'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'stub_instance'
op|'('
number|'1'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'_return_server'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|fake_compute_get
dedent|''
name|'def'
name|'fake_compute_get'
op|'('
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
DECL|function|_return_server_obj
indent|'    '
name|'def'
name|'_return_server_obj'
op|'('
name|'context'
op|','
name|'uuid'
op|','
name|'want_objects'
op|'='
name|'False'
op|','
nl|'\n'
name|'expected_attrs'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'stub_instance_obj'
op|'('
name|'context'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'_return_server_obj'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|fake_actions_to_locked_server
dedent|''
name|'def'
name|'fake_actions_to_locked_server'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'instance'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'raise'
name|'exc'
op|'.'
name|'InstanceIsLocked'
op|'('
name|'instance_uuid'
op|'='
name|'instance'
op|'['
string|"'uuid'"
op|']'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|fake_instance_get_all_by_filters
dedent|''
name|'def'
name|'fake_instance_get_all_by_filters'
op|'('
name|'num_servers'
op|'='
number|'5'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
DECL|function|_return_servers
indent|'    '
name|'def'
name|'_return_servers'
op|'('
name|'context'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'servers_list'
op|'='
op|'['
op|']'
newline|'\n'
name|'marker'
op|'='
name|'None'
newline|'\n'
name|'limit'
op|'='
name|'None'
newline|'\n'
name|'found_marker'
op|'='
name|'False'
newline|'\n'
name|'if'
string|'"marker"'
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'            '
name|'marker'
op|'='
name|'kwargs'
op|'['
string|'"marker"'
op|']'
newline|'\n'
dedent|''
name|'if'
string|'"limit"'
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'            '
name|'limit'
op|'='
name|'kwargs'
op|'['
string|'"limit"'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
string|"'columns_to_join'"
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'            '
name|'kwargs'
op|'.'
name|'pop'
op|'('
string|"'columns_to_join'"
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
string|"'use_slave'"
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'            '
name|'kwargs'
op|'.'
name|'pop'
op|'('
string|"'use_slave'"
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
string|"'sort_keys'"
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'            '
name|'kwargs'
op|'.'
name|'pop'
op|'('
string|"'sort_keys'"
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
string|"'sort_dirs'"
name|'in'
name|'kwargs'
op|':'
newline|'\n'
indent|'            '
name|'kwargs'
op|'.'
name|'pop'
op|'('
string|"'sort_dirs'"
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'for'
name|'i'
name|'in'
name|'range'
op|'('
name|'num_servers'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'uuid'
op|'='
name|'get_fake_uuid'
op|'('
name|'i'
op|')'
newline|'\n'
name|'server'
op|'='
name|'stub_instance'
op|'('
name|'id'
op|'='
name|'i'
op|'+'
number|'1'
op|','
name|'uuid'
op|'='
name|'uuid'
op|','
nl|'\n'
op|'**'
name|'kwargs'
op|')'
newline|'\n'
name|'servers_list'
op|'.'
name|'append'
op|'('
name|'server'
op|')'
newline|'\n'
name|'if'
name|'marker'
name|'is'
name|'not'
name|'None'
name|'and'
name|'uuid'
op|'=='
name|'marker'
op|':'
newline|'\n'
indent|'                '
name|'found_marker'
op|'='
name|'True'
newline|'\n'
name|'servers_list'
op|'='
op|'['
op|']'
newline|'\n'
dedent|''
dedent|''
name|'if'
name|'marker'
name|'is'
name|'not'
name|'None'
name|'and'
name|'not'
name|'found_marker'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'exc'
op|'.'
name|'MarkerNotFound'
op|'('
name|'marker'
op|'='
name|'marker'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'limit'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'servers_list'
op|'='
name|'servers_list'
op|'['
op|':'
name|'limit'
op|']'
newline|'\n'
dedent|''
name|'return'
name|'servers_list'
newline|'\n'
dedent|''
name|'return'
name|'_return_servers'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|fake_compute_get_all
dedent|''
name|'def'
name|'fake_compute_get_all'
op|'('
name|'num_servers'
op|'='
number|'5'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
DECL|function|_return_servers_objs
indent|'    '
name|'def'
name|'_return_servers_objs'
op|'('
name|'context'
op|','
name|'search_opts'
op|'='
name|'None'
op|','
name|'limit'
op|'='
name|'None'
op|','
nl|'\n'
name|'marker'
op|'='
name|'None'
op|','
name|'want_objects'
op|'='
name|'False'
op|','
nl|'\n'
name|'expected_attrs'
op|'='
name|'None'
op|','
name|'sort_keys'
op|'='
name|'None'
op|','
nl|'\n'
name|'sort_dirs'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'db_insts'
op|'='
name|'fake_instance_get_all_by_filters'
op|'('
op|')'
op|'('
name|'None'
op|','
nl|'\n'
name|'limit'
op|'='
name|'limit'
op|','
nl|'\n'
name|'marker'
op|'='
name|'marker'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'['
string|"'metadata'"
op|','
string|"'system_metadata'"
op|','
string|"'flavor'"
op|','
nl|'\n'
string|"'info_cache'"
op|','
string|"'security_groups'"
op|']'
newline|'\n'
name|'return'
name|'base'
op|'.'
name|'obj_make_list'
op|'('
name|'context'
op|','
name|'objects'
op|'.'
name|'InstanceList'
op|'('
op|')'
op|','
nl|'\n'
name|'objects'
op|'.'
name|'Instance'
op|','
name|'db_insts'
op|','
nl|'\n'
name|'expected_attrs'
op|'='
name|'expected'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'_return_servers_objs'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_instance
dedent|''
name|'def'
name|'stub_instance'
op|'('
name|'id'
op|'='
number|'1'
op|','
name|'user_id'
op|'='
name|'None'
op|','
name|'project_id'
op|'='
name|'None'
op|','
name|'host'
op|'='
name|'None'
op|','
nl|'\n'
name|'node'
op|'='
name|'None'
op|','
name|'vm_state'
op|'='
name|'None'
op|','
name|'task_state'
op|'='
name|'None'
op|','
nl|'\n'
name|'reservation_id'
op|'='
string|'""'
op|','
name|'uuid'
op|'='
name|'FAKE_UUID'
op|','
name|'image_ref'
op|'='
string|'"10"'
op|','
nl|'\n'
name|'flavor_id'
op|'='
string|'"1"'
op|','
name|'name'
op|'='
name|'None'
op|','
name|'key_name'
op|'='
string|"''"
op|','
nl|'\n'
name|'access_ipv4'
op|'='
name|'None'
op|','
name|'access_ipv6'
op|'='
name|'None'
op|','
name|'progress'
op|'='
number|'0'
op|','
nl|'\n'
name|'auto_disk_config'
op|'='
name|'False'
op|','
name|'display_name'
op|'='
name|'None'
op|','
nl|'\n'
name|'include_fake_metadata'
op|'='
name|'True'
op|','
name|'config_drive'
op|'='
name|'None'
op|','
nl|'\n'
name|'power_state'
op|'='
name|'None'
op|','
name|'nw_cache'
op|'='
name|'None'
op|','
name|'metadata'
op|'='
name|'None'
op|','
nl|'\n'
name|'security_groups'
op|'='
name|'None'
op|','
name|'root_device_name'
op|'='
name|'None'
op|','
nl|'\n'
name|'limit'
op|'='
name|'None'
op|','
name|'marker'
op|'='
name|'None'
op|','
nl|'\n'
name|'launched_at'
op|'='
name|'timeutils'
op|'.'
name|'utcnow'
op|'('
op|')'
op|','
nl|'\n'
name|'terminated_at'
op|'='
name|'timeutils'
op|'.'
name|'utcnow'
op|'('
op|')'
op|','
nl|'\n'
name|'availability_zone'
op|'='
string|"''"
op|','
name|'locked_by'
op|'='
name|'None'
op|','
name|'cleaned'
op|'='
name|'False'
op|','
nl|'\n'
name|'memory_mb'
op|'='
number|'0'
op|','
name|'vcpus'
op|'='
number|'0'
op|','
name|'root_gb'
op|'='
number|'0'
op|','
name|'ephemeral_gb'
op|'='
number|'0'
op|','
nl|'\n'
name|'instance_type'
op|'='
name|'None'
op|','
name|'launch_index'
op|'='
number|'0'
op|','
name|'kernel_id'
op|'='
string|'""'
op|','
nl|'\n'
name|'ramdisk_id'
op|'='
string|'""'
op|','
name|'user_data'
op|'='
name|'None'
op|','
name|'system_metadata'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'if'
name|'user_id'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'        '
name|'user_id'
op|'='
string|"'fake_user'"
newline|'\n'
dedent|''
name|'if'
name|'project_id'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'        '
name|'project_id'
op|'='
string|"'fake_project'"
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'metadata'
op|':'
newline|'\n'
indent|'        '
name|'metadata'
op|'='
op|'['
op|'{'
string|"'key'"
op|':'
name|'k'
op|','
string|"'value'"
op|':'
name|'v'
op|'}'
name|'for'
name|'k'
op|','
name|'v'
name|'in'
name|'metadata'
op|'.'
name|'items'
op|'('
op|')'
op|']'
newline|'\n'
dedent|''
name|'elif'
name|'include_fake_metadata'
op|':'
newline|'\n'
indent|'        '
name|'metadata'
op|'='
op|'['
name|'models'
op|'.'
name|'InstanceMetadata'
op|'('
name|'key'
op|'='
string|"'seq'"
op|','
name|'value'
op|'='
name|'str'
op|'('
name|'id'
op|')'
op|')'
op|']'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'        '
name|'metadata'
op|'='
op|'['
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'inst_type'
op|'='
name|'flavors'
op|'.'
name|'get_flavor_by_flavor_id'
op|'('
name|'int'
op|'('
name|'flavor_id'
op|')'
op|')'
newline|'\n'
name|'sys_meta'
op|'='
name|'flavors'
op|'.'
name|'save_flavor_info'
op|'('
op|'{'
op|'}'
op|','
name|'inst_type'
op|')'
newline|'\n'
name|'sys_meta'
op|'.'
name|'update'
op|'('
name|'system_metadata'
name|'or'
op|'{'
op|'}'
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'host'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'        '
name|'host'
op|'='
name|'str'
op|'('
name|'host'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'key_name'
op|':'
newline|'\n'
indent|'        '
name|'key_data'
op|'='
string|"'FAKE'"
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'        '
name|'key_data'
op|'='
string|"''"
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'security_groups'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'        '
name|'security_groups'
op|'='
op|'['
op|'{'
string|'"id"'
op|':'
number|'1'
op|','
string|'"name"'
op|':'
string|'"test"'
op|','
string|'"description"'
op|':'
string|'"Foo:"'
op|','
nl|'\n'
string|'"project_id"'
op|':'
string|'"project"'
op|','
string|'"user_id"'
op|':'
string|'"user"'
op|','
nl|'\n'
string|'"created_at"'
op|':'
name|'None'
op|','
string|'"updated_at"'
op|':'
name|'None'
op|','
nl|'\n'
string|'"deleted_at"'
op|':'
name|'None'
op|','
string|'"deleted"'
op|':'
name|'False'
op|'}'
op|']'
newline|'\n'
nl|'\n'
comment|"# ReservationID isn't sent back, hack it in there."
nl|'\n'
dedent|''
name|'server_name'
op|'='
name|'name'
name|'or'
string|'"server%s"'
op|'%'
name|'id'
newline|'\n'
name|'if'
name|'reservation_id'
op|'!='
string|'""'
op|':'
newline|'\n'
indent|'        '
name|'server_name'
op|'='
string|'"reservation_%s"'
op|'%'
op|'('
name|'reservation_id'
op|','
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'info_cache'
op|'='
name|'create_info_cache'
op|'('
name|'nw_cache'
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'instance_type'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'        '
name|'instance_type'
op|'='
name|'flavors'
op|'.'
name|'get_default_flavor'
op|'('
op|')'
newline|'\n'
dedent|''
name|'flavorinfo'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
op|'{'
nl|'\n'
string|"'cur'"
op|':'
name|'instance_type'
op|'.'
name|'obj_to_primitive'
op|'('
op|')'
op|','
nl|'\n'
string|"'old'"
op|':'
name|'None'
op|','
nl|'\n'
string|"'new'"
op|':'
name|'None'
op|','
nl|'\n'
op|'}'
op|')'
newline|'\n'
nl|'\n'
name|'instance'
op|'='
op|'{'
nl|'\n'
string|'"id"'
op|':'
name|'int'
op|'('
name|'id'
op|')'
op|','
nl|'\n'
string|'"created_at"'
op|':'
name|'datetime'
op|'.'
name|'datetime'
op|'('
number|'2010'
op|','
number|'10'
op|','
number|'10'
op|','
number|'12'
op|','
number|'0'
op|','
number|'0'
op|')'
op|','
nl|'\n'
string|'"updated_at"'
op|':'
name|'datetime'
op|'.'
name|'datetime'
op|'('
number|'2010'
op|','
number|'11'
op|','
number|'11'
op|','
number|'11'
op|','
number|'0'
op|','
number|'0'
op|')'
op|','
nl|'\n'
string|'"deleted_at"'
op|':'
name|'datetime'
op|'.'
name|'datetime'
op|'('
number|'2010'
op|','
number|'12'
op|','
number|'12'
op|','
number|'10'
op|','
number|'0'
op|','
number|'0'
op|')'
op|','
nl|'\n'
string|'"deleted"'
op|':'
name|'None'
op|','
nl|'\n'
string|'"user_id"'
op|':'
name|'user_id'
op|','
nl|'\n'
string|'"project_id"'
op|':'
name|'project_id'
op|','
nl|'\n'
string|'"image_ref"'
op|':'
name|'image_ref'
op|','
nl|'\n'
string|'"kernel_id"'
op|':'
name|'kernel_id'
op|','
nl|'\n'
string|'"ramdisk_id"'
op|':'
name|'ramdisk_id'
op|','
nl|'\n'
string|'"launch_index"'
op|':'
name|'launch_index'
op|','
nl|'\n'
string|'"key_name"'
op|':'
name|'key_name'
op|','
nl|'\n'
string|'"key_data"'
op|':'
name|'key_data'
op|','
nl|'\n'
string|'"config_drive"'
op|':'
name|'config_drive'
op|','
nl|'\n'
string|'"vm_state"'
op|':'
name|'vm_state'
name|'or'
name|'vm_states'
op|'.'
name|'BUILDING'
op|','
nl|'\n'
string|'"task_state"'
op|':'
name|'task_state'
op|','
nl|'\n'
string|'"power_state"'
op|':'
name|'power_state'
op|','
nl|'\n'
string|'"memory_mb"'
op|':'
name|'memory_mb'
op|','
nl|'\n'
string|'"vcpus"'
op|':'
name|'vcpus'
op|','
nl|'\n'
string|'"root_gb"'
op|':'
name|'root_gb'
op|','
nl|'\n'
string|'"ephemeral_gb"'
op|':'
name|'ephemeral_gb'
op|','
nl|'\n'
string|'"ephemeral_key_uuid"'
op|':'
name|'None'
op|','
nl|'\n'
string|'"hostname"'
op|':'
name|'display_name'
name|'or'
name|'server_name'
op|','
nl|'\n'
string|'"host"'
op|':'
name|'host'
op|','
nl|'\n'
string|'"node"'
op|':'
name|'node'
op|','
nl|'\n'
string|'"instance_type_id"'
op|':'
number|'1'
op|','
nl|'\n'
string|'"instance_type"'
op|':'
name|'inst_type'
op|','
nl|'\n'
string|'"user_data"'
op|':'
name|'user_data'
op|','
nl|'\n'
string|'"reservation_id"'
op|':'
name|'reservation_id'
op|','
nl|'\n'
string|'"mac_address"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"launched_at"'
op|':'
name|'launched_at'
op|','
nl|'\n'
string|'"terminated_at"'
op|':'
name|'terminated_at'
op|','
nl|'\n'
string|'"availability_zone"'
op|':'
name|'availability_zone'
op|','
nl|'\n'
string|'"display_name"'
op|':'
name|'display_name'
name|'or'
name|'server_name'
op|','
nl|'\n'
string|'"display_description"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"locked"'
op|':'
name|'locked_by'
name|'is'
name|'not'
name|'None'
op|','
nl|'\n'
string|'"locked_by"'
op|':'
name|'locked_by'
op|','
nl|'\n'
string|'"metadata"'
op|':'
name|'metadata'
op|','
nl|'\n'
string|'"access_ip_v4"'
op|':'
name|'access_ipv4'
op|','
nl|'\n'
string|'"access_ip_v6"'
op|':'
name|'access_ipv6'
op|','
nl|'\n'
string|'"uuid"'
op|':'
name|'uuid'
op|','
nl|'\n'
string|'"progress"'
op|':'
name|'progress'
op|','
nl|'\n'
string|'"auto_disk_config"'
op|':'
name|'auto_disk_config'
op|','
nl|'\n'
string|'"name"'
op|':'
string|'"instance-%s"'
op|'%'
name|'id'
op|','
nl|'\n'
string|'"shutdown_terminate"'
op|':'
name|'True'
op|','
nl|'\n'
string|'"disable_terminate"'
op|':'
name|'False'
op|','
nl|'\n'
string|'"security_groups"'
op|':'
name|'security_groups'
op|','
nl|'\n'
string|'"root_device_name"'
op|':'
name|'root_device_name'
op|','
nl|'\n'
string|'"system_metadata"'
op|':'
name|'utils'
op|'.'
name|'dict_to_metadata'
op|'('
name|'sys_meta'
op|')'
op|','
nl|'\n'
string|'"pci_devices"'
op|':'
op|'['
op|']'
op|','
nl|'\n'
string|'"vm_mode"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"default_swap_device"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"default_ephemeral_device"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"launched_on"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"cell_name"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"architecture"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"os_type"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"extra"'
op|':'
op|'{'
string|'"numa_topology"'
op|':'
name|'None'
op|','
nl|'\n'
string|'"pci_requests"'
op|':'
name|'None'
op|','
nl|'\n'
string|'"flavor"'
op|':'
name|'flavorinfo'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"cleaned"'
op|':'
name|'cleaned'
op|'}'
newline|'\n'
nl|'\n'
name|'instance'
op|'.'
name|'update'
op|'('
name|'info_cache'
op|')'
newline|'\n'
name|'instance'
op|'['
string|"'info_cache'"
op|']'
op|'['
string|"'instance_uuid'"
op|']'
op|'='
name|'instance'
op|'['
string|"'uuid'"
op|']'
newline|'\n'
nl|'\n'
name|'return'
name|'instance'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_instance_obj
dedent|''
name|'def'
name|'stub_instance_obj'
op|'('
name|'ctxt'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'db_inst'
op|'='
name|'stub_instance'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'['
string|"'metadata'"
op|','
string|"'system_metadata'"
op|','
string|"'flavor'"
op|','
nl|'\n'
string|"'info_cache'"
op|','
string|"'security_groups'"
op|']'
newline|'\n'
name|'inst'
op|'='
name|'objects'
op|'.'
name|'Instance'
op|'.'
name|'_from_db_object'
op|'('
name|'ctxt'
op|','
name|'objects'
op|'.'
name|'Instance'
op|'('
op|')'
op|','
nl|'\n'
name|'db_inst'
op|','
nl|'\n'
name|'expected_attrs'
op|'='
name|'expected'
op|')'
newline|'\n'
name|'inst'
op|'.'
name|'fault'
op|'='
name|'None'
newline|'\n'
name|'return'
name|'inst'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_volume
dedent|''
name|'def'
name|'stub_volume'
op|'('
name|'id'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'volume'
op|'='
op|'{'
nl|'\n'
string|"'id'"
op|':'
name|'id'
op|','
nl|'\n'
string|"'user_id'"
op|':'
string|"'fakeuser'"
op|','
nl|'\n'
string|"'project_id'"
op|':'
string|"'fakeproject'"
op|','
nl|'\n'
string|"'host'"
op|':'
string|"'fakehost'"
op|','
nl|'\n'
string|"'size'"
op|':'
number|'1'
op|','
nl|'\n'
string|"'availability_zone'"
op|':'
string|"'fakeaz'"
op|','
nl|'\n'
string|"'instance_uuid'"
op|':'
string|"'fakeuuid'"
op|','
nl|'\n'
string|"'mountpoint'"
op|':'
string|"'/'"
op|','
nl|'\n'
string|"'status'"
op|':'
string|"'fakestatus'"
op|','
nl|'\n'
string|"'attach_status'"
op|':'
string|"'attached'"
op|','
nl|'\n'
string|"'name'"
op|':'
string|"'vol name'"
op|','
nl|'\n'
string|"'display_name'"
op|':'
string|"'displayname'"
op|','
nl|'\n'
string|"'display_description'"
op|':'
string|"'displaydesc'"
op|','
nl|'\n'
string|"'created_at'"
op|':'
name|'datetime'
op|'.'
name|'datetime'
op|'('
number|'1999'
op|','
number|'1'
op|','
number|'1'
op|','
number|'1'
op|','
number|'1'
op|','
number|'1'
op|')'
op|','
nl|'\n'
string|"'snapshot_id'"
op|':'
name|'None'
op|','
nl|'\n'
string|"'volume_type_id'"
op|':'
string|"'fakevoltype'"
op|','
nl|'\n'
string|"'volume_metadata'"
op|':'
op|'['
op|']'
op|','
nl|'\n'
string|"'volume_type'"
op|':'
op|'{'
string|"'name'"
op|':'
string|"'vol_type_name'"
op|'}'
op|'}'
newline|'\n'
nl|'\n'
name|'volume'
op|'.'
name|'update'
op|'('
name|'kwargs'
op|')'
newline|'\n'
name|'return'
name|'volume'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_volume_create
dedent|''
name|'def'
name|'stub_volume_create'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'size'
op|','
name|'name'
op|','
name|'description'
op|','
name|'snapshot'
op|','
nl|'\n'
op|'**'
name|'param'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'vol'
op|'='
name|'stub_volume'
op|'('
string|"'1'"
op|')'
newline|'\n'
name|'vol'
op|'['
string|"'size'"
op|']'
op|'='
name|'size'
newline|'\n'
name|'vol'
op|'['
string|"'display_name'"
op|']'
op|'='
name|'name'
newline|'\n'
name|'vol'
op|'['
string|"'display_description'"
op|']'
op|'='
name|'description'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'        '
name|'vol'
op|'['
string|"'snapshot_id'"
op|']'
op|'='
name|'snapshot'
op|'['
string|"'id'"
op|']'
newline|'\n'
dedent|''
name|'except'
op|'('
name|'KeyError'
op|','
name|'TypeError'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'vol'
op|'['
string|"'snapshot_id'"
op|']'
op|'='
name|'None'
newline|'\n'
dedent|''
name|'vol'
op|'['
string|"'availability_zone'"
op|']'
op|'='
name|'param'
op|'.'
name|'get'
op|'('
string|"'availability_zone'"
op|','
string|"'fakeaz'"
op|')'
newline|'\n'
name|'return'
name|'vol'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_volume_update
dedent|''
name|'def'
name|'stub_volume_update'
op|'('
name|'self'
op|','
name|'context'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'param'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'pass'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_volume_delete
dedent|''
name|'def'
name|'stub_volume_delete'
op|'('
name|'self'
op|','
name|'context'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'param'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'pass'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_volume_get
dedent|''
name|'def'
name|'stub_volume_get'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'volume_id'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'return'
name|'stub_volume'
op|'('
name|'volume_id'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_volume_notfound
dedent|''
name|'def'
name|'stub_volume_notfound'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'volume_id'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'raise'
name|'exc'
op|'.'
name|'VolumeNotFound'
op|'('
name|'volume_id'
op|'='
name|'volume_id'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_volume_get_all
dedent|''
name|'def'
name|'stub_volume_get_all'
op|'('
name|'context'
op|','
name|'search_opts'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'return'
op|'['
name|'stub_volume'
op|'('
number|'100'
op|','
name|'project_id'
op|'='
string|"'fake'"
op|')'
op|','
nl|'\n'
name|'stub_volume'
op|'('
number|'101'
op|','
name|'project_id'
op|'='
string|"'superfake'"
op|')'
op|','
nl|'\n'
name|'stub_volume'
op|'('
number|'102'
op|','
name|'project_id'
op|'='
string|"'superduperfake'"
op|')'
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_volume_check_attach
dedent|''
name|'def'
name|'stub_volume_check_attach'
op|'('
name|'self'
op|','
name|'context'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'param'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'pass'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_snapshot
dedent|''
name|'def'
name|'stub_snapshot'
op|'('
name|'id'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'snapshot'
op|'='
op|'{'
nl|'\n'
string|"'id'"
op|':'
name|'id'
op|','
nl|'\n'
string|"'volume_id'"
op|':'
number|'12'
op|','
nl|'\n'
string|"'status'"
op|':'
string|"'available'"
op|','
nl|'\n'
string|"'volume_size'"
op|':'
number|'100'
op|','
nl|'\n'
string|"'created_at'"
op|':'
name|'timeutils'
op|'.'
name|'utcnow'
op|'('
op|')'
op|','
nl|'\n'
string|"'display_name'"
op|':'
string|"'Default name'"
op|','
nl|'\n'
string|"'display_description'"
op|':'
string|"'Default description'"
op|','
nl|'\n'
string|"'project_id'"
op|':'
string|"'fake'"
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'snapshot'
op|'.'
name|'update'
op|'('
name|'kwargs'
op|')'
newline|'\n'
name|'return'
name|'snapshot'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_snapshot_create
dedent|''
name|'def'
name|'stub_snapshot_create'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'volume_id'
op|','
name|'name'
op|','
name|'description'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'return'
name|'stub_snapshot'
op|'('
number|'100'
op|','
name|'volume_id'
op|'='
name|'volume_id'
op|','
name|'display_name'
op|'='
name|'name'
op|','
nl|'\n'
name|'display_description'
op|'='
name|'description'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_compute_volume_snapshot_create
dedent|''
name|'def'
name|'stub_compute_volume_snapshot_create'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'volume_id'
op|','
name|'create_info'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'return'
op|'{'
string|"'snapshot'"
op|':'
op|'{'
string|"'id'"
op|':'
number|'100'
op|','
string|"'volumeId'"
op|':'
name|'volume_id'
op|'}'
op|'}'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_snapshot_delete
dedent|''
name|'def'
name|'stub_snapshot_delete'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'snapshot_id'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'if'
name|'snapshot_id'
op|'=='
string|"'-1'"
op|':'
newline|'\n'
indent|'        '
name|'raise'
name|'exc'
op|'.'
name|'SnapshotNotFound'
op|'('
name|'snapshot_id'
op|'='
name|'snapshot_id'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_compute_volume_snapshot_delete
dedent|''
dedent|''
name|'def'
name|'stub_compute_volume_snapshot_delete'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'volume_id'
op|','
name|'snapshot_id'
op|','
nl|'\n'
name|'delete_info'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'pass'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_snapshot_get
dedent|''
name|'def'
name|'stub_snapshot_get'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'snapshot_id'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'if'
name|'snapshot_id'
op|'=='
string|"'-1'"
op|':'
newline|'\n'
indent|'        '
name|'raise'
name|'exc'
op|'.'
name|'SnapshotNotFound'
op|'('
name|'snapshot_id'
op|'='
name|'snapshot_id'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'stub_snapshot'
op|'('
name|'snapshot_id'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_snapshot_get_all
dedent|''
name|'def'
name|'stub_snapshot_get_all'
op|'('
name|'self'
op|','
name|'context'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'return'
op|'['
name|'stub_snapshot'
op|'('
number|'100'
op|','
name|'project_id'
op|'='
string|"'fake'"
op|')'
op|','
nl|'\n'
name|'stub_snapshot'
op|'('
number|'101'
op|','
name|'project_id'
op|'='
string|"'superfake'"
op|')'
op|','
nl|'\n'
name|'stub_snapshot'
op|'('
number|'102'
op|','
name|'project_id'
op|'='
string|"'superduperfake'"
op|')'
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_bdm_get_all_by_instance
dedent|''
name|'def'
name|'stub_bdm_get_all_by_instance'
op|'('
name|'context'
op|','
name|'instance_uuid'
op|','
name|'use_slave'
op|'='
name|'False'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'return'
op|'['
name|'fake_block_device'
op|'.'
name|'FakeDbBlockDeviceDict'
op|'('
nl|'\n'
op|'{'
string|"'id'"
op|':'
number|'1'
op|','
string|"'source_type'"
op|':'
string|"'volume'"
op|','
string|"'destination_type'"
op|':'
string|"'volume'"
op|','
nl|'\n'
string|"'volume_id'"
op|':'
string|"'volume_id1'"
op|','
string|"'instance_uuid'"
op|':'
name|'instance_uuid'
op|'}'
op|')'
op|','
nl|'\n'
name|'fake_block_device'
op|'.'
name|'FakeDbBlockDeviceDict'
op|'('
nl|'\n'
op|'{'
string|"'id'"
op|':'
number|'2'
op|','
string|"'source_type'"
op|':'
string|"'volume'"
op|','
string|"'destination_type'"
op|':'
string|"'volume'"
op|','
nl|'\n'
string|"'volume_id'"
op|':'
string|"'volume_id2'"
op|','
string|"'instance_uuid'"
op|':'
name|'instance_uuid'
op|'}'
op|')'
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|fake_get_available_languages
dedent|''
name|'def'
name|'fake_get_available_languages'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
name|'existing_translations'
op|'='
op|'['
string|"'en_GB'"
op|','
string|"'en_AU'"
op|','
string|"'de'"
op|','
string|"'zh_CN'"
op|','
string|"'en_US'"
op|']'
newline|'\n'
name|'return'
name|'existing_translations'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|fake_not_implemented
dedent|''
name|'def'
name|'fake_not_implemented'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'raise'
name|'NotImplementedError'
op|'('
op|')'
newline|'\n'
dedent|''
endmarker|''
end_unit
