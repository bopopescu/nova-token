begin_unit
comment|'# vim: tabstop=4 shiftwidth=4 softtabstop=4'
nl|'\n'
nl|'\n'
comment|'# Copyright 2010-2011 OpenStack LLC.'
nl|'\n'
comment|'# Copyright 2011 Piston Cloud Computing, Inc.'
nl|'\n'
comment|'# All Rights Reserved.'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#    Licensed under the Apache License, Version 2.0 (the "License"); you may'
nl|'\n'
comment|'#    not use this file except in compliance with the License. You may obtain'
nl|'\n'
comment|'#    a copy of the License at'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#         http://www.apache.org/licenses/LICENSE-2.0'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#    Unless required by applicable law or agreed to in writing, software'
nl|'\n'
comment|'#    distributed under the License is distributed on an "AS IS" BASIS, WITHOUT'
nl|'\n'
comment|'#    WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the'
nl|'\n'
comment|'#    License for the specific language governing permissions and limitations'
nl|'\n'
comment|'#    under the License.'
nl|'\n'
nl|'\n'
name|'import'
name|'datetime'
newline|'\n'
name|'import'
name|'urlparse'
newline|'\n'
nl|'\n'
name|'import'
name|'iso8601'
newline|'\n'
name|'from'
name|'lxml'
name|'import'
name|'etree'
newline|'\n'
name|'import'
name|'webob'
newline|'\n'
nl|'\n'
name|'import'
name|'nova'
op|'.'
name|'api'
op|'.'
name|'openstack'
op|'.'
name|'compute'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'api'
op|'.'
name|'openstack'
op|'.'
name|'compute'
name|'import'
name|'ips'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'api'
op|'.'
name|'openstack'
op|'.'
name|'compute'
name|'import'
name|'servers'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'api'
op|'.'
name|'openstack'
op|'.'
name|'compute'
name|'import'
name|'views'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'api'
op|'.'
name|'openstack'
name|'import'
name|'extensions'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'api'
op|'.'
name|'openstack'
name|'import'
name|'xmlutil'
newline|'\n'
name|'import'
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'api'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'compute'
name|'import'
name|'instance_types'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'compute'
name|'import'
name|'task_states'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'compute'
name|'import'
name|'vm_states'
newline|'\n'
name|'import'
name|'nova'
op|'.'
name|'db'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'db'
op|'.'
name|'sqlalchemy'
name|'import'
name|'models'
newline|'\n'
name|'from'
name|'nova'
name|'import'
name|'flags'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'openstack'
op|'.'
name|'common'
name|'import'
name|'jsonutils'
newline|'\n'
name|'import'
name|'nova'
op|'.'
name|'openstack'
op|'.'
name|'common'
op|'.'
name|'rpc'
newline|'\n'
name|'from'
name|'nova'
name|'import'
name|'test'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'tests'
op|'.'
name|'api'
op|'.'
name|'openstack'
name|'import'
name|'fakes'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'tests'
name|'import'
name|'fake_network'
newline|'\n'
name|'import'
name|'nova'
op|'.'
name|'tests'
op|'.'
name|'image'
op|'.'
name|'fake'
newline|'\n'
name|'from'
name|'nova'
name|'import'
name|'utils'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|variable|FLAGS
name|'FLAGS'
op|'='
name|'flags'
op|'.'
name|'FLAGS'
newline|'\n'
DECL|variable|FAKE_UUID
name|'FAKE_UUID'
op|'='
name|'fakes'
op|'.'
name|'FAKE_UUID'
newline|'\n'
DECL|variable|NS
name|'NS'
op|'='
string|'"{http://docs.openstack.org/compute/api/v1.1}"'
newline|'\n'
DECL|variable|ATOMNS
name|'ATOMNS'
op|'='
string|'"{http://www.w3.org/2005/Atom}"'
newline|'\n'
DECL|variable|XPATH_NS
name|'XPATH_NS'
op|'='
op|'{'
nl|'\n'
string|"'atom'"
op|':'
string|"'http://www.w3.org/2005/Atom'"
op|','
nl|'\n'
string|"'ns'"
op|':'
string|"'http://docs.openstack.org/compute/api/v1.1'"
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
DECL|variable|INSTANCE_IDS
name|'INSTANCE_IDS'
op|'='
op|'{'
name|'FAKE_UUID'
op|':'
number|'1'
op|'}'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|fake_gen_uuid
name|'def'
name|'fake_gen_uuid'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
name|'return'
name|'FAKE_UUID'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|return_servers_by_reservation
dedent|''
name|'def'
name|'return_servers_by_reservation'
op|'('
name|'context'
op|','
name|'reservation_id'
op|'='
string|'""'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'return'
op|'['
name|'fakes'
op|'.'
name|'stub_instance'
op|'('
name|'i'
op|'+'
number|'1'
op|','
nl|'\n'
name|'reservation_id'
op|'='
name|'reservation_id'
op|')'
name|'for'
name|'i'
name|'in'
name|'xrange'
op|'('
number|'5'
op|')'
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|return_servers_by_reservation_empty
dedent|''
name|'def'
name|'return_servers_by_reservation_empty'
op|'('
name|'context'
op|','
name|'reservation_id'
op|'='
string|'""'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'return'
op|'['
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|return_security_group
dedent|''
name|'def'
name|'return_security_group'
op|'('
name|'context'
op|','
name|'instance_id'
op|','
name|'security_group_id'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'pass'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|instance_update
dedent|''
name|'def'
name|'instance_update'
op|'('
name|'context'
op|','
name|'instance_uuid'
op|','
name|'values'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'inst'
op|'='
name|'fakes'
op|'.'
name|'stub_instance'
op|'('
name|'INSTANCE_IDS'
op|'.'
name|'get'
op|'('
name|'instance_uuid'
op|')'
op|','
nl|'\n'
name|'name'
op|'='
name|'values'
op|'.'
name|'get'
op|'('
string|"'display_name'"
op|')'
op|')'
newline|'\n'
name|'return'
op|'('
name|'inst'
op|','
name|'inst'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|fake_compute_api
dedent|''
name|'def'
name|'fake_compute_api'
op|'('
name|'cls'
op|','
name|'req'
op|','
name|'id'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'return'
name|'True'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|MockSetAdminPassword
dedent|''
name|'class'
name|'MockSetAdminPassword'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'instance_id'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'password'
op|'='
name|'None'
newline|'\n'
nl|'\n'
DECL|member|__call__
dedent|''
name|'def'
name|'__call__'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'instance_id'
op|','
name|'password'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'instance_id'
op|'='
name|'instance_id'
newline|'\n'
name|'self'
op|'.'
name|'password'
op|'='
name|'password'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|ServersControllerTest
dedent|''
dedent|''
name|'class'
name|'ServersControllerTest'
op|'('
name|'test'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'ServersControllerTest'
op|','
name|'self'
op|')'
op|'.'
name|'setUp'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'flags'
op|'('
name|'verbose'
op|'='
name|'True'
op|','
name|'use_ipv6'
op|'='
name|'False'
op|')'
newline|'\n'
name|'fakes'
op|'.'
name|'stub_out_rate_limiting'
op|'('
name|'self'
op|'.'
name|'stubs'
op|')'
newline|'\n'
name|'fakes'
op|'.'
name|'stub_out_key_pair_funcs'
op|'('
name|'self'
op|'.'
name|'stubs'
op|')'
newline|'\n'
name|'nova'
op|'.'
name|'tests'
op|'.'
name|'image'
op|'.'
name|'fake'
op|'.'
name|'stub_out_image_service'
op|'('
name|'self'
op|'.'
name|'stubs'
op|')'
newline|'\n'
name|'return_server'
op|'='
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
op|')'
newline|'\n'
name|'return_servers'
op|'='
name|'fakes'
op|'.'
name|'fake_instance_get_all_by_filters'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_all_by_filters'"
op|','
nl|'\n'
name|'return_servers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_by_uuid'"
op|','
nl|'\n'
name|'return_server'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_all_by_project'"
op|','
nl|'\n'
name|'return_servers'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_add_security_group'"
op|','
nl|'\n'
name|'return_security_group'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_update_and_get_original'"
op|','
nl|'\n'
name|'instance_update'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'ext_mgr'
op|'='
name|'extensions'
op|'.'
name|'ExtensionManager'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'ext_mgr'
op|'.'
name|'extensions'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'controller'
op|'='
name|'servers'
op|'.'
name|'Controller'
op|'('
name|'self'
op|'.'
name|'ext_mgr'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'ips_controller'
op|'='
name|'ips'
op|'.'
name|'Controller'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'fake_network'
op|'.'
name|'stub_out_nw_api_get_instance_nw_info'
op|'('
name|'self'
op|'.'
name|'stubs'
op|','
nl|'\n'
name|'spectacular'
op|'='
name|'True'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_can_check_loaded_extensions
dedent|''
name|'def'
name|'test_can_check_loaded_extensions'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'ext_mgr'
op|'.'
name|'extensions'
op|'='
op|'{'
string|"'os-fake'"
op|':'
name|'None'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
name|'self'
op|'.'
name|'controller'
op|'.'
name|'ext_mgr'
op|'.'
name|'is_loaded'
op|'('
string|"'os-fake'"
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertFalse'
op|'('
name|'self'
op|'.'
name|'controller'
op|'.'
name|'ext_mgr'
op|'.'
name|'is_loaded'
op|'('
string|"'os-not-loaded'"
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_requested_networks_prefix
dedent|''
name|'def'
name|'test_requested_networks_prefix'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'uuid'
op|'='
string|"'br-00000000-0000-0000-0000-000000000000'"
newline|'\n'
name|'requested_networks'
op|'='
op|'['
op|'{'
string|"'uuid'"
op|':'
name|'uuid'
op|'}'
op|']'
newline|'\n'
name|'res'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'_get_requested_networks'
op|'('
name|'requested_networks'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
op|'('
name|'uuid'
op|','
name|'None'
op|')'
name|'in'
name|'res'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_server_by_uuid
dedent|''
name|'def'
name|'test_get_server_by_uuid'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'res_dict'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'show'
op|'('
name|'req'
op|','
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'res_dict'
op|'['
string|"'server'"
op|']'
op|'['
string|"'id'"
op|']'
op|','
name|'FAKE_UUID'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_unique_host_id
dedent|''
name|'def'
name|'test_unique_host_id'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Create two servers with the same host and different\n           project_ids and check that the hostId\'s are unique"""'
newline|'\n'
DECL|function|return_instance_with_host
name|'def'
name|'return_instance_with_host'
op|'('
name|'self'
op|','
op|'*'
name|'args'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'project_id'
op|'='
name|'str'
op|'('
name|'utils'
op|'.'
name|'gen_uuid'
op|'('
op|')'
op|')'
newline|'\n'
name|'return'
name|'fakes'
op|'.'
name|'stub_instance'
op|'('
name|'id'
op|'='
number|'1'
op|','
name|'uuid'
op|'='
name|'FAKE_UUID'
op|','
nl|'\n'
name|'project_id'
op|'='
name|'project_id'
op|','
nl|'\n'
name|'host'
op|'='
string|"'fake_host'"
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_by_uuid'"
op|','
nl|'\n'
name|'return_instance_with_host'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get'"
op|','
nl|'\n'
name|'return_instance_with_host'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'server1'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'show'
op|'('
name|'req'
op|','
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'server2'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'show'
op|'('
name|'req'
op|','
name|'FAKE_UUID'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertNotEqual'
op|'('
name|'server1'
op|'['
string|"'server'"
op|']'
op|'['
string|"'hostId'"
op|']'
op|','
nl|'\n'
name|'server2'
op|'['
string|"'server'"
op|']'
op|'['
string|"'hostId'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_server_by_id
dedent|''
name|'def'
name|'test_get_server_by_id'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'flags'
op|'('
name|'use_ipv6'
op|'='
name|'True'
op|')'
newline|'\n'
name|'image_bookmark'
op|'='
string|'"http://localhost/fake/images/10"'
newline|'\n'
name|'flavor_bookmark'
op|'='
string|'"http://localhost/fake/flavors/1"'
newline|'\n'
nl|'\n'
name|'uuid'
op|'='
name|'FAKE_UUID'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'uuid'
op|')'
newline|'\n'
name|'res_dict'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'show'
op|'('
name|'req'
op|','
name|'uuid'
op|')'
newline|'\n'
nl|'\n'
name|'expected_server'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
name|'uuid'
op|','
nl|'\n'
string|'"user_id"'
op|':'
string|'"fake_user"'
op|','
nl|'\n'
string|'"tenant_id"'
op|':'
string|'"fake_project"'
op|','
nl|'\n'
string|'"updated"'
op|':'
string|'"2010-11-11T11:00:00Z"'
op|','
nl|'\n'
string|'"created"'
op|':'
string|'"2010-10-10T12:00:00Z"'
op|','
nl|'\n'
string|'"progress"'
op|':'
number|'0'
op|','
nl|'\n'
string|'"name"'
op|':'
string|'"server1"'
op|','
nl|'\n'
string|'"status"'
op|':'
string|'"BUILD"'
op|','
nl|'\n'
string|'"accessIPv4"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"accessIPv6"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"hostId"'
op|':'
string|"''"
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"10"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'image_bookmark'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"flavor"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'flavor_bookmark'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"addresses"'
op|':'
op|'{'
nl|'\n'
string|"'test1'"
op|':'
op|'['
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'4'
op|','
string|"'addr'"
op|':'
string|"'192.168.1.100'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'6'
op|','
string|"'addr'"
op|':'
string|"'2001:db8:0:1::1'"
op|'}'
nl|'\n'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"metadata"'
op|':'
op|'{'
nl|'\n'
string|'"seq"'
op|':'
string|'"1"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"self"'
op|','
nl|'\n'
string|'"href"'
op|':'
string|'"http://localhost/v2/fake/servers/%s"'
op|'%'
name|'uuid'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
string|'"http://localhost/fake/servers/%s"'
op|'%'
name|'uuid'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertDictMatch'
op|'('
name|'res_dict'
op|','
name|'expected_server'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_server_with_active_status_by_id
dedent|''
name|'def'
name|'test_get_server_with_active_status_by_id'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'image_bookmark'
op|'='
string|'"http://localhost/fake/images/10"'
newline|'\n'
name|'flavor_bookmark'
op|'='
string|'"http://localhost/fake/flavors/1"'
newline|'\n'
nl|'\n'
name|'new_return_server'
op|'='
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
nl|'\n'
name|'vm_state'
op|'='
name|'vm_states'
op|'.'
name|'ACTIVE'
op|','
name|'progress'
op|'='
number|'100'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_by_uuid'"
op|','
name|'new_return_server'
op|')'
newline|'\n'
nl|'\n'
name|'uuid'
op|'='
name|'FAKE_UUID'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'uuid'
op|')'
newline|'\n'
name|'res_dict'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'show'
op|'('
name|'req'
op|','
name|'uuid'
op|')'
newline|'\n'
name|'expected_server'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
name|'uuid'
op|','
nl|'\n'
string|'"user_id"'
op|':'
string|'"fake_user"'
op|','
nl|'\n'
string|'"tenant_id"'
op|':'
string|'"fake_project"'
op|','
nl|'\n'
string|'"updated"'
op|':'
string|'"2010-11-11T11:00:00Z"'
op|','
nl|'\n'
string|'"created"'
op|':'
string|'"2010-10-10T12:00:00Z"'
op|','
nl|'\n'
string|'"progress"'
op|':'
number|'100'
op|','
nl|'\n'
string|'"name"'
op|':'
string|'"server1"'
op|','
nl|'\n'
string|'"status"'
op|':'
string|'"ACTIVE"'
op|','
nl|'\n'
string|'"accessIPv4"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"accessIPv6"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"hostId"'
op|':'
string|"''"
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"10"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'image_bookmark'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"flavor"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'flavor_bookmark'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"addresses"'
op|':'
op|'{'
nl|'\n'
string|"'test1'"
op|':'
op|'['
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'4'
op|','
string|"'addr'"
op|':'
string|"'192.168.1.100'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'6'
op|','
string|"'addr'"
op|':'
string|"'2001:db8:0:1::1'"
op|'}'
nl|'\n'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"metadata"'
op|':'
op|'{'
nl|'\n'
string|'"seq"'
op|':'
string|'"1"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"self"'
op|','
nl|'\n'
string|'"href"'
op|':'
string|'"http://localhost/v2/fake/servers/%s"'
op|'%'
name|'uuid'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
string|'"http://localhost/fake/servers/%s"'
op|'%'
name|'uuid'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertDictMatch'
op|'('
name|'res_dict'
op|','
name|'expected_server'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_server_with_id_image_ref_by_id
dedent|''
name|'def'
name|'test_get_server_with_id_image_ref_by_id'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'image_ref'
op|'='
string|'"10"'
newline|'\n'
name|'image_bookmark'
op|'='
string|'"http://localhost/fake/images/10"'
newline|'\n'
name|'flavor_id'
op|'='
string|'"1"'
newline|'\n'
name|'flavor_bookmark'
op|'='
string|'"http://localhost/fake/flavors/1"'
newline|'\n'
nl|'\n'
name|'new_return_server'
op|'='
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
nl|'\n'
name|'vm_state'
op|'='
name|'vm_states'
op|'.'
name|'ACTIVE'
op|','
name|'image_ref'
op|'='
name|'image_ref'
op|','
nl|'\n'
name|'flavor_id'
op|'='
name|'flavor_id'
op|','
name|'progress'
op|'='
number|'100'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_by_uuid'"
op|','
name|'new_return_server'
op|')'
newline|'\n'
nl|'\n'
name|'uuid'
op|'='
name|'FAKE_UUID'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'uuid'
op|')'
newline|'\n'
name|'res_dict'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'show'
op|'('
name|'req'
op|','
name|'uuid'
op|')'
newline|'\n'
name|'expected_server'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
name|'uuid'
op|','
nl|'\n'
string|'"user_id"'
op|':'
string|'"fake_user"'
op|','
nl|'\n'
string|'"tenant_id"'
op|':'
string|'"fake_project"'
op|','
nl|'\n'
string|'"updated"'
op|':'
string|'"2010-11-11T11:00:00Z"'
op|','
nl|'\n'
string|'"created"'
op|':'
string|'"2010-10-10T12:00:00Z"'
op|','
nl|'\n'
string|'"progress"'
op|':'
number|'100'
op|','
nl|'\n'
string|'"name"'
op|':'
string|'"server1"'
op|','
nl|'\n'
string|'"status"'
op|':'
string|'"ACTIVE"'
op|','
nl|'\n'
string|'"accessIPv4"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"accessIPv6"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"hostId"'
op|':'
string|"''"
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"10"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'image_bookmark'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"flavor"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'flavor_bookmark'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"addresses"'
op|':'
op|'{'
nl|'\n'
string|"'test1'"
op|':'
op|'['
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'4'
op|','
string|"'addr'"
op|':'
string|"'192.168.1.100'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'6'
op|','
string|"'addr'"
op|':'
string|"'2001:db8:0:1::1'"
op|'}'
nl|'\n'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"metadata"'
op|':'
op|'{'
nl|'\n'
string|'"seq"'
op|':'
string|'"1"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"self"'
op|','
nl|'\n'
string|'"href"'
op|':'
string|'"http://localhost/v2/fake/servers/%s"'
op|'%'
name|'uuid'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
string|'"http://localhost/fake/servers/%s"'
op|'%'
name|'uuid'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertDictMatch'
op|'('
name|'res_dict'
op|','
name|'expected_server'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_server_addresses_from_cache
dedent|''
name|'def'
name|'test_get_server_addresses_from_cache'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pub0'
op|'='
op|'('
string|"'172.19.0.1'"
op|','
string|"'172.19.0.2'"
op|','
op|')'
newline|'\n'
name|'pub1'
op|'='
op|'('
string|"'1.2.3.4'"
op|','
op|')'
newline|'\n'
name|'pub2'
op|'='
op|'('
string|"'b33f::fdee:ddff:fecc:bbaa'"
op|','
op|')'
newline|'\n'
name|'priv0'
op|'='
op|'('
string|"'192.168.0.3'"
op|','
string|"'192.168.0.4'"
op|','
op|')'
newline|'\n'
nl|'\n'
DECL|function|_ip
name|'def'
name|'_ip'
op|'('
name|'ip'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
op|'{'
string|"'address'"
op|':'
name|'ip'
op|','
string|"'type'"
op|':'
string|"'fixed'"
op|'}'
newline|'\n'
nl|'\n'
dedent|''
name|'nw_cache'
op|'='
op|'['
nl|'\n'
op|'{'
string|"'address'"
op|':'
string|"'aa:aa:aa:aa:aa:aa'"
op|','
nl|'\n'
string|"'id'"
op|':'
number|'1'
op|','
nl|'\n'
string|"'network'"
op|':'
op|'{'
string|"'bridge'"
op|':'
string|"'br0'"
op|','
nl|'\n'
string|"'id'"
op|':'
number|'1'
op|','
nl|'\n'
string|"'label'"
op|':'
string|"'public'"
op|','
nl|'\n'
string|"'subnets'"
op|':'
op|'['
op|'{'
string|"'cidr'"
op|':'
string|"'172.19.0.0/24'"
op|','
nl|'\n'
string|"'ips'"
op|':'
op|'['
name|'_ip'
op|'('
name|'ip'
op|')'
name|'for'
name|'ip'
name|'in'
name|'pub0'
op|']'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'cidr'"
op|':'
string|"'1.2.3.0/16'"
op|','
nl|'\n'
string|"'ips'"
op|':'
op|'['
name|'_ip'
op|'('
name|'ip'
op|')'
name|'for'
name|'ip'
name|'in'
name|'pub1'
op|']'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'cidr'"
op|':'
string|"'b33f::/64'"
op|','
nl|'\n'
string|"'ips'"
op|':'
op|'['
name|'_ip'
op|'('
name|'ip'
op|')'
name|'for'
name|'ip'
name|'in'
name|'pub2'
op|']'
op|'}'
op|']'
op|'}'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'address'"
op|':'
string|"'bb:bb:bb:bb:bb:bb'"
op|','
nl|'\n'
string|"'id'"
op|':'
number|'2'
op|','
nl|'\n'
string|"'network'"
op|':'
op|'{'
string|"'bridge'"
op|':'
string|"'br1'"
op|','
nl|'\n'
string|"'id'"
op|':'
number|'2'
op|','
nl|'\n'
string|"'label'"
op|':'
string|"'private'"
op|','
nl|'\n'
string|"'subnets'"
op|':'
op|'['
op|'{'
string|"'cidr'"
op|':'
string|"'192.168.0.0/24'"
op|','
nl|'\n'
string|"'ips'"
op|':'
op|'['
name|'_ip'
op|'('
name|'ip'
op|')'
name|'for'
name|'ip'
name|'in'
name|'priv0'
op|']'
op|'}'
op|']'
op|'}'
op|'}'
op|']'
newline|'\n'
nl|'\n'
name|'return_server'
op|'='
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
name|'nw_cache'
op|'='
name|'nw_cache'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_by_uuid'"
op|','
name|'return_server'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s/ips'"
op|'%'
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'res_dict'
op|'='
name|'self'
op|'.'
name|'ips_controller'
op|'.'
name|'index'
op|'('
name|'req'
op|','
name|'FAKE_UUID'
op|')'
newline|'\n'
nl|'\n'
name|'expected'
op|'='
op|'{'
nl|'\n'
string|"'addresses'"
op|':'
op|'{'
nl|'\n'
string|"'private'"
op|':'
op|'['
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'4'
op|','
string|"'addr'"
op|':'
string|"'192.168.0.3'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'4'
op|','
string|"'addr'"
op|':'
string|"'192.168.0.4'"
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
string|"'public'"
op|':'
op|'['
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'4'
op|','
string|"'addr'"
op|':'
string|"'172.19.0.1'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'4'
op|','
string|"'addr'"
op|':'
string|"'172.19.0.2'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'4'
op|','
string|"'addr'"
op|':'
string|"'1.2.3.4'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'6'
op|','
string|"'addr'"
op|':'
string|"'b33f::fdee:ddff:fecc:bbaa'"
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertDictMatch'
op|'('
name|'res_dict'
op|','
name|'expected'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_server_addresses_nonexistant_network
dedent|''
name|'def'
name|'test_get_server_addresses_nonexistant_network'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'url'
op|'='
string|"'/v2/fake/servers/%s/ips/network_0'"
op|'%'
name|'FAKE_UUID'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
name|'url'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPNotFound'
op|','
name|'self'
op|'.'
name|'ips_controller'
op|'.'
name|'show'
op|','
nl|'\n'
name|'req'
op|','
name|'FAKE_UUID'
op|','
string|"'network_0'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_server_addresses_nonexistant_server
dedent|''
name|'def'
name|'test_get_server_addresses_nonexistant_server'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|function|fake_instance_get
indent|'        '
name|'def'
name|'fake_instance_get'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'nova'
op|'.'
name|'exception'
op|'.'
name|'InstanceNotFound'
op|'('
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_by_uuid'"
op|','
name|'fake_instance_get'
op|')'
newline|'\n'
nl|'\n'
name|'server_id'
op|'='
name|'str'
op|'('
name|'utils'
op|'.'
name|'gen_uuid'
op|'('
op|')'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s/ips'"
op|'%'
name|'server_id'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPNotFound'
op|','
nl|'\n'
name|'self'
op|'.'
name|'ips_controller'
op|'.'
name|'index'
op|','
name|'req'
op|','
name|'server_id'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_server_list_with_reservation_id
dedent|''
name|'def'
name|'test_get_server_list_with_reservation_id'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_all_by_reservation'"
op|','
nl|'\n'
name|'return_servers_by_reservation'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers?reservation_id=foo'"
op|')'
newline|'\n'
name|'res_dict'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'i'
op|'='
number|'0'
newline|'\n'
name|'for'
name|'s'
name|'in'
name|'res_dict'
op|'['
string|"'servers'"
op|']'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'s'
op|'.'
name|'get'
op|'('
string|"'name'"
op|')'
op|','
string|"'server%d'"
op|'%'
op|'('
name|'i'
op|'+'
number|'1'
op|')'
op|')'
newline|'\n'
name|'i'
op|'+='
number|'1'
newline|'\n'
nl|'\n'
DECL|member|test_get_server_list_with_reservation_id_empty
dedent|''
dedent|''
name|'def'
name|'test_get_server_list_with_reservation_id_empty'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_all_by_reservation'"
op|','
nl|'\n'
name|'return_servers_by_reservation_empty'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/detail?'"
nl|'\n'
string|"'reservation_id=foo'"
op|')'
newline|'\n'
name|'res_dict'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'detail'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'i'
op|'='
number|'0'
newline|'\n'
name|'for'
name|'s'
name|'in'
name|'res_dict'
op|'['
string|"'servers'"
op|']'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'s'
op|'.'
name|'get'
op|'('
string|"'name'"
op|')'
op|','
string|"'server%d'"
op|'%'
op|'('
name|'i'
op|'+'
number|'1'
op|')'
op|')'
newline|'\n'
name|'i'
op|'+='
number|'1'
newline|'\n'
nl|'\n'
DECL|member|test_get_server_list_with_reservation_id_details
dedent|''
dedent|''
name|'def'
name|'test_get_server_list_with_reservation_id_details'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_all_by_reservation'"
op|','
nl|'\n'
name|'return_servers_by_reservation'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/detail?'"
nl|'\n'
string|"'reservation_id=foo'"
op|')'
newline|'\n'
name|'res_dict'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'detail'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'i'
op|'='
number|'0'
newline|'\n'
name|'for'
name|'s'
name|'in'
name|'res_dict'
op|'['
string|"'servers'"
op|']'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'s'
op|'.'
name|'get'
op|'('
string|"'name'"
op|')'
op|','
string|"'server%d'"
op|'%'
op|'('
name|'i'
op|'+'
number|'1'
op|')'
op|')'
newline|'\n'
name|'i'
op|'+='
number|'1'
newline|'\n'
nl|'\n'
DECL|member|test_get_server_list
dedent|''
dedent|''
name|'def'
name|'test_get_server_list'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'res_dict'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'res_dict'
op|'['
string|"'servers'"
op|']'
op|')'
op|','
number|'5'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'s'
name|'in'
name|'enumerate'
op|'('
name|'res_dict'
op|'['
string|"'servers'"
op|']'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'s'
op|'['
string|"'id'"
op|']'
op|','
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
name|'i'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'s'
op|'['
string|"'name'"
op|']'
op|','
string|"'server%d'"
op|'%'
op|'('
name|'i'
op|'+'
number|'1'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'s'
op|'.'
name|'get'
op|'('
string|"'image'"
op|','
name|'None'
op|')'
op|','
name|'None'
op|')'
newline|'\n'
nl|'\n'
name|'expected_links'
op|'='
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"self"'
op|','
nl|'\n'
string|'"href"'
op|':'
string|'"http://localhost/v2/fake/servers/%s"'
op|'%'
name|'s'
op|'['
string|"'id'"
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
string|'"http://localhost/fake/servers/%s"'
op|'%'
name|'s'
op|'['
string|"'id'"
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'s'
op|'['
string|"'links'"
op|']'
op|','
name|'expected_links'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_servers_with_limit
dedent|''
dedent|''
name|'def'
name|'test_get_servers_with_limit'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers?limit=3'"
op|')'
newline|'\n'
name|'res_dict'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'servers'
op|'='
name|'res_dict'
op|'['
string|"'servers'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
op|'['
name|'s'
op|'['
string|"'id'"
op|']'
name|'for'
name|'s'
name|'in'
name|'servers'
op|']'
op|','
nl|'\n'
op|'['
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
name|'i'
op|')'
name|'for'
name|'i'
name|'in'
name|'xrange'
op|'('
name|'len'
op|'('
name|'servers'
op|')'
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'servers_links'
op|'='
name|'res_dict'
op|'['
string|"'servers_links'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'servers_links'
op|'['
number|'0'
op|']'
op|'['
string|"'rel'"
op|']'
op|','
string|"'next'"
op|')'
newline|'\n'
name|'href_parts'
op|'='
name|'urlparse'
op|'.'
name|'urlparse'
op|'('
name|'servers_links'
op|'['
number|'0'
op|']'
op|'['
string|"'href'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'/v2/fake/servers'"
op|','
name|'href_parts'
op|'.'
name|'path'
op|')'
newline|'\n'
name|'params'
op|'='
name|'urlparse'
op|'.'
name|'parse_qs'
op|'('
name|'href_parts'
op|'.'
name|'query'
op|')'
newline|'\n'
name|'expected_params'
op|'='
op|'{'
string|"'limit'"
op|':'
op|'['
string|"'3'"
op|']'
op|','
nl|'\n'
string|"'marker'"
op|':'
op|'['
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
number|'2'
op|')'
op|']'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertDictMatch'
op|'('
name|'expected_params'
op|','
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_servers_with_limit_bad_value
dedent|''
name|'def'
name|'test_get_servers_with_limit_bad_value'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers?limit=aaa'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|','
name|'req'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_server_details_with_limit
dedent|''
name|'def'
name|'test_get_server_details_with_limit'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/detail?limit=3'"
op|')'
newline|'\n'
name|'res'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'detail'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'servers'
op|'='
name|'res'
op|'['
string|"'servers'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
op|'['
name|'s'
op|'['
string|"'id'"
op|']'
name|'for'
name|'s'
name|'in'
name|'servers'
op|']'
op|','
nl|'\n'
op|'['
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
name|'i'
op|')'
name|'for'
name|'i'
name|'in'
name|'xrange'
op|'('
name|'len'
op|'('
name|'servers'
op|')'
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'servers_links'
op|'='
name|'res'
op|'['
string|"'servers_links'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'servers_links'
op|'['
number|'0'
op|']'
op|'['
string|"'rel'"
op|']'
op|','
string|"'next'"
op|')'
newline|'\n'
nl|'\n'
name|'href_parts'
op|'='
name|'urlparse'
op|'.'
name|'urlparse'
op|'('
name|'servers_links'
op|'['
number|'0'
op|']'
op|'['
string|"'href'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'/v2/fake/servers'"
op|','
name|'href_parts'
op|'.'
name|'path'
op|')'
newline|'\n'
name|'params'
op|'='
name|'urlparse'
op|'.'
name|'parse_qs'
op|'('
name|'href_parts'
op|'.'
name|'query'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'{'
string|"'limit'"
op|':'
op|'['
string|"'3'"
op|']'
op|','
string|"'marker'"
op|':'
op|'['
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
number|'2'
op|')'
op|']'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertDictMatch'
op|'('
name|'expected'
op|','
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_server_details_with_limit_bad_value
dedent|''
name|'def'
name|'test_get_server_details_with_limit_bad_value'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/detail?limit=aaa'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'detail'
op|','
name|'req'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_server_details_with_limit_and_other_params
dedent|''
name|'def'
name|'test_get_server_details_with_limit_and_other_params'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/detail'"
nl|'\n'
string|"'?limit=3&blah=2:t'"
op|')'
newline|'\n'
name|'res'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'detail'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'servers'
op|'='
name|'res'
op|'['
string|"'servers'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
op|'['
name|'s'
op|'['
string|"'id'"
op|']'
name|'for'
name|'s'
name|'in'
name|'servers'
op|']'
op|','
nl|'\n'
op|'['
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
name|'i'
op|')'
name|'for'
name|'i'
name|'in'
name|'xrange'
op|'('
name|'len'
op|'('
name|'servers'
op|')'
op|')'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'servers_links'
op|'='
name|'res'
op|'['
string|"'servers_links'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'servers_links'
op|'['
number|'0'
op|']'
op|'['
string|"'rel'"
op|']'
op|','
string|"'next'"
op|')'
newline|'\n'
nl|'\n'
name|'href_parts'
op|'='
name|'urlparse'
op|'.'
name|'urlparse'
op|'('
name|'servers_links'
op|'['
number|'0'
op|']'
op|'['
string|"'href'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
string|"'/v2/fake/servers'"
op|','
name|'href_parts'
op|'.'
name|'path'
op|')'
newline|'\n'
name|'params'
op|'='
name|'urlparse'
op|'.'
name|'parse_qs'
op|'('
name|'href_parts'
op|'.'
name|'query'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertDictMatch'
op|'('
op|'{'
string|"'limit'"
op|':'
op|'['
string|"'3'"
op|']'
op|','
string|"'blah'"
op|':'
op|'['
string|"'2:t'"
op|']'
op|','
nl|'\n'
string|"'marker'"
op|':'
op|'['
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
number|'2'
op|')'
op|']'
op|'}'
op|','
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_servers_with_too_big_limit
dedent|''
name|'def'
name|'test_get_servers_with_too_big_limit'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers?limit=30'"
op|')'
newline|'\n'
name|'res_dict'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|'('
name|'req'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'servers_links'"
name|'not'
name|'in'
name|'res_dict'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_servers_with_bad_limit
dedent|''
name|'def'
name|'test_get_servers_with_bad_limit'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers?limit=asdf'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|','
name|'req'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_servers_with_marker
dedent|''
name|'def'
name|'test_get_servers_with_marker'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'url'
op|'='
string|"'/v2/fake/servers?marker=%s'"
op|'%'
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
number|'2'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
name|'url'
op|')'
newline|'\n'
name|'servers'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|'('
name|'req'
op|')'
op|'['
string|"'servers'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
op|'['
name|'s'
op|'['
string|"'name'"
op|']'
name|'for'
name|'s'
name|'in'
name|'servers'
op|']'
op|','
op|'['
string|'"server4"'
op|','
string|'"server5"'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_servers_with_limit_and_marker
dedent|''
name|'def'
name|'test_get_servers_with_limit_and_marker'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'url'
op|'='
string|"'/v2/fake/servers?limit=2&marker=%s'"
op|'%'
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
number|'1'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
name|'url'
op|')'
newline|'\n'
name|'servers'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|'('
name|'req'
op|')'
op|'['
string|"'servers'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
op|'['
name|'s'
op|'['
string|"'name'"
op|']'
name|'for'
name|'s'
name|'in'
name|'servers'
op|']'
op|','
op|'['
string|"'server3'"
op|','
string|"'server4'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_servers_with_bad_marker
dedent|''
name|'def'
name|'test_get_servers_with_bad_marker'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers?limit=2&marker=asdf'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|','
name|'req'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_servers_with_bad_option
dedent|''
name|'def'
name|'test_get_servers_with_bad_option'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'server_uuid'
op|'='
name|'str'
op|'('
name|'utils'
op|'.'
name|'gen_uuid'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|function|fake_get_all
name|'def'
name|'fake_get_all'
op|'('
name|'compute_self'
op|','
name|'context'
op|','
name|'search_opts'
op|'='
name|'None'
op|','
nl|'\n'
name|'sort_key'
op|'='
name|'None'
op|','
name|'sort_dir'
op|'='
string|"'desc'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
op|'['
name|'fakes'
op|'.'
name|'stub_instance'
op|'('
number|'100'
op|','
name|'uuid'
op|'='
name|'server_uuid'
op|')'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'API'
op|','
string|"'get_all'"
op|','
name|'fake_get_all'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers?unknownoption=whee'"
op|')'
newline|'\n'
name|'servers'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|'('
name|'req'
op|')'
op|'['
string|"'servers'"
op|']'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'servers'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'servers'
op|'['
number|'0'
op|']'
op|'['
string|"'id'"
op|']'
op|','
name|'server_uuid'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_servers_allows_image
dedent|''
name|'def'
name|'test_get_servers_allows_image'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'server_uuid'
op|'='
name|'str'
op|'('
name|'utils'
op|'.'
name|'gen_uuid'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|function|fake_get_all
name|'def'
name|'fake_get_all'
op|'('
name|'compute_self'
op|','
name|'context'
op|','
name|'search_opts'
op|'='
name|'None'
op|','
nl|'\n'
name|'sort_key'
op|'='
name|'None'
op|','
name|'sort_dir'
op|'='
string|"'desc'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertNotEqual'
op|'('
name|'search_opts'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'image'"
name|'in'
name|'search_opts'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'search_opts'
op|'['
string|"'image'"
op|']'
op|','
string|"'12345'"
op|')'
newline|'\n'
name|'return'
op|'['
name|'fakes'
op|'.'
name|'stub_instance'
op|'('
number|'100'
op|','
name|'uuid'
op|'='
name|'server_uuid'
op|')'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'API'
op|','
string|"'get_all'"
op|','
name|'fake_get_all'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers?image=12345'"
op|')'
newline|'\n'
name|'servers'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|'('
name|'req'
op|')'
op|'['
string|"'servers'"
op|']'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'servers'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'servers'
op|'['
number|'0'
op|']'
op|'['
string|"'id'"
op|']'
op|','
name|'server_uuid'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_tenant_id_filter_converts_to_project_id_for_admin
dedent|''
name|'def'
name|'test_tenant_id_filter_converts_to_project_id_for_admin'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|function|fake_get_all
indent|'        '
name|'def'
name|'fake_get_all'
op|'('
name|'context'
op|','
name|'filters'
op|'='
name|'None'
op|','
name|'sort_key'
op|'='
name|'None'
op|','
nl|'\n'
name|'sort_dir'
op|'='
string|"'desc'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertNotEqual'
op|'('
name|'filters'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'filters'
op|'['
string|"'project_id'"
op|']'
op|','
string|"'fake'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertFalse'
op|'('
name|'filters'
op|'.'
name|'get'
op|'('
string|"'tenant_id'"
op|')'
op|')'
newline|'\n'
name|'return'
op|'['
name|'fakes'
op|'.'
name|'stub_instance'
op|'('
number|'100'
op|')'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_all_by_filters'"
op|','
nl|'\n'
name|'fake_get_all'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers?tenant_id=fake'"
op|','
nl|'\n'
name|'use_admin_context'
op|'='
name|'True'
op|')'
newline|'\n'
name|'res'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'servers'"
name|'in'
name|'res'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_admin_restricted_tenant
dedent|''
name|'def'
name|'test_admin_restricted_tenant'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|function|fake_get_all
indent|'        '
name|'def'
name|'fake_get_all'
op|'('
name|'context'
op|','
name|'filters'
op|'='
name|'None'
op|','
name|'sort_key'
op|'='
name|'None'
op|','
nl|'\n'
name|'sort_dir'
op|'='
string|"'desc'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertNotEqual'
op|'('
name|'filters'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'filters'
op|'['
string|"'project_id'"
op|']'
op|','
string|"'fake'"
op|')'
newline|'\n'
name|'return'
op|'['
name|'fakes'
op|'.'
name|'stub_instance'
op|'('
number|'100'
op|')'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_all_by_filters'"
op|','
nl|'\n'
name|'fake_get_all'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|','
nl|'\n'
name|'use_admin_context'
op|'='
name|'True'
op|')'
newline|'\n'
name|'res'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'servers'"
name|'in'
name|'res'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_admin_all_tenants
dedent|''
name|'def'
name|'test_admin_all_tenants'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|function|fake_get_all
indent|'        '
name|'def'
name|'fake_get_all'
op|'('
name|'context'
op|','
name|'filters'
op|'='
name|'None'
op|','
name|'sort_key'
op|'='
name|'None'
op|','
nl|'\n'
name|'sort_dir'
op|'='
string|"'desc'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertNotEqual'
op|'('
name|'filters'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'project_id'"
name|'not'
name|'in'
name|'filters'
op|')'
newline|'\n'
name|'return'
op|'['
name|'fakes'
op|'.'
name|'stub_instance'
op|'('
number|'100'
op|')'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_all_by_filters'"
op|','
nl|'\n'
name|'fake_get_all'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers?all_tenants=1'"
op|','
nl|'\n'
name|'use_admin_context'
op|'='
name|'True'
op|')'
newline|'\n'
name|'res'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'servers'"
name|'in'
name|'res'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_all_tenants
dedent|''
name|'def'
name|'test_all_tenants'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|function|fake_get_all
indent|'        '
name|'def'
name|'fake_get_all'
op|'('
name|'context'
op|','
name|'filters'
op|'='
name|'None'
op|','
name|'sort_key'
op|'='
name|'None'
op|','
nl|'\n'
name|'sort_dir'
op|'='
string|"'desc'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertNotEqual'
op|'('
name|'filters'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'filters'
op|'['
string|"'project_id'"
op|']'
op|','
string|"'fake'"
op|')'
newline|'\n'
name|'return'
op|'['
name|'fakes'
op|'.'
name|'stub_instance'
op|'('
number|'100'
op|')'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_all_by_filters'"
op|','
nl|'\n'
name|'fake_get_all'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers?all_tenants=1'"
op|')'
newline|'\n'
name|'res'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'servers'"
name|'in'
name|'res'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_servers_allows_flavor
dedent|''
name|'def'
name|'test_get_servers_allows_flavor'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'server_uuid'
op|'='
name|'str'
op|'('
name|'utils'
op|'.'
name|'gen_uuid'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|function|fake_get_all
name|'def'
name|'fake_get_all'
op|'('
name|'compute_self'
op|','
name|'context'
op|','
name|'search_opts'
op|'='
name|'None'
op|','
nl|'\n'
name|'sort_key'
op|'='
name|'None'
op|','
name|'sort_dir'
op|'='
string|"'desc'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertNotEqual'
op|'('
name|'search_opts'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'flavor'"
name|'in'
name|'search_opts'
op|')'
newline|'\n'
comment|'# flavor is an integer ID'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'search_opts'
op|'['
string|"'flavor'"
op|']'
op|','
string|"'12345'"
op|')'
newline|'\n'
name|'return'
op|'['
name|'fakes'
op|'.'
name|'stub_instance'
op|'('
number|'100'
op|','
name|'uuid'
op|'='
name|'server_uuid'
op|')'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'API'
op|','
string|"'get_all'"
op|','
name|'fake_get_all'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers?flavor=12345'"
op|')'
newline|'\n'
name|'servers'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|'('
name|'req'
op|')'
op|'['
string|"'servers'"
op|']'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'servers'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'servers'
op|'['
number|'0'
op|']'
op|'['
string|"'id'"
op|']'
op|','
name|'server_uuid'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_servers_allows_status
dedent|''
name|'def'
name|'test_get_servers_allows_status'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'server_uuid'
op|'='
name|'str'
op|'('
name|'utils'
op|'.'
name|'gen_uuid'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|function|fake_get_all
name|'def'
name|'fake_get_all'
op|'('
name|'compute_self'
op|','
name|'context'
op|','
name|'search_opts'
op|'='
name|'None'
op|','
nl|'\n'
name|'sort_key'
op|'='
name|'None'
op|','
name|'sort_dir'
op|'='
string|"'desc'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertNotEqual'
op|'('
name|'search_opts'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'vm_state'"
name|'in'
name|'search_opts'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'search_opts'
op|'['
string|"'vm_state'"
op|']'
op|','
name|'vm_states'
op|'.'
name|'ACTIVE'
op|')'
newline|'\n'
name|'return'
op|'['
name|'fakes'
op|'.'
name|'stub_instance'
op|'('
number|'100'
op|','
name|'uuid'
op|'='
name|'server_uuid'
op|')'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'API'
op|','
string|"'get_all'"
op|','
name|'fake_get_all'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers?status=active'"
op|')'
newline|'\n'
name|'servers'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|'('
name|'req'
op|')'
op|'['
string|"'servers'"
op|']'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'servers'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'servers'
op|'['
number|'0'
op|']'
op|'['
string|"'id'"
op|']'
op|','
name|'server_uuid'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_servers_invalid_status
dedent|''
name|'def'
name|'test_get_servers_invalid_status'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Test getting servers by invalid status"""'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers?status=unknown'"
op|','
nl|'\n'
name|'use_admin_context'
op|'='
name|'False'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|','
name|'req'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_servers_allows_name
dedent|''
name|'def'
name|'test_get_servers_allows_name'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'server_uuid'
op|'='
name|'str'
op|'('
name|'utils'
op|'.'
name|'gen_uuid'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|function|fake_get_all
name|'def'
name|'fake_get_all'
op|'('
name|'compute_self'
op|','
name|'context'
op|','
name|'search_opts'
op|'='
name|'None'
op|','
nl|'\n'
name|'sort_key'
op|'='
name|'None'
op|','
name|'sort_dir'
op|'='
string|"'desc'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertNotEqual'
op|'('
name|'search_opts'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'name'"
name|'in'
name|'search_opts'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'search_opts'
op|'['
string|"'name'"
op|']'
op|','
string|"'whee.*'"
op|')'
newline|'\n'
name|'return'
op|'['
name|'fakes'
op|'.'
name|'stub_instance'
op|'('
number|'100'
op|','
name|'uuid'
op|'='
name|'server_uuid'
op|')'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'API'
op|','
string|"'get_all'"
op|','
name|'fake_get_all'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers?name=whee.*'"
op|')'
newline|'\n'
name|'servers'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|'('
name|'req'
op|')'
op|'['
string|"'servers'"
op|']'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'servers'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'servers'
op|'['
number|'0'
op|']'
op|'['
string|"'id'"
op|']'
op|','
name|'server_uuid'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_servers_allows_changes_since
dedent|''
name|'def'
name|'test_get_servers_allows_changes_since'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'server_uuid'
op|'='
name|'str'
op|'('
name|'utils'
op|'.'
name|'gen_uuid'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|function|fake_get_all
name|'def'
name|'fake_get_all'
op|'('
name|'compute_self'
op|','
name|'context'
op|','
name|'search_opts'
op|'='
name|'None'
op|','
nl|'\n'
name|'sort_key'
op|'='
name|'None'
op|','
name|'sort_dir'
op|'='
string|"'desc'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertNotEqual'
op|'('
name|'search_opts'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'changes-since'"
name|'in'
name|'search_opts'
op|')'
newline|'\n'
name|'changes_since'
op|'='
name|'datetime'
op|'.'
name|'datetime'
op|'('
number|'2011'
op|','
number|'1'
op|','
number|'24'
op|','
number|'17'
op|','
number|'8'
op|','
number|'1'
op|','
nl|'\n'
name|'tzinfo'
op|'='
name|'iso8601'
op|'.'
name|'iso8601'
op|'.'
name|'UTC'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'search_opts'
op|'['
string|"'changes-since'"
op|']'
op|','
name|'changes_since'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'deleted'"
name|'not'
name|'in'
name|'search_opts'
op|')'
newline|'\n'
name|'return'
op|'['
name|'fakes'
op|'.'
name|'stub_instance'
op|'('
number|'100'
op|','
name|'uuid'
op|'='
name|'server_uuid'
op|')'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'API'
op|','
string|"'get_all'"
op|','
name|'fake_get_all'
op|')'
newline|'\n'
nl|'\n'
name|'params'
op|'='
string|"'changes-since=2011-01-24T17:08:01Z'"
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers?%s'"
op|'%'
name|'params'
op|')'
newline|'\n'
name|'servers'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|'('
name|'req'
op|')'
op|'['
string|"'servers'"
op|']'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'servers'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'servers'
op|'['
number|'0'
op|']'
op|'['
string|"'id'"
op|']'
op|','
name|'server_uuid'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_servers_allows_changes_since_bad_value
dedent|''
name|'def'
name|'test_get_servers_allows_changes_since_bad_value'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'params'
op|'='
string|"'changes-since=asdf'"
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers?%s'"
op|'%'
name|'params'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|','
name|'req'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_servers_admin_filters_as_user
dedent|''
name|'def'
name|'test_get_servers_admin_filters_as_user'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Test getting servers by admin-only or unknown options when\n        context is not admin. Make sure the admin and unknown options\n        are stripped before they get to compute_api.get_all()\n        """'
newline|'\n'
name|'server_uuid'
op|'='
name|'str'
op|'('
name|'utils'
op|'.'
name|'gen_uuid'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|function|fake_get_all
name|'def'
name|'fake_get_all'
op|'('
name|'compute_self'
op|','
name|'context'
op|','
name|'search_opts'
op|'='
name|'None'
op|','
nl|'\n'
name|'sort_key'
op|'='
name|'None'
op|','
name|'sort_dir'
op|'='
string|"'desc'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertNotEqual'
op|'('
name|'search_opts'
op|','
name|'None'
op|')'
newline|'\n'
comment|'# Allowed by user'
nl|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'name'"
name|'in'
name|'search_opts'
op|')'
newline|'\n'
comment|'# OSAPI converts status to vm_state'
nl|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'vm_state'"
name|'in'
name|'search_opts'
op|')'
newline|'\n'
comment|'# Allowed only by admins with admin API on'
nl|'\n'
name|'self'
op|'.'
name|'assertFalse'
op|'('
string|"'ip'"
name|'in'
name|'search_opts'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertFalse'
op|'('
string|"'unknown_option'"
name|'in'
name|'search_opts'
op|')'
newline|'\n'
name|'return'
op|'['
name|'fakes'
op|'.'
name|'stub_instance'
op|'('
number|'100'
op|','
name|'uuid'
op|'='
name|'server_uuid'
op|')'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'API'
op|','
string|"'get_all'"
op|','
name|'fake_get_all'
op|')'
newline|'\n'
nl|'\n'
name|'query_str'
op|'='
string|'"name=foo&ip=10.*&status=active&unknown_option=meow"'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers?%s'"
op|'%'
name|'query_str'
op|')'
newline|'\n'
name|'res'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'servers'
op|'='
name|'res'
op|'['
string|"'servers'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'servers'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'servers'
op|'['
number|'0'
op|']'
op|'['
string|"'id'"
op|']'
op|','
name|'server_uuid'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_servers_admin_options_as_admin
dedent|''
name|'def'
name|'test_get_servers_admin_options_as_admin'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Test getting servers by admin-only or unknown options when\n        context is admin. All options should be passed\n        """'
newline|'\n'
name|'server_uuid'
op|'='
name|'str'
op|'('
name|'utils'
op|'.'
name|'gen_uuid'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|function|fake_get_all
name|'def'
name|'fake_get_all'
op|'('
name|'compute_self'
op|','
name|'context'
op|','
name|'search_opts'
op|'='
name|'None'
op|','
nl|'\n'
name|'sort_key'
op|'='
name|'None'
op|','
name|'sort_dir'
op|'='
string|"'desc'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertNotEqual'
op|'('
name|'search_opts'
op|','
name|'None'
op|')'
newline|'\n'
comment|'# Allowed by user'
nl|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'name'"
name|'in'
name|'search_opts'
op|')'
newline|'\n'
comment|'# OSAPI converts status to vm_state'
nl|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'vm_state'"
name|'in'
name|'search_opts'
op|')'
newline|'\n'
comment|'# Allowed only by admins with admin API on'
nl|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'ip'"
name|'in'
name|'search_opts'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'unknown_option'"
name|'in'
name|'search_opts'
op|')'
newline|'\n'
name|'return'
op|'['
name|'fakes'
op|'.'
name|'stub_instance'
op|'('
number|'100'
op|','
name|'uuid'
op|'='
name|'server_uuid'
op|')'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'API'
op|','
string|"'get_all'"
op|','
name|'fake_get_all'
op|')'
newline|'\n'
nl|'\n'
name|'query_str'
op|'='
string|'"name=foo&ip=10.*&status=active&unknown_option=meow"'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers?%s'"
op|'%'
name|'query_str'
op|','
nl|'\n'
name|'use_admin_context'
op|'='
name|'True'
op|')'
newline|'\n'
name|'servers'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|'('
name|'req'
op|')'
op|'['
string|"'servers'"
op|']'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'servers'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'servers'
op|'['
number|'0'
op|']'
op|'['
string|"'id'"
op|']'
op|','
name|'server_uuid'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_servers_admin_allows_ip
dedent|''
name|'def'
name|'test_get_servers_admin_allows_ip'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Test getting servers by ip with admin_api enabled and\n        admin context\n        """'
newline|'\n'
name|'server_uuid'
op|'='
name|'str'
op|'('
name|'utils'
op|'.'
name|'gen_uuid'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|function|fake_get_all
name|'def'
name|'fake_get_all'
op|'('
name|'compute_self'
op|','
name|'context'
op|','
name|'search_opts'
op|'='
name|'None'
op|','
nl|'\n'
name|'sort_key'
op|'='
name|'None'
op|','
name|'sort_dir'
op|'='
string|"'desc'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertNotEqual'
op|'('
name|'search_opts'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'ip'"
name|'in'
name|'search_opts'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'search_opts'
op|'['
string|"'ip'"
op|']'
op|','
string|"'10\\..*'"
op|')'
newline|'\n'
name|'return'
op|'['
name|'fakes'
op|'.'
name|'stub_instance'
op|'('
number|'100'
op|','
name|'uuid'
op|'='
name|'server_uuid'
op|')'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'API'
op|','
string|"'get_all'"
op|','
name|'fake_get_all'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers?ip=10\\..*'"
op|','
nl|'\n'
name|'use_admin_context'
op|'='
name|'True'
op|')'
newline|'\n'
name|'servers'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|'('
name|'req'
op|')'
op|'['
string|"'servers'"
op|']'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'servers'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'servers'
op|'['
number|'0'
op|']'
op|'['
string|"'id'"
op|']'
op|','
name|'server_uuid'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_servers_admin_allows_ip6
dedent|''
name|'def'
name|'test_get_servers_admin_allows_ip6'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Test getting servers by ip6 with admin_api enabled and\n        admin context\n        """'
newline|'\n'
name|'server_uuid'
op|'='
name|'str'
op|'('
name|'utils'
op|'.'
name|'gen_uuid'
op|'('
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|function|fake_get_all
name|'def'
name|'fake_get_all'
op|'('
name|'compute_self'
op|','
name|'context'
op|','
name|'search_opts'
op|'='
name|'None'
op|','
nl|'\n'
name|'sort_key'
op|'='
name|'None'
op|','
name|'sort_dir'
op|'='
string|"'desc'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertNotEqual'
op|'('
name|'search_opts'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'ip6'"
name|'in'
name|'search_opts'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'search_opts'
op|'['
string|"'ip6'"
op|']'
op|','
string|"'ffff.*'"
op|')'
newline|'\n'
name|'return'
op|'['
name|'fakes'
op|'.'
name|'stub_instance'
op|'('
number|'100'
op|','
name|'uuid'
op|'='
name|'server_uuid'
op|')'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'API'
op|','
string|"'get_all'"
op|','
name|'fake_get_all'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers?ip6=ffff.*'"
op|','
nl|'\n'
name|'use_admin_context'
op|'='
name|'True'
op|')'
newline|'\n'
name|'servers'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'index'
op|'('
name|'req'
op|')'
op|'['
string|"'servers'"
op|']'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'servers'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'servers'
op|'['
number|'0'
op|']'
op|'['
string|"'id'"
op|']'
op|','
name|'server_uuid'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_update_server_no_body
dedent|''
name|'def'
name|'test_update_server_no_body'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'PUT'"
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPUnprocessableEntity'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'update'
op|','
name|'req'
op|','
name|'FAKE_UUID'
op|','
name|'None'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_update_server_all_attributes
dedent|''
name|'def'
name|'test_update_server_all_attributes'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get'"
op|','
nl|'\n'
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
name|'name'
op|'='
string|"'server_test'"
op|','
nl|'\n'
name|'access_ipv4'
op|'='
string|"'0.0.0.0'"
op|','
nl|'\n'
name|'access_ipv6'
op|'='
string|"'beef::0123'"
op|')'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'PUT'"
newline|'\n'
name|'req'
op|'.'
name|'content_type'
op|'='
string|"'application/json'"
newline|'\n'
name|'body'
op|'='
op|'{'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'server_test'"
op|','
nl|'\n'
string|"'accessIPv4'"
op|':'
string|"'0.0.0.0'"
op|','
nl|'\n'
string|"'accessIPv6'"
op|':'
string|"'beef::0123'"
op|','
nl|'\n'
op|'}'
op|'}'
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'res_dict'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'update'
op|'('
name|'req'
op|','
name|'FAKE_UUID'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'res_dict'
op|'['
string|"'server'"
op|']'
op|'['
string|"'id'"
op|']'
op|','
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'res_dict'
op|'['
string|"'server'"
op|']'
op|'['
string|"'name'"
op|']'
op|','
string|"'server_test'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'res_dict'
op|'['
string|"'server'"
op|']'
op|'['
string|"'accessIPv4'"
op|']'
op|','
string|"'0.0.0.0'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'res_dict'
op|'['
string|"'server'"
op|']'
op|'['
string|"'accessIPv6'"
op|']'
op|','
string|"'beef::0123'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_update_server_name
dedent|''
name|'def'
name|'test_update_server_name'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get'"
op|','
nl|'\n'
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
name|'name'
op|'='
string|"'server_test'"
op|')'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'PUT'"
newline|'\n'
name|'req'
op|'.'
name|'content_type'
op|'='
string|"'application/json'"
newline|'\n'
name|'body'
op|'='
op|'{'
string|"'server'"
op|':'
op|'{'
string|"'name'"
op|':'
string|"'server_test'"
op|'}'
op|'}'
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'res_dict'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'update'
op|'('
name|'req'
op|','
name|'FAKE_UUID'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'res_dict'
op|'['
string|"'server'"
op|']'
op|'['
string|"'id'"
op|']'
op|','
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'res_dict'
op|'['
string|"'server'"
op|']'
op|'['
string|"'name'"
op|']'
op|','
string|"'server_test'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_update_server_name_too_long
dedent|''
name|'def'
name|'test_update_server_name_too_long'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get'"
op|','
nl|'\n'
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
name|'name'
op|'='
string|"'server_test'"
op|')'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'PUT'"
newline|'\n'
name|'req'
op|'.'
name|'content_type'
op|'='
string|"'application/json'"
newline|'\n'
name|'body'
op|'='
op|'{'
string|"'server'"
op|':'
op|'{'
string|"'name'"
op|':'
string|"'x'"
op|'*'
number|'256'
op|'}'
op|'}'
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
name|'self'
op|'.'
name|'controller'
op|'.'
name|'update'
op|','
nl|'\n'
name|'req'
op|','
name|'FAKE_UUID'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_update_server_access_ipv4
dedent|''
name|'def'
name|'test_update_server_access_ipv4'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get'"
op|','
nl|'\n'
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
name|'access_ipv4'
op|'='
string|"'0.0.0.0'"
op|')'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'PUT'"
newline|'\n'
name|'req'
op|'.'
name|'content_type'
op|'='
string|"'application/json'"
newline|'\n'
name|'body'
op|'='
op|'{'
string|"'server'"
op|':'
op|'{'
string|"'accessIPv4'"
op|':'
string|"'0.0.0.0'"
op|'}'
op|'}'
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'res_dict'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'update'
op|'('
name|'req'
op|','
name|'FAKE_UUID'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'res_dict'
op|'['
string|"'server'"
op|']'
op|'['
string|"'id'"
op|']'
op|','
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'res_dict'
op|'['
string|"'server'"
op|']'
op|'['
string|"'accessIPv4'"
op|']'
op|','
string|"'0.0.0.0'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_update_server_access_ipv4_bad_format
dedent|''
name|'def'
name|'test_update_server_access_ipv4_bad_format'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get'"
op|','
nl|'\n'
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
name|'access_ipv4'
op|'='
string|"'0.0.0.0'"
op|')'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'PUT'"
newline|'\n'
name|'req'
op|'.'
name|'content_type'
op|'='
string|"'application/json'"
newline|'\n'
name|'body'
op|'='
op|'{'
string|"'server'"
op|':'
op|'{'
string|"'accessIPv4'"
op|':'
string|"'bad_format'"
op|'}'
op|'}'
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
name|'self'
op|'.'
name|'controller'
op|'.'
name|'update'
op|','
nl|'\n'
name|'req'
op|','
name|'FAKE_UUID'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_update_server_access_ipv4_none
dedent|''
name|'def'
name|'test_update_server_access_ipv4_none'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get'"
op|','
nl|'\n'
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
name|'access_ipv4'
op|'='
string|"'0.0.0.0'"
op|')'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'PUT'"
newline|'\n'
name|'req'
op|'.'
name|'content_type'
op|'='
string|"'application/json'"
newline|'\n'
name|'body'
op|'='
op|'{'
string|"'server'"
op|':'
op|'{'
string|"'accessIPv4'"
op|':'
name|'None'
op|'}'
op|'}'
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'res_dict'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'update'
op|'('
name|'req'
op|','
name|'FAKE_UUID'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'res_dict'
op|'['
string|"'server'"
op|']'
op|'['
string|"'id'"
op|']'
op|','
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'res_dict'
op|'['
string|"'server'"
op|']'
op|'['
string|"'accessIPv4'"
op|']'
op|','
string|"''"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_update_server_access_ipv4_blank
dedent|''
name|'def'
name|'test_update_server_access_ipv4_blank'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get'"
op|','
nl|'\n'
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
name|'access_ipv4'
op|'='
string|"'0.0.0.0'"
op|')'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'PUT'"
newline|'\n'
name|'req'
op|'.'
name|'content_type'
op|'='
string|"'application/json'"
newline|'\n'
name|'body'
op|'='
op|'{'
string|"'server'"
op|':'
op|'{'
string|"'accessIPv4'"
op|':'
string|"''"
op|'}'
op|'}'
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'res_dict'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'update'
op|'('
name|'req'
op|','
name|'FAKE_UUID'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'res_dict'
op|'['
string|"'server'"
op|']'
op|'['
string|"'id'"
op|']'
op|','
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'res_dict'
op|'['
string|"'server'"
op|']'
op|'['
string|"'accessIPv4'"
op|']'
op|','
string|"''"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_update_server_access_ipv6
dedent|''
name|'def'
name|'test_update_server_access_ipv6'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get'"
op|','
nl|'\n'
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
name|'access_ipv6'
op|'='
string|"'beef::0123'"
op|')'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'PUT'"
newline|'\n'
name|'req'
op|'.'
name|'content_type'
op|'='
string|"'application/json'"
newline|'\n'
name|'body'
op|'='
op|'{'
string|"'server'"
op|':'
op|'{'
string|"'accessIPv6'"
op|':'
string|"'beef::0123'"
op|'}'
op|'}'
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'res_dict'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'update'
op|'('
name|'req'
op|','
name|'FAKE_UUID'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'res_dict'
op|'['
string|"'server'"
op|']'
op|'['
string|"'id'"
op|']'
op|','
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'res_dict'
op|'['
string|"'server'"
op|']'
op|'['
string|"'accessIPv6'"
op|']'
op|','
string|"'beef::0123'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_update_server_access_ipv6_bad_format
dedent|''
name|'def'
name|'test_update_server_access_ipv6_bad_format'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get'"
op|','
nl|'\n'
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
name|'access_ipv6'
op|'='
string|"'beef::0123'"
op|')'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'PUT'"
newline|'\n'
name|'req'
op|'.'
name|'content_type'
op|'='
string|"'application/json'"
newline|'\n'
name|'body'
op|'='
op|'{'
string|"'server'"
op|':'
op|'{'
string|"'accessIPv6'"
op|':'
string|"'bad_format'"
op|'}'
op|'}'
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
name|'self'
op|'.'
name|'controller'
op|'.'
name|'update'
op|','
nl|'\n'
name|'req'
op|','
name|'FAKE_UUID'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_update_server_access_ipv6_none
dedent|''
name|'def'
name|'test_update_server_access_ipv6_none'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get'"
op|','
nl|'\n'
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
name|'access_ipv6'
op|'='
string|"'beef::0123'"
op|')'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'PUT'"
newline|'\n'
name|'req'
op|'.'
name|'content_type'
op|'='
string|"'application/json'"
newline|'\n'
name|'body'
op|'='
op|'{'
string|"'server'"
op|':'
op|'{'
string|"'accessIPv6'"
op|':'
name|'None'
op|'}'
op|'}'
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'res_dict'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'update'
op|'('
name|'req'
op|','
name|'FAKE_UUID'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'res_dict'
op|'['
string|"'server'"
op|']'
op|'['
string|"'id'"
op|']'
op|','
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'res_dict'
op|'['
string|"'server'"
op|']'
op|'['
string|"'accessIPv6'"
op|']'
op|','
string|"''"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_update_server_access_ipv6_blank
dedent|''
name|'def'
name|'test_update_server_access_ipv6_blank'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get'"
op|','
nl|'\n'
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
name|'access_ipv6'
op|'='
string|"'beef::0123'"
op|')'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'PUT'"
newline|'\n'
name|'req'
op|'.'
name|'content_type'
op|'='
string|"'application/json'"
newline|'\n'
name|'body'
op|'='
op|'{'
string|"'server'"
op|':'
op|'{'
string|"'accessIPv6'"
op|':'
string|"''"
op|'}'
op|'}'
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'res_dict'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'update'
op|'('
name|'req'
op|','
name|'FAKE_UUID'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'res_dict'
op|'['
string|"'server'"
op|']'
op|'['
string|"'id'"
op|']'
op|','
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'res_dict'
op|'['
string|"'server'"
op|']'
op|'['
string|"'accessIPv6'"
op|']'
op|','
string|"''"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_update_server_adminPass_ignored
dedent|''
name|'def'
name|'test_update_server_adminPass_ignored'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'inst_dict'
op|'='
name|'dict'
op|'('
name|'name'
op|'='
string|"'server_test'"
op|','
name|'adminPass'
op|'='
string|"'bacon'"
op|')'
newline|'\n'
name|'body'
op|'='
name|'dict'
op|'('
name|'server'
op|'='
name|'inst_dict'
op|')'
newline|'\n'
nl|'\n'
DECL|function|server_update
name|'def'
name|'server_update'
op|'('
name|'context'
op|','
name|'id'
op|','
name|'params'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'filtered_dict'
op|'='
op|'{'
nl|'\n'
string|"'display_name'"
op|':'
string|"'server_test'"
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'params'
op|','
name|'filtered_dict'
op|')'
newline|'\n'
name|'filtered_dict'
op|'['
string|"'uuid'"
op|']'
op|'='
name|'id'
newline|'\n'
name|'return'
name|'filtered_dict'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_update'"
op|','
name|'server_update'
op|')'
newline|'\n'
comment|'# FIXME (comstud)'
nl|'\n'
comment|"#        self.stubs.Set(nova.db, 'instance_get',"
nl|'\n'
comment|"#                return_server_with_attributes(name='server_test'))"
nl|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'PUT'"
newline|'\n'
name|'req'
op|'.'
name|'content_type'
op|'='
string|'"application/json"'
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'res_dict'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'update'
op|'('
name|'req'
op|','
name|'FAKE_UUID'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'res_dict'
op|'['
string|"'server'"
op|']'
op|'['
string|"'id'"
op|']'
op|','
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'res_dict'
op|'['
string|"'server'"
op|']'
op|'['
string|"'name'"
op|']'
op|','
string|"'server_test'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_update_server_not_found
dedent|''
name|'def'
name|'test_update_server_not_found'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|function|fake_get
indent|'        '
name|'def'
name|'fake_get'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'nova'
op|'.'
name|'exception'
op|'.'
name|'InstanceNotFound'
op|'('
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'API'
op|','
string|"'get'"
op|','
name|'fake_get'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'PUT'"
newline|'\n'
name|'req'
op|'.'
name|'content_type'
op|'='
string|"'application/json'"
newline|'\n'
name|'body'
op|'='
op|'{'
string|"'server'"
op|':'
op|'{'
string|"'name'"
op|':'
string|"'server_test'"
op|'}'
op|'}'
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPNotFound'
op|','
name|'self'
op|'.'
name|'controller'
op|'.'
name|'update'
op|','
nl|'\n'
name|'req'
op|','
name|'FAKE_UUID'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_update_server_not_found_on_update
dedent|''
name|'def'
name|'test_update_server_not_found_on_update'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
DECL|function|fake_update
indent|'        '
name|'def'
name|'fake_update'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'nova'
op|'.'
name|'exception'
op|'.'
name|'InstanceNotFound'
op|'('
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'API'
op|','
string|"'update'"
op|','
name|'fake_update'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'PUT'"
newline|'\n'
name|'req'
op|'.'
name|'content_type'
op|'='
string|"'application/json'"
newline|'\n'
name|'body'
op|'='
op|'{'
string|"'server'"
op|':'
op|'{'
string|"'name'"
op|':'
string|"'server_test'"
op|'}'
op|'}'
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPNotFound'
op|','
name|'self'
op|'.'
name|'controller'
op|'.'
name|'update'
op|','
nl|'\n'
name|'req'
op|','
name|'FAKE_UUID'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_rebuild_instance_with_access_ipv4_bad_format
dedent|''
name|'def'
name|'test_rebuild_instance_with_access_ipv4_bad_format'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_by_uuid'"
op|','
nl|'\n'
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
name|'vm_state'
op|'='
name|'vm_states'
op|'.'
name|'ACTIVE'
op|')'
op|')'
newline|'\n'
comment|"# proper local hrefs must start with 'http://localhost/v2/'"
nl|'\n'
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'image_href'
op|'='
string|"'http://localhost/v2/fake/images/%s'"
op|'%'
name|'image_uuid'
newline|'\n'
name|'access_ipv4'
op|'='
string|"'bad_format'"
newline|'\n'
name|'access_ipv6'
op|'='
string|"'fead::1234'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'rebuild'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'new_name'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'accessIPv4'"
op|':'
name|'access_ipv4'
op|','
nl|'\n'
string|"'accessIPv6'"
op|':'
name|'access_ipv6'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
nl|'\n'
string|"'hello'"
op|':'
string|"'world'"
op|','
nl|'\n'
string|"'open'"
op|':'
string|"'stack'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'personality'"
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"path"'
op|':'
string|'"/etc/banner.txt"'
op|','
nl|'\n'
string|'"contents"'
op|':'
string|'"MQ=="'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/a/action'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'_action_rebuild'
op|','
name|'req'
op|','
name|'FAKE_UUID'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_rebuild_instance_with_blank_metadata_key
dedent|''
name|'def'
name|'test_rebuild_instance_with_blank_metadata_key'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_by_uuid'"
op|','
nl|'\n'
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
name|'vm_state'
op|'='
name|'vm_states'
op|'.'
name|'ACTIVE'
op|')'
op|')'
newline|'\n'
comment|"# proper local hrefs must start with 'http://localhost/v2/'"
nl|'\n'
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'image_href'
op|'='
string|"'http://localhost/v2/fake/images/%s'"
op|'%'
name|'image_uuid'
newline|'\n'
name|'access_ipv4'
op|'='
string|"'0.0.0.0'"
newline|'\n'
name|'access_ipv6'
op|'='
string|"'fead::1234'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'rebuild'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'new_name'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'accessIPv4'"
op|':'
name|'access_ipv4'
op|','
nl|'\n'
string|"'accessIPv6'"
op|':'
name|'access_ipv6'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
nl|'\n'
string|"''"
op|':'
string|"'world'"
op|','
nl|'\n'
string|"'open'"
op|':'
string|"'stack'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'personality'"
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"path"'
op|':'
string|'"/etc/banner.txt"'
op|','
nl|'\n'
string|'"contents"'
op|':'
string|'"MQ=="'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/a/action'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'_action_rebuild'
op|','
name|'req'
op|','
name|'FAKE_UUID'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_rebuild_instance_with_metadata_key_too_long
dedent|''
name|'def'
name|'test_rebuild_instance_with_metadata_key_too_long'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_by_uuid'"
op|','
nl|'\n'
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
name|'vm_state'
op|'='
name|'vm_states'
op|'.'
name|'ACTIVE'
op|')'
op|')'
newline|'\n'
comment|"# proper local hrefs must start with 'http://localhost/v2/'"
nl|'\n'
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'image_href'
op|'='
string|"'http://localhost/v2/fake/images/%s'"
op|'%'
name|'image_uuid'
newline|'\n'
name|'access_ipv4'
op|'='
string|"'0.0.0.0'"
newline|'\n'
name|'access_ipv6'
op|'='
string|"'fead::1234'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'rebuild'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'new_name'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'accessIPv4'"
op|':'
name|'access_ipv4'
op|','
nl|'\n'
string|"'accessIPv6'"
op|':'
name|'access_ipv6'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
nl|'\n'
op|'('
string|"'a'"
op|'*'
number|'260'
op|')'
op|':'
string|"'world'"
op|','
nl|'\n'
string|"'open'"
op|':'
string|"'stack'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'personality'"
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"path"'
op|':'
string|'"/etc/banner.txt"'
op|','
nl|'\n'
string|'"contents"'
op|':'
string|'"MQ=="'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/a/action'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'_action_rebuild'
op|','
name|'req'
op|','
name|'FAKE_UUID'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_rebuild_instance_with_metadata_value_too_long
dedent|''
name|'def'
name|'test_rebuild_instance_with_metadata_value_too_long'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_by_uuid'"
op|','
nl|'\n'
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
name|'vm_state'
op|'='
name|'vm_states'
op|'.'
name|'ACTIVE'
op|')'
op|')'
newline|'\n'
comment|"# proper local hrefs must start with 'http://localhost/v2/'"
nl|'\n'
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'image_href'
op|'='
string|"'http://localhost/v2/fake/images/%s'"
op|'%'
name|'image_uuid'
newline|'\n'
name|'access_ipv4'
op|'='
string|"'0.0.0.0'"
newline|'\n'
name|'access_ipv6'
op|'='
string|"'fead::1234'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'rebuild'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'new_name'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'accessIPv4'"
op|':'
name|'access_ipv4'
op|','
nl|'\n'
string|"'accessIPv6'"
op|':'
name|'access_ipv6'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
nl|'\n'
string|"'key1'"
op|':'
op|'('
string|"'a'"
op|'*'
number|'260'
op|')'
op|','
nl|'\n'
string|"'open'"
op|':'
string|"'stack'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'personality'"
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"path"'
op|':'
string|'"/etc/banner.txt"'
op|','
nl|'\n'
string|'"contents"'
op|':'
string|'"MQ=="'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/a/action'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'_action_rebuild'
op|','
name|'req'
op|','
name|'FAKE_UUID'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_rebuild_instance_fails_when_min_ram_too_small
dedent|''
name|'def'
name|'test_rebuild_instance_fails_when_min_ram_too_small'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# make min_ram larger than our instance ram size'
nl|'\n'
DECL|function|fake_get_image
indent|'        '
name|'def'
name|'fake_get_image'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'image_href'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'dict'
op|'('
name|'id'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
op|','
nl|'\n'
name|'name'
op|'='
string|"'public image'"
op|','
name|'is_public'
op|'='
name|'True'
op|','
nl|'\n'
name|'status'
op|'='
string|"'active'"
op|','
name|'properties'
op|'='
op|'{'
string|"'key1'"
op|':'
string|"'value1'"
op|'}'
op|','
nl|'\n'
name|'min_ram'
op|'='
string|'"4096"'
op|','
name|'min_disk'
op|'='
string|'"10"'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'api'
op|'.'
name|'API'
op|','
string|"'_get_image'"
op|','
nl|'\n'
name|'fake_get_image'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_by_uuid'"
op|','
nl|'\n'
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
name|'vm_state'
op|'='
name|'vm_states'
op|'.'
name|'ACTIVE'
op|')'
op|')'
newline|'\n'
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'image_href'
op|'='
string|"'http://localhost/v2/fake/images/%s'"
op|'%'
name|'image_uuid'
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'rebuild'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'new_name'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/a/action'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'_action_rebuild'
op|','
name|'req'
op|','
name|'FAKE_UUID'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_rebuild_instance_fails_when_min_disk_too_small
dedent|''
name|'def'
name|'test_rebuild_instance_fails_when_min_disk_too_small'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# make min_disk larger than our instance disk size'
nl|'\n'
DECL|function|fake_get_image
indent|'        '
name|'def'
name|'fake_get_image'
op|'('
name|'self'
op|','
name|'context'
op|','
name|'image_href'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'dict'
op|'('
name|'id'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
op|','
nl|'\n'
name|'name'
op|'='
string|"'public image'"
op|','
name|'is_public'
op|'='
name|'True'
op|','
nl|'\n'
name|'status'
op|'='
string|"'active'"
op|','
name|'properties'
op|'='
op|'{'
string|"'key1'"
op|':'
string|"'value1'"
op|'}'
op|','
nl|'\n'
name|'min_ram'
op|'='
string|'"128"'
op|','
name|'min_disk'
op|'='
string|'"100000"'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'api'
op|'.'
name|'API'
op|','
string|"'_get_image'"
op|','
nl|'\n'
name|'fake_get_image'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_by_uuid'"
op|','
nl|'\n'
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
name|'vm_state'
op|'='
name|'vm_states'
op|'.'
name|'ACTIVE'
op|')'
op|')'
newline|'\n'
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'image_href'
op|'='
string|"'http://localhost/v2/fake/images/%s'"
op|'%'
name|'image_uuid'
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'rebuild'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'new_name'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/a/action'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'_action_rebuild'
op|','
name|'req'
op|','
name|'FAKE_UUID'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_rebuild_instance_with_access_ipv6_bad_format
dedent|''
name|'def'
name|'test_rebuild_instance_with_access_ipv6_bad_format'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_by_uuid'"
op|','
nl|'\n'
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
name|'vm_state'
op|'='
name|'vm_states'
op|'.'
name|'ACTIVE'
op|')'
op|')'
newline|'\n'
comment|"# proper local hrefs must start with 'http://localhost/v2/'"
nl|'\n'
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'image_href'
op|'='
string|"'http://localhost/v2/fake/images/%s'"
op|'%'
name|'image_uuid'
newline|'\n'
name|'access_ipv4'
op|'='
string|"'1.2.3.4'"
newline|'\n'
name|'access_ipv6'
op|'='
string|"'bad_format'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'rebuild'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'new_name'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'accessIPv4'"
op|':'
name|'access_ipv4'
op|','
nl|'\n'
string|"'accessIPv6'"
op|':'
name|'access_ipv6'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
nl|'\n'
string|"'hello'"
op|':'
string|"'world'"
op|','
nl|'\n'
string|"'open'"
op|':'
string|"'stack'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'personality'"
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"path"'
op|':'
string|'"/etc/banner.txt"'
op|','
nl|'\n'
string|'"contents"'
op|':'
string|'"MQ=="'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/a/action'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'_action_rebuild'
op|','
name|'req'
op|','
name|'FAKE_UUID'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_all_server_details
dedent|''
name|'def'
name|'test_get_all_server_details'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'expected_flavor'
op|'='
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
string|"'http://localhost/fake/flavors/1'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'expected_image'
op|'='
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"10"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
string|"'http://localhost/fake/images/10'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/detail'"
op|')'
newline|'\n'
name|'res_dict'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'detail'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'for'
name|'i'
op|','
name|'s'
name|'in'
name|'enumerate'
op|'('
name|'res_dict'
op|'['
string|"'servers'"
op|']'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'s'
op|'['
string|"'id'"
op|']'
op|','
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
name|'i'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'s'
op|'['
string|"'hostId'"
op|']'
op|','
string|"''"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'s'
op|'['
string|"'name'"
op|']'
op|','
string|"'server%d'"
op|'%'
op|'('
name|'i'
op|'+'
number|'1'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'s'
op|'['
string|"'image'"
op|']'
op|','
name|'expected_image'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'s'
op|'['
string|"'flavor'"
op|']'
op|','
name|'expected_flavor'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'s'
op|'['
string|"'status'"
op|']'
op|','
string|"'BUILD'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'s'
op|'['
string|"'metadata'"
op|']'
op|'['
string|"'seq'"
op|']'
op|','
name|'str'
op|'('
name|'i'
op|'+'
number|'1'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_all_server_details_with_host
dedent|''
dedent|''
name|'def'
name|'test_get_all_server_details_with_host'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|"'''\n        We want to make sure that if two instances are on the same host, then\n        they return the same hostId. If two instances are on different hosts,\n        they should return different hostId's. In this test, there are 5\n        instances - 2 on one host and 3 on another.\n        '''"
newline|'\n'
nl|'\n'
DECL|function|return_servers_with_host
name|'def'
name|'return_servers_with_host'
op|'('
name|'context'
op|','
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
op|'['
name|'fakes'
op|'.'
name|'stub_instance'
op|'('
name|'i'
op|'+'
number|'1'
op|','
string|"'fake'"
op|','
string|"'fake'"
op|','
name|'host'
op|'='
name|'i'
op|'%'
number|'2'
op|','
nl|'\n'
name|'uuid'
op|'='
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
name|'i'
op|')'
op|')'
nl|'\n'
name|'for'
name|'i'
name|'in'
name|'xrange'
op|'('
number|'5'
op|')'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_all_by_filters'"
op|','
nl|'\n'
name|'return_servers_with_host'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/detail'"
op|')'
newline|'\n'
name|'res_dict'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'detail'
op|'('
name|'req'
op|')'
newline|'\n'
nl|'\n'
name|'server_list'
op|'='
name|'res_dict'
op|'['
string|"'servers'"
op|']'
newline|'\n'
name|'host_ids'
op|'='
op|'['
name|'server_list'
op|'['
number|'0'
op|']'
op|'['
string|"'hostId'"
op|']'
op|','
name|'server_list'
op|'['
number|'1'
op|']'
op|'['
string|"'hostId'"
op|']'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
name|'host_ids'
op|'['
number|'0'
op|']'
name|'and'
name|'host_ids'
op|'['
number|'1'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertNotEqual'
op|'('
name|'host_ids'
op|'['
number|'0'
op|']'
op|','
name|'host_ids'
op|'['
number|'1'
op|']'
op|')'
newline|'\n'
nl|'\n'
name|'for'
name|'i'
op|','
name|'s'
name|'in'
name|'enumerate'
op|'('
name|'server_list'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'s'
op|'['
string|"'id'"
op|']'
op|','
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
name|'i'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'s'
op|'['
string|"'hostId'"
op|']'
op|','
name|'host_ids'
op|'['
name|'i'
op|'%'
number|'2'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'s'
op|'['
string|"'name'"
op|']'
op|','
string|"'server%d'"
op|'%'
op|'('
name|'i'
op|'+'
number|'1'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_delete_server_instance
dedent|''
dedent|''
name|'def'
name|'test_delete_server_instance'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'fakes'
op|'.'
name|'stub_out_instance_quota'
op|'('
name|'self'
op|'.'
name|'stubs'
op|','
number|'0'
op|','
number|'10'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'DELETE'"
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'server_delete_called'
op|'='
name|'False'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_by_uuid'"
op|','
nl|'\n'
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
name|'vm_state'
op|'='
name|'vm_states'
op|'.'
name|'ACTIVE'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|function|instance_destroy_mock
name|'def'
name|'instance_destroy_mock'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'server_delete_called'
op|'='
name|'True'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_destroy'"
op|','
name|'instance_destroy_mock'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'delete'
op|'('
name|'req'
op|','
name|'FAKE_UUID'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'server_delete_called'
op|','
name|'True'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_delete_server_instance_while_building
dedent|''
name|'def'
name|'test_delete_server_instance_while_building'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'fakes'
op|'.'
name|'stub_out_instance_quota'
op|'('
name|'self'
op|'.'
name|'stubs'
op|','
number|'0'
op|','
number|'10'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'DELETE'"
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'server_delete_called'
op|'='
name|'False'
newline|'\n'
nl|'\n'
DECL|function|instance_destroy_mock
name|'def'
name|'instance_destroy_mock'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'server_delete_called'
op|'='
name|'True'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_destroy'"
op|','
name|'instance_destroy_mock'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'delete'
op|'('
name|'req'
op|','
name|'FAKE_UUID'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'server_delete_called'
op|','
name|'True'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_delete_server_instance_while_resize
dedent|''
name|'def'
name|'test_delete_server_instance_while_resize'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'DELETE'"
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'server_delete_called'
op|'='
name|'False'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_by_uuid'"
op|','
nl|'\n'
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
name|'vm_state'
op|'='
name|'vm_states'
op|'.'
name|'ACTIVE'
op|','
nl|'\n'
name|'task_state'
op|'='
name|'task_states'
op|'.'
name|'RESIZE_PREP'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|function|instance_destroy_mock
name|'def'
name|'instance_destroy_mock'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'server_delete_called'
op|'='
name|'True'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_destroy'"
op|','
name|'instance_destroy_mock'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'delete'
op|'('
name|'req'
op|','
name|'FAKE_UUID'
op|')'
newline|'\n'
comment|'# Delete shoud be allowed in any case, even during resizing,'
nl|'\n'
comment|'# because it may get stuck.'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'server_delete_called'
op|','
name|'True'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|ServerStatusTest
dedent|''
dedent|''
name|'class'
name|'ServerStatusTest'
op|'('
name|'test'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'ServerStatusTest'
op|','
name|'self'
op|')'
op|'.'
name|'setUp'
op|'('
op|')'
newline|'\n'
name|'fakes'
op|'.'
name|'stub_out_nw_api'
op|'('
name|'self'
op|'.'
name|'stubs'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'ext_mgr'
op|'='
name|'extensions'
op|'.'
name|'ExtensionManager'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'ext_mgr'
op|'.'
name|'extensions'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'controller'
op|'='
name|'servers'
op|'.'
name|'Controller'
op|'('
name|'self'
op|'.'
name|'ext_mgr'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_get_with_state
dedent|''
name|'def'
name|'_get_with_state'
op|'('
name|'self'
op|','
name|'vm_state'
op|','
name|'task_state'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get_by_uuid'"
op|','
nl|'\n'
name|'fakes'
op|'.'
name|'fake_instance_get'
op|'('
name|'vm_state'
op|'='
name|'vm_state'
op|','
nl|'\n'
name|'task_state'
op|'='
name|'task_state'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'request'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers/%s'"
op|'%'
name|'FAKE_UUID'
op|')'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'show'
op|'('
name|'request'
op|','
name|'FAKE_UUID'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_active
dedent|''
name|'def'
name|'test_active'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'response'
op|'='
name|'self'
op|'.'
name|'_get_with_state'
op|'('
name|'vm_states'
op|'.'
name|'ACTIVE'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'response'
op|'['
string|"'server'"
op|']'
op|'['
string|"'status'"
op|']'
op|','
string|"'ACTIVE'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_reboot
dedent|''
name|'def'
name|'test_reboot'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'response'
op|'='
name|'self'
op|'.'
name|'_get_with_state'
op|'('
name|'vm_states'
op|'.'
name|'ACTIVE'
op|','
nl|'\n'
name|'task_states'
op|'.'
name|'REBOOTING'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'response'
op|'['
string|"'server'"
op|']'
op|'['
string|"'status'"
op|']'
op|','
string|"'REBOOT'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_reboot_hard
dedent|''
name|'def'
name|'test_reboot_hard'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'response'
op|'='
name|'self'
op|'.'
name|'_get_with_state'
op|'('
name|'vm_states'
op|'.'
name|'ACTIVE'
op|','
nl|'\n'
name|'task_states'
op|'.'
name|'REBOOTING_HARD'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'response'
op|'['
string|"'server'"
op|']'
op|'['
string|"'status'"
op|']'
op|','
string|"'HARD_REBOOT'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_rebuild
dedent|''
name|'def'
name|'test_rebuild'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'response'
op|'='
name|'self'
op|'.'
name|'_get_with_state'
op|'('
name|'vm_states'
op|'.'
name|'ACTIVE'
op|','
nl|'\n'
name|'task_states'
op|'.'
name|'REBUILDING'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'response'
op|'['
string|"'server'"
op|']'
op|'['
string|"'status'"
op|']'
op|','
string|"'REBUILD'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_rebuild_error
dedent|''
name|'def'
name|'test_rebuild_error'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'response'
op|'='
name|'self'
op|'.'
name|'_get_with_state'
op|'('
name|'vm_states'
op|'.'
name|'ERROR'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'response'
op|'['
string|"'server'"
op|']'
op|'['
string|"'status'"
op|']'
op|','
string|"'ERROR'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_resize
dedent|''
name|'def'
name|'test_resize'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'response'
op|'='
name|'self'
op|'.'
name|'_get_with_state'
op|'('
name|'vm_states'
op|'.'
name|'ACTIVE'
op|','
nl|'\n'
name|'task_states'
op|'.'
name|'RESIZE_PREP'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'response'
op|'['
string|"'server'"
op|']'
op|'['
string|"'status'"
op|']'
op|','
string|"'RESIZE'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_verify_resize
dedent|''
name|'def'
name|'test_verify_resize'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'response'
op|'='
name|'self'
op|'.'
name|'_get_with_state'
op|'('
name|'vm_states'
op|'.'
name|'RESIZED'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'response'
op|'['
string|"'server'"
op|']'
op|'['
string|"'status'"
op|']'
op|','
string|"'VERIFY_RESIZE'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_revert_resize
dedent|''
name|'def'
name|'test_revert_resize'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'response'
op|'='
name|'self'
op|'.'
name|'_get_with_state'
op|'('
name|'vm_states'
op|'.'
name|'RESIZED'
op|','
nl|'\n'
name|'task_states'
op|'.'
name|'RESIZE_REVERTING'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'response'
op|'['
string|"'server'"
op|']'
op|'['
string|"'status'"
op|']'
op|','
string|"'REVERT_RESIZE'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_password_update
dedent|''
name|'def'
name|'test_password_update'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'response'
op|'='
name|'self'
op|'.'
name|'_get_with_state'
op|'('
name|'vm_states'
op|'.'
name|'ACTIVE'
op|','
nl|'\n'
name|'task_states'
op|'.'
name|'UPDATING_PASSWORD'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'response'
op|'['
string|"'server'"
op|']'
op|'['
string|"'status'"
op|']'
op|','
string|"'PASSWORD'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_stopped
dedent|''
name|'def'
name|'test_stopped'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'response'
op|'='
name|'self'
op|'.'
name|'_get_with_state'
op|'('
name|'vm_states'
op|'.'
name|'STOPPED'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'response'
op|'['
string|"'server'"
op|']'
op|'['
string|"'status'"
op|']'
op|','
string|"'SHUTOFF'"
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|ServersControllerCreateTest
dedent|''
dedent|''
name|'class'
name|'ServersControllerCreateTest'
op|'('
name|'test'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Shared implementation for tests below that create instance"""'
newline|'\n'
name|'super'
op|'('
name|'ServersControllerCreateTest'
op|','
name|'self'
op|')'
op|'.'
name|'setUp'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'flags'
op|'('
name|'verbose'
op|'='
name|'True'
op|','
nl|'\n'
name|'enable_instance_password'
op|'='
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'instance_cache_num'
op|'='
number|'0'
newline|'\n'
name|'self'
op|'.'
name|'instance_cache_by_id'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'instance_cache_by_uuid'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'ext_mgr'
op|'='
name|'extensions'
op|'.'
name|'ExtensionManager'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'ext_mgr'
op|'.'
name|'extensions'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'controller'
op|'='
name|'servers'
op|'.'
name|'Controller'
op|'('
name|'self'
op|'.'
name|'ext_mgr'
op|')'
newline|'\n'
nl|'\n'
DECL|function|instance_create
name|'def'
name|'instance_create'
op|'('
name|'context'
op|','
name|'inst'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'inst_type'
op|'='
name|'instance_types'
op|'.'
name|'get_instance_type_by_flavor_id'
op|'('
number|'3'
op|')'
newline|'\n'
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'def_image_ref'
op|'='
string|"'http://localhost/images/%s'"
op|'%'
name|'image_uuid'
newline|'\n'
name|'self'
op|'.'
name|'instance_cache_num'
op|'+='
number|'1'
newline|'\n'
name|'instance'
op|'='
op|'{'
nl|'\n'
string|"'id'"
op|':'
name|'self'
op|'.'
name|'instance_cache_num'
op|','
nl|'\n'
string|"'display_name'"
op|':'
name|'inst'
op|'['
string|"'display_name'"
op|']'
name|'or'
string|"'test'"
op|','
nl|'\n'
string|"'uuid'"
op|':'
name|'FAKE_UUID'
op|','
nl|'\n'
string|"'instance_type'"
op|':'
name|'dict'
op|'('
name|'inst_type'
op|')'
op|','
nl|'\n'
string|"'access_ip_v4'"
op|':'
string|"'1.2.3.4'"
op|','
nl|'\n'
string|"'access_ip_v6'"
op|':'
string|"'fead::1234'"
op|','
nl|'\n'
string|"'image_ref'"
op|':'
name|'inst'
op|'.'
name|'get'
op|'('
string|"'image_ref'"
op|','
name|'def_image_ref'
op|')'
op|','
nl|'\n'
string|"'user_id'"
op|':'
string|"'fake'"
op|','
nl|'\n'
string|"'project_id'"
op|':'
string|"'fake'"
op|','
nl|'\n'
string|"'reservation_id'"
op|':'
name|'inst'
op|'['
string|"'reservation_id'"
op|']'
op|','
nl|'\n'
string|'"created_at"'
op|':'
name|'datetime'
op|'.'
name|'datetime'
op|'('
number|'2010'
op|','
number|'10'
op|','
number|'10'
op|','
number|'12'
op|','
number|'0'
op|','
number|'0'
op|')'
op|','
nl|'\n'
string|'"updated_at"'
op|':'
name|'datetime'
op|'.'
name|'datetime'
op|'('
number|'2010'
op|','
number|'11'
op|','
number|'11'
op|','
number|'11'
op|','
number|'0'
op|','
number|'0'
op|')'
op|','
nl|'\n'
string|'"config_drive"'
op|':'
name|'None'
op|','
nl|'\n'
string|'"progress"'
op|':'
number|'0'
op|','
nl|'\n'
string|'"fixed_ips"'
op|':'
op|'['
op|']'
op|','
nl|'\n'
string|'"task_state"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"vm_state"'
op|':'
string|'""'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'instance_cache_by_id'
op|'['
name|'instance'
op|'['
string|"'id'"
op|']'
op|']'
op|'='
name|'instance'
newline|'\n'
name|'self'
op|'.'
name|'instance_cache_by_uuid'
op|'['
name|'instance'
op|'['
string|"'uuid'"
op|']'
op|']'
op|'='
name|'instance'
newline|'\n'
name|'return'
name|'instance'
newline|'\n'
nl|'\n'
DECL|function|instance_get
dedent|''
name|'def'
name|'instance_get'
op|'('
name|'context'
op|','
name|'instance_id'
op|')'
op|':'
newline|'\n'
indent|'            '
string|'"""Stub for compute/api create() pulling in instance after\n            scheduling\n            """'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'instance_cache_by_id'
op|'['
name|'instance_id'
op|']'
newline|'\n'
nl|'\n'
DECL|function|rpc_call_wrapper
dedent|''
name|'def'
name|'rpc_call_wrapper'
op|'('
name|'context'
op|','
name|'topic'
op|','
name|'msg'
op|','
name|'timeout'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'            '
string|'"""Stub out the scheduler creating the instance entry"""'
newline|'\n'
name|'if'
op|'('
name|'topic'
op|'=='
name|'FLAGS'
op|'.'
name|'scheduler_topic'
name|'and'
nl|'\n'
name|'msg'
op|'['
string|"'method'"
op|']'
op|'=='
string|"'run_instance'"
op|')'
op|':'
newline|'\n'
indent|'                '
name|'request_spec'
op|'='
name|'msg'
op|'['
string|"'args'"
op|']'
op|'['
string|"'request_spec'"
op|']'
newline|'\n'
name|'num_instances'
op|'='
name|'request_spec'
op|'.'
name|'get'
op|'('
string|"'num_instances'"
op|','
number|'1'
op|')'
newline|'\n'
name|'instances'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'x'
name|'in'
name|'xrange'
op|'('
name|'num_instances'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'instances'
op|'.'
name|'append'
op|'('
name|'instance_create'
op|'('
name|'context'
op|','
nl|'\n'
name|'request_spec'
op|'['
string|"'instance_properties'"
op|']'
op|')'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'instances'
newline|'\n'
nl|'\n'
DECL|function|server_update
dedent|''
dedent|''
name|'def'
name|'server_update'
op|'('
name|'context'
op|','
name|'instance_uuid'
op|','
name|'params'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'inst'
op|'='
name|'self'
op|'.'
name|'instance_cache_by_uuid'
op|'['
name|'instance_uuid'
op|']'
newline|'\n'
name|'inst'
op|'.'
name|'update'
op|'('
name|'params'
op|')'
newline|'\n'
name|'return'
op|'('
name|'inst'
op|','
name|'inst'
op|')'
newline|'\n'
nl|'\n'
DECL|function|fake_method
dedent|''
name|'def'
name|'fake_method'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'pass'
newline|'\n'
nl|'\n'
DECL|function|project_get_networks
dedent|''
name|'def'
name|'project_get_networks'
op|'('
name|'context'
op|','
name|'user_id'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'dict'
op|'('
name|'id'
op|'='
string|"'1'"
op|','
name|'host'
op|'='
string|"'localhost'"
op|')'
newline|'\n'
nl|'\n'
DECL|function|queue_get_for
dedent|''
name|'def'
name|'queue_get_for'
op|'('
name|'context'
op|','
op|'*'
name|'args'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
string|"'network_topic'"
newline|'\n'
nl|'\n'
dedent|''
name|'fakes'
op|'.'
name|'stub_out_rate_limiting'
op|'('
name|'self'
op|'.'
name|'stubs'
op|')'
newline|'\n'
name|'fakes'
op|'.'
name|'stub_out_key_pair_funcs'
op|'('
name|'self'
op|'.'
name|'stubs'
op|')'
newline|'\n'
name|'nova'
op|'.'
name|'tests'
op|'.'
name|'image'
op|'.'
name|'fake'
op|'.'
name|'stub_out_image_service'
op|'('
name|'self'
op|'.'
name|'stubs'
op|')'
newline|'\n'
name|'fakes'
op|'.'
name|'stub_out_nw_api'
op|'('
name|'self'
op|'.'
name|'stubs'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'utils'
op|','
string|"'gen_uuid'"
op|','
name|'fake_gen_uuid'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_add_security_group'"
op|','
nl|'\n'
name|'return_security_group'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'project_get_networks'"
op|','
nl|'\n'
name|'project_get_networks'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_create'"
op|','
name|'instance_create'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_system_metadata_update'"
op|','
nl|'\n'
name|'fake_method'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_get'"
op|','
name|'instance_get'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'openstack'
op|'.'
name|'common'
op|'.'
name|'rpc'
op|','
string|"'cast'"
op|','
name|'fake_method'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'openstack'
op|'.'
name|'common'
op|'.'
name|'rpc'
op|','
string|"'call'"
op|','
name|'rpc_call_wrapper'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|','
string|"'instance_update_and_get_original'"
op|','
nl|'\n'
name|'server_update'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'openstack'
op|'.'
name|'common'
op|'.'
name|'rpc'
op|','
string|"'queue_get_for'"
op|','
nl|'\n'
name|'queue_get_for'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'network'
op|'.'
name|'manager'
op|'.'
name|'VlanManager'
op|','
string|"'allocate_fixed_ip'"
op|','
nl|'\n'
name|'fake_method'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_check_admin_pass_len
dedent|''
name|'def'
name|'_check_admin_pass_len'
op|'('
name|'self'
op|','
name|'server_dict'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'""" utility function - check server_dict for adminPass\n        length.\n\n        """'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'FLAGS'
op|'.'
name|'password_length'
op|','
nl|'\n'
name|'len'
op|'('
name|'server_dict'
op|'['
string|'"adminPass"'
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_check_admin_pass_missing
dedent|''
name|'def'
name|'_check_admin_pass_missing'
op|'('
name|'self'
op|','
name|'server_dict'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'""" utility function - check server_dict for absence\n        of adminPass\n        """'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|'"adminPass"'
name|'not'
name|'in'
name|'server_dict'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_test_create_instance
dedent|''
name|'def'
name|'_test_create_instance'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'image_uuid'
op|'='
string|"'c905cedb-7281-47e4-8a62-f26bc5fc4c77'"
newline|'\n'
name|'body'
op|'='
name|'dict'
op|'('
name|'server'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'name'
op|'='
string|"'server_test'"
op|','
name|'imageRef'
op|'='
name|'image_uuid'
op|','
name|'flavorRef'
op|'='
number|'2'
op|','
nl|'\n'
name|'metadata'
op|'='
op|'{'
string|"'hello'"
op|':'
string|"'world'"
op|','
string|"'open'"
op|':'
string|"'stack'"
op|'}'
op|','
nl|'\n'
name|'personality'
op|'='
op|'{'
op|'}'
op|')'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'server'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|'('
name|'req'
op|','
name|'body'
op|')'
op|'.'
name|'obj'
op|'['
string|"'server'"
op|']'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'_check_admin_pass_len'
op|'('
name|'server'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'FAKE_UUID'
op|','
name|'server'
op|'['
string|"'id'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_server_bad_image_href
dedent|''
name|'def'
name|'test_create_server_bad_image_href'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'image_href'
op|'='
number|'1'
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/123/flavors/3'"
newline|'\n'
nl|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'min_count'"
op|':'
number|'1'
op|','
nl|'\n'
string|"'name'"
op|':'
string|"'server_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
name|'flavor_ref'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|','
nl|'\n'
name|'req'
op|','
nl|'\n'
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_multiple_instances
dedent|''
name|'def'
name|'test_create_multiple_instances'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Test creating multiple instances but not asking for\n        reservation_id\n        """'
newline|'\n'
name|'image_href'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/123/flavors/3'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'min_count'"
op|':'
number|'2'
op|','
nl|'\n'
string|"'name'"
op|':'
string|"'server_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
name|'flavor_ref'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
string|"'hello'"
op|':'
string|"'world'"
op|','
nl|'\n'
string|"'open'"
op|':'
string|"'stack'"
op|'}'
op|','
nl|'\n'
string|"'personality'"
op|':'
op|'['
op|']'
nl|'\n'
op|'}'
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'res'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|'('
name|'req'
op|','
name|'body'
op|')'
op|'.'
name|'obj'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'FAKE_UUID'
op|','
name|'res'
op|'['
string|'"server"'
op|']'
op|'['
string|'"id"'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_check_admin_pass_len'
op|'('
name|'res'
op|'['
string|'"server"'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_multiple_instances_pass_disabled
dedent|''
name|'def'
name|'test_create_multiple_instances_pass_disabled'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Test creating multiple instances but not asking for\n        reservation_id\n        """'
newline|'\n'
name|'self'
op|'.'
name|'flags'
op|'('
name|'enable_instance_password'
op|'='
name|'False'
op|')'
newline|'\n'
name|'image_href'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/123/flavors/3'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'min_count'"
op|':'
number|'2'
op|','
nl|'\n'
string|"'name'"
op|':'
string|"'server_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
name|'flavor_ref'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
string|"'hello'"
op|':'
string|"'world'"
op|','
nl|'\n'
string|"'open'"
op|':'
string|"'stack'"
op|'}'
op|','
nl|'\n'
string|"'personality'"
op|':'
op|'['
op|']'
nl|'\n'
op|'}'
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'res'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|'('
name|'req'
op|','
name|'body'
op|')'
op|'.'
name|'obj'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'FAKE_UUID'
op|','
name|'res'
op|'['
string|'"server"'
op|']'
op|'['
string|'"id"'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_check_admin_pass_missing'
op|'('
name|'res'
op|'['
string|'"server"'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_multiple_instances_resv_id_return
dedent|''
name|'def'
name|'test_create_multiple_instances_resv_id_return'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Test creating multiple instances with asking for\n        reservation_id\n        """'
newline|'\n'
name|'image_href'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/123/flavors/3'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'min_count'"
op|':'
number|'2'
op|','
nl|'\n'
string|"'name'"
op|':'
string|"'server_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
name|'flavor_ref'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
string|"'hello'"
op|':'
string|"'world'"
op|','
nl|'\n'
string|"'open'"
op|':'
string|"'stack'"
op|'}'
op|','
nl|'\n'
string|"'personality'"
op|':'
op|'['
op|']'
op|','
nl|'\n'
string|"'return_reservation_id'"
op|':'
name|'True'
nl|'\n'
op|'}'
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'res'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|'('
name|'req'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
name|'reservation_id'
op|'='
name|'res'
op|'.'
name|'get'
op|'('
string|"'reservation_id'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertNotEqual'
op|'('
name|'reservation_id'
op|','
string|'""'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertNotEqual'
op|'('
name|'reservation_id'
op|','
name|'None'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
name|'len'
op|'('
name|'reservation_id'
op|')'
op|'>'
number|'1'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_image_ref_is_bookmark
dedent|''
name|'def'
name|'test_create_instance_image_ref_is_bookmark'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'image_href'
op|'='
string|"'http://localhost/fake/images/%s'"
op|'%'
name|'image_uuid'
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/fake/flavors/3'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'server_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
name|'flavor_ref'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'res'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|'('
name|'req'
op|','
name|'body'
op|')'
op|'.'
name|'obj'
newline|'\n'
nl|'\n'
name|'server'
op|'='
name|'res'
op|'['
string|"'server'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'FAKE_UUID'
op|','
name|'server'
op|'['
string|"'id'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_image_ref_is_invalid
dedent|''
name|'def'
name|'test_create_instance_image_ref_is_invalid'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'image_uuid'
op|'='
string|"'this_is_not_a_valid_uuid'"
newline|'\n'
name|'image_href'
op|'='
string|"'http://localhost/fake/images/%s'"
op|'%'
name|'image_uuid'
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/fake/flavors/3'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'server_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
name|'flavor_ref'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|','
nl|'\n'
name|'req'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_no_key_pair
dedent|''
name|'def'
name|'test_create_instance_no_key_pair'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'fakes'
op|'.'
name|'stub_out_key_pair_funcs'
op|'('
name|'self'
op|'.'
name|'stubs'
op|','
name|'have_key_pair'
op|'='
name|'False'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_test_create_instance'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|_test_create_extra
dedent|''
name|'def'
name|'_test_create_extra'
op|'('
name|'self'
op|','
name|'params'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'image_uuid'
op|'='
string|"'c905cedb-7281-47e4-8a62-f26bc5fc4c77'"
newline|'\n'
name|'server'
op|'='
name|'dict'
op|'('
name|'name'
op|'='
string|"'server_test'"
op|','
name|'imageRef'
op|'='
name|'image_uuid'
op|','
name|'flavorRef'
op|'='
number|'2'
op|')'
newline|'\n'
name|'server'
op|'.'
name|'update'
op|'('
name|'params'
op|')'
newline|'\n'
name|'body'
op|'='
name|'dict'
op|'('
name|'server'
op|'='
name|'server'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'server'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|'('
name|'req'
op|','
name|'body'
op|')'
op|'.'
name|'obj'
op|'['
string|"'server'"
op|']'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_with_security_group_enabled
dedent|''
name|'def'
name|'test_create_instance_with_security_group_enabled'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'ext_mgr'
op|'.'
name|'extensions'
op|'='
op|'{'
string|"'os-security-groups'"
op|':'
string|"'fake'"
op|'}'
newline|'\n'
name|'group'
op|'='
string|"'foo'"
newline|'\n'
name|'params'
op|'='
op|'{'
string|"'security_groups'"
op|':'
op|'['
op|'{'
string|"'name'"
op|':'
name|'group'
op|'}'
op|']'
op|'}'
newline|'\n'
name|'old_create'
op|'='
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'api'
op|'.'
name|'API'
op|'.'
name|'create'
newline|'\n'
nl|'\n'
DECL|function|create
name|'def'
name|'create'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'kwargs'
op|'['
string|"'security_group'"
op|']'
op|','
op|'['
name|'group'
op|']'
op|')'
newline|'\n'
name|'return'
name|'old_create'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'api'
op|'.'
name|'API'
op|','
string|"'create'"
op|','
name|'create'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_test_create_extra'
op|'('
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_with_security_group_disabled
dedent|''
name|'def'
name|'test_create_instance_with_security_group_disabled'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'group'
op|'='
string|"'foo'"
newline|'\n'
name|'params'
op|'='
op|'{'
string|"'security_groups'"
op|':'
op|'['
op|'{'
string|"'name'"
op|':'
name|'group'
op|'}'
op|']'
op|'}'
newline|'\n'
name|'old_create'
op|'='
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'api'
op|'.'
name|'API'
op|'.'
name|'create'
newline|'\n'
nl|'\n'
DECL|function|create
name|'def'
name|'create'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
comment|'# NOTE(vish): if the security groups extension is not'
nl|'\n'
comment|'#             enabled, then security groups passed in'
nl|'\n'
comment|'#             are ignored.'
nl|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'kwargs'
op|'['
string|"'security_group'"
op|']'
op|','
op|'['
string|"'default'"
op|']'
op|')'
newline|'\n'
name|'return'
name|'old_create'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'api'
op|'.'
name|'API'
op|','
string|"'create'"
op|','
name|'create'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_test_create_extra'
op|'('
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_with_volumes_enabled
dedent|''
name|'def'
name|'test_create_instance_with_volumes_enabled'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'ext_mgr'
op|'.'
name|'extensions'
op|'='
op|'{'
string|"'os-volumes'"
op|':'
string|"'fake'"
op|'}'
newline|'\n'
name|'bdm'
op|'='
op|'['
op|'{'
string|"'device_name'"
op|':'
string|"'foo'"
op|'}'
op|']'
newline|'\n'
name|'params'
op|'='
op|'{'
string|"'block_device_mapping'"
op|':'
name|'bdm'
op|'}'
newline|'\n'
name|'old_create'
op|'='
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'api'
op|'.'
name|'API'
op|'.'
name|'create'
newline|'\n'
nl|'\n'
DECL|function|create
name|'def'
name|'create'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'kwargs'
op|'['
string|"'block_device_mapping'"
op|']'
op|','
name|'bdm'
op|')'
newline|'\n'
name|'return'
name|'old_create'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'api'
op|'.'
name|'API'
op|','
string|"'create'"
op|','
name|'create'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_test_create_extra'
op|'('
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_with_volumes_disabled
dedent|''
name|'def'
name|'test_create_instance_with_volumes_disabled'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'bdm'
op|'='
op|'['
op|'{'
string|"'device_name'"
op|':'
string|"'foo'"
op|'}'
op|']'
newline|'\n'
name|'params'
op|'='
op|'{'
string|"'block_device_mapping'"
op|':'
name|'bdm'
op|'}'
newline|'\n'
name|'old_create'
op|'='
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'api'
op|'.'
name|'API'
op|'.'
name|'create'
newline|'\n'
nl|'\n'
DECL|function|create
name|'def'
name|'create'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'kwargs'
op|'['
string|"'block_device_mapping'"
op|']'
op|','
name|'None'
op|')'
newline|'\n'
name|'return'
name|'old_create'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'api'
op|'.'
name|'API'
op|','
string|"'create'"
op|','
name|'create'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_test_create_extra'
op|'('
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_with_user_data_enabled
dedent|''
name|'def'
name|'test_create_instance_with_user_data_enabled'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'ext_mgr'
op|'.'
name|'extensions'
op|'='
op|'{'
string|"'os-user-data'"
op|':'
string|"'fake'"
op|'}'
newline|'\n'
name|'user_data'
op|'='
string|"'fake'"
newline|'\n'
name|'params'
op|'='
op|'{'
string|"'user_data'"
op|':'
name|'user_data'
op|'}'
newline|'\n'
name|'old_create'
op|'='
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'api'
op|'.'
name|'API'
op|'.'
name|'create'
newline|'\n'
nl|'\n'
DECL|function|create
name|'def'
name|'create'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'kwargs'
op|'['
string|"'user_data'"
op|']'
op|','
name|'user_data'
op|')'
newline|'\n'
name|'return'
name|'old_create'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'api'
op|'.'
name|'API'
op|','
string|"'create'"
op|','
name|'create'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_test_create_extra'
op|'('
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_with_user_data_disabled
dedent|''
name|'def'
name|'test_create_instance_with_user_data_disabled'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'user_data'
op|'='
string|"'fake'"
newline|'\n'
name|'params'
op|'='
op|'{'
string|"'user_data'"
op|':'
name|'user_data'
op|'}'
newline|'\n'
name|'old_create'
op|'='
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'api'
op|'.'
name|'API'
op|'.'
name|'create'
newline|'\n'
nl|'\n'
DECL|function|create
name|'def'
name|'create'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'kwargs'
op|'['
string|"'user_data'"
op|']'
op|','
name|'None'
op|')'
newline|'\n'
name|'return'
name|'old_create'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'api'
op|'.'
name|'API'
op|','
string|"'create'"
op|','
name|'create'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_test_create_extra'
op|'('
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_with_availability_zone_enabled
dedent|''
name|'def'
name|'test_create_instance_with_availability_zone_enabled'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'ext_mgr'
op|'.'
name|'extensions'
op|'='
op|'{'
string|"'os-availability-zone'"
op|':'
string|"'fake'"
op|'}'
newline|'\n'
name|'availability_zone'
op|'='
string|"'fake'"
newline|'\n'
name|'params'
op|'='
op|'{'
string|"'availability_zone'"
op|':'
name|'availability_zone'
op|'}'
newline|'\n'
name|'old_create'
op|'='
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'api'
op|'.'
name|'API'
op|'.'
name|'create'
newline|'\n'
nl|'\n'
DECL|function|create
name|'def'
name|'create'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'kwargs'
op|'['
string|"'availability_zone'"
op|']'
op|','
name|'availability_zone'
op|')'
newline|'\n'
name|'return'
name|'old_create'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'api'
op|'.'
name|'API'
op|','
string|"'create'"
op|','
name|'create'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_test_create_extra'
op|'('
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_with_availability_zone_disabled
dedent|''
name|'def'
name|'test_create_instance_with_availability_zone_disabled'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'availability_zone'
op|'='
string|"'fake'"
newline|'\n'
name|'params'
op|'='
op|'{'
string|"'availability_zone'"
op|':'
name|'availability_zone'
op|'}'
newline|'\n'
name|'old_create'
op|'='
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'api'
op|'.'
name|'API'
op|'.'
name|'create'
newline|'\n'
nl|'\n'
DECL|function|create
name|'def'
name|'create'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'kwargs'
op|'['
string|"'availability_zone'"
op|']'
op|','
name|'None'
op|')'
newline|'\n'
name|'return'
name|'old_create'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'compute'
op|'.'
name|'api'
op|'.'
name|'API'
op|','
string|"'create'"
op|','
name|'create'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_test_create_extra'
op|'('
name|'params'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_with_access_ip
dedent|''
name|'def'
name|'test_create_instance_with_access_ip'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|"# proper local hrefs must start with 'http://localhost/v2/'"
nl|'\n'
indent|'        '
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'image_href'
op|'='
string|"'http://localhost/v2/fake/images/%s'"
op|'%'
name|'image_uuid'
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/fake/flavors/3'"
newline|'\n'
name|'access_ipv4'
op|'='
string|"'1.2.3.4'"
newline|'\n'
name|'access_ipv6'
op|'='
string|"'fead::1234'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'server_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
name|'flavor_ref'
op|','
nl|'\n'
string|"'accessIPv4'"
op|':'
name|'access_ipv4'
op|','
nl|'\n'
string|"'accessIPv6'"
op|':'
name|'access_ipv6'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
nl|'\n'
string|"'hello'"
op|':'
string|"'world'"
op|','
nl|'\n'
string|"'open'"
op|':'
string|"'stack'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'personality'"
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"path"'
op|':'
string|'"/etc/banner.txt"'
op|','
nl|'\n'
string|'"contents"'
op|':'
string|'"MQ=="'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'res'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|'('
name|'req'
op|','
name|'body'
op|')'
op|'.'
name|'obj'
newline|'\n'
nl|'\n'
name|'server'
op|'='
name|'res'
op|'['
string|"'server'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'_check_admin_pass_len'
op|'('
name|'server'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'FAKE_UUID'
op|','
name|'server'
op|'['
string|"'id'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_with_access_ip_pass_disabled
dedent|''
name|'def'
name|'test_create_instance_with_access_ip_pass_disabled'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'# test with admin passwords disabled See lp bug 921814'
nl|'\n'
indent|'        '
name|'self'
op|'.'
name|'flags'
op|'('
name|'enable_instance_password'
op|'='
name|'False'
op|')'
newline|'\n'
nl|'\n'
comment|"# proper local hrefs must start with 'http://localhost/v2/'"
nl|'\n'
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'image_href'
op|'='
string|"'http://localhost/v2/fake/images/%s'"
op|'%'
name|'image_uuid'
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/fake/flavors/3'"
newline|'\n'
name|'access_ipv4'
op|'='
string|"'1.2.3.4'"
newline|'\n'
name|'access_ipv6'
op|'='
string|"'fead::1234'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'server_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
name|'flavor_ref'
op|','
nl|'\n'
string|"'accessIPv4'"
op|':'
name|'access_ipv4'
op|','
nl|'\n'
string|"'accessIPv6'"
op|':'
name|'access_ipv6'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
nl|'\n'
string|"'hello'"
op|':'
string|"'world'"
op|','
nl|'\n'
string|"'open'"
op|':'
string|"'stack'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'personality'"
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"path"'
op|':'
string|'"/etc/banner.txt"'
op|','
nl|'\n'
string|'"contents"'
op|':'
string|'"MQ=="'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'res'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|'('
name|'req'
op|','
name|'body'
op|')'
op|'.'
name|'obj'
newline|'\n'
nl|'\n'
name|'server'
op|'='
name|'res'
op|'['
string|"'server'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'_check_admin_pass_missing'
op|'('
name|'server'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'FAKE_UUID'
op|','
name|'server'
op|'['
string|"'id'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_bad_format_access_ip_v4
dedent|''
name|'def'
name|'test_create_instance_bad_format_access_ip_v4'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|"# proper local hrefs must start with 'http://localhost/v2/'"
nl|'\n'
indent|'        '
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'image_href'
op|'='
string|"'http://localhost/v2/fake/images/%s'"
op|'%'
name|'image_uuid'
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/fake/flavors/3'"
newline|'\n'
name|'access_ipv4'
op|'='
string|"'bad_format'"
newline|'\n'
name|'access_ipv6'
op|'='
string|"'fead::1234'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'server_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
name|'flavor_ref'
op|','
nl|'\n'
string|"'accessIPv4'"
op|':'
name|'access_ipv4'
op|','
nl|'\n'
string|"'accessIPv6'"
op|':'
name|'access_ipv6'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
nl|'\n'
string|"'hello'"
op|':'
string|"'world'"
op|','
nl|'\n'
string|"'open'"
op|':'
string|"'stack'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'personality'"
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"path"'
op|':'
string|'"/etc/banner.txt"'
op|','
nl|'\n'
string|'"contents"'
op|':'
string|'"MQ=="'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|','
nl|'\n'
name|'req'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_bad_format_access_ip_v6
dedent|''
name|'def'
name|'test_create_instance_bad_format_access_ip_v6'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|"# proper local hrefs must start with 'http://localhost/v2/'"
nl|'\n'
indent|'        '
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'image_href'
op|'='
string|"'http://localhost/v2/fake/images/%s'"
op|'%'
name|'image_uuid'
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/fake/flavors/3'"
newline|'\n'
name|'access_ipv4'
op|'='
string|"'1.2.3.4'"
newline|'\n'
name|'access_ipv6'
op|'='
string|"'bad_format'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'server_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
name|'flavor_ref'
op|','
nl|'\n'
string|"'accessIPv4'"
op|':'
name|'access_ipv4'
op|','
nl|'\n'
string|"'accessIPv6'"
op|':'
name|'access_ipv6'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
nl|'\n'
string|"'hello'"
op|':'
string|"'world'"
op|','
nl|'\n'
string|"'open'"
op|':'
string|"'stack'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'personality'"
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"path"'
op|':'
string|'"/etc/banner.txt"'
op|','
nl|'\n'
string|'"contents"'
op|':'
string|'"MQ=="'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|','
nl|'\n'
name|'req'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_name_too_long
dedent|''
name|'def'
name|'test_create_instance_name_too_long'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|"# proper local hrefs must start with 'http://localhost/v2/'"
nl|'\n'
indent|'        '
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'image_href'
op|'='
string|"'http://localhost/v2/images/%s'"
op|'%'
name|'image_uuid'
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/123/flavors/3'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'X'"
op|'*'
number|'256'
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
name|'flavor_ref'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
nl|'\n'
string|"'hello'"
op|':'
string|"'world'"
op|','
nl|'\n'
string|"'open'"
op|':'
string|"'stack'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'personality'"
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"path"'
op|':'
string|'"/etc/banner.txt"'
op|','
nl|'\n'
string|'"contents"'
op|':'
string|'"MQ=="'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|','
nl|'\n'
name|'req'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance
dedent|''
name|'def'
name|'test_create_instance'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|"# proper local hrefs must start with 'http://localhost/v2/'"
nl|'\n'
indent|'        '
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'image_href'
op|'='
string|"'http://localhost/v2/images/%s'"
op|'%'
name|'image_uuid'
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/123/flavors/3'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'server_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
name|'flavor_ref'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
nl|'\n'
string|"'hello'"
op|':'
string|"'world'"
op|','
nl|'\n'
string|"'open'"
op|':'
string|"'stack'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'personality'"
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"path"'
op|':'
string|'"/etc/banner.txt"'
op|','
nl|'\n'
string|'"contents"'
op|':'
string|'"MQ=="'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'res'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|'('
name|'req'
op|','
name|'body'
op|')'
op|'.'
name|'obj'
newline|'\n'
nl|'\n'
name|'server'
op|'='
name|'res'
op|'['
string|"'server'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'_check_admin_pass_len'
op|'('
name|'server'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'FAKE_UUID'
op|','
name|'server'
op|'['
string|"'id'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_pass_disabled
dedent|''
name|'def'
name|'test_create_instance_pass_disabled'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'flags'
op|'('
name|'enable_instance_password'
op|'='
name|'False'
op|')'
newline|'\n'
comment|"# proper local hrefs must start with 'http://localhost/v2/'"
nl|'\n'
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'image_href'
op|'='
string|"'http://localhost/v2/images/%s'"
op|'%'
name|'image_uuid'
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/123/flavors/3'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'server_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
name|'flavor_ref'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
nl|'\n'
string|"'hello'"
op|':'
string|"'world'"
op|','
nl|'\n'
string|"'open'"
op|':'
string|"'stack'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'personality'"
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"path"'
op|':'
string|'"/etc/banner.txt"'
op|','
nl|'\n'
string|'"contents"'
op|':'
string|'"MQ=="'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'res'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|'('
name|'req'
op|','
name|'body'
op|')'
op|'.'
name|'obj'
newline|'\n'
nl|'\n'
name|'server'
op|'='
name|'res'
op|'['
string|"'server'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'_check_admin_pass_missing'
op|'('
name|'server'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'FAKE_UUID'
op|','
name|'server'
op|'['
string|"'id'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_too_much_metadata
dedent|''
name|'def'
name|'test_create_instance_too_much_metadata'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'flags'
op|'('
name|'quota_metadata_items'
op|'='
number|'1'
op|')'
newline|'\n'
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'image_href'
op|'='
string|"'http://localhost/v2/images/%s'"
op|'%'
name|'image_uuid'
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/123/flavors/3'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'server_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
name|'flavor_ref'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
nl|'\n'
string|"'hello'"
op|':'
string|"'world'"
op|','
nl|'\n'
string|"'open'"
op|':'
string|"'stack'"
op|','
nl|'\n'
string|"'vote'"
op|':'
string|"'fiddletown'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPRequestEntityTooLarge'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|','
name|'req'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_metadata_key_too_long
dedent|''
name|'def'
name|'test_create_instance_metadata_key_too_long'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'flags'
op|'('
name|'quota_metadata_items'
op|'='
number|'1'
op|')'
newline|'\n'
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'image_href'
op|'='
string|"'http://localhost/v2/images/%s'"
op|'%'
name|'image_uuid'
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/123/flavors/3'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'server_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
name|'flavor_ref'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
nl|'\n'
op|'('
string|"'a'"
op|'*'
number|'260'
op|')'
op|':'
string|"'12345'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|','
name|'req'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_metadata_value_too_long
dedent|''
name|'def'
name|'test_create_instance_metadata_value_too_long'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'flags'
op|'('
name|'quota_metadata_items'
op|'='
number|'1'
op|')'
newline|'\n'
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'image_href'
op|'='
string|"'http://localhost/v2/images/%s'"
op|'%'
name|'image_uuid'
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/123/flavors/3'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'server_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
name|'flavor_ref'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
nl|'\n'
string|"'key1'"
op|':'
op|'('
string|"'a'"
op|'*'
number|'260'
op|')'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|','
name|'req'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_metadata_key_blank
dedent|''
name|'def'
name|'test_create_instance_metadata_key_blank'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'flags'
op|'('
name|'quota_metadata_items'
op|'='
number|'1'
op|')'
newline|'\n'
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'image_href'
op|'='
string|"'http://localhost/v2/images/%s'"
op|'%'
name|'image_uuid'
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/123/flavors/3'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'server_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
name|'flavor_ref'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
nl|'\n'
string|"''"
op|':'
string|"'12345'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|','
name|'req'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_invalid_key_name
dedent|''
name|'def'
name|'test_create_instance_invalid_key_name'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'image_href'
op|'='
string|"'http://localhost/v2/images/2'"
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/flavors/3'"
newline|'\n'
name|'body'
op|'='
name|'dict'
op|'('
name|'server'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'name'
op|'='
string|"'server_test'"
op|','
name|'imageRef'
op|'='
name|'image_href'
op|','
name|'flavorRef'
op|'='
name|'flavor_ref'
op|','
nl|'\n'
name|'key_name'
op|'='
string|"'nonexistentkey'"
op|')'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|','
name|'req'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_valid_key_name
dedent|''
name|'def'
name|'test_create_instance_valid_key_name'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'image_href'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/flavors/3'"
newline|'\n'
name|'body'
op|'='
name|'dict'
op|'('
name|'server'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'name'
op|'='
string|"'server_test'"
op|','
name|'imageRef'
op|'='
name|'image_href'
op|','
name|'flavorRef'
op|'='
name|'flavor_ref'
op|','
nl|'\n'
name|'key_name'
op|'='
string|"'key'"
op|')'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'res'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|'('
name|'req'
op|','
name|'body'
op|')'
op|'.'
name|'obj'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'FAKE_UUID'
op|','
name|'res'
op|'['
string|'"server"'
op|']'
op|'['
string|'"id"'
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_check_admin_pass_len'
op|'('
name|'res'
op|'['
string|'"server"'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_invalid_flavor_href
dedent|''
name|'def'
name|'test_create_instance_invalid_flavor_href'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'image_href'
op|'='
string|"'http://localhost/v2/images/2'"
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/v2/flavors/asdf'"
newline|'\n'
name|'body'
op|'='
name|'dict'
op|'('
name|'server'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'name'
op|'='
string|"'server_test'"
op|','
name|'imageRef'
op|'='
name|'image_href'
op|','
name|'flavorRef'
op|'='
name|'flavor_ref'
op|','
nl|'\n'
name|'metadata'
op|'='
op|'{'
string|"'hello'"
op|':'
string|"'world'"
op|','
string|"'open'"
op|':'
string|"'stack'"
op|'}'
op|','
nl|'\n'
name|'personality'
op|'='
op|'{'
op|'}'
op|')'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|','
name|'req'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_invalid_flavor_id_int
dedent|''
name|'def'
name|'test_create_instance_invalid_flavor_id_int'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'image_href'
op|'='
string|"'http://localhost/v2/fake/images/2'"
newline|'\n'
name|'flavor_ref'
op|'='
op|'-'
number|'1'
newline|'\n'
name|'body'
op|'='
name|'dict'
op|'('
name|'server'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'name'
op|'='
string|"'server_test'"
op|','
name|'imageRef'
op|'='
name|'image_href'
op|','
name|'flavorRef'
op|'='
name|'flavor_ref'
op|','
nl|'\n'
name|'metadata'
op|'='
op|'{'
string|"'hello'"
op|':'
string|"'world'"
op|','
string|"'open'"
op|':'
string|"'stack'"
op|'}'
op|','
nl|'\n'
name|'personality'
op|'='
op|'{'
op|'}'
op|')'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|','
name|'req'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_bad_flavor_href
dedent|''
name|'def'
name|'test_create_instance_bad_flavor_href'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'image_href'
op|'='
string|"'http://localhost/v2/images/2'"
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/v2/flavors/17'"
newline|'\n'
name|'body'
op|'='
name|'dict'
op|'('
name|'server'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'name'
op|'='
string|"'server_test'"
op|','
name|'imageRef'
op|'='
name|'image_href'
op|','
name|'flavorRef'
op|'='
name|'flavor_ref'
op|','
nl|'\n'
name|'metadata'
op|'='
op|'{'
string|"'hello'"
op|':'
string|"'world'"
op|','
string|"'open'"
op|':'
string|"'stack'"
op|'}'
op|','
nl|'\n'
name|'personality'
op|'='
op|'{'
op|'}'
op|')'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|','
name|'req'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_with_config_drive
dedent|''
name|'def'
name|'test_create_instance_with_config_drive'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'image_href'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/v2/fake/flavors/3'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'config_drive_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
name|'flavor_ref'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
nl|'\n'
string|"'hello'"
op|':'
string|"'world'"
op|','
nl|'\n'
string|"'open'"
op|':'
string|"'stack'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'personality'"
op|':'
op|'{'
op|'}'
op|','
nl|'\n'
string|"'config_drive'"
op|':'
name|'True'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'res'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|'('
name|'req'
op|','
name|'body'
op|')'
op|'.'
name|'obj'
newline|'\n'
nl|'\n'
name|'server'
op|'='
name|'res'
op|'['
string|"'server'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'FAKE_UUID'
op|','
name|'server'
op|'['
string|"'id'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_with_config_drive_as_id
dedent|''
name|'def'
name|'test_create_instance_with_config_drive_as_id'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'image_href'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/v2/fake/flavors/3'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'config_drive_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
name|'flavor_ref'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
nl|'\n'
string|"'hello'"
op|':'
string|"'world'"
op|','
nl|'\n'
string|"'open'"
op|':'
string|"'stack'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'personality'"
op|':'
op|'{'
op|'}'
op|','
nl|'\n'
string|"'config_drive'"
op|':'
name|'image_href'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'res'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|'('
name|'req'
op|','
name|'body'
op|')'
op|'.'
name|'obj'
newline|'\n'
nl|'\n'
name|'server'
op|'='
name|'res'
op|'['
string|"'server'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'FAKE_UUID'
op|','
name|'server'
op|'['
string|"'id'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_with_bad_config_drive
dedent|''
name|'def'
name|'test_create_instance_with_bad_config_drive'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'image_href'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/v2/fake/flavors/3'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'config_drive_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
name|'flavor_ref'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
nl|'\n'
string|"'hello'"
op|':'
string|"'world'"
op|','
nl|'\n'
string|"'open'"
op|':'
string|"'stack'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'personality'"
op|':'
op|'{'
op|'}'
op|','
nl|'\n'
string|"'config_drive'"
op|':'
string|"'asdf'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|','
name|'req'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_without_config_drive
dedent|''
name|'def'
name|'test_create_instance_without_config_drive'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'image_href'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/v2/fake/flavors/3'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'config_drive_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
name|'flavor_ref'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
nl|'\n'
string|"'hello'"
op|':'
string|"'world'"
op|','
nl|'\n'
string|"'open'"
op|':'
string|"'stack'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'personality'"
op|':'
op|'{'
op|'}'
op|','
nl|'\n'
string|"'config_drive'"
op|':'
name|'True'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'res'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|'('
name|'req'
op|','
name|'body'
op|')'
op|'.'
name|'obj'
newline|'\n'
nl|'\n'
name|'server'
op|'='
name|'res'
op|'['
string|"'server'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'FAKE_UUID'
op|','
name|'server'
op|'['
string|"'id'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_bad_href
dedent|''
name|'def'
name|'test_create_instance_bad_href'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'image_href'
op|'='
string|"'asdf'"
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/v2/flavors/3'"
newline|'\n'
name|'body'
op|'='
name|'dict'
op|'('
name|'server'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'name'
op|'='
string|"'server_test'"
op|','
name|'imageRef'
op|'='
name|'image_href'
op|','
name|'flavorRef'
op|'='
name|'flavor_ref'
op|','
nl|'\n'
name|'metadata'
op|'='
op|'{'
string|"'hello'"
op|':'
string|"'world'"
op|','
string|"'open'"
op|':'
string|"'stack'"
op|'}'
op|','
nl|'\n'
name|'personality'
op|'='
op|'{'
op|'}'
op|')'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|','
name|'req'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_local_href
dedent|''
name|'def'
name|'test_create_instance_local_href'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/v2/flavors/3'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'server_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_uuid'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
name|'flavor_ref'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'res'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|'('
name|'req'
op|','
name|'body'
op|')'
op|'.'
name|'obj'
newline|'\n'
nl|'\n'
name|'server'
op|'='
name|'res'
op|'['
string|"'server'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'FAKE_UUID'
op|','
name|'server'
op|'['
string|"'id'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_admin_pass
dedent|''
name|'def'
name|'test_create_instance_admin_pass'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'server_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_uuid'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
number|'3'
op|','
nl|'\n'
string|"'adminPass'"
op|':'
string|"'testpass'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|"'content-type'"
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'res'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|'('
name|'req'
op|','
name|'body'
op|')'
op|'.'
name|'obj'
newline|'\n'
nl|'\n'
name|'server'
op|'='
name|'res'
op|'['
string|"'server'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'server'
op|'['
string|"'adminPass'"
op|']'
op|','
name|'body'
op|'['
string|"'server'"
op|']'
op|'['
string|"'adminPass'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_admin_pass_pass_disabled
dedent|''
name|'def'
name|'test_create_instance_admin_pass_pass_disabled'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'flags'
op|'('
name|'enable_instance_password'
op|'='
name|'False'
op|')'
newline|'\n'
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'server_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_uuid'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
number|'3'
op|','
nl|'\n'
string|"'adminPass'"
op|':'
string|"'testpass'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|"'content-type'"
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'res'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|'('
name|'req'
op|','
name|'body'
op|')'
op|'.'
name|'obj'
newline|'\n'
nl|'\n'
name|'server'
op|'='
name|'res'
op|'['
string|"'server'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'adminPass'"
name|'in'
name|'body'
op|'['
string|"'server'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
string|"'adminPass'"
name|'not'
name|'in'
name|'server'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_admin_pass_empty
dedent|''
name|'def'
name|'test_create_instance_admin_pass_empty'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'server_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_uuid'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
number|'3'
op|','
nl|'\n'
string|"'adminPass'"
op|':'
string|"''"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|"'content-type'"
op|']'
op|'='
string|'"application/json"'
newline|'\n'
nl|'\n'
comment|"# The fact that the action doesn't raise is enough validation"
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|'('
name|'req'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_malformed_entity
dedent|''
name|'def'
name|'test_create_instance_malformed_entity'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'body'
op|'='
op|'{'
string|"'server'"
op|':'
string|"'string'"
op|'}'
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|"'content-type'"
op|']'
op|'='
string|'"application/json"'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertRaises'
op|'('
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPBadRequest'
op|','
nl|'\n'
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|','
name|'req'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_location
dedent|''
name|'def'
name|'test_create_location'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'selfhref'
op|'='
string|"'http://localhost/v2/fake/servers/%s'"
op|'%'
name|'FAKE_UUID'
newline|'\n'
name|'bookhref'
op|'='
string|"'http://localhost/fake/servers/%s'"
op|'%'
name|'FAKE_UUID'
newline|'\n'
name|'image_uuid'
op|'='
string|"'76fa36fc-c930-4bf3-8c8a-ea2a2420deb6'"
newline|'\n'
name|'image_href'
op|'='
string|"'http://localhost/v2/images/%s'"
op|'%'
name|'image_uuid'
newline|'\n'
name|'flavor_ref'
op|'='
string|"'http://localhost/123/flavors/3'"
newline|'\n'
name|'body'
op|'='
op|'{'
nl|'\n'
string|"'server'"
op|':'
op|'{'
nl|'\n'
string|"'name'"
op|':'
string|"'server_test'"
op|','
nl|'\n'
string|"'imageRef'"
op|':'
name|'image_href'
op|','
nl|'\n'
string|"'flavorRef'"
op|':'
name|'flavor_ref'
op|','
nl|'\n'
string|"'metadata'"
op|':'
op|'{'
nl|'\n'
string|"'hello'"
op|':'
string|"'world'"
op|','
nl|'\n'
string|"'open'"
op|':'
string|"'stack'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'personality'"
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"path"'
op|':'
string|'"/etc/banner.txt"'
op|','
nl|'\n'
string|'"contents"'
op|':'
string|'"MQ=="'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|"'content-type'"
op|']'
op|'='
string|"'application/json'"
newline|'\n'
name|'robj'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|'('
name|'req'
op|','
name|'body'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'robj'
op|'['
string|"'Location'"
op|']'
op|','
name|'selfhref'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_do_test_create_instance_above_quota
dedent|''
name|'def'
name|'_do_test_create_instance_above_quota'
op|'('
name|'self'
op|','
name|'resource'
op|','
name|'allowed'
op|','
name|'quota'
op|','
nl|'\n'
name|'expected_msg'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'fakes'
op|'.'
name|'stub_out_instance_quota'
op|'('
name|'self'
op|'.'
name|'stubs'
op|','
name|'allowed'
op|','
name|'quota'
op|','
name|'resource'
op|')'
newline|'\n'
name|'image_uuid'
op|'='
string|"'c905cedb-7281-47e4-8a62-f26bc5fc4c77'"
newline|'\n'
name|'body'
op|'='
name|'dict'
op|'('
name|'server'
op|'='
name|'dict'
op|'('
nl|'\n'
name|'name'
op|'='
string|"'server_test'"
op|','
name|'imageRef'
op|'='
name|'image_uuid'
op|','
name|'flavorRef'
op|'='
number|'3'
op|','
nl|'\n'
name|'metadata'
op|'='
op|'{'
string|"'hello'"
op|':'
string|"'world'"
op|','
string|"'open'"
op|':'
string|"'stack'"
op|'}'
op|','
nl|'\n'
name|'personality'
op|'='
op|'{'
op|'}'
op|')'
op|')'
newline|'\n'
name|'req'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|"'/v2/fake/servers'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'method'
op|'='
string|"'POST'"
newline|'\n'
name|'req'
op|'.'
name|'body'
op|'='
name|'jsonutils'
op|'.'
name|'dumps'
op|'('
name|'body'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|'"content-type"'
op|']'
op|'='
string|'"application/json"'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'server'
op|'='
name|'self'
op|'.'
name|'controller'
op|'.'
name|'create'
op|'('
name|'req'
op|','
name|'body'
op|')'
op|'.'
name|'obj'
op|'['
string|"'server'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'fail'
op|'('
string|"'expected quota to be exceeded'"
op|')'
newline|'\n'
dedent|''
name|'except'
name|'webob'
op|'.'
name|'exc'
op|'.'
name|'HTTPRequestEntityTooLarge'
name|'as'
name|'e'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'e'
op|'.'
name|'explanation'
op|','
name|'expected_msg'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_above_quota_instances
dedent|''
dedent|''
name|'def'
name|'test_create_instance_above_quota_instances'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'msg'
op|'='
name|'_'
op|'('
string|"'Quota exceeded for instances: Requested 1, but'"
nl|'\n'
string|"' already used 10 of 10 instances'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_do_test_create_instance_above_quota'
op|'('
string|"'instances'"
op|','
number|'0'
op|','
number|'10'
op|','
name|'msg'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_above_quota_ram
dedent|''
name|'def'
name|'test_create_instance_above_quota_ram'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'msg'
op|'='
name|'_'
op|'('
string|"'Quota exceeded for ram: Requested 4096, but'"
nl|'\n'
string|"' already used 8192 of 10240 ram'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_do_test_create_instance_above_quota'
op|'('
string|"'ram'"
op|','
number|'2048'
op|','
number|'10'
op|'*'
number|'1024'
op|','
name|'msg'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create_instance_above_quota_cores
dedent|''
name|'def'
name|'test_create_instance_above_quota_cores'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'msg'
op|'='
name|'_'
op|'('
string|"'Quota exceeded for cores: Requested 2, but'"
nl|'\n'
string|"' already used 9 of 10 cores'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_do_test_create_instance_above_quota'
op|'('
string|"'cores'"
op|','
number|'1'
op|','
number|'10'
op|','
name|'msg'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TestServerCreateRequestXMLDeserializer
dedent|''
dedent|''
name|'class'
name|'TestServerCreateRequestXMLDeserializer'
op|'('
name|'test'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'TestServerCreateRequestXMLDeserializer'
op|','
name|'self'
op|')'
op|'.'
name|'setUp'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'deserializer'
op|'='
name|'servers'
op|'.'
name|'CreateDeserializer'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_minimal_request
dedent|''
name|'def'
name|'test_minimal_request'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serial_request'
op|'='
string|'"""\n<server xmlns="http://docs.openstack.org/compute/api/v2"\n        name="new-server-test"\n        imageRef="1"\n        flavorRef="2"/>"""'
newline|'\n'
name|'request'
op|'='
name|'self'
op|'.'
name|'deserializer'
op|'.'
name|'deserialize'
op|'('
name|'serial_request'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"name"'
op|':'
string|'"new-server-test"'
op|','
nl|'\n'
string|'"imageRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"flavorRef"'
op|':'
string|'"2"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'request'
op|'['
string|"'body'"
op|']'
op|','
name|'expected'
op|')'
newline|'\n'
nl|'\n'
DECL|function|test_access_ipv4
dedent|''
name|'def'
name|'test_access_ipv4'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serial_request'
op|'='
string|'"""\n<server xmlns="http://docs.openstack.org/compute/api/v2"\n        name="new-server-test"\n        imageRef="1"\n        flavorRef="2"\n        accessIPv4="1.2.3.4"/>"""'
newline|'\n'
name|'request'
op|'='
name|'self'
op|'.'
name|'deserializer'
op|'.'
name|'deserialize'
op|'('
name|'serial_request'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"name"'
op|':'
string|'"new-server-test"'
op|','
nl|'\n'
string|'"imageRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"flavorRef"'
op|':'
string|'"2"'
op|','
nl|'\n'
string|'"accessIPv4"'
op|':'
string|'"1.2.3.4"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'request'
op|'['
string|"'body'"
op|']'
op|','
name|'expected'
op|')'
newline|'\n'
nl|'\n'
DECL|function|test_access_ipv6
dedent|''
name|'def'
name|'test_access_ipv6'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serial_request'
op|'='
string|'"""\n<server xmlns="http://docs.openstack.org/compute/api/v2"\n        name="new-server-test"\n        imageRef="1"\n        flavorRef="2"\n        accessIPv6="fead::1234"/>"""'
newline|'\n'
name|'request'
op|'='
name|'self'
op|'.'
name|'deserializer'
op|'.'
name|'deserialize'
op|'('
name|'serial_request'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"name"'
op|':'
string|'"new-server-test"'
op|','
nl|'\n'
string|'"imageRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"flavorRef"'
op|':'
string|'"2"'
op|','
nl|'\n'
string|'"accessIPv6"'
op|':'
string|'"fead::1234"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'request'
op|'['
string|"'body'"
op|']'
op|','
name|'expected'
op|')'
newline|'\n'
nl|'\n'
DECL|function|test_access_ip
dedent|''
name|'def'
name|'test_access_ip'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serial_request'
op|'='
string|'"""\n<server xmlns="http://docs.openstack.org/compute/api/v2"\n        name="new-server-test"\n        imageRef="1"\n        flavorRef="2"\n        accessIPv4="1.2.3.4"\n        accessIPv6="fead::1234"/>"""'
newline|'\n'
name|'request'
op|'='
name|'self'
op|'.'
name|'deserializer'
op|'.'
name|'deserialize'
op|'('
name|'serial_request'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"name"'
op|':'
string|'"new-server-test"'
op|','
nl|'\n'
string|'"imageRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"flavorRef"'
op|':'
string|'"2"'
op|','
nl|'\n'
string|'"accessIPv4"'
op|':'
string|'"1.2.3.4"'
op|','
nl|'\n'
string|'"accessIPv6"'
op|':'
string|'"fead::1234"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'request'
op|'['
string|"'body'"
op|']'
op|','
name|'expected'
op|')'
newline|'\n'
nl|'\n'
DECL|function|test_admin_pass
dedent|''
name|'def'
name|'test_admin_pass'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serial_request'
op|'='
string|'"""\n<server xmlns="http://docs.openstack.org/compute/api/v2"\n        name="new-server-test"\n        imageRef="1"\n        flavorRef="2"\n        adminPass="1234"/>"""'
newline|'\n'
name|'request'
op|'='
name|'self'
op|'.'
name|'deserializer'
op|'.'
name|'deserialize'
op|'('
name|'serial_request'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"name"'
op|':'
string|'"new-server-test"'
op|','
nl|'\n'
string|'"imageRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"flavorRef"'
op|':'
string|'"2"'
op|','
nl|'\n'
string|'"adminPass"'
op|':'
string|'"1234"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'request'
op|'['
string|"'body'"
op|']'
op|','
name|'expected'
op|')'
newline|'\n'
nl|'\n'
DECL|function|test_image_link
dedent|''
name|'def'
name|'test_image_link'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serial_request'
op|'='
string|'"""\n<server xmlns="http://docs.openstack.org/compute/api/v2"\n        name="new-server-test"\n        imageRef="http://localhost:8774/v2/images/2"\n        flavorRef="3"/>"""'
newline|'\n'
name|'request'
op|'='
name|'self'
op|'.'
name|'deserializer'
op|'.'
name|'deserialize'
op|'('
name|'serial_request'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"name"'
op|':'
string|'"new-server-test"'
op|','
nl|'\n'
string|'"imageRef"'
op|':'
string|'"http://localhost:8774/v2/images/2"'
op|','
nl|'\n'
string|'"flavorRef"'
op|':'
string|'"3"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'request'
op|'['
string|"'body'"
op|']'
op|','
name|'expected'
op|')'
newline|'\n'
nl|'\n'
DECL|function|test_flavor_link
dedent|''
name|'def'
name|'test_flavor_link'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serial_request'
op|'='
string|'"""\n<server xmlns="http://docs.openstack.org/compute/api/v2"\n        name="new-server-test"\n        imageRef="1"\n        flavorRef="http://localhost:8774/v2/flavors/3"/>"""'
newline|'\n'
name|'request'
op|'='
name|'self'
op|'.'
name|'deserializer'
op|'.'
name|'deserialize'
op|'('
name|'serial_request'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"name"'
op|':'
string|'"new-server-test"'
op|','
nl|'\n'
string|'"imageRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"flavorRef"'
op|':'
string|'"http://localhost:8774/v2/flavors/3"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'request'
op|'['
string|"'body'"
op|']'
op|','
name|'expected'
op|')'
newline|'\n'
nl|'\n'
DECL|function|test_empty_metadata_personality
dedent|''
name|'def'
name|'test_empty_metadata_personality'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serial_request'
op|'='
string|'"""\n<server xmlns="http://docs.openstack.org/compute/api/v2"\n        name="new-server-test"\n        imageRef="1"\n        flavorRef="2">\n    <metadata/>\n    <personality/>\n</server>"""'
newline|'\n'
name|'request'
op|'='
name|'self'
op|'.'
name|'deserializer'
op|'.'
name|'deserialize'
op|'('
name|'serial_request'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"name"'
op|':'
string|'"new-server-test"'
op|','
nl|'\n'
string|'"imageRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"flavorRef"'
op|':'
string|'"2"'
op|','
nl|'\n'
string|'"metadata"'
op|':'
op|'{'
op|'}'
op|','
nl|'\n'
string|'"personality"'
op|':'
op|'['
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'request'
op|'['
string|"'body'"
op|']'
op|','
name|'expected'
op|')'
newline|'\n'
nl|'\n'
DECL|function|test_multiple_metadata_items
dedent|''
name|'def'
name|'test_multiple_metadata_items'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serial_request'
op|'='
string|'"""\n<server xmlns="http://docs.openstack.org/compute/api/v2"\n        name="new-server-test"\n        imageRef="1"\n        flavorRef="2">\n    <metadata>\n        <meta key="one">two</meta>\n        <meta key="open">snack</meta>\n    </metadata>\n</server>"""'
newline|'\n'
name|'request'
op|'='
name|'self'
op|'.'
name|'deserializer'
op|'.'
name|'deserialize'
op|'('
name|'serial_request'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"name"'
op|':'
string|'"new-server-test"'
op|','
nl|'\n'
string|'"imageRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"flavorRef"'
op|':'
string|'"2"'
op|','
nl|'\n'
string|'"metadata"'
op|':'
op|'{'
string|'"one"'
op|':'
string|'"two"'
op|','
string|'"open"'
op|':'
string|'"snack"'
op|'}'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'request'
op|'['
string|"'body'"
op|']'
op|','
name|'expected'
op|')'
newline|'\n'
nl|'\n'
DECL|function|test_multiple_personality_files
dedent|''
name|'def'
name|'test_multiple_personality_files'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serial_request'
op|'='
string|'"""\n<server xmlns="http://docs.openstack.org/compute/api/v2"\n        name="new-server-test"\n        imageRef="1"\n        flavorRef="2">\n    <personality>\n        <file path="/etc/banner.txt">MQ==</file>\n        <file path="/etc/hosts">Mg==</file>\n    </personality>\n</server>"""'
newline|'\n'
name|'request'
op|'='
name|'self'
op|'.'
name|'deserializer'
op|'.'
name|'deserialize'
op|'('
name|'serial_request'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"name"'
op|':'
string|'"new-server-test"'
op|','
nl|'\n'
string|'"imageRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"flavorRef"'
op|':'
string|'"2"'
op|','
nl|'\n'
string|'"personality"'
op|':'
op|'['
nl|'\n'
op|'{'
string|'"path"'
op|':'
string|'"/etc/banner.txt"'
op|','
string|'"contents"'
op|':'
string|'"MQ=="'
op|'}'
op|','
nl|'\n'
op|'{'
string|'"path"'
op|':'
string|'"/etc/hosts"'
op|','
string|'"contents"'
op|':'
string|'"Mg=="'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertDictMatch'
op|'('
name|'request'
op|'['
string|"'body'"
op|']'
op|','
name|'expected'
op|')'
newline|'\n'
nl|'\n'
DECL|function|test_spec_request
dedent|''
name|'def'
name|'test_spec_request'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'image_bookmark_link'
op|'='
op|'('
string|'"http://servers.api.openstack.org/1234/"'
nl|'\n'
string|'"images/52415800-8b69-11e0-9b19-734f6f006e54"'
op|')'
newline|'\n'
name|'serial_request'
op|'='
string|'"""\n<server xmlns="http://docs.openstack.org/compute/api/v2"\n        imageRef="%s"\n        flavorRef="52415800-8b69-11e0-9b19-734f1195ff37"\n        name="new-server-test">\n  <metadata>\n    <meta key="My Server Name">Apache1</meta>\n  </metadata>\n  <personality>\n    <file path="/etc/banner.txt">Mg==</file>\n  </personality>\n</server>"""'
op|'%'
op|'('
name|'image_bookmark_link'
op|')'
newline|'\n'
name|'request'
op|'='
name|'self'
op|'.'
name|'deserializer'
op|'.'
name|'deserialize'
op|'('
name|'serial_request'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"name"'
op|':'
string|'"new-server-test"'
op|','
nl|'\n'
string|'"imageRef"'
op|':'
op|'('
string|'"http://servers.api.openstack.org/1234/"'
nl|'\n'
string|'"images/52415800-8b69-11e0-9b19-734f6f006e54"'
op|')'
op|','
nl|'\n'
string|'"flavorRef"'
op|':'
string|'"52415800-8b69-11e0-9b19-734f1195ff37"'
op|','
nl|'\n'
string|'"metadata"'
op|':'
op|'{'
string|'"My Server Name"'
op|':'
string|'"Apache1"'
op|'}'
op|','
nl|'\n'
string|'"personality"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"path"'
op|':'
string|'"/etc/banner.txt"'
op|','
nl|'\n'
string|'"contents"'
op|':'
string|'"Mg=="'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'request'
op|'['
string|"'body'"
op|']'
op|','
name|'expected'
op|')'
newline|'\n'
nl|'\n'
DECL|function|test_request_with_empty_networks
dedent|''
name|'def'
name|'test_request_with_empty_networks'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serial_request'
op|'='
string|'"""\n<server xmlns="http://docs.openstack.org/compute/api/v2"\n name="new-server-test" imageRef="1" flavorRef="1">\n    <networks/>\n</server>"""'
newline|'\n'
name|'request'
op|'='
name|'self'
op|'.'
name|'deserializer'
op|'.'
name|'deserialize'
op|'('
name|'serial_request'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'{'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"name"'
op|':'
string|'"new-server-test"'
op|','
nl|'\n'
string|'"imageRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"flavorRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"networks"'
op|':'
op|'['
op|']'
op|','
nl|'\n'
op|'}'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'request'
op|'['
string|"'body'"
op|']'
op|','
name|'expected'
op|')'
newline|'\n'
nl|'\n'
DECL|function|test_request_with_one_network
dedent|''
name|'def'
name|'test_request_with_one_network'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serial_request'
op|'='
string|'"""\n<server xmlns="http://docs.openstack.org/compute/api/v2"\n name="new-server-test" imageRef="1" flavorRef="1">\n    <networks>\n       <network uuid="1" fixed_ip="10.0.1.12"/>\n    </networks>\n</server>"""'
newline|'\n'
name|'request'
op|'='
name|'self'
op|'.'
name|'deserializer'
op|'.'
name|'deserialize'
op|'('
name|'serial_request'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'{'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"name"'
op|':'
string|'"new-server-test"'
op|','
nl|'\n'
string|'"imageRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"flavorRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"networks"'
op|':'
op|'['
op|'{'
string|'"uuid"'
op|':'
string|'"1"'
op|','
string|'"fixed_ip"'
op|':'
string|'"10.0.1.12"'
op|'}'
op|']'
op|','
nl|'\n'
op|'}'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'request'
op|'['
string|"'body'"
op|']'
op|','
name|'expected'
op|')'
newline|'\n'
nl|'\n'
DECL|function|test_request_with_two_networks
dedent|''
name|'def'
name|'test_request_with_two_networks'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serial_request'
op|'='
string|'"""\n<server xmlns="http://docs.openstack.org/compute/api/v2"\n name="new-server-test" imageRef="1" flavorRef="1">\n    <networks>\n       <network uuid="1" fixed_ip="10.0.1.12"/>\n       <network uuid="2" fixed_ip="10.0.2.12"/>\n    </networks>\n</server>"""'
newline|'\n'
name|'request'
op|'='
name|'self'
op|'.'
name|'deserializer'
op|'.'
name|'deserialize'
op|'('
name|'serial_request'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'{'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"name"'
op|':'
string|'"new-server-test"'
op|','
nl|'\n'
string|'"imageRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"flavorRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"networks"'
op|':'
op|'['
op|'{'
string|'"uuid"'
op|':'
string|'"1"'
op|','
string|'"fixed_ip"'
op|':'
string|'"10.0.1.12"'
op|'}'
op|','
nl|'\n'
op|'{'
string|'"uuid"'
op|':'
string|'"2"'
op|','
string|'"fixed_ip"'
op|':'
string|'"10.0.2.12"'
op|'}'
op|']'
op|','
nl|'\n'
op|'}'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'request'
op|'['
string|"'body'"
op|']'
op|','
name|'expected'
op|')'
newline|'\n'
nl|'\n'
DECL|function|test_request_with_second_network_node_ignored
dedent|''
name|'def'
name|'test_request_with_second_network_node_ignored'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serial_request'
op|'='
string|'"""\n<server xmlns="http://docs.openstack.org/compute/api/v2"\n name="new-server-test" imageRef="1" flavorRef="1">\n    <networks>\n       <network uuid="1" fixed_ip="10.0.1.12"/>\n    </networks>\n    <networks>\n       <network uuid="2" fixed_ip="10.0.2.12"/>\n    </networks>\n</server>"""'
newline|'\n'
name|'request'
op|'='
name|'self'
op|'.'
name|'deserializer'
op|'.'
name|'deserialize'
op|'('
name|'serial_request'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'{'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"name"'
op|':'
string|'"new-server-test"'
op|','
nl|'\n'
string|'"imageRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"flavorRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"networks"'
op|':'
op|'['
op|'{'
string|'"uuid"'
op|':'
string|'"1"'
op|','
string|'"fixed_ip"'
op|':'
string|'"10.0.1.12"'
op|'}'
op|']'
op|','
nl|'\n'
op|'}'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'request'
op|'['
string|"'body'"
op|']'
op|','
name|'expected'
op|')'
newline|'\n'
nl|'\n'
DECL|function|test_request_with_one_network_missing_id
dedent|''
name|'def'
name|'test_request_with_one_network_missing_id'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serial_request'
op|'='
string|'"""\n<server xmlns="http://docs.openstack.org/compute/api/v2"\n name="new-server-test" imageRef="1" flavorRef="1">\n    <networks>\n       <network fixed_ip="10.0.1.12"/>\n    </networks>\n</server>"""'
newline|'\n'
name|'request'
op|'='
name|'self'
op|'.'
name|'deserializer'
op|'.'
name|'deserialize'
op|'('
name|'serial_request'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'{'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"name"'
op|':'
string|'"new-server-test"'
op|','
nl|'\n'
string|'"imageRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"flavorRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"networks"'
op|':'
op|'['
op|'{'
string|'"fixed_ip"'
op|':'
string|'"10.0.1.12"'
op|'}'
op|']'
op|','
nl|'\n'
op|'}'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'request'
op|'['
string|"'body'"
op|']'
op|','
name|'expected'
op|')'
newline|'\n'
nl|'\n'
DECL|function|test_request_with_one_network_missing_fixed_ip
dedent|''
name|'def'
name|'test_request_with_one_network_missing_fixed_ip'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serial_request'
op|'='
string|'"""\n<server xmlns="http://docs.openstack.org/compute/api/v2"\n name="new-server-test" imageRef="1" flavorRef="1">\n    <networks>\n       <network uuid="1"/>\n    </networks>\n</server>"""'
newline|'\n'
name|'request'
op|'='
name|'self'
op|'.'
name|'deserializer'
op|'.'
name|'deserialize'
op|'('
name|'serial_request'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'{'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"name"'
op|':'
string|'"new-server-test"'
op|','
nl|'\n'
string|'"imageRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"flavorRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"networks"'
op|':'
op|'['
op|'{'
string|'"uuid"'
op|':'
string|'"1"'
op|'}'
op|']'
op|','
nl|'\n'
op|'}'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'request'
op|'['
string|"'body'"
op|']'
op|','
name|'expected'
op|')'
newline|'\n'
nl|'\n'
DECL|function|test_request_with_one_network_empty_id
dedent|''
name|'def'
name|'test_request_with_one_network_empty_id'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serial_request'
op|'='
string|'"""\n    <server xmlns="http://docs.openstack.org/compute/api/v2"\n     name="new-server-test" imageRef="1" flavorRef="1">\n        <networks>\n           <network uuid="" fixed_ip="10.0.1.12"/>\n        </networks>\n    </server>"""'
newline|'\n'
name|'request'
op|'='
name|'self'
op|'.'
name|'deserializer'
op|'.'
name|'deserialize'
op|'('
name|'serial_request'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'{'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"name"'
op|':'
string|'"new-server-test"'
op|','
nl|'\n'
string|'"imageRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"flavorRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"networks"'
op|':'
op|'['
op|'{'
string|'"uuid"'
op|':'
string|'""'
op|','
string|'"fixed_ip"'
op|':'
string|'"10.0.1.12"'
op|'}'
op|']'
op|','
nl|'\n'
op|'}'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'request'
op|'['
string|"'body'"
op|']'
op|','
name|'expected'
op|')'
newline|'\n'
nl|'\n'
DECL|function|test_request_with_one_network_empty_fixed_ip
dedent|''
name|'def'
name|'test_request_with_one_network_empty_fixed_ip'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serial_request'
op|'='
string|'"""\n    <server xmlns="http://docs.openstack.org/compute/api/v2"\n     name="new-server-test" imageRef="1" flavorRef="1">\n        <networks>\n           <network uuid="1" fixed_ip=""/>\n        </networks>\n    </server>"""'
newline|'\n'
name|'request'
op|'='
name|'self'
op|'.'
name|'deserializer'
op|'.'
name|'deserialize'
op|'('
name|'serial_request'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'{'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"name"'
op|':'
string|'"new-server-test"'
op|','
nl|'\n'
string|'"imageRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"flavorRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"networks"'
op|':'
op|'['
op|'{'
string|'"uuid"'
op|':'
string|'"1"'
op|','
string|'"fixed_ip"'
op|':'
string|'""'
op|'}'
op|']'
op|','
nl|'\n'
op|'}'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'request'
op|'['
string|"'body'"
op|']'
op|','
name|'expected'
op|')'
newline|'\n'
nl|'\n'
DECL|function|test_request_with_networks_duplicate_ids
dedent|''
name|'def'
name|'test_request_with_networks_duplicate_ids'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serial_request'
op|'='
string|'"""\n    <server xmlns="http://docs.openstack.org/compute/api/v2"\n     name="new-server-test" imageRef="1" flavorRef="1">\n        <networks>\n           <network uuid="1" fixed_ip="10.0.1.12"/>\n           <network uuid="1" fixed_ip="10.0.2.12"/>\n        </networks>\n    </server>"""'
newline|'\n'
name|'request'
op|'='
name|'self'
op|'.'
name|'deserializer'
op|'.'
name|'deserialize'
op|'('
name|'serial_request'
op|')'
newline|'\n'
name|'expected'
op|'='
op|'{'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"name"'
op|':'
string|'"new-server-test"'
op|','
nl|'\n'
string|'"imageRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"flavorRef"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"networks"'
op|':'
op|'['
op|'{'
string|'"uuid"'
op|':'
string|'"1"'
op|','
string|'"fixed_ip"'
op|':'
string|'"10.0.1.12"'
op|'}'
op|','
nl|'\n'
op|'{'
string|'"uuid"'
op|':'
string|'"1"'
op|','
string|'"fixed_ip"'
op|':'
string|'"10.0.2.12"'
op|'}'
op|']'
op|','
nl|'\n'
op|'}'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'assertEquals'
op|'('
name|'request'
op|'['
string|"'body'"
op|']'
op|','
name|'expected'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TestAddressesXMLSerialization
dedent|''
dedent|''
name|'class'
name|'TestAddressesXMLSerialization'
op|'('
name|'test'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|variable|index_serializer
indent|'    '
name|'index_serializer'
op|'='
name|'nova'
op|'.'
name|'api'
op|'.'
name|'openstack'
op|'.'
name|'compute'
op|'.'
name|'ips'
op|'.'
name|'AddressesTemplate'
op|'('
op|')'
newline|'\n'
DECL|variable|show_serializer
name|'show_serializer'
op|'='
name|'nova'
op|'.'
name|'api'
op|'.'
name|'openstack'
op|'.'
name|'compute'
op|'.'
name|'ips'
op|'.'
name|'NetworkTemplate'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_xml_declaration
name|'def'
name|'test_xml_declaration'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'fixture'
op|'='
op|'{'
nl|'\n'
string|"'network_2'"
op|':'
op|'['
nl|'\n'
op|'{'
string|"'addr'"
op|':'
string|"'192.168.0.1'"
op|','
string|"'version'"
op|':'
number|'4'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'addr'"
op|':'
string|"'fe80::beef'"
op|','
string|"'version'"
op|':'
number|'6'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'output'
op|'='
name|'self'
op|'.'
name|'show_serializer'
op|'.'
name|'serialize'
op|'('
name|'fixture'
op|')'
newline|'\n'
name|'has_dec'
op|'='
name|'output'
op|'.'
name|'startswith'
op|'('
string|'"<?xml version=\'1.0\' encoding=\'UTF-8\'?>"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
name|'has_dec'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_show
dedent|''
name|'def'
name|'test_show'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'fixture'
op|'='
op|'{'
nl|'\n'
string|"'network_2'"
op|':'
op|'['
nl|'\n'
op|'{'
string|"'addr'"
op|':'
string|"'192.168.0.1'"
op|','
string|"'version'"
op|':'
number|'4'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'addr'"
op|':'
string|"'fe80::beef'"
op|','
string|"'version'"
op|':'
number|'6'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'output'
op|'='
name|'self'
op|'.'
name|'show_serializer'
op|'.'
name|'serialize'
op|'('
name|'fixture'
op|')'
newline|'\n'
name|'root'
op|'='
name|'etree'
op|'.'
name|'XML'
op|'('
name|'output'
op|')'
newline|'\n'
name|'network'
op|'='
name|'fixture'
op|'['
string|"'network_2'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'root'
op|'.'
name|'get'
op|'('
string|"'id'"
op|')'
op|')'
op|','
string|"'network_2'"
op|')'
newline|'\n'
name|'ip_elems'
op|'='
name|'root'
op|'.'
name|'findall'
op|'('
string|"'{0}ip'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'for'
name|'z'
op|','
name|'ip_elem'
name|'in'
name|'enumerate'
op|'('
name|'ip_elems'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'ip'
op|'='
name|'network'
op|'['
name|'z'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'ip_elem'
op|'.'
name|'get'
op|'('
string|"'version'"
op|')'
op|')'
op|','
nl|'\n'
name|'str'
op|'('
name|'ip'
op|'['
string|"'version'"
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'ip_elem'
op|'.'
name|'get'
op|'('
string|"'addr'"
op|')'
op|')'
op|','
nl|'\n'
name|'str'
op|'('
name|'ip'
op|'['
string|"'addr'"
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_index
dedent|''
dedent|''
name|'def'
name|'test_index'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'fixture'
op|'='
op|'{'
nl|'\n'
string|"'addresses'"
op|':'
op|'{'
nl|'\n'
string|"'network_1'"
op|':'
op|'['
nl|'\n'
op|'{'
string|"'addr'"
op|':'
string|"'192.168.0.3'"
op|','
string|"'version'"
op|':'
number|'4'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'addr'"
op|':'
string|"'192.168.0.5'"
op|','
string|"'version'"
op|':'
number|'4'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
string|"'network_2'"
op|':'
op|'['
nl|'\n'
op|'{'
string|"'addr'"
op|':'
string|"'192.168.0.1'"
op|','
string|"'version'"
op|':'
number|'4'
op|'}'
op|','
nl|'\n'
op|'{'
string|"'addr'"
op|':'
string|"'fe80::beef'"
op|','
string|"'version'"
op|':'
number|'6'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
newline|'\n'
name|'output'
op|'='
name|'self'
op|'.'
name|'index_serializer'
op|'.'
name|'serialize'
op|'('
name|'fixture'
op|')'
newline|'\n'
name|'root'
op|'='
name|'etree'
op|'.'
name|'XML'
op|'('
name|'output'
op|')'
newline|'\n'
name|'xmlutil'
op|'.'
name|'validate_schema'
op|'('
name|'root'
op|','
string|"'addresses'"
op|')'
newline|'\n'
name|'addresses_dict'
op|'='
name|'fixture'
op|'['
string|"'addresses'"
op|']'
newline|'\n'
name|'network_elems'
op|'='
name|'root'
op|'.'
name|'findall'
op|'('
string|"'{0}network'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'network_elems'
op|')'
op|','
number|'2'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'network_elem'
name|'in'
name|'enumerate'
op|'('
name|'network_elems'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'network'
op|'='
name|'addresses_dict'
op|'.'
name|'items'
op|'('
op|')'
op|'['
name|'i'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'network_elem'
op|'.'
name|'get'
op|'('
string|"'id'"
op|')'
op|')'
op|','
name|'str'
op|'('
name|'network'
op|'['
number|'0'
op|']'
op|')'
op|')'
newline|'\n'
name|'ip_elems'
op|'='
name|'network_elem'
op|'.'
name|'findall'
op|'('
string|"'{0}ip'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'for'
name|'z'
op|','
name|'ip_elem'
name|'in'
name|'enumerate'
op|'('
name|'ip_elems'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'ip'
op|'='
name|'network'
op|'['
number|'1'
op|']'
op|'['
name|'z'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'ip_elem'
op|'.'
name|'get'
op|'('
string|"'version'"
op|')'
op|')'
op|','
nl|'\n'
name|'str'
op|'('
name|'ip'
op|'['
string|"'version'"
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'ip_elem'
op|'.'
name|'get'
op|'('
string|"'addr'"
op|')'
op|')'
op|','
nl|'\n'
name|'str'
op|'('
name|'ip'
op|'['
string|"'addr'"
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|ServersViewBuilderTest
dedent|''
dedent|''
dedent|''
dedent|''
name|'class'
name|'ServersViewBuilderTest'
op|'('
name|'test'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'ServersViewBuilderTest'
op|','
name|'self'
op|')'
op|'.'
name|'setUp'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'flags'
op|'('
name|'use_ipv6'
op|'='
name|'True'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'instance'
op|'='
name|'fakes'
op|'.'
name|'stub_instance'
op|'('
nl|'\n'
name|'id'
op|'='
number|'1'
op|','
nl|'\n'
name|'image_ref'
op|'='
string|'"5"'
op|','
nl|'\n'
name|'uuid'
op|'='
string|'"deadbeef-feed-edee-beef-d0ea7beefedd"'
op|','
nl|'\n'
name|'display_name'
op|'='
string|'"test_server"'
op|','
nl|'\n'
name|'include_fake_metadata'
op|'='
name|'False'
op|')'
newline|'\n'
nl|'\n'
name|'privates'
op|'='
op|'['
string|"'172.19.0.1'"
op|']'
newline|'\n'
name|'publics'
op|'='
op|'['
string|"'192.168.0.3'"
op|']'
newline|'\n'
name|'public6s'
op|'='
op|'['
string|"'b33f::fdee:ddff:fecc:bbaa'"
op|']'
newline|'\n'
nl|'\n'
DECL|function|nw_info
name|'def'
name|'nw_info'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
op|'['
op|'('
name|'None'
op|','
op|'{'
string|"'label'"
op|':'
string|"'public'"
op|','
nl|'\n'
string|"'ips'"
op|':'
op|'['
name|'dict'
op|'('
name|'ip'
op|'='
name|'ip'
op|')'
name|'for'
name|'ip'
name|'in'
name|'publics'
op|']'
op|','
nl|'\n'
string|"'ip6s'"
op|':'
op|'['
name|'dict'
op|'('
name|'ip'
op|'='
name|'ip'
op|')'
name|'for'
name|'ip'
name|'in'
name|'public6s'
op|']'
op|'}'
op|')'
op|','
nl|'\n'
op|'('
name|'None'
op|','
op|'{'
string|"'label'"
op|':'
string|"'private'"
op|','
nl|'\n'
string|"'ips'"
op|':'
op|'['
name|'dict'
op|'('
name|'ip'
op|'='
name|'ip'
op|')'
name|'for'
name|'ip'
name|'in'
name|'privates'
op|']'
op|'}'
op|')'
op|']'
newline|'\n'
nl|'\n'
DECL|function|floaters
dedent|''
name|'def'
name|'floaters'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
op|'['
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'fakes'
op|'.'
name|'stub_out_nw_api_get_instance_nw_info'
op|'('
name|'self'
op|'.'
name|'stubs'
op|','
name|'nw_info'
op|')'
newline|'\n'
name|'fakes'
op|'.'
name|'stub_out_nw_api_get_floating_ips_by_fixed_address'
op|'('
name|'self'
op|'.'
name|'stubs'
op|','
nl|'\n'
name|'floaters'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'uuid'
op|'='
name|'self'
op|'.'
name|'instance'
op|'['
string|"'uuid'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'view_builder'
op|'='
name|'views'
op|'.'
name|'servers'
op|'.'
name|'ViewBuilder'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'request'
op|'='
name|'fakes'
op|'.'
name|'HTTPRequest'
op|'.'
name|'blank'
op|'('
string|'"/v2"'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_flavor_valid_instance_type
dedent|''
name|'def'
name|'test_get_flavor_valid_instance_type'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'flavor_bookmark'
op|'='
string|'"http://localhost/fake/flavors/1"'
newline|'\n'
name|'expected'
op|'='
op|'{'
string|'"id"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
op|'{'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'flavor_bookmark'
op|'}'
op|']'
op|'}'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'view_builder'
op|'.'
name|'_get_flavor'
op|'('
name|'self'
op|'.'
name|'request'
op|','
name|'self'
op|'.'
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
name|'expected'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_get_flavor_deleted_instance_type
dedent|''
name|'def'
name|'test_get_flavor_deleted_instance_type'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'instance'
op|'['
string|"'instance_type'"
op|']'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'result'
op|'='
name|'self'
op|'.'
name|'view_builder'
op|'.'
name|'_get_flavor'
op|'('
name|'self'
op|'.'
name|'request'
op|','
name|'self'
op|'.'
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|','
op|'{'
op|'}'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_build_server
dedent|''
name|'def'
name|'test_build_server'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self_link'
op|'='
string|'"http://localhost/v2/fake/servers/%s"'
op|'%'
name|'self'
op|'.'
name|'uuid'
newline|'\n'
name|'bookmark_link'
op|'='
string|'"http://localhost/fake/servers/%s"'
op|'%'
name|'self'
op|'.'
name|'uuid'
newline|'\n'
name|'expected_server'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
name|'self'
op|'.'
name|'uuid'
op|','
nl|'\n'
string|'"name"'
op|':'
string|'"test_server"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"self"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'self_link'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'bookmark_link'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'output'
op|'='
name|'self'
op|'.'
name|'view_builder'
op|'.'
name|'basic'
op|'('
name|'self'
op|'.'
name|'request'
op|','
name|'self'
op|'.'
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertDictMatch'
op|'('
name|'output'
op|','
name|'expected_server'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_build_server_with_project_id
dedent|''
name|'def'
name|'test_build_server_with_project_id'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'expected_server'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
name|'self'
op|'.'
name|'uuid'
op|','
nl|'\n'
string|'"name"'
op|':'
string|'"test_server"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"self"'
op|','
nl|'\n'
string|'"href"'
op|':'
string|'"http://localhost/v2/fake/servers/%s"'
op|'%'
nl|'\n'
name|'self'
op|'.'
name|'uuid'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
string|'"http://localhost/fake/servers/%s"'
op|'%'
name|'self'
op|'.'
name|'uuid'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'output'
op|'='
name|'self'
op|'.'
name|'view_builder'
op|'.'
name|'basic'
op|'('
name|'self'
op|'.'
name|'request'
op|','
name|'self'
op|'.'
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertDictMatch'
op|'('
name|'output'
op|','
name|'expected_server'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_build_server_detail
dedent|''
name|'def'
name|'test_build_server_detail'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'image_bookmark'
op|'='
string|'"http://localhost/fake/images/5"'
newline|'\n'
name|'flavor_bookmark'
op|'='
string|'"http://localhost/fake/flavors/1"'
newline|'\n'
name|'self_link'
op|'='
string|'"http://localhost/v2/fake/servers/%s"'
op|'%'
name|'self'
op|'.'
name|'uuid'
newline|'\n'
name|'bookmark_link'
op|'='
string|'"http://localhost/fake/servers/%s"'
op|'%'
name|'self'
op|'.'
name|'uuid'
newline|'\n'
name|'expected_server'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
name|'self'
op|'.'
name|'uuid'
op|','
nl|'\n'
string|'"user_id"'
op|':'
string|'"fake_user"'
op|','
nl|'\n'
string|'"tenant_id"'
op|':'
string|'"fake_project"'
op|','
nl|'\n'
string|'"updated"'
op|':'
string|'"2010-11-11T11:00:00Z"'
op|','
nl|'\n'
string|'"created"'
op|':'
string|'"2010-10-10T12:00:00Z"'
op|','
nl|'\n'
string|'"progress"'
op|':'
number|'0'
op|','
nl|'\n'
string|'"name"'
op|':'
string|'"test_server"'
op|','
nl|'\n'
string|'"status"'
op|':'
string|'"BUILD"'
op|','
nl|'\n'
string|'"accessIPv4"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"accessIPv6"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"hostId"'
op|':'
string|"''"
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"5"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'image_bookmark'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"flavor"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'flavor_bookmark'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"addresses"'
op|':'
op|'{'
nl|'\n'
string|"'test1'"
op|':'
op|'['
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'4'
op|','
string|"'addr'"
op|':'
string|"'192.168.1.100'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'6'
op|','
string|"'addr'"
op|':'
string|"'2001:db8:0:1::1'"
op|'}'
nl|'\n'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"metadata"'
op|':'
op|'{'
op|'}'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"self"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'self_link'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'bookmark_link'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'output'
op|'='
name|'self'
op|'.'
name|'view_builder'
op|'.'
name|'show'
op|'('
name|'self'
op|'.'
name|'request'
op|','
name|'self'
op|'.'
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertDictMatch'
op|'('
name|'output'
op|','
name|'expected_server'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_build_server_detail_with_fault
dedent|''
name|'def'
name|'test_build_server_detail_with_fault'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'instance'
op|'['
string|"'vm_state'"
op|']'
op|'='
name|'vm_states'
op|'.'
name|'ERROR'
newline|'\n'
name|'self'
op|'.'
name|'instance'
op|'['
string|"'fault'"
op|']'
op|'='
op|'{'
nl|'\n'
string|"'code'"
op|':'
number|'404'
op|','
nl|'\n'
string|"'instance_uuid'"
op|':'
name|'self'
op|'.'
name|'uuid'
op|','
nl|'\n'
string|"'message'"
op|':'
string|'"HTTPNotFound"'
op|','
nl|'\n'
string|"'details'"
op|':'
string|'"Stock details for test"'
op|','
nl|'\n'
string|"'created_at'"
op|':'
name|'datetime'
op|'.'
name|'datetime'
op|'('
number|'2010'
op|','
number|'10'
op|','
number|'10'
op|','
number|'12'
op|','
number|'0'
op|','
number|'0'
op|')'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'image_bookmark'
op|'='
string|'"http://localhost/fake/images/5"'
newline|'\n'
name|'flavor_bookmark'
op|'='
string|'"http://localhost/fake/flavors/1"'
newline|'\n'
name|'self_link'
op|'='
string|'"http://localhost/v2/fake/servers/%s"'
op|'%'
name|'self'
op|'.'
name|'uuid'
newline|'\n'
name|'bookmark_link'
op|'='
string|'"http://localhost/fake/servers/%s"'
op|'%'
name|'self'
op|'.'
name|'uuid'
newline|'\n'
name|'expected_server'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
name|'self'
op|'.'
name|'uuid'
op|','
nl|'\n'
string|'"user_id"'
op|':'
string|'"fake_user"'
op|','
nl|'\n'
string|'"tenant_id"'
op|':'
string|'"fake_project"'
op|','
nl|'\n'
string|'"updated"'
op|':'
string|'"2010-11-11T11:00:00Z"'
op|','
nl|'\n'
string|'"created"'
op|':'
string|'"2010-10-10T12:00:00Z"'
op|','
nl|'\n'
string|'"name"'
op|':'
string|'"test_server"'
op|','
nl|'\n'
string|'"status"'
op|':'
string|'"ERROR"'
op|','
nl|'\n'
string|'"accessIPv4"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"accessIPv6"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"hostId"'
op|':'
string|"''"
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"5"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'image_bookmark'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"flavor"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'flavor_bookmark'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"addresses"'
op|':'
op|'{'
nl|'\n'
string|"'test1'"
op|':'
op|'['
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'4'
op|','
string|"'addr'"
op|':'
string|"'192.168.1.100'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'6'
op|','
string|"'addr'"
op|':'
string|"'2001:db8:0:1::1'"
op|'}'
nl|'\n'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"metadata"'
op|':'
op|'{'
op|'}'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"self"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'self_link'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'bookmark_link'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
string|'"fault"'
op|':'
op|'{'
nl|'\n'
string|'"code"'
op|':'
number|'404'
op|','
nl|'\n'
string|'"created"'
op|':'
string|'"2010-10-10T12:00:00Z"'
op|','
nl|'\n'
string|'"message"'
op|':'
string|'"HTTPNotFound"'
op|','
nl|'\n'
string|'"details"'
op|':'
string|'"Stock details for test"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'request'
op|'.'
name|'context'
op|'='
name|'nova'
op|'.'
name|'context'
op|'.'
name|'RequestContext'
op|'('
string|"'fake'"
op|','
string|"'fake'"
op|')'
newline|'\n'
name|'output'
op|'='
name|'self'
op|'.'
name|'view_builder'
op|'.'
name|'show'
op|'('
name|'self'
op|'.'
name|'request'
op|','
name|'self'
op|'.'
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertDictMatch'
op|'('
name|'output'
op|','
name|'expected_server'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_build_server_detail_with_fault_no_details_not_admin
dedent|''
name|'def'
name|'test_build_server_detail_with_fault_no_details_not_admin'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'instance'
op|'['
string|"'vm_state'"
op|']'
op|'='
name|'vm_states'
op|'.'
name|'ERROR'
newline|'\n'
name|'self'
op|'.'
name|'instance'
op|'['
string|"'fault'"
op|']'
op|'='
op|'{'
nl|'\n'
string|"'code'"
op|':'
number|'500'
op|','
nl|'\n'
string|"'instance_uuid'"
op|':'
name|'self'
op|'.'
name|'uuid'
op|','
nl|'\n'
string|"'message'"
op|':'
string|'"Error"'
op|','
nl|'\n'
string|"'details'"
op|':'
string|"'Stock details for test'"
op|','
nl|'\n'
string|"'created_at'"
op|':'
name|'datetime'
op|'.'
name|'datetime'
op|'('
number|'2010'
op|','
number|'10'
op|','
number|'10'
op|','
number|'12'
op|','
number|'0'
op|','
number|'0'
op|')'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'expected_fault'
op|'='
op|'{'
string|'"code"'
op|':'
number|'500'
op|','
nl|'\n'
string|'"created"'
op|':'
string|'"2010-10-10T12:00:00Z"'
op|','
nl|'\n'
string|'"message"'
op|':'
string|'"Error"'
op|'}'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'request'
op|'.'
name|'context'
op|'='
name|'nova'
op|'.'
name|'context'
op|'.'
name|'RequestContext'
op|'('
string|"'fake'"
op|','
string|"'fake'"
op|')'
newline|'\n'
name|'output'
op|'='
name|'self'
op|'.'
name|'view_builder'
op|'.'
name|'show'
op|'('
name|'self'
op|'.'
name|'request'
op|','
name|'self'
op|'.'
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertDictMatch'
op|'('
name|'output'
op|'['
string|"'server'"
op|']'
op|'['
string|"'fault'"
op|']'
op|','
name|'expected_fault'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_build_server_detail_with_fault_admin
dedent|''
name|'def'
name|'test_build_server_detail_with_fault_admin'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'instance'
op|'['
string|"'vm_state'"
op|']'
op|'='
name|'vm_states'
op|'.'
name|'ERROR'
newline|'\n'
name|'self'
op|'.'
name|'instance'
op|'['
string|"'fault'"
op|']'
op|'='
op|'{'
nl|'\n'
string|"'code'"
op|':'
number|'500'
op|','
nl|'\n'
string|"'instance_uuid'"
op|':'
name|'self'
op|'.'
name|'uuid'
op|','
nl|'\n'
string|"'message'"
op|':'
string|'"Error"'
op|','
nl|'\n'
string|"'details'"
op|':'
string|"'Stock details for test'"
op|','
nl|'\n'
string|"'created_at'"
op|':'
name|'datetime'
op|'.'
name|'datetime'
op|'('
number|'2010'
op|','
number|'10'
op|','
number|'10'
op|','
number|'12'
op|','
number|'0'
op|','
number|'0'
op|')'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'expected_fault'
op|'='
op|'{'
string|'"code"'
op|':'
number|'500'
op|','
nl|'\n'
string|'"created"'
op|':'
string|'"2010-10-10T12:00:00Z"'
op|','
nl|'\n'
string|'"message"'
op|':'
string|'"Error"'
op|','
nl|'\n'
string|"'details'"
op|':'
string|"'Stock details for test'"
op|'}'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'request'
op|'.'
name|'context'
op|'='
name|'nova'
op|'.'
name|'context'
op|'.'
name|'get_admin_context'
op|'('
op|')'
newline|'\n'
name|'output'
op|'='
name|'self'
op|'.'
name|'view_builder'
op|'.'
name|'show'
op|'('
name|'self'
op|'.'
name|'request'
op|','
name|'self'
op|'.'
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertDictMatch'
op|'('
name|'output'
op|'['
string|"'server'"
op|']'
op|'['
string|"'fault'"
op|']'
op|','
name|'expected_fault'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_build_server_detail_with_fault_no_details_admin
dedent|''
name|'def'
name|'test_build_server_detail_with_fault_no_details_admin'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'instance'
op|'['
string|"'vm_state'"
op|']'
op|'='
name|'vm_states'
op|'.'
name|'ERROR'
newline|'\n'
name|'self'
op|'.'
name|'instance'
op|'['
string|"'fault'"
op|']'
op|'='
op|'{'
nl|'\n'
string|"'code'"
op|':'
number|'500'
op|','
nl|'\n'
string|"'instance_uuid'"
op|':'
name|'self'
op|'.'
name|'uuid'
op|','
nl|'\n'
string|"'message'"
op|':'
string|'"Error"'
op|','
nl|'\n'
string|"'details'"
op|':'
string|"''"
op|','
nl|'\n'
string|"'created_at'"
op|':'
name|'datetime'
op|'.'
name|'datetime'
op|'('
number|'2010'
op|','
number|'10'
op|','
number|'10'
op|','
number|'12'
op|','
number|'0'
op|','
number|'0'
op|')'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'expected_fault'
op|'='
op|'{'
string|'"code"'
op|':'
number|'500'
op|','
nl|'\n'
string|'"created"'
op|':'
string|'"2010-10-10T12:00:00Z"'
op|','
nl|'\n'
string|'"message"'
op|':'
string|'"Error"'
op|'}'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'request'
op|'.'
name|'context'
op|'='
name|'nova'
op|'.'
name|'context'
op|'.'
name|'get_admin_context'
op|'('
op|')'
newline|'\n'
name|'output'
op|'='
name|'self'
op|'.'
name|'view_builder'
op|'.'
name|'show'
op|'('
name|'self'
op|'.'
name|'request'
op|','
name|'self'
op|'.'
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertDictMatch'
op|'('
name|'output'
op|'['
string|"'server'"
op|']'
op|'['
string|"'fault'"
op|']'
op|','
name|'expected_fault'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_build_server_detail_with_fault_but_active
dedent|''
name|'def'
name|'test_build_server_detail_with_fault_but_active'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'instance'
op|'['
string|"'vm_state'"
op|']'
op|'='
name|'vm_states'
op|'.'
name|'ACTIVE'
newline|'\n'
name|'self'
op|'.'
name|'instance'
op|'['
string|"'progress'"
op|']'
op|'='
number|'100'
newline|'\n'
name|'self'
op|'.'
name|'instance'
op|'['
string|"'fault'"
op|']'
op|'='
op|'{'
nl|'\n'
string|"'code'"
op|':'
number|'404'
op|','
nl|'\n'
string|"'instance_uuid'"
op|':'
name|'self'
op|'.'
name|'uuid'
op|','
nl|'\n'
string|"'message'"
op|':'
string|'"HTTPNotFound"'
op|','
nl|'\n'
string|"'details'"
op|':'
string|'"Stock details for test"'
op|','
nl|'\n'
string|"'created_at'"
op|':'
name|'datetime'
op|'.'
name|'datetime'
op|'('
number|'2010'
op|','
number|'10'
op|','
number|'10'
op|','
number|'12'
op|','
number|'0'
op|','
number|'0'
op|')'
op|','
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'image_bookmark'
op|'='
string|'"http://localhost/fake/images/5"'
newline|'\n'
name|'flavor_bookmark'
op|'='
string|'"http://localhost/fake/flavors/1"'
newline|'\n'
name|'self_link'
op|'='
string|'"http://localhost/v2/fake/servers/%s"'
op|'%'
name|'self'
op|'.'
name|'uuid'
newline|'\n'
name|'bookmark_link'
op|'='
string|'"http://localhost/fake/servers/%s"'
op|'%'
name|'self'
op|'.'
name|'uuid'
newline|'\n'
nl|'\n'
name|'output'
op|'='
name|'self'
op|'.'
name|'view_builder'
op|'.'
name|'show'
op|'('
name|'self'
op|'.'
name|'request'
op|','
name|'self'
op|'.'
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertFalse'
op|'('
string|"'fault'"
name|'in'
name|'output'
op|'['
string|"'server'"
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_build_server_detail_active_status
dedent|''
name|'def'
name|'test_build_server_detail_active_status'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'#set the power state of the instance to running'
nl|'\n'
indent|'        '
name|'self'
op|'.'
name|'instance'
op|'['
string|"'vm_state'"
op|']'
op|'='
name|'vm_states'
op|'.'
name|'ACTIVE'
newline|'\n'
name|'self'
op|'.'
name|'instance'
op|'['
string|"'progress'"
op|']'
op|'='
number|'100'
newline|'\n'
name|'image_bookmark'
op|'='
string|'"http://localhost/fake/images/5"'
newline|'\n'
name|'flavor_bookmark'
op|'='
string|'"http://localhost/fake/flavors/1"'
newline|'\n'
name|'self_link'
op|'='
string|'"http://localhost/v2/fake/servers/%s"'
op|'%'
name|'self'
op|'.'
name|'uuid'
newline|'\n'
name|'bookmark_link'
op|'='
string|'"http://localhost/fake/servers/%s"'
op|'%'
name|'self'
op|'.'
name|'uuid'
newline|'\n'
name|'expected_server'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
name|'self'
op|'.'
name|'uuid'
op|','
nl|'\n'
string|'"user_id"'
op|':'
string|'"fake_user"'
op|','
nl|'\n'
string|'"tenant_id"'
op|':'
string|'"fake_project"'
op|','
nl|'\n'
string|'"updated"'
op|':'
string|'"2010-11-11T11:00:00Z"'
op|','
nl|'\n'
string|'"created"'
op|':'
string|'"2010-10-10T12:00:00Z"'
op|','
nl|'\n'
string|'"progress"'
op|':'
number|'100'
op|','
nl|'\n'
string|'"name"'
op|':'
string|'"test_server"'
op|','
nl|'\n'
string|'"status"'
op|':'
string|'"ACTIVE"'
op|','
nl|'\n'
string|'"accessIPv4"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"accessIPv6"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"hostId"'
op|':'
string|"''"
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"5"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'image_bookmark'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"flavor"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'flavor_bookmark'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"addresses"'
op|':'
op|'{'
nl|'\n'
string|"'test1'"
op|':'
op|'['
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'4'
op|','
string|"'addr'"
op|':'
string|"'192.168.1.100'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'6'
op|','
string|"'addr'"
op|':'
string|"'2001:db8:0:1::1'"
op|'}'
nl|'\n'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"metadata"'
op|':'
op|'{'
op|'}'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"self"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'self_link'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'bookmark_link'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'output'
op|'='
name|'self'
op|'.'
name|'view_builder'
op|'.'
name|'show'
op|'('
name|'self'
op|'.'
name|'request'
op|','
name|'self'
op|'.'
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertDictMatch'
op|'('
name|'output'
op|','
name|'expected_server'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_build_server_detail_with_accessipv4
dedent|''
name|'def'
name|'test_build_server_detail_with_accessipv4'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
nl|'\n'
indent|'        '
name|'self'
op|'.'
name|'instance'
op|'['
string|"'access_ip_v4'"
op|']'
op|'='
string|"'1.2.3.4'"
newline|'\n'
nl|'\n'
name|'image_bookmark'
op|'='
string|'"http://localhost/fake/images/5"'
newline|'\n'
name|'flavor_bookmark'
op|'='
string|'"http://localhost/fake/flavors/1"'
newline|'\n'
name|'self_link'
op|'='
string|'"http://localhost/v2/fake/servers/%s"'
op|'%'
name|'self'
op|'.'
name|'uuid'
newline|'\n'
name|'bookmark_link'
op|'='
string|'"http://localhost/fake/servers/%s"'
op|'%'
name|'self'
op|'.'
name|'uuid'
newline|'\n'
name|'expected_server'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
name|'self'
op|'.'
name|'uuid'
op|','
nl|'\n'
string|'"user_id"'
op|':'
string|'"fake_user"'
op|','
nl|'\n'
string|'"tenant_id"'
op|':'
string|'"fake_project"'
op|','
nl|'\n'
string|'"updated"'
op|':'
string|'"2010-11-11T11:00:00Z"'
op|','
nl|'\n'
string|'"created"'
op|':'
string|'"2010-10-10T12:00:00Z"'
op|','
nl|'\n'
string|'"progress"'
op|':'
number|'0'
op|','
nl|'\n'
string|'"name"'
op|':'
string|'"test_server"'
op|','
nl|'\n'
string|'"status"'
op|':'
string|'"BUILD"'
op|','
nl|'\n'
string|'"hostId"'
op|':'
string|"''"
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"5"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'image_bookmark'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"flavor"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'flavor_bookmark'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"addresses"'
op|':'
op|'{'
nl|'\n'
string|"'test1'"
op|':'
op|'['
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'4'
op|','
string|"'addr'"
op|':'
string|"'192.168.1.100'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'6'
op|','
string|"'addr'"
op|':'
string|"'2001:db8:0:1::1'"
op|'}'
nl|'\n'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"metadata"'
op|':'
op|'{'
op|'}'
op|','
nl|'\n'
string|'"accessIPv4"'
op|':'
string|'"1.2.3.4"'
op|','
nl|'\n'
string|'"accessIPv6"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"self"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'self_link'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'bookmark_link'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'output'
op|'='
name|'self'
op|'.'
name|'view_builder'
op|'.'
name|'show'
op|'('
name|'self'
op|'.'
name|'request'
op|','
name|'self'
op|'.'
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertDictMatch'
op|'('
name|'output'
op|','
name|'expected_server'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_build_server_detail_with_accessipv6
dedent|''
name|'def'
name|'test_build_server_detail_with_accessipv6'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
nl|'\n'
indent|'        '
name|'self'
op|'.'
name|'instance'
op|'['
string|"'access_ip_v6'"
op|']'
op|'='
string|"'fead::1234'"
newline|'\n'
nl|'\n'
name|'image_bookmark'
op|'='
string|'"http://localhost/fake/images/5"'
newline|'\n'
name|'flavor_bookmark'
op|'='
string|'"http://localhost/fake/flavors/1"'
newline|'\n'
name|'self_link'
op|'='
string|'"http://localhost/v2/fake/servers/%s"'
op|'%'
name|'self'
op|'.'
name|'uuid'
newline|'\n'
name|'bookmark_link'
op|'='
string|'"http://localhost/fake/servers/%s"'
op|'%'
name|'self'
op|'.'
name|'uuid'
newline|'\n'
name|'expected_server'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
name|'self'
op|'.'
name|'uuid'
op|','
nl|'\n'
string|'"user_id"'
op|':'
string|'"fake_user"'
op|','
nl|'\n'
string|'"tenant_id"'
op|':'
string|'"fake_project"'
op|','
nl|'\n'
string|'"updated"'
op|':'
string|'"2010-11-11T11:00:00Z"'
op|','
nl|'\n'
string|'"created"'
op|':'
string|'"2010-10-10T12:00:00Z"'
op|','
nl|'\n'
string|'"progress"'
op|':'
number|'0'
op|','
nl|'\n'
string|'"name"'
op|':'
string|'"test_server"'
op|','
nl|'\n'
string|'"status"'
op|':'
string|'"BUILD"'
op|','
nl|'\n'
string|'"hostId"'
op|':'
string|"''"
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"5"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'image_bookmark'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"flavor"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'flavor_bookmark'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"addresses"'
op|':'
op|'{'
nl|'\n'
string|"'test1'"
op|':'
op|'['
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'4'
op|','
string|"'addr'"
op|':'
string|"'192.168.1.100'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'6'
op|','
string|"'addr'"
op|':'
string|"'2001:db8:0:1::1'"
op|'}'
nl|'\n'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"metadata"'
op|':'
op|'{'
op|'}'
op|','
nl|'\n'
string|'"accessIPv4"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"accessIPv6"'
op|':'
string|'"fead::1234"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"self"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'self_link'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'bookmark_link'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'output'
op|'='
name|'self'
op|'.'
name|'view_builder'
op|'.'
name|'show'
op|'('
name|'self'
op|'.'
name|'request'
op|','
name|'self'
op|'.'
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertDictMatch'
op|'('
name|'output'
op|','
name|'expected_server'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_build_server_detail_with_metadata
dedent|''
name|'def'
name|'test_build_server_detail_with_metadata'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
nl|'\n'
indent|'        '
name|'metadata'
op|'='
op|'['
op|']'
newline|'\n'
name|'metadata'
op|'.'
name|'append'
op|'('
name|'models'
op|'.'
name|'InstanceMetadata'
op|'('
name|'key'
op|'='
string|'"Open"'
op|','
name|'value'
op|'='
string|'"Stack"'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'instance'
op|'['
string|"'metadata'"
op|']'
op|'='
name|'metadata'
newline|'\n'
nl|'\n'
name|'image_bookmark'
op|'='
string|'"http://localhost/fake/images/5"'
newline|'\n'
name|'flavor_bookmark'
op|'='
string|'"http://localhost/fake/flavors/1"'
newline|'\n'
name|'self_link'
op|'='
string|'"http://localhost/v2/fake/servers/%s"'
op|'%'
name|'self'
op|'.'
name|'uuid'
newline|'\n'
name|'bookmark_link'
op|'='
string|'"http://localhost/fake/servers/%s"'
op|'%'
name|'self'
op|'.'
name|'uuid'
newline|'\n'
name|'expected_server'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
name|'self'
op|'.'
name|'uuid'
op|','
nl|'\n'
string|'"user_id"'
op|':'
string|'"fake_user"'
op|','
nl|'\n'
string|'"tenant_id"'
op|':'
string|'"fake_project"'
op|','
nl|'\n'
string|'"updated"'
op|':'
string|'"2010-11-11T11:00:00Z"'
op|','
nl|'\n'
string|'"created"'
op|':'
string|'"2010-10-10T12:00:00Z"'
op|','
nl|'\n'
string|'"progress"'
op|':'
number|'0'
op|','
nl|'\n'
string|'"name"'
op|':'
string|'"test_server"'
op|','
nl|'\n'
string|'"status"'
op|':'
string|'"BUILD"'
op|','
nl|'\n'
string|'"accessIPv4"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"accessIPv6"'
op|':'
string|'""'
op|','
nl|'\n'
string|'"hostId"'
op|':'
string|"''"
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"5"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'image_bookmark'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"flavor"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'flavor_bookmark'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"addresses"'
op|':'
op|'{'
nl|'\n'
string|"'test1'"
op|':'
op|'['
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'4'
op|','
string|"'addr'"
op|':'
string|"'192.168.1.100'"
op|'}'
op|','
nl|'\n'
op|'{'
string|"'version'"
op|':'
number|'6'
op|','
string|"'addr'"
op|':'
string|"'2001:db8:0:1::1'"
op|'}'
nl|'\n'
op|']'
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"metadata"'
op|':'
op|'{'
string|'"Open"'
op|':'
string|'"Stack"'
op|'}'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"self"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'self_link'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'bookmark_link'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'output'
op|'='
name|'self'
op|'.'
name|'view_builder'
op|'.'
name|'show'
op|'('
name|'self'
op|'.'
name|'request'
op|','
name|'self'
op|'.'
name|'instance'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertDictMatch'
op|'('
name|'output'
op|','
name|'expected_server'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|ServerXMLSerializationTest
dedent|''
dedent|''
name|'class'
name|'ServerXMLSerializationTest'
op|'('
name|'test'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|variable|TIMESTAMP
indent|'    '
name|'TIMESTAMP'
op|'='
string|'"2010-10-11T10:30:22Z"'
newline|'\n'
DECL|variable|SERVER_HREF
name|'SERVER_HREF'
op|'='
string|"'http://localhost/v2/servers/%s'"
op|'%'
name|'FAKE_UUID'
newline|'\n'
name|'SERVER_NEXT'
op|'='
string|"'http://localhost/v2/servers?limit=%s&marker=%s'"
newline|'\n'
DECL|variable|SERVER_BOOKMARK
name|'SERVER_BOOKMARK'
op|'='
string|"'http://localhost/servers/%s'"
op|'%'
name|'FAKE_UUID'
newline|'\n'
DECL|variable|IMAGE_BOOKMARK
name|'IMAGE_BOOKMARK'
op|'='
string|"'http://localhost/images/5'"
newline|'\n'
DECL|variable|FLAVOR_BOOKMARK
name|'FLAVOR_BOOKMARK'
op|'='
string|"'http://localhost/flavors/1'"
newline|'\n'
nl|'\n'
DECL|member|test_xml_declaration
name|'def'
name|'test_xml_declaration'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serializer'
op|'='
name|'servers'
op|'.'
name|'ServerTemplate'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'fixture'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|"'id'"
op|':'
name|'FAKE_UUID'
op|','
nl|'\n'
string|"'user_id'"
op|':'
string|"'fake_user_id'"
op|','
nl|'\n'
string|"'tenant_id'"
op|':'
string|"'fake_tenant_id'"
op|','
nl|'\n'
string|"'created'"
op|':'
name|'self'
op|'.'
name|'TIMESTAMP'
op|','
nl|'\n'
string|"'updated'"
op|':'
name|'self'
op|'.'
name|'TIMESTAMP'
op|','
nl|'\n'
string|'"progress"'
op|':'
number|'0'
op|','
nl|'\n'
string|'"name"'
op|':'
string|'"test_server"'
op|','
nl|'\n'
string|'"status"'
op|':'
string|'"BUILD"'
op|','
nl|'\n'
string|'"hostId"'
op|':'
string|"'e4d909c290d0fb1ca068ffaddf22cbd0'"
op|','
nl|'\n'
string|'"accessIPv4"'
op|':'
string|'"1.2.3.4"'
op|','
nl|'\n'
string|'"accessIPv6"'
op|':'
string|'"fead::1234"'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"5"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'self'
op|'.'
name|'IMAGE_BOOKMARK'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"flavor"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'self'
op|'.'
name|'FLAVOR_BOOKMARK'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"addresses"'
op|':'
op|'{'
nl|'\n'
string|'"network_one"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'4'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"67.23.10.138"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'6'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"::babe:67.23.10.138"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
string|'"network_two"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'4'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"67.23.10.139"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'6'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"::babe:67.23.10.139"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"metadata"'
op|':'
op|'{'
nl|'\n'
string|'"Open"'
op|':'
string|'"Stack"'
op|','
nl|'\n'
string|'"Number"'
op|':'
string|'"1"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'links'"
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|"'href'"
op|':'
name|'self'
op|'.'
name|'SERVER_HREF'
op|','
nl|'\n'
string|"'rel'"
op|':'
string|"'self'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|"'href'"
op|':'
name|'self'
op|'.'
name|'SERVER_BOOKMARK'
op|','
nl|'\n'
string|"'rel'"
op|':'
string|"'bookmark'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'output'
op|'='
name|'serializer'
op|'.'
name|'serialize'
op|'('
name|'fixture'
op|')'
newline|'\n'
name|'print'
name|'output'
newline|'\n'
name|'has_dec'
op|'='
name|'output'
op|'.'
name|'startswith'
op|'('
string|'"<?xml version=\'1.0\' encoding=\'UTF-8\'?>"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertTrue'
op|'('
name|'has_dec'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_show
dedent|''
name|'def'
name|'test_show'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serializer'
op|'='
name|'servers'
op|'.'
name|'ServerTemplate'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'fixture'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
name|'FAKE_UUID'
op|','
nl|'\n'
string|'"user_id"'
op|':'
string|'"fake"'
op|','
nl|'\n'
string|'"tenant_id"'
op|':'
string|'"fake"'
op|','
nl|'\n'
string|"'created'"
op|':'
name|'self'
op|'.'
name|'TIMESTAMP'
op|','
nl|'\n'
string|"'updated'"
op|':'
name|'self'
op|'.'
name|'TIMESTAMP'
op|','
nl|'\n'
string|'"progress"'
op|':'
number|'0'
op|','
nl|'\n'
string|'"name"'
op|':'
string|'"test_server"'
op|','
nl|'\n'
string|'"status"'
op|':'
string|'"BUILD"'
op|','
nl|'\n'
string|'"hostId"'
op|':'
string|"'e4d909c290d0fb1ca068ffaddf22cbd0'"
op|','
nl|'\n'
string|'"accessIPv4"'
op|':'
string|'"1.2.3.4"'
op|','
nl|'\n'
string|'"accessIPv6"'
op|':'
string|'"fead::1234"'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"5"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'self'
op|'.'
name|'IMAGE_BOOKMARK'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"flavor"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'self'
op|'.'
name|'FLAVOR_BOOKMARK'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"addresses"'
op|':'
op|'{'
nl|'\n'
string|'"network_one"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'4'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"67.23.10.138"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'6'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"::babe:67.23.10.138"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
string|'"network_two"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'4'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"67.23.10.139"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'6'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"::babe:67.23.10.139"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"metadata"'
op|':'
op|'{'
nl|'\n'
string|'"Open"'
op|':'
string|'"Stack"'
op|','
nl|'\n'
string|'"Number"'
op|':'
string|'"1"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'links'"
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|"'href'"
op|':'
name|'self'
op|'.'
name|'SERVER_HREF'
op|','
nl|'\n'
string|"'rel'"
op|':'
string|"'self'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|"'href'"
op|':'
name|'self'
op|'.'
name|'SERVER_BOOKMARK'
op|','
nl|'\n'
string|"'rel'"
op|':'
string|"'bookmark'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'output'
op|'='
name|'serializer'
op|'.'
name|'serialize'
op|'('
name|'fixture'
op|')'
newline|'\n'
name|'print'
name|'output'
newline|'\n'
name|'root'
op|'='
name|'etree'
op|'.'
name|'XML'
op|'('
name|'output'
op|')'
newline|'\n'
name|'xmlutil'
op|'.'
name|'validate_schema'
op|'('
name|'root'
op|','
string|"'server'"
op|')'
newline|'\n'
nl|'\n'
name|'server_dict'
op|'='
name|'fixture'
op|'['
string|"'server'"
op|']'
newline|'\n'
nl|'\n'
name|'for'
name|'key'
name|'in'
op|'['
string|"'name'"
op|','
string|"'id'"
op|','
string|"'created'"
op|','
string|"'accessIPv4'"
op|','
nl|'\n'
string|"'updated'"
op|','
string|"'progress'"
op|','
string|"'status'"
op|','
string|"'hostId'"
op|','
nl|'\n'
string|"'accessIPv6'"
op|']'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'root'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'str'
op|'('
name|'server_dict'
op|'['
name|'key'
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'link_nodes'
op|'='
name|'root'
op|'.'
name|'findall'
op|'('
string|"'{0}link'"
op|'.'
name|'format'
op|'('
name|'ATOMNS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'link_nodes'
op|')'
op|','
number|'2'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'link'
name|'in'
name|'enumerate'
op|'('
name|'server_dict'
op|'['
string|"'links'"
op|']'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'key'
op|','
name|'value'
name|'in'
name|'link'
op|'.'
name|'items'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'link_nodes'
op|'['
name|'i'
op|']'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'value'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'metadata_root'
op|'='
name|'root'
op|'.'
name|'find'
op|'('
string|"'{0}metadata'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'metadata_elems'
op|'='
name|'metadata_root'
op|'.'
name|'findall'
op|'('
string|"'{0}meta'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'metadata_elems'
op|')'
op|','
number|'2'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'metadata_elem'
name|'in'
name|'enumerate'
op|'('
name|'metadata_elems'
op|')'
op|':'
newline|'\n'
indent|'            '
op|'('
name|'meta_key'
op|','
name|'meta_value'
op|')'
op|'='
name|'server_dict'
op|'['
string|"'metadata'"
op|']'
op|'.'
name|'items'
op|'('
op|')'
op|'['
name|'i'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'metadata_elem'
op|'.'
name|'get'
op|'('
string|"'key'"
op|')'
op|')'
op|','
name|'str'
op|'('
name|'meta_key'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'metadata_elem'
op|'.'
name|'text'
op|')'
op|'.'
name|'strip'
op|'('
op|')'
op|','
name|'str'
op|'('
name|'meta_value'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'image_root'
op|'='
name|'root'
op|'.'
name|'find'
op|'('
string|"'{0}image'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'image_root'
op|'.'
name|'get'
op|'('
string|"'id'"
op|')'
op|','
name|'server_dict'
op|'['
string|"'image'"
op|']'
op|'['
string|"'id'"
op|']'
op|')'
newline|'\n'
name|'link_nodes'
op|'='
name|'image_root'
op|'.'
name|'findall'
op|'('
string|"'{0}link'"
op|'.'
name|'format'
op|'('
name|'ATOMNS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'link_nodes'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'link'
name|'in'
name|'enumerate'
op|'('
name|'server_dict'
op|'['
string|"'image'"
op|']'
op|'['
string|"'links'"
op|']'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'key'
op|','
name|'value'
name|'in'
name|'link'
op|'.'
name|'items'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'link_nodes'
op|'['
name|'i'
op|']'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'value'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'flavor_root'
op|'='
name|'root'
op|'.'
name|'find'
op|'('
string|"'{0}flavor'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'flavor_root'
op|'.'
name|'get'
op|'('
string|"'id'"
op|')'
op|','
name|'server_dict'
op|'['
string|"'flavor'"
op|']'
op|'['
string|"'id'"
op|']'
op|')'
newline|'\n'
name|'link_nodes'
op|'='
name|'flavor_root'
op|'.'
name|'findall'
op|'('
string|"'{0}link'"
op|'.'
name|'format'
op|'('
name|'ATOMNS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'link_nodes'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'link'
name|'in'
name|'enumerate'
op|'('
name|'server_dict'
op|'['
string|"'flavor'"
op|']'
op|'['
string|"'links'"
op|']'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'key'
op|','
name|'value'
name|'in'
name|'link'
op|'.'
name|'items'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'link_nodes'
op|'['
name|'i'
op|']'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'value'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'addresses_root'
op|'='
name|'root'
op|'.'
name|'find'
op|'('
string|"'{0}addresses'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'addresses_dict'
op|'='
name|'server_dict'
op|'['
string|"'addresses'"
op|']'
newline|'\n'
name|'network_elems'
op|'='
name|'addresses_root'
op|'.'
name|'findall'
op|'('
string|"'{0}network'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'network_elems'
op|')'
op|','
number|'2'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'network_elem'
name|'in'
name|'enumerate'
op|'('
name|'network_elems'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'network'
op|'='
name|'addresses_dict'
op|'.'
name|'items'
op|'('
op|')'
op|'['
name|'i'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'network_elem'
op|'.'
name|'get'
op|'('
string|"'id'"
op|')'
op|')'
op|','
name|'str'
op|'('
name|'network'
op|'['
number|'0'
op|']'
op|')'
op|')'
newline|'\n'
name|'ip_elems'
op|'='
name|'network_elem'
op|'.'
name|'findall'
op|'('
string|"'{0}ip'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'for'
name|'z'
op|','
name|'ip_elem'
name|'in'
name|'enumerate'
op|'('
name|'ip_elems'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'ip'
op|'='
name|'network'
op|'['
number|'1'
op|']'
op|'['
name|'z'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'ip_elem'
op|'.'
name|'get'
op|'('
string|"'version'"
op|')'
op|')'
op|','
nl|'\n'
name|'str'
op|'('
name|'ip'
op|'['
string|"'version'"
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'ip_elem'
op|'.'
name|'get'
op|'('
string|"'addr'"
op|')'
op|')'
op|','
nl|'\n'
name|'str'
op|'('
name|'ip'
op|'['
string|"'addr'"
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_create
dedent|''
dedent|''
dedent|''
name|'def'
name|'test_create'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serializer'
op|'='
name|'servers'
op|'.'
name|'FullServerTemplate'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'fixture'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
name|'FAKE_UUID'
op|','
nl|'\n'
string|'"user_id"'
op|':'
string|'"fake"'
op|','
nl|'\n'
string|'"tenant_id"'
op|':'
string|'"fake"'
op|','
nl|'\n'
string|"'created'"
op|':'
name|'self'
op|'.'
name|'TIMESTAMP'
op|','
nl|'\n'
string|"'updated'"
op|':'
name|'self'
op|'.'
name|'TIMESTAMP'
op|','
nl|'\n'
string|'"progress"'
op|':'
number|'0'
op|','
nl|'\n'
string|'"name"'
op|':'
string|'"test_server"'
op|','
nl|'\n'
string|'"status"'
op|':'
string|'"BUILD"'
op|','
nl|'\n'
string|'"accessIPv4"'
op|':'
string|'"1.2.3.4"'
op|','
nl|'\n'
string|'"accessIPv6"'
op|':'
string|'"fead::1234"'
op|','
nl|'\n'
string|'"hostId"'
op|':'
string|'"e4d909c290d0fb1ca068ffaddf22cbd0"'
op|','
nl|'\n'
string|'"adminPass"'
op|':'
string|'"test_password"'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"5"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'self'
op|'.'
name|'IMAGE_BOOKMARK'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"flavor"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'self'
op|'.'
name|'FLAVOR_BOOKMARK'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"addresses"'
op|':'
op|'{'
nl|'\n'
string|'"network_one"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'4'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"67.23.10.138"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'6'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"::babe:67.23.10.138"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
string|'"network_two"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'4'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"67.23.10.139"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'6'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"::babe:67.23.10.139"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"metadata"'
op|':'
op|'{'
nl|'\n'
string|'"Open"'
op|':'
string|'"Stack"'
op|','
nl|'\n'
string|'"Number"'
op|':'
string|'"1"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'links'"
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|"'href'"
op|':'
name|'self'
op|'.'
name|'SERVER_HREF'
op|','
nl|'\n'
string|"'rel'"
op|':'
string|"'self'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|"'href'"
op|':'
name|'self'
op|'.'
name|'SERVER_BOOKMARK'
op|','
nl|'\n'
string|"'rel'"
op|':'
string|"'bookmark'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'output'
op|'='
name|'serializer'
op|'.'
name|'serialize'
op|'('
name|'fixture'
op|')'
newline|'\n'
name|'print'
name|'output'
newline|'\n'
name|'root'
op|'='
name|'etree'
op|'.'
name|'XML'
op|'('
name|'output'
op|')'
newline|'\n'
name|'xmlutil'
op|'.'
name|'validate_schema'
op|'('
name|'root'
op|','
string|"'server'"
op|')'
newline|'\n'
nl|'\n'
name|'server_dict'
op|'='
name|'fixture'
op|'['
string|"'server'"
op|']'
newline|'\n'
nl|'\n'
name|'for'
name|'key'
name|'in'
op|'['
string|"'name'"
op|','
string|"'id'"
op|','
string|"'created'"
op|','
string|"'accessIPv4'"
op|','
nl|'\n'
string|"'updated'"
op|','
string|"'progress'"
op|','
string|"'status'"
op|','
string|"'hostId'"
op|','
nl|'\n'
string|"'accessIPv6'"
op|','
string|"'adminPass'"
op|']'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'root'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'str'
op|'('
name|'server_dict'
op|'['
name|'key'
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'link_nodes'
op|'='
name|'root'
op|'.'
name|'findall'
op|'('
string|"'{0}link'"
op|'.'
name|'format'
op|'('
name|'ATOMNS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'link_nodes'
op|')'
op|','
number|'2'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'link'
name|'in'
name|'enumerate'
op|'('
name|'server_dict'
op|'['
string|"'links'"
op|']'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'key'
op|','
name|'value'
name|'in'
name|'link'
op|'.'
name|'items'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'link_nodes'
op|'['
name|'i'
op|']'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'value'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'metadata_root'
op|'='
name|'root'
op|'.'
name|'find'
op|'('
string|"'{0}metadata'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'metadata_elems'
op|'='
name|'metadata_root'
op|'.'
name|'findall'
op|'('
string|"'{0}meta'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'metadata_elems'
op|')'
op|','
number|'2'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'metadata_elem'
name|'in'
name|'enumerate'
op|'('
name|'metadata_elems'
op|')'
op|':'
newline|'\n'
indent|'            '
op|'('
name|'meta_key'
op|','
name|'meta_value'
op|')'
op|'='
name|'server_dict'
op|'['
string|"'metadata'"
op|']'
op|'.'
name|'items'
op|'('
op|')'
op|'['
name|'i'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'metadata_elem'
op|'.'
name|'get'
op|'('
string|"'key'"
op|')'
op|')'
op|','
name|'str'
op|'('
name|'meta_key'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'metadata_elem'
op|'.'
name|'text'
op|')'
op|'.'
name|'strip'
op|'('
op|')'
op|','
name|'str'
op|'('
name|'meta_value'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'image_root'
op|'='
name|'root'
op|'.'
name|'find'
op|'('
string|"'{0}image'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'image_root'
op|'.'
name|'get'
op|'('
string|"'id'"
op|')'
op|','
name|'server_dict'
op|'['
string|"'image'"
op|']'
op|'['
string|"'id'"
op|']'
op|')'
newline|'\n'
name|'link_nodes'
op|'='
name|'image_root'
op|'.'
name|'findall'
op|'('
string|"'{0}link'"
op|'.'
name|'format'
op|'('
name|'ATOMNS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'link_nodes'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'link'
name|'in'
name|'enumerate'
op|'('
name|'server_dict'
op|'['
string|"'image'"
op|']'
op|'['
string|"'links'"
op|']'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'key'
op|','
name|'value'
name|'in'
name|'link'
op|'.'
name|'items'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'link_nodes'
op|'['
name|'i'
op|']'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'value'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'flavor_root'
op|'='
name|'root'
op|'.'
name|'find'
op|'('
string|"'{0}flavor'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'flavor_root'
op|'.'
name|'get'
op|'('
string|"'id'"
op|')'
op|','
name|'server_dict'
op|'['
string|"'flavor'"
op|']'
op|'['
string|"'id'"
op|']'
op|')'
newline|'\n'
name|'link_nodes'
op|'='
name|'flavor_root'
op|'.'
name|'findall'
op|'('
string|"'{0}link'"
op|'.'
name|'format'
op|'('
name|'ATOMNS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'link_nodes'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'link'
name|'in'
name|'enumerate'
op|'('
name|'server_dict'
op|'['
string|"'flavor'"
op|']'
op|'['
string|"'links'"
op|']'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'key'
op|','
name|'value'
name|'in'
name|'link'
op|'.'
name|'items'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'link_nodes'
op|'['
name|'i'
op|']'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'value'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'addresses_root'
op|'='
name|'root'
op|'.'
name|'find'
op|'('
string|"'{0}addresses'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'addresses_dict'
op|'='
name|'server_dict'
op|'['
string|"'addresses'"
op|']'
newline|'\n'
name|'network_elems'
op|'='
name|'addresses_root'
op|'.'
name|'findall'
op|'('
string|"'{0}network'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'network_elems'
op|')'
op|','
number|'2'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'network_elem'
name|'in'
name|'enumerate'
op|'('
name|'network_elems'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'network'
op|'='
name|'addresses_dict'
op|'.'
name|'items'
op|'('
op|')'
op|'['
name|'i'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'network_elem'
op|'.'
name|'get'
op|'('
string|"'id'"
op|')'
op|')'
op|','
name|'str'
op|'('
name|'network'
op|'['
number|'0'
op|']'
op|')'
op|')'
newline|'\n'
name|'ip_elems'
op|'='
name|'network_elem'
op|'.'
name|'findall'
op|'('
string|"'{0}ip'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'for'
name|'z'
op|','
name|'ip_elem'
name|'in'
name|'enumerate'
op|'('
name|'ip_elems'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'ip'
op|'='
name|'network'
op|'['
number|'1'
op|']'
op|'['
name|'z'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'ip_elem'
op|'.'
name|'get'
op|'('
string|"'version'"
op|')'
op|')'
op|','
nl|'\n'
name|'str'
op|'('
name|'ip'
op|'['
string|"'version'"
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'ip_elem'
op|'.'
name|'get'
op|'('
string|"'addr'"
op|')'
op|')'
op|','
nl|'\n'
name|'str'
op|'('
name|'ip'
op|'['
string|"'addr'"
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_index
dedent|''
dedent|''
dedent|''
name|'def'
name|'test_index'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serializer'
op|'='
name|'servers'
op|'.'
name|'MinimalServersTemplate'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'uuid1'
op|'='
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
number|'1'
op|')'
newline|'\n'
name|'uuid2'
op|'='
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
number|'2'
op|')'
newline|'\n'
name|'expected_server_href'
op|'='
string|"'http://localhost/v2/servers/%s'"
op|'%'
name|'uuid1'
newline|'\n'
name|'expected_server_bookmark'
op|'='
string|"'http://localhost/servers/%s'"
op|'%'
name|'uuid1'
newline|'\n'
name|'expected_server_href_2'
op|'='
string|"'http://localhost/v2/servers/%s'"
op|'%'
name|'uuid2'
newline|'\n'
name|'expected_server_bookmark_2'
op|'='
string|"'http://localhost/servers/%s'"
op|'%'
name|'uuid2'
newline|'\n'
name|'fixture'
op|'='
op|'{'
string|'"servers"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"id"'
op|':'
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
number|'1'
op|')'
op|','
nl|'\n'
string|'"name"'
op|':'
string|'"test_server"'
op|','
nl|'\n'
string|"'links'"
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|"'href'"
op|':'
name|'expected_server_href'
op|','
nl|'\n'
string|"'rel'"
op|':'
string|"'self'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|"'href'"
op|':'
name|'expected_server_bookmark'
op|','
nl|'\n'
string|"'rel'"
op|':'
string|"'bookmark'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"id"'
op|':'
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
number|'2'
op|')'
op|','
nl|'\n'
string|'"name"'
op|':'
string|'"test_server_2"'
op|','
nl|'\n'
string|"'links'"
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|"'href'"
op|':'
name|'expected_server_href_2'
op|','
nl|'\n'
string|"'rel'"
op|':'
string|"'self'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|"'href'"
op|':'
name|'expected_server_bookmark_2'
op|','
nl|'\n'
string|"'rel'"
op|':'
string|"'bookmark'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|'}'
newline|'\n'
nl|'\n'
name|'output'
op|'='
name|'serializer'
op|'.'
name|'serialize'
op|'('
name|'fixture'
op|')'
newline|'\n'
name|'print'
name|'output'
newline|'\n'
name|'root'
op|'='
name|'etree'
op|'.'
name|'XML'
op|'('
name|'output'
op|')'
newline|'\n'
name|'xmlutil'
op|'.'
name|'validate_schema'
op|'('
name|'root'
op|','
string|"'servers_index'"
op|')'
newline|'\n'
name|'server_elems'
op|'='
name|'root'
op|'.'
name|'findall'
op|'('
string|"'{0}server'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'server_elems'
op|')'
op|','
number|'2'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'server_elem'
name|'in'
name|'enumerate'
op|'('
name|'server_elems'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'server_dict'
op|'='
name|'fixture'
op|'['
string|"'servers'"
op|']'
op|'['
name|'i'
op|']'
newline|'\n'
name|'for'
name|'key'
name|'in'
op|'['
string|"'name'"
op|','
string|"'id'"
op|']'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'server_elem'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'str'
op|'('
name|'server_dict'
op|'['
name|'key'
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'link_nodes'
op|'='
name|'server_elem'
op|'.'
name|'findall'
op|'('
string|"'{0}link'"
op|'.'
name|'format'
op|'('
name|'ATOMNS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'link_nodes'
op|')'
op|','
number|'2'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'link'
name|'in'
name|'enumerate'
op|'('
name|'server_dict'
op|'['
string|"'links'"
op|']'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'for'
name|'key'
op|','
name|'value'
name|'in'
name|'link'
op|'.'
name|'items'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'link_nodes'
op|'['
name|'i'
op|']'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'value'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_index_with_servers_links
dedent|''
dedent|''
dedent|''
dedent|''
name|'def'
name|'test_index_with_servers_links'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serializer'
op|'='
name|'servers'
op|'.'
name|'MinimalServersTemplate'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'uuid1'
op|'='
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
number|'1'
op|')'
newline|'\n'
name|'uuid2'
op|'='
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
number|'2'
op|')'
newline|'\n'
name|'expected_server_href'
op|'='
string|"'http://localhost/v2/servers/%s'"
op|'%'
name|'uuid1'
newline|'\n'
name|'expected_server_next'
op|'='
name|'self'
op|'.'
name|'SERVER_NEXT'
op|'%'
op|'('
number|'2'
op|','
number|'2'
op|')'
newline|'\n'
name|'expected_server_bookmark'
op|'='
string|"'http://localhost/servers/%s'"
op|'%'
name|'uuid1'
newline|'\n'
name|'expected_server_href_2'
op|'='
string|"'http://localhost/v2/servers/%s'"
op|'%'
name|'uuid2'
newline|'\n'
name|'expected_server_bookmark_2'
op|'='
string|"'http://localhost/servers/%s'"
op|'%'
name|'uuid2'
newline|'\n'
name|'fixture'
op|'='
op|'{'
string|'"servers"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"id"'
op|':'
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
number|'1'
op|')'
op|','
nl|'\n'
string|'"name"'
op|':'
string|'"test_server"'
op|','
nl|'\n'
string|"'links'"
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|"'href'"
op|':'
name|'expected_server_href'
op|','
nl|'\n'
string|"'rel'"
op|':'
string|"'self'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|"'href'"
op|':'
name|'expected_server_bookmark'
op|','
nl|'\n'
string|"'rel'"
op|':'
string|"'bookmark'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"id"'
op|':'
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
number|'2'
op|')'
op|','
nl|'\n'
string|'"name"'
op|':'
string|'"test_server_2"'
op|','
nl|'\n'
string|"'links'"
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|"'href'"
op|':'
name|'expected_server_href_2'
op|','
nl|'\n'
string|"'rel'"
op|':'
string|"'self'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|"'href'"
op|':'
name|'expected_server_bookmark_2'
op|','
nl|'\n'
string|"'rel'"
op|':'
string|"'bookmark'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
string|'"servers_links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|"'rel'"
op|':'
string|"'next'"
op|','
nl|'\n'
string|"'href'"
op|':'
name|'expected_server_next'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|'}'
newline|'\n'
nl|'\n'
name|'output'
op|'='
name|'serializer'
op|'.'
name|'serialize'
op|'('
name|'fixture'
op|')'
newline|'\n'
name|'print'
name|'output'
newline|'\n'
name|'root'
op|'='
name|'etree'
op|'.'
name|'XML'
op|'('
name|'output'
op|')'
newline|'\n'
name|'xmlutil'
op|'.'
name|'validate_schema'
op|'('
name|'root'
op|','
string|"'servers_index'"
op|')'
newline|'\n'
name|'server_elems'
op|'='
name|'root'
op|'.'
name|'findall'
op|'('
string|"'{0}server'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'server_elems'
op|')'
op|','
number|'2'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'server_elem'
name|'in'
name|'enumerate'
op|'('
name|'server_elems'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'server_dict'
op|'='
name|'fixture'
op|'['
string|"'servers'"
op|']'
op|'['
name|'i'
op|']'
newline|'\n'
name|'for'
name|'key'
name|'in'
op|'['
string|"'name'"
op|','
string|"'id'"
op|']'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'server_elem'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'str'
op|'('
name|'server_dict'
op|'['
name|'key'
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'link_nodes'
op|'='
name|'server_elem'
op|'.'
name|'findall'
op|'('
string|"'{0}link'"
op|'.'
name|'format'
op|'('
name|'ATOMNS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'link_nodes'
op|')'
op|','
number|'2'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'link'
name|'in'
name|'enumerate'
op|'('
name|'server_dict'
op|'['
string|"'links'"
op|']'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'for'
name|'key'
op|','
name|'value'
name|'in'
name|'link'
op|'.'
name|'items'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'link_nodes'
op|'['
name|'i'
op|']'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'value'
op|')'
newline|'\n'
nl|'\n'
comment|'# Check servers_links'
nl|'\n'
dedent|''
dedent|''
dedent|''
name|'servers_links'
op|'='
name|'root'
op|'.'
name|'findall'
op|'('
string|"'{0}link'"
op|'.'
name|'format'
op|'('
name|'ATOMNS'
op|')'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'link'
name|'in'
name|'enumerate'
op|'('
name|'fixture'
op|'['
string|"'servers_links'"
op|']'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'key'
op|','
name|'value'
name|'in'
name|'link'
op|'.'
name|'items'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'servers_links'
op|'['
name|'i'
op|']'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'value'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_detail
dedent|''
dedent|''
dedent|''
name|'def'
name|'test_detail'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serializer'
op|'='
name|'servers'
op|'.'
name|'ServersTemplate'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'uuid1'
op|'='
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
number|'1'
op|')'
newline|'\n'
name|'expected_server_href'
op|'='
string|"'http://localhost/v2/servers/%s'"
op|'%'
name|'uuid1'
newline|'\n'
name|'expected_server_bookmark'
op|'='
string|"'http://localhost/servers/%s'"
op|'%'
name|'uuid1'
newline|'\n'
name|'expected_image_bookmark'
op|'='
name|'self'
op|'.'
name|'IMAGE_BOOKMARK'
newline|'\n'
name|'expected_flavor_bookmark'
op|'='
name|'self'
op|'.'
name|'FLAVOR_BOOKMARK'
newline|'\n'
nl|'\n'
name|'uuid2'
op|'='
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
number|'2'
op|')'
newline|'\n'
name|'expected_server_href_2'
op|'='
string|"'http://localhost/v2/servers/%s'"
op|'%'
name|'uuid2'
newline|'\n'
name|'expected_server_bookmark_2'
op|'='
string|"'http://localhost/servers/%s'"
op|'%'
name|'uuid2'
newline|'\n'
name|'fixture'
op|'='
op|'{'
string|'"servers"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"id"'
op|':'
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
number|'1'
op|')'
op|','
nl|'\n'
string|'"user_id"'
op|':'
string|'"fake"'
op|','
nl|'\n'
string|'"tenant_id"'
op|':'
string|'"fake"'
op|','
nl|'\n'
string|"'created'"
op|':'
name|'self'
op|'.'
name|'TIMESTAMP'
op|','
nl|'\n'
string|"'updated'"
op|':'
name|'self'
op|'.'
name|'TIMESTAMP'
op|','
nl|'\n'
string|'"progress"'
op|':'
number|'0'
op|','
nl|'\n'
string|'"name"'
op|':'
string|'"test_server"'
op|','
nl|'\n'
string|'"status"'
op|':'
string|'"BUILD"'
op|','
nl|'\n'
string|'"accessIPv4"'
op|':'
string|'"1.2.3.4"'
op|','
nl|'\n'
string|'"accessIPv6"'
op|':'
string|'"fead::1234"'
op|','
nl|'\n'
string|'"hostId"'
op|':'
string|"'e4d909c290d0fb1ca068ffaddf22cbd0'"
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"5"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'expected_image_bookmark'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"flavor"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'expected_flavor_bookmark'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"addresses"'
op|':'
op|'{'
nl|'\n'
string|'"network_one"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'4'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"67.23.10.138"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'6'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"::babe:67.23.10.138"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"metadata"'
op|':'
op|'{'
nl|'\n'
string|'"Number"'
op|':'
string|'"1"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"href"'
op|':'
name|'expected_server_href'
op|','
nl|'\n'
string|'"rel"'
op|':'
string|'"self"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"href"'
op|':'
name|'expected_server_bookmark'
op|','
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"id"'
op|':'
name|'fakes'
op|'.'
name|'get_fake_uuid'
op|'('
number|'2'
op|')'
op|','
nl|'\n'
string|'"user_id"'
op|':'
string|"'fake'"
op|','
nl|'\n'
string|'"tenant_id"'
op|':'
string|"'fake'"
op|','
nl|'\n'
string|"'created'"
op|':'
name|'self'
op|'.'
name|'TIMESTAMP'
op|','
nl|'\n'
string|"'updated'"
op|':'
name|'self'
op|'.'
name|'TIMESTAMP'
op|','
nl|'\n'
string|'"progress"'
op|':'
number|'100'
op|','
nl|'\n'
string|'"name"'
op|':'
string|'"test_server_2"'
op|','
nl|'\n'
string|'"status"'
op|':'
string|'"ACTIVE"'
op|','
nl|'\n'
string|'"accessIPv4"'
op|':'
string|'"1.2.3.4"'
op|','
nl|'\n'
string|'"accessIPv6"'
op|':'
string|'"fead::1234"'
op|','
nl|'\n'
string|'"hostId"'
op|':'
string|"'e4d909c290d0fb1ca068ffaddf22cbd0'"
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"5"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'expected_image_bookmark'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"flavor"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'expected_flavor_bookmark'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"addresses"'
op|':'
op|'{'
nl|'\n'
string|'"network_one"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'4'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"67.23.10.138"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'6'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"::babe:67.23.10.138"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"metadata"'
op|':'
op|'{'
nl|'\n'
string|'"Number"'
op|':'
string|'"2"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"href"'
op|':'
name|'expected_server_href_2'
op|','
nl|'\n'
string|'"rel"'
op|':'
string|'"self"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"href"'
op|':'
name|'expected_server_bookmark_2'
op|','
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|'}'
newline|'\n'
nl|'\n'
name|'output'
op|'='
name|'serializer'
op|'.'
name|'serialize'
op|'('
name|'fixture'
op|')'
newline|'\n'
name|'root'
op|'='
name|'etree'
op|'.'
name|'XML'
op|'('
name|'output'
op|')'
newline|'\n'
name|'xmlutil'
op|'.'
name|'validate_schema'
op|'('
name|'root'
op|','
string|"'servers'"
op|')'
newline|'\n'
name|'server_elems'
op|'='
name|'root'
op|'.'
name|'findall'
op|'('
string|"'{0}server'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'server_elems'
op|')'
op|','
number|'2'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'server_elem'
name|'in'
name|'enumerate'
op|'('
name|'server_elems'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'server_dict'
op|'='
name|'fixture'
op|'['
string|"'servers'"
op|']'
op|'['
name|'i'
op|']'
newline|'\n'
nl|'\n'
name|'for'
name|'key'
name|'in'
op|'['
string|"'name'"
op|','
string|"'id'"
op|','
string|"'created'"
op|','
string|"'accessIPv4'"
op|','
nl|'\n'
string|"'updated'"
op|','
string|"'progress'"
op|','
string|"'status'"
op|','
string|"'hostId'"
op|','
nl|'\n'
string|"'accessIPv6'"
op|']'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'server_elem'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'str'
op|'('
name|'server_dict'
op|'['
name|'key'
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'link_nodes'
op|'='
name|'server_elem'
op|'.'
name|'findall'
op|'('
string|"'{0}link'"
op|'.'
name|'format'
op|'('
name|'ATOMNS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'link_nodes'
op|')'
op|','
number|'2'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'link'
name|'in'
name|'enumerate'
op|'('
name|'server_dict'
op|'['
string|"'links'"
op|']'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'for'
name|'key'
op|','
name|'value'
name|'in'
name|'link'
op|'.'
name|'items'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'link_nodes'
op|'['
name|'i'
op|']'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'value'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'metadata_root'
op|'='
name|'server_elem'
op|'.'
name|'find'
op|'('
string|"'{0}metadata'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'metadata_elems'
op|'='
name|'metadata_root'
op|'.'
name|'findall'
op|'('
string|"'{0}meta'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'metadata_elem'
name|'in'
name|'enumerate'
op|'('
name|'metadata_elems'
op|')'
op|':'
newline|'\n'
indent|'                '
op|'('
name|'meta_key'
op|','
name|'meta_value'
op|')'
op|'='
name|'server_dict'
op|'['
string|"'metadata'"
op|']'
op|'.'
name|'items'
op|'('
op|')'
op|'['
name|'i'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'metadata_elem'
op|'.'
name|'get'
op|'('
string|"'key'"
op|')'
op|')'
op|','
name|'str'
op|'('
name|'meta_key'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'metadata_elem'
op|'.'
name|'text'
op|')'
op|'.'
name|'strip'
op|'('
op|')'
op|','
nl|'\n'
name|'str'
op|'('
name|'meta_value'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'image_root'
op|'='
name|'server_elem'
op|'.'
name|'find'
op|'('
string|"'{0}image'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'image_root'
op|'.'
name|'get'
op|'('
string|"'id'"
op|')'
op|','
name|'server_dict'
op|'['
string|"'image'"
op|']'
op|'['
string|"'id'"
op|']'
op|')'
newline|'\n'
name|'link_nodes'
op|'='
name|'image_root'
op|'.'
name|'findall'
op|'('
string|"'{0}link'"
op|'.'
name|'format'
op|'('
name|'ATOMNS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'link_nodes'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'link'
name|'in'
name|'enumerate'
op|'('
name|'server_dict'
op|'['
string|"'image'"
op|']'
op|'['
string|"'links'"
op|']'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'for'
name|'key'
op|','
name|'value'
name|'in'
name|'link'
op|'.'
name|'items'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'link_nodes'
op|'['
name|'i'
op|']'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'value'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'flavor_root'
op|'='
name|'server_elem'
op|'.'
name|'find'
op|'('
string|"'{0}flavor'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'flavor_root'
op|'.'
name|'get'
op|'('
string|"'id'"
op|')'
op|','
nl|'\n'
name|'server_dict'
op|'['
string|"'flavor'"
op|']'
op|'['
string|"'id'"
op|']'
op|')'
newline|'\n'
name|'link_nodes'
op|'='
name|'flavor_root'
op|'.'
name|'findall'
op|'('
string|"'{0}link'"
op|'.'
name|'format'
op|'('
name|'ATOMNS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'link_nodes'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'link'
name|'in'
name|'enumerate'
op|'('
name|'server_dict'
op|'['
string|"'flavor'"
op|']'
op|'['
string|"'links'"
op|']'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'for'
name|'key'
op|','
name|'value'
name|'in'
name|'link'
op|'.'
name|'items'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'link_nodes'
op|'['
name|'i'
op|']'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'value'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'addresses_root'
op|'='
name|'server_elem'
op|'.'
name|'find'
op|'('
string|"'{0}addresses'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'addresses_dict'
op|'='
name|'server_dict'
op|'['
string|"'addresses'"
op|']'
newline|'\n'
name|'network_elems'
op|'='
name|'addresses_root'
op|'.'
name|'findall'
op|'('
string|"'{0}network'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'network_elem'
name|'in'
name|'enumerate'
op|'('
name|'network_elems'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'network'
op|'='
name|'addresses_dict'
op|'.'
name|'items'
op|'('
op|')'
op|'['
name|'i'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'network_elem'
op|'.'
name|'get'
op|'('
string|"'id'"
op|')'
op|')'
op|','
name|'str'
op|'('
name|'network'
op|'['
number|'0'
op|']'
op|')'
op|')'
newline|'\n'
name|'ip_elems'
op|'='
name|'network_elem'
op|'.'
name|'findall'
op|'('
string|"'{0}ip'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'for'
name|'z'
op|','
name|'ip_elem'
name|'in'
name|'enumerate'
op|'('
name|'ip_elems'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'ip'
op|'='
name|'network'
op|'['
number|'1'
op|']'
op|'['
name|'z'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'ip_elem'
op|'.'
name|'get'
op|'('
string|"'version'"
op|')'
op|')'
op|','
nl|'\n'
name|'str'
op|'('
name|'ip'
op|'['
string|"'version'"
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'ip_elem'
op|'.'
name|'get'
op|'('
string|"'addr'"
op|')'
op|')'
op|','
nl|'\n'
name|'str'
op|'('
name|'ip'
op|'['
string|"'addr'"
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_update
dedent|''
dedent|''
dedent|''
dedent|''
name|'def'
name|'test_update'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serializer'
op|'='
name|'servers'
op|'.'
name|'ServerTemplate'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'fixture'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
name|'FAKE_UUID'
op|','
nl|'\n'
string|'"user_id"'
op|':'
string|'"fake"'
op|','
nl|'\n'
string|'"tenant_id"'
op|':'
string|'"fake"'
op|','
nl|'\n'
string|"'created'"
op|':'
name|'self'
op|'.'
name|'TIMESTAMP'
op|','
nl|'\n'
string|"'updated'"
op|':'
name|'self'
op|'.'
name|'TIMESTAMP'
op|','
nl|'\n'
string|'"progress"'
op|':'
number|'0'
op|','
nl|'\n'
string|'"name"'
op|':'
string|'"test_server"'
op|','
nl|'\n'
string|'"status"'
op|':'
string|'"BUILD"'
op|','
nl|'\n'
string|'"hostId"'
op|':'
string|"'e4d909c290d0fb1ca068ffaddf22cbd0'"
op|','
nl|'\n'
string|'"accessIPv4"'
op|':'
string|'"1.2.3.4"'
op|','
nl|'\n'
string|'"accessIPv6"'
op|':'
string|'"fead::1234"'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"5"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'self'
op|'.'
name|'IMAGE_BOOKMARK'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"flavor"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'self'
op|'.'
name|'FLAVOR_BOOKMARK'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"addresses"'
op|':'
op|'{'
nl|'\n'
string|'"network_one"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'4'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"67.23.10.138"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'6'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"::babe:67.23.10.138"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
string|'"network_two"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'4'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"67.23.10.139"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'6'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"::babe:67.23.10.139"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"metadata"'
op|':'
op|'{'
nl|'\n'
string|'"Open"'
op|':'
string|'"Stack"'
op|','
nl|'\n'
string|'"Number"'
op|':'
string|'"1"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'links'"
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|"'href'"
op|':'
name|'self'
op|'.'
name|'SERVER_HREF'
op|','
nl|'\n'
string|"'rel'"
op|':'
string|"'self'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|"'href'"
op|':'
name|'self'
op|'.'
name|'SERVER_BOOKMARK'
op|','
nl|'\n'
string|"'rel'"
op|':'
string|"'bookmark'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
string|'"fault"'
op|':'
op|'{'
nl|'\n'
string|'"code"'
op|':'
number|'500'
op|','
nl|'\n'
string|'"created"'
op|':'
name|'self'
op|'.'
name|'TIMESTAMP'
op|','
nl|'\n'
string|'"message"'
op|':'
string|'"Error Message"'
op|','
nl|'\n'
string|'"details"'
op|':'
string|'"Fault details"'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'output'
op|'='
name|'serializer'
op|'.'
name|'serialize'
op|'('
name|'fixture'
op|')'
newline|'\n'
name|'print'
name|'output'
newline|'\n'
name|'root'
op|'='
name|'etree'
op|'.'
name|'XML'
op|'('
name|'output'
op|')'
newline|'\n'
name|'xmlutil'
op|'.'
name|'validate_schema'
op|'('
name|'root'
op|','
string|"'server'"
op|')'
newline|'\n'
nl|'\n'
name|'server_dict'
op|'='
name|'fixture'
op|'['
string|"'server'"
op|']'
newline|'\n'
nl|'\n'
name|'for'
name|'key'
name|'in'
op|'['
string|"'name'"
op|','
string|"'id'"
op|','
string|"'created'"
op|','
string|"'accessIPv4'"
op|','
nl|'\n'
string|"'updated'"
op|','
string|"'progress'"
op|','
string|"'status'"
op|','
string|"'hostId'"
op|','
nl|'\n'
string|"'accessIPv6'"
op|']'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'root'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'str'
op|'('
name|'server_dict'
op|'['
name|'key'
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'link_nodes'
op|'='
name|'root'
op|'.'
name|'findall'
op|'('
string|"'{0}link'"
op|'.'
name|'format'
op|'('
name|'ATOMNS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'link_nodes'
op|')'
op|','
number|'2'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'link'
name|'in'
name|'enumerate'
op|'('
name|'server_dict'
op|'['
string|"'links'"
op|']'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'key'
op|','
name|'value'
name|'in'
name|'link'
op|'.'
name|'items'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'link_nodes'
op|'['
name|'i'
op|']'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'value'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'metadata_root'
op|'='
name|'root'
op|'.'
name|'find'
op|'('
string|"'{0}metadata'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'metadata_elems'
op|'='
name|'metadata_root'
op|'.'
name|'findall'
op|'('
string|"'{0}meta'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'metadata_elems'
op|')'
op|','
number|'2'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'metadata_elem'
name|'in'
name|'enumerate'
op|'('
name|'metadata_elems'
op|')'
op|':'
newline|'\n'
indent|'            '
op|'('
name|'meta_key'
op|','
name|'meta_value'
op|')'
op|'='
name|'server_dict'
op|'['
string|"'metadata'"
op|']'
op|'.'
name|'items'
op|'('
op|')'
op|'['
name|'i'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'metadata_elem'
op|'.'
name|'get'
op|'('
string|"'key'"
op|')'
op|')'
op|','
name|'str'
op|'('
name|'meta_key'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'metadata_elem'
op|'.'
name|'text'
op|')'
op|'.'
name|'strip'
op|'('
op|')'
op|','
name|'str'
op|'('
name|'meta_value'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'image_root'
op|'='
name|'root'
op|'.'
name|'find'
op|'('
string|"'{0}image'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'image_root'
op|'.'
name|'get'
op|'('
string|"'id'"
op|')'
op|','
name|'server_dict'
op|'['
string|"'image'"
op|']'
op|'['
string|"'id'"
op|']'
op|')'
newline|'\n'
name|'link_nodes'
op|'='
name|'image_root'
op|'.'
name|'findall'
op|'('
string|"'{0}link'"
op|'.'
name|'format'
op|'('
name|'ATOMNS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'link_nodes'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'link'
name|'in'
name|'enumerate'
op|'('
name|'server_dict'
op|'['
string|"'image'"
op|']'
op|'['
string|"'links'"
op|']'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'key'
op|','
name|'value'
name|'in'
name|'link'
op|'.'
name|'items'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'link_nodes'
op|'['
name|'i'
op|']'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'value'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'flavor_root'
op|'='
name|'root'
op|'.'
name|'find'
op|'('
string|"'{0}flavor'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'flavor_root'
op|'.'
name|'get'
op|'('
string|"'id'"
op|')'
op|','
name|'server_dict'
op|'['
string|"'flavor'"
op|']'
op|'['
string|"'id'"
op|']'
op|')'
newline|'\n'
name|'link_nodes'
op|'='
name|'flavor_root'
op|'.'
name|'findall'
op|'('
string|"'{0}link'"
op|'.'
name|'format'
op|'('
name|'ATOMNS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'link_nodes'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'link'
name|'in'
name|'enumerate'
op|'('
name|'server_dict'
op|'['
string|"'flavor'"
op|']'
op|'['
string|"'links'"
op|']'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'key'
op|','
name|'value'
name|'in'
name|'link'
op|'.'
name|'items'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'link_nodes'
op|'['
name|'i'
op|']'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'value'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'addresses_root'
op|'='
name|'root'
op|'.'
name|'find'
op|'('
string|"'{0}addresses'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'addresses_dict'
op|'='
name|'server_dict'
op|'['
string|"'addresses'"
op|']'
newline|'\n'
name|'network_elems'
op|'='
name|'addresses_root'
op|'.'
name|'findall'
op|'('
string|"'{0}network'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'network_elems'
op|')'
op|','
number|'2'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'network_elem'
name|'in'
name|'enumerate'
op|'('
name|'network_elems'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'network'
op|'='
name|'addresses_dict'
op|'.'
name|'items'
op|'('
op|')'
op|'['
name|'i'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'network_elem'
op|'.'
name|'get'
op|'('
string|"'id'"
op|')'
op|')'
op|','
name|'str'
op|'('
name|'network'
op|'['
number|'0'
op|']'
op|')'
op|')'
newline|'\n'
name|'ip_elems'
op|'='
name|'network_elem'
op|'.'
name|'findall'
op|'('
string|"'{0}ip'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'for'
name|'z'
op|','
name|'ip_elem'
name|'in'
name|'enumerate'
op|'('
name|'ip_elems'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'ip'
op|'='
name|'network'
op|'['
number|'1'
op|']'
op|'['
name|'z'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'ip_elem'
op|'.'
name|'get'
op|'('
string|"'version'"
op|')'
op|')'
op|','
nl|'\n'
name|'str'
op|'('
name|'ip'
op|'['
string|"'version'"
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'ip_elem'
op|'.'
name|'get'
op|'('
string|"'addr'"
op|')'
op|')'
op|','
nl|'\n'
name|'str'
op|'('
name|'ip'
op|'['
string|"'addr'"
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'fault_root'
op|'='
name|'root'
op|'.'
name|'find'
op|'('
string|"'{0}fault'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'fault_dict'
op|'='
name|'server_dict'
op|'['
string|"'fault'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'fault_root'
op|'.'
name|'get'
op|'('
string|'"code"'
op|')'
op|','
name|'str'
op|'('
name|'fault_dict'
op|'['
string|'"code"'
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'fault_root'
op|'.'
name|'get'
op|'('
string|'"created"'
op|')'
op|','
name|'fault_dict'
op|'['
string|'"created"'
op|']'
op|')'
newline|'\n'
name|'msg_elem'
op|'='
name|'fault_root'
op|'.'
name|'find'
op|'('
string|"'{0}message'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'msg_elem'
op|'.'
name|'text'
op|','
name|'fault_dict'
op|'['
string|'"message"'
op|']'
op|')'
newline|'\n'
name|'det_elem'
op|'='
name|'fault_root'
op|'.'
name|'find'
op|'('
string|"'{0}details'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'det_elem'
op|'.'
name|'text'
op|','
name|'fault_dict'
op|'['
string|'"details"'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_action
dedent|''
name|'def'
name|'test_action'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'serializer'
op|'='
name|'servers'
op|'.'
name|'FullServerTemplate'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'fixture'
op|'='
op|'{'
nl|'\n'
string|'"server"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
name|'FAKE_UUID'
op|','
nl|'\n'
string|'"user_id"'
op|':'
string|'"fake"'
op|','
nl|'\n'
string|'"tenant_id"'
op|':'
string|'"fake"'
op|','
nl|'\n'
string|"'created'"
op|':'
name|'self'
op|'.'
name|'TIMESTAMP'
op|','
nl|'\n'
string|"'updated'"
op|':'
name|'self'
op|'.'
name|'TIMESTAMP'
op|','
nl|'\n'
string|'"progress"'
op|':'
number|'0'
op|','
nl|'\n'
string|'"name"'
op|':'
string|'"test_server"'
op|','
nl|'\n'
string|'"status"'
op|':'
string|'"BUILD"'
op|','
nl|'\n'
string|'"accessIPv4"'
op|':'
string|'"1.2.3.4"'
op|','
nl|'\n'
string|'"accessIPv6"'
op|':'
string|'"fead::1234"'
op|','
nl|'\n'
string|'"hostId"'
op|':'
string|'"e4d909c290d0fb1ca068ffaddf22cbd0"'
op|','
nl|'\n'
string|'"adminPass"'
op|':'
string|'"test_password"'
op|','
nl|'\n'
string|'"image"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"5"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'self'
op|'.'
name|'IMAGE_BOOKMARK'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"flavor"'
op|':'
op|'{'
nl|'\n'
string|'"id"'
op|':'
string|'"1"'
op|','
nl|'\n'
string|'"links"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"rel"'
op|':'
string|'"bookmark"'
op|','
nl|'\n'
string|'"href"'
op|':'
name|'self'
op|'.'
name|'FLAVOR_BOOKMARK'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"addresses"'
op|':'
op|'{'
nl|'\n'
string|'"network_one"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'4'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"67.23.10.138"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'6'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"::babe:67.23.10.138"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
string|'"network_two"'
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'4'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"67.23.10.139"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|'"version"'
op|':'
number|'6'
op|','
nl|'\n'
string|'"addr"'
op|':'
string|'"::babe:67.23.10.139"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|'"metadata"'
op|':'
op|'{'
nl|'\n'
string|'"Open"'
op|':'
string|'"Stack"'
op|','
nl|'\n'
string|'"Number"'
op|':'
string|'"1"'
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
string|"'links'"
op|':'
op|'['
nl|'\n'
op|'{'
nl|'\n'
string|"'href'"
op|':'
name|'self'
op|'.'
name|'SERVER_HREF'
op|','
nl|'\n'
string|"'rel'"
op|':'
string|"'self'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|'{'
nl|'\n'
string|"'href'"
op|':'
name|'self'
op|'.'
name|'SERVER_BOOKMARK'
op|','
nl|'\n'
string|"'rel'"
op|':'
string|"'bookmark'"
op|','
nl|'\n'
op|'}'
op|','
nl|'\n'
op|']'
op|','
nl|'\n'
op|'}'
nl|'\n'
op|'}'
newline|'\n'
nl|'\n'
name|'output'
op|'='
name|'serializer'
op|'.'
name|'serialize'
op|'('
name|'fixture'
op|')'
newline|'\n'
name|'root'
op|'='
name|'etree'
op|'.'
name|'XML'
op|'('
name|'output'
op|')'
newline|'\n'
name|'xmlutil'
op|'.'
name|'validate_schema'
op|'('
name|'root'
op|','
string|"'server'"
op|')'
newline|'\n'
nl|'\n'
name|'server_dict'
op|'='
name|'fixture'
op|'['
string|"'server'"
op|']'
newline|'\n'
nl|'\n'
name|'for'
name|'key'
name|'in'
op|'['
string|"'name'"
op|','
string|"'id'"
op|','
string|"'created'"
op|','
string|"'accessIPv4'"
op|','
nl|'\n'
string|"'updated'"
op|','
string|"'progress'"
op|','
string|"'status'"
op|','
string|"'hostId'"
op|','
nl|'\n'
string|"'accessIPv6'"
op|','
string|"'adminPass'"
op|']'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'root'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'str'
op|'('
name|'server_dict'
op|'['
name|'key'
op|']'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'link_nodes'
op|'='
name|'root'
op|'.'
name|'findall'
op|'('
string|"'{0}link'"
op|'.'
name|'format'
op|'('
name|'ATOMNS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'link_nodes'
op|')'
op|','
number|'2'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'link'
name|'in'
name|'enumerate'
op|'('
name|'server_dict'
op|'['
string|"'links'"
op|']'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'key'
op|','
name|'value'
name|'in'
name|'link'
op|'.'
name|'items'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'link_nodes'
op|'['
name|'i'
op|']'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'value'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'metadata_root'
op|'='
name|'root'
op|'.'
name|'find'
op|'('
string|"'{0}metadata'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'metadata_elems'
op|'='
name|'metadata_root'
op|'.'
name|'findall'
op|'('
string|"'{0}meta'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'metadata_elems'
op|')'
op|','
number|'2'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'metadata_elem'
name|'in'
name|'enumerate'
op|'('
name|'metadata_elems'
op|')'
op|':'
newline|'\n'
indent|'            '
op|'('
name|'meta_key'
op|','
name|'meta_value'
op|')'
op|'='
name|'server_dict'
op|'['
string|"'metadata'"
op|']'
op|'.'
name|'items'
op|'('
op|')'
op|'['
name|'i'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'metadata_elem'
op|'.'
name|'get'
op|'('
string|"'key'"
op|')'
op|')'
op|','
name|'str'
op|'('
name|'meta_key'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'metadata_elem'
op|'.'
name|'text'
op|')'
op|'.'
name|'strip'
op|'('
op|')'
op|','
name|'str'
op|'('
name|'meta_value'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'image_root'
op|'='
name|'root'
op|'.'
name|'find'
op|'('
string|"'{0}image'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'image_root'
op|'.'
name|'get'
op|'('
string|"'id'"
op|')'
op|','
name|'server_dict'
op|'['
string|"'image'"
op|']'
op|'['
string|"'id'"
op|']'
op|')'
newline|'\n'
name|'link_nodes'
op|'='
name|'image_root'
op|'.'
name|'findall'
op|'('
string|"'{0}link'"
op|'.'
name|'format'
op|'('
name|'ATOMNS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'link_nodes'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'link'
name|'in'
name|'enumerate'
op|'('
name|'server_dict'
op|'['
string|"'image'"
op|']'
op|'['
string|"'links'"
op|']'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'key'
op|','
name|'value'
name|'in'
name|'link'
op|'.'
name|'items'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'link_nodes'
op|'['
name|'i'
op|']'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'value'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'flavor_root'
op|'='
name|'root'
op|'.'
name|'find'
op|'('
string|"'{0}flavor'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'flavor_root'
op|'.'
name|'get'
op|'('
string|"'id'"
op|')'
op|','
name|'server_dict'
op|'['
string|"'flavor'"
op|']'
op|'['
string|"'id'"
op|']'
op|')'
newline|'\n'
name|'link_nodes'
op|'='
name|'flavor_root'
op|'.'
name|'findall'
op|'('
string|"'{0}link'"
op|'.'
name|'format'
op|'('
name|'ATOMNS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'link_nodes'
op|')'
op|','
number|'1'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'link'
name|'in'
name|'enumerate'
op|'('
name|'server_dict'
op|'['
string|"'flavor'"
op|']'
op|'['
string|"'links'"
op|']'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'key'
op|','
name|'value'
name|'in'
name|'link'
op|'.'
name|'items'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'link_nodes'
op|'['
name|'i'
op|']'
op|'.'
name|'get'
op|'('
name|'key'
op|')'
op|','
name|'value'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'addresses_root'
op|'='
name|'root'
op|'.'
name|'find'
op|'('
string|"'{0}addresses'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'addresses_dict'
op|'='
name|'server_dict'
op|'['
string|"'addresses'"
op|']'
newline|'\n'
name|'network_elems'
op|'='
name|'addresses_root'
op|'.'
name|'findall'
op|'('
string|"'{0}network'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'network_elems'
op|')'
op|','
number|'2'
op|')'
newline|'\n'
name|'for'
name|'i'
op|','
name|'network_elem'
name|'in'
name|'enumerate'
op|'('
name|'network_elems'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'network'
op|'='
name|'addresses_dict'
op|'.'
name|'items'
op|'('
op|')'
op|'['
name|'i'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'network_elem'
op|'.'
name|'get'
op|'('
string|"'id'"
op|')'
op|')'
op|','
name|'str'
op|'('
name|'network'
op|'['
number|'0'
op|']'
op|')'
op|')'
newline|'\n'
name|'ip_elems'
op|'='
name|'network_elem'
op|'.'
name|'findall'
op|'('
string|"'{0}ip'"
op|'.'
name|'format'
op|'('
name|'NS'
op|')'
op|')'
newline|'\n'
name|'for'
name|'z'
op|','
name|'ip_elem'
name|'in'
name|'enumerate'
op|'('
name|'ip_elems'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'ip'
op|'='
name|'network'
op|'['
number|'1'
op|']'
op|'['
name|'z'
op|']'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'ip_elem'
op|'.'
name|'get'
op|'('
string|"'version'"
op|')'
op|')'
op|','
nl|'\n'
name|'str'
op|'('
name|'ip'
op|'['
string|"'version'"
op|']'
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'str'
op|'('
name|'ip_elem'
op|'.'
name|'get'
op|'('
string|"'addr'"
op|')'
op|')'
op|','
nl|'\n'
name|'str'
op|'('
name|'ip'
op|'['
string|"'addr'"
op|']'
op|')'
op|')'
newline|'\n'
dedent|''
dedent|''
dedent|''
dedent|''
endmarker|''
end_unit
