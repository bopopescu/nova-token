begin_unit
name|'import'
name|'datetime'
newline|'\n'
name|'import'
name|'json'
newline|'\n'
nl|'\n'
name|'import'
name|'webob'
newline|'\n'
name|'import'
name|'webob'
op|'.'
name|'dec'
newline|'\n'
nl|'\n'
name|'from'
name|'nova'
name|'import'
name|'auth'
newline|'\n'
name|'from'
name|'nova'
name|'import'
name|'utils'
newline|'\n'
name|'from'
name|'nova'
name|'import'
name|'flags'
newline|'\n'
name|'import'
name|'nova'
op|'.'
name|'api'
op|'.'
name|'rackspace'
op|'.'
name|'auth'
newline|'\n'
name|'import'
name|'nova'
op|'.'
name|'api'
op|'.'
name|'rackspace'
op|'.'
name|'_id_translator'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'image'
name|'import'
name|'service'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'wsgi'
name|'import'
name|'Router'
newline|'\n'
nl|'\n'
DECL|variable|FLAGS
name|'FLAGS'
op|'='
name|'flags'
op|'.'
name|'FLAGS'
newline|'\n'
nl|'\n'
DECL|class|Context
name|'class'
name|'Context'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'pass'
newline|'\n'
nl|'\n'
DECL|class|FakeRouter
dedent|''
name|'class'
name|'FakeRouter'
op|'('
name|'Router'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pass'
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'webob'
op|'.'
name|'dec'
op|'.'
name|'wsgify'
newline|'\n'
DECL|member|__call__
name|'def'
name|'__call__'
op|'('
name|'self'
op|','
name|'req'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'res'
op|'='
name|'webob'
op|'.'
name|'Response'
op|'('
op|')'
newline|'\n'
name|'res'
op|'.'
name|'status'
op|'='
string|"'200'"
newline|'\n'
name|'res'
op|'.'
name|'headers'
op|'['
string|"'X-Test-Success'"
op|']'
op|'='
string|"'True'"
newline|'\n'
name|'return'
name|'res'
newline|'\n'
nl|'\n'
DECL|function|fake_auth_init
dedent|''
dedent|''
name|'def'
name|'fake_auth_init'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'self'
op|'.'
name|'db'
op|'='
name|'FakeAuthDatabase'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'context'
op|'='
name|'Context'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'auth'
op|'='
name|'FakeAuthManager'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'host'
op|'='
string|"'foo'"
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'webob'
op|'.'
name|'dec'
op|'.'
name|'wsgify'
newline|'\n'
DECL|function|fake_wsgi
name|'def'
name|'fake_wsgi'
op|'('
name|'self'
op|','
name|'req'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'req'
op|'.'
name|'environ'
op|'['
string|"'nova.context'"
op|']'
op|'='
name|'dict'
op|'('
name|'user'
op|'='
name|'dict'
op|'('
name|'id'
op|'='
number|'1'
op|')'
op|')'
newline|'\n'
name|'if'
name|'req'
op|'.'
name|'body'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'.'
name|'environ'
op|'['
string|"'inst_dict'"
op|']'
op|'='
name|'json'
op|'.'
name|'loads'
op|'('
name|'req'
op|'.'
name|'body'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'self'
op|'.'
name|'application'
newline|'\n'
nl|'\n'
nl|'\n'
nl|'\n'
DECL|function|stub_out_key_pair_funcs
dedent|''
name|'def'
name|'stub_out_key_pair_funcs'
op|'('
name|'stubs'
op|')'
op|':'
newline|'\n'
DECL|function|key_pair
indent|'    '
name|'def'
name|'key_pair'
op|'('
name|'context'
op|','
name|'user_id'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
op|'['
name|'dict'
op|'('
name|'name'
op|'='
string|"'key'"
op|','
name|'public_key'
op|'='
string|"'public_key'"
op|')'
op|']'
newline|'\n'
dedent|''
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'db'
op|'.'
name|'api'
op|','
string|"'key_pair_get_all_by_user'"
op|','
nl|'\n'
name|'key_pair'
op|')'
newline|'\n'
nl|'\n'
DECL|function|stub_out_image_service
dedent|''
name|'def'
name|'stub_out_image_service'
op|'('
name|'stubs'
op|')'
op|':'
newline|'\n'
DECL|function|fake_image_show
indent|'    '
name|'def'
name|'fake_image_show'
op|'('
name|'meh'
op|','
name|'id'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'dict'
op|'('
name|'kernelId'
op|'='
number|'1'
op|','
name|'ramdiskId'
op|'='
number|'1'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'image'
op|'.'
name|'service'
op|'.'
name|'LocalImageService'
op|','
string|"'show'"
op|','
name|'fake_image_show'
op|')'
newline|'\n'
nl|'\n'
DECL|function|stub_out_id_translator
dedent|''
name|'def'
name|'stub_out_id_translator'
op|'('
name|'stubs'
op|')'
op|':'
newline|'\n'
DECL|class|FakeTranslator
indent|'    '
name|'class'
name|'FakeTranslator'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'        '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'id_type'
op|','
name|'service_name'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'pass'
newline|'\n'
nl|'\n'
DECL|member|to_rs_id
dedent|''
name|'def'
name|'to_rs_id'
op|'('
name|'self'
op|','
name|'id'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'id'
newline|'\n'
nl|'\n'
DECL|member|from_rs_id
dedent|''
name|'def'
name|'from_rs_id'
op|'('
name|'self'
op|','
name|'id'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'id'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'api'
op|'.'
name|'rackspace'
op|'.'
name|'_id_translator'
op|','
nl|'\n'
string|"'RackspaceAPIIdTranslator'"
op|','
name|'FakeTranslator'
op|')'
newline|'\n'
nl|'\n'
DECL|function|stub_out_auth
dedent|''
name|'def'
name|'stub_out_auth'
op|'('
name|'stubs'
op|')'
op|':'
newline|'\n'
DECL|function|fake_auth_init
indent|'    '
name|'def'
name|'fake_auth_init'
op|'('
name|'self'
op|','
name|'app'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'application'
op|'='
name|'app'
newline|'\n'
nl|'\n'
dedent|''
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'api'
op|'.'
name|'rackspace'
op|'.'
name|'AuthMiddleware'
op|','
nl|'\n'
string|"'__init__'"
op|','
name|'fake_auth_init'
op|')'
newline|'\n'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'api'
op|'.'
name|'rackspace'
op|'.'
name|'AuthMiddleware'
op|','
nl|'\n'
string|"'__call__'"
op|','
name|'fake_wsgi'
op|')'
newline|'\n'
nl|'\n'
DECL|function|stub_out_rate_limiting
dedent|''
name|'def'
name|'stub_out_rate_limiting'
op|'('
name|'stubs'
op|')'
op|':'
newline|'\n'
DECL|function|fake_rate_init
indent|'    '
name|'def'
name|'fake_rate_init'
op|'('
name|'self'
op|','
name|'app'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'nova'
op|'.'
name|'api'
op|'.'
name|'rackspace'
op|'.'
name|'RateLimitingMiddleware'
op|','
name|'self'
op|')'
op|'.'
name|'__init__'
op|'('
name|'app'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'application'
op|'='
name|'app'
newline|'\n'
nl|'\n'
dedent|''
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'api'
op|'.'
name|'rackspace'
op|'.'
name|'RateLimitingMiddleware'
op|','
nl|'\n'
string|"'__init__'"
op|','
name|'fake_rate_init'
op|')'
newline|'\n'
nl|'\n'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'api'
op|'.'
name|'rackspace'
op|'.'
name|'RateLimitingMiddleware'
op|','
nl|'\n'
string|"'__call__'"
op|','
name|'fake_wsgi'
op|')'
newline|'\n'
nl|'\n'
DECL|function|stub_for_testing
dedent|''
name|'def'
name|'stub_for_testing'
op|'('
name|'stubs'
op|')'
op|':'
newline|'\n'
DECL|function|get_my_ip
indent|'    '
name|'def'
name|'get_my_ip'
op|'('
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
string|"'127.0.0.1'"
newline|'\n'
dedent|''
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'utils'
op|','
string|"'get_my_ip'"
op|','
name|'get_my_ip'
op|')'
newline|'\n'
name|'FLAGS'
op|'.'
name|'FAKE_subdomain'
op|'='
string|"'rs'"
newline|'\n'
nl|'\n'
DECL|class|FakeAuthDatabase
dedent|''
name|'class'
name|'FakeAuthDatabase'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|variable|data
indent|'    '
name|'data'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
op|'@'
name|'staticmethod'
newline|'\n'
DECL|member|auth_get_token
name|'def'
name|'auth_get_token'
op|'('
name|'context'
op|','
name|'token_hash'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'FakeAuthDatabase'
op|'.'
name|'data'
op|'.'
name|'get'
op|'('
name|'token_hash'
op|','
name|'None'
op|')'
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'staticmethod'
newline|'\n'
DECL|member|auth_create_token
name|'def'
name|'auth_create_token'
op|'('
name|'context'
op|','
name|'token'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'token'
op|'['
string|"'created_at'"
op|']'
op|'='
name|'datetime'
op|'.'
name|'datetime'
op|'.'
name|'now'
op|'('
op|')'
newline|'\n'
name|'FakeAuthDatabase'
op|'.'
name|'data'
op|'['
name|'token'
op|'['
string|"'token_hash'"
op|']'
op|']'
op|'='
name|'token'
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'staticmethod'
newline|'\n'
DECL|member|auth_destroy_token
name|'def'
name|'auth_destroy_token'
op|'('
name|'context'
op|','
name|'token'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'FakeAuthDatabase'
op|'.'
name|'data'
op|'.'
name|'has_key'
op|'('
name|'token'
op|'['
string|"'token_hash'"
op|']'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'del'
name|'FakeAuthDatabase'
op|'.'
name|'data'
op|'['
string|"'token_hash'"
op|']'
newline|'\n'
nl|'\n'
DECL|class|FakeAuthManager
dedent|''
dedent|''
dedent|''
name|'class'
name|'FakeAuthManager'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|variable|auth_data
indent|'    '
name|'auth_data'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
DECL|member|add_user
name|'def'
name|'add_user'
op|'('
name|'self'
op|','
name|'key'
op|','
name|'user'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'FakeAuthManager'
op|'.'
name|'auth_data'
op|'['
name|'key'
op|']'
op|'='
name|'user'
newline|'\n'
nl|'\n'
DECL|member|get_user
dedent|''
name|'def'
name|'get_user'
op|'('
name|'self'
op|','
name|'uid'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'for'
name|'k'
op|','
name|'v'
name|'in'
name|'FakeAuthManager'
op|'.'
name|'auth_data'
op|'.'
name|'iteritems'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'v'
op|'['
string|"'uid'"
op|']'
op|'=='
name|'uid'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'v'
newline|'\n'
dedent|''
dedent|''
name|'return'
name|'None'
newline|'\n'
nl|'\n'
DECL|member|get_user_from_access_key
dedent|''
name|'def'
name|'get_user_from_access_key'
op|'('
name|'self'
op|','
name|'key'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'FakeAuthManager'
op|'.'
name|'auth_data'
op|'.'
name|'get'
op|'('
name|'key'
op|','
name|'None'
op|')'
newline|'\n'
nl|'\n'
DECL|class|FakeRateLimiter
dedent|''
dedent|''
name|'class'
name|'FakeRateLimiter'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'application'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'application'
op|'='
name|'application'
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'webob'
op|'.'
name|'dec'
op|'.'
name|'wsgify'
newline|'\n'
DECL|member|__call__
name|'def'
name|'__call__'
op|'('
name|'self'
op|','
name|'req'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'application'
newline|'\n'
dedent|''
dedent|''
endmarker|''
end_unit
