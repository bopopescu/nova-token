begin_unit
name|'import'
name|'webob'
newline|'\n'
name|'import'
name|'webob'
op|'.'
name|'dec'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'wsgi'
name|'import'
name|'Router'
newline|'\n'
nl|'\n'
DECL|variable|fake_data_store
name|'fake_data_store'
op|'='
op|'{'
op|'}'
newline|'\n'
DECL|variable|auth_hash
name|'auth_hash'
op|'='
string|"'dummy_hash'"
newline|'\n'
nl|'\n'
DECL|class|FakeRedis
name|'class'
name|'FakeRedis'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'global'
name|'fake_data_store'
newline|'\n'
name|'self'
op|'.'
name|'store'
op|'='
name|'fake_data_store'
newline|'\n'
nl|'\n'
DECL|member|hsetnx
dedent|''
name|'def'
name|'hsetnx'
op|'('
name|'self'
op|','
name|'hash_name'
op|','
name|'key'
op|','
name|'value'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'not'
name|'self'
op|'.'
name|'store'
op|'.'
name|'has_key'
op|'('
name|'hash_name'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'store'
op|'['
name|'hash_name'
op|']'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'store'
op|'['
name|'hash_name'
op|']'
op|'.'
name|'has_key'
op|'('
name|'key'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
number|'0'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'store'
op|'['
name|'hash_name'
op|']'
op|'['
name|'key'
op|']'
op|'='
name|'value'
newline|'\n'
name|'return'
number|'1'
newline|'\n'
nl|'\n'
DECL|member|hset
dedent|''
name|'def'
name|'hset'
op|'('
name|'self'
op|','
name|'hash_name'
op|','
name|'key'
op|','
name|'value'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'not'
name|'self'
op|'.'
name|'store'
op|'.'
name|'has_key'
op|'('
name|'hash_name'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'store'
op|'['
name|'hash_name'
op|']'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'store'
op|'['
name|'hash_name'
op|']'
op|'['
name|'key'
op|']'
op|'='
name|'value'
newline|'\n'
name|'return'
number|'1'
newline|'\n'
nl|'\n'
DECL|member|hget
dedent|''
name|'def'
name|'hget'
op|'('
name|'self'
op|','
name|'hash_name'
op|','
name|'key'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'not'
name|'self'
op|'.'
name|'store'
op|'['
name|'hash_name'
op|']'
op|'.'
name|'has_key'
op|'('
name|'key'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'None'
newline|'\n'
dedent|''
name|'return'
name|'self'
op|'.'
name|'store'
op|'['
name|'hash_name'
op|']'
op|'['
name|'key'
op|']'
newline|'\n'
nl|'\n'
DECL|member|hincrby
dedent|''
name|'def'
name|'hincrby'
op|'('
name|'self'
op|','
name|'hash_name'
op|','
name|'key'
op|','
name|'amount'
op|'='
number|'1'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'store'
op|'['
name|'hash_name'
op|']'
op|'['
name|'key'
op|']'
op|'+='
name|'amount'
newline|'\n'
nl|'\n'
DECL|class|FakeRouter
dedent|''
dedent|''
name|'class'
name|'FakeRouter'
op|'('
name|'Router'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pass'
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'webob'
op|'.'
name|'dec'
op|'.'
name|'wsgify'
newline|'\n'
DECL|member|__call__
name|'def'
name|'__call__'
op|'('
name|'self'
op|','
name|'req'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'res'
op|'='
name|'webob'
op|'.'
name|'Response'
op|'('
op|')'
newline|'\n'
name|'res'
op|'.'
name|'status'
op|'='
string|"'200'"
newline|'\n'
name|'res'
op|'.'
name|'headers'
op|'['
string|"'X-Test-Success'"
op|']'
op|'='
string|"'True'"
newline|'\n'
name|'return'
name|'res'
newline|'\n'
nl|'\n'
DECL|function|fake_auth_init
dedent|''
dedent|''
name|'def'
name|'fake_auth_init'
op|'('
name|'self'
op|','
name|'store'
op|'='
name|'FakeRedis'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'global'
name|'auth_hash'
newline|'\n'
name|'self'
op|'.'
name|'_store'
op|'='
name|'store'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'auth_hash'
op|'='
name|'auth_hash'
newline|'\n'
nl|'\n'
dedent|''
endmarker|''
end_unit
