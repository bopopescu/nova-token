begin_unit
name|'import'
name|'webob'
newline|'\n'
name|'import'
name|'webob'
op|'.'
name|'dec'
newline|'\n'
name|'import'
name|'unittest'
newline|'\n'
name|'import'
name|'stubout'
newline|'\n'
name|'import'
name|'nova'
op|'.'
name|'api'
newline|'\n'
name|'import'
name|'nova'
op|'.'
name|'api'
op|'.'
name|'rackspace'
op|'.'
name|'auth'
newline|'\n'
name|'from'
name|'nova'
name|'import'
name|'auth'
newline|'\n'
name|'from'
name|'nova'
op|'.'
name|'tests'
op|'.'
name|'api'
op|'.'
name|'rackspace'
name|'import'
name|'test_helper'
newline|'\n'
name|'import'
name|'datetime'
newline|'\n'
nl|'\n'
DECL|class|Test
name|'class'
name|'Test'
op|'('
name|'unittest'
op|'.'
name|'TestCase'
op|')'
op|':'
newline|'\n'
DECL|member|setUp
indent|'    '
name|'def'
name|'setUp'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'stubs'
op|'='
name|'stubout'
op|'.'
name|'StubOutForTesting'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'api'
op|'.'
name|'rackspace'
op|'.'
name|'auth'
op|'.'
name|'BasicApiAuthManager'
op|','
nl|'\n'
string|"'__init__'"
op|','
name|'test_helper'
op|'.'
name|'fake_auth_init'
op|')'
newline|'\n'
name|'test_helper'
op|'.'
name|'FakeAuthManager'
op|'.'
name|'auth_data'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'test_helper'
op|'.'
name|'FakeAuthDatabase'
op|'.'
name|'data'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
DECL|member|tearDown
dedent|''
name|'def'
name|'tearDown'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'UnsetAll'
op|'('
op|')'
newline|'\n'
name|'test_helper'
op|'.'
name|'fake_data_store'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
DECL|member|test_authorize_user
dedent|''
name|'def'
name|'test_authorize_user'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'f'
op|'='
name|'test_helper'
op|'.'
name|'FakeAuthManager'
op|'('
op|')'
newline|'\n'
name|'f'
op|'.'
name|'add_user'
op|'('
string|"'derp'"
op|','
op|'{'
string|"'uid'"
op|':'
number|'1'
op|','
string|"'name'"
op|':'
string|"'herp'"
op|'}'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'webob'
op|'.'
name|'Request'
op|'.'
name|'blank'
op|'('
string|"'/v1.0/'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|"'X-Auth-User'"
op|']'
op|'='
string|"'herp'"
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|"'X-Auth-Key'"
op|']'
op|'='
string|"'derp'"
newline|'\n'
name|'result'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'nova'
op|'.'
name|'api'
op|'.'
name|'API'
op|'('
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|'.'
name|'status'
op|','
string|"'204 No Content'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'result'
op|'.'
name|'headers'
op|'['
string|"'X-Auth-Token'"
op|']'
op|')'
op|','
number|'40'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|'.'
name|'headers'
op|'['
string|"'X-CDN-Management-Url'"
op|']'
op|','
nl|'\n'
string|'""'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|'.'
name|'headers'
op|'['
string|"'X-Storage-Url'"
op|']'
op|','
string|'""'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_authorize_token
dedent|''
name|'def'
name|'test_authorize_token'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'f'
op|'='
name|'test_helper'
op|'.'
name|'FakeAuthManager'
op|'('
op|')'
newline|'\n'
name|'f'
op|'.'
name|'add_user'
op|'('
string|"'derp'"
op|','
op|'{'
string|"'uid'"
op|':'
number|'1'
op|','
string|"'name'"
op|':'
string|"'herp'"
op|'}'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'webob'
op|'.'
name|'Request'
op|'.'
name|'blank'
op|'('
string|"'/v1.0/'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|"'X-Auth-User'"
op|']'
op|'='
string|"'herp'"
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|"'X-Auth-Key'"
op|']'
op|'='
string|"'derp'"
newline|'\n'
name|'result'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'nova'
op|'.'
name|'api'
op|'.'
name|'API'
op|'('
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|'.'
name|'status'
op|','
string|"'204 No Content'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'len'
op|'('
name|'result'
op|'.'
name|'headers'
op|'['
string|"'X-Auth-Token'"
op|']'
op|')'
op|','
number|'40'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|'.'
name|'headers'
op|'['
string|"'X-Server-Management-Url'"
op|']'
op|','
nl|'\n'
string|'"https://foo/v1.0/"'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|'.'
name|'headers'
op|'['
string|"'X-CDN-Management-Url'"
op|']'
op|','
nl|'\n'
string|'""'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|'.'
name|'headers'
op|'['
string|"'X-Storage-Url'"
op|']'
op|','
string|'""'
op|')'
newline|'\n'
nl|'\n'
name|'token'
op|'='
name|'result'
op|'.'
name|'headers'
op|'['
string|"'X-Auth-Token'"
op|']'
newline|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'nova'
op|'.'
name|'api'
op|'.'
name|'rackspace'
op|','
string|"'APIRouter'"
op|','
nl|'\n'
name|'test_helper'
op|'.'
name|'FakeRouter'
op|')'
newline|'\n'
name|'req'
op|'='
name|'webob'
op|'.'
name|'Request'
op|'.'
name|'blank'
op|'('
string|"'/v1.0/fake'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|"'X-Auth-Token'"
op|']'
op|'='
name|'token'
newline|'\n'
name|'result'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'nova'
op|'.'
name|'api'
op|'.'
name|'API'
op|'('
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|'.'
name|'status'
op|','
string|"'200 OK'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|'.'
name|'headers'
op|'['
string|"'X-Test-Success'"
op|']'
op|','
string|"'True'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_token_expiry
dedent|''
name|'def'
name|'test_token_expiry'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'destroy_called'
op|'='
name|'False'
newline|'\n'
name|'token_hash'
op|'='
string|"'bacon'"
newline|'\n'
nl|'\n'
DECL|function|destroy_token_mock
name|'def'
name|'destroy_token_mock'
op|'('
name|'meh'
op|','
name|'context'
op|','
name|'token'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'destroy_called'
op|'='
name|'True'
newline|'\n'
nl|'\n'
DECL|function|bad_token
dedent|''
name|'def'
name|'bad_token'
op|'('
name|'meh'
op|','
name|'context'
op|','
name|'token_hash'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
op|'{'
string|"'token_hash'"
op|':'
name|'token_hash'
op|','
nl|'\n'
string|"'created_at'"
op|':'
name|'datetime'
op|'.'
name|'datetime'
op|'('
number|'1990'
op|','
number|'1'
op|','
number|'1'
op|')'
op|'}'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'test_helper'
op|'.'
name|'FakeAuthDatabase'
op|','
string|"'auth_destroy_token'"
op|','
nl|'\n'
name|'destroy_token_mock'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'stubs'
op|'.'
name|'Set'
op|'('
name|'test_helper'
op|'.'
name|'FakeAuthDatabase'
op|','
string|"'auth_get_token'"
op|','
nl|'\n'
name|'bad_token'
op|')'
newline|'\n'
nl|'\n'
name|'req'
op|'='
name|'webob'
op|'.'
name|'Request'
op|'.'
name|'blank'
op|'('
string|"'/v1.0/'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|"'X-Auth-Token'"
op|']'
op|'='
string|"'bacon'"
newline|'\n'
name|'result'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'nova'
op|'.'
name|'api'
op|'.'
name|'API'
op|'('
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|'.'
name|'status'
op|','
string|"'401 Unauthorized'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'self'
op|'.'
name|'destroy_called'
op|','
name|'True'
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_bad_user
dedent|''
name|'def'
name|'test_bad_user'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'webob'
op|'.'
name|'Request'
op|'.'
name|'blank'
op|'('
string|"'/v1.0/'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|"'X-Auth-User'"
op|']'
op|'='
string|"'herp'"
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|"'X-Auth-Key'"
op|']'
op|'='
string|"'derp'"
newline|'\n'
name|'result'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'nova'
op|'.'
name|'api'
op|'.'
name|'API'
op|'('
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|'.'
name|'status'
op|','
string|"'401 Unauthorized'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_no_user
dedent|''
name|'def'
name|'test_no_user'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'webob'
op|'.'
name|'Request'
op|'.'
name|'blank'
op|'('
string|"'/v1.0/'"
op|')'
newline|'\n'
name|'result'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'nova'
op|'.'
name|'api'
op|'.'
name|'API'
op|'('
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|'.'
name|'status'
op|','
string|"'401 Unauthorized'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|test_bad_token
dedent|''
name|'def'
name|'test_bad_token'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'webob'
op|'.'
name|'Request'
op|'.'
name|'blank'
op|'('
string|"'/v1.0/'"
op|')'
newline|'\n'
name|'req'
op|'.'
name|'headers'
op|'['
string|"'X-Auth-Token'"
op|']'
op|'='
string|"'baconbaconbacon'"
newline|'\n'
name|'result'
op|'='
name|'req'
op|'.'
name|'get_response'
op|'('
name|'nova'
op|'.'
name|'api'
op|'.'
name|'API'
op|'('
op|')'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'assertEqual'
op|'('
name|'result'
op|'.'
name|'status'
op|','
string|"'401 Unauthorized'"
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'if'
name|'__name__'
op|'=='
string|"'__main__'"
op|':'
newline|'\n'
indent|'    '
name|'unittest'
op|'.'
name|'main'
op|'('
op|')'
newline|'\n'
dedent|''
endmarker|''
end_unit
