begin_unit
comment|'# Copyright 2016 OpenStack Foundation'
nl|'\n'
comment|'# All Rights Reserved.'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#    Licensed under the Apache License, Version 2.0 (the "License"); you may'
nl|'\n'
comment|'#    not use this file except in compliance with the License. You may obtain'
nl|'\n'
comment|'#    a copy of the License at'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#         http://www.apache.org/licenses/LICENSE-2.0'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#    Unless required by applicable law or agreed to in writing, software'
nl|'\n'
comment|'#    distributed under the License is distributed on an "AS IS" BASIS, WITHOUT'
nl|'\n'
comment|'#    WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the'
nl|'\n'
comment|'#    License for the specific language governing permissions and limitations'
nl|'\n'
comment|'#    under the License.'
nl|'\n'
nl|'\n'
name|'import'
name|'itertools'
newline|'\n'
nl|'\n'
name|'from'
name|'oslo_config'
name|'import'
name|'cfg'
newline|'\n'
nl|'\n'
DECL|variable|xenserver_group
name|'xenserver_group'
op|'='
name|'cfg'
op|'.'
name|'OptGroup'
op|'('
string|"'xenserver'"
op|','
name|'title'
op|'='
string|"'Xenserver Options'"
op|')'
newline|'\n'
nl|'\n'
DECL|variable|xenapi_agent_opts
name|'xenapi_agent_opts'
op|'='
op|'['
nl|'\n'
name|'cfg'
op|'.'
name|'IntOpt'
op|'('
string|"'agent_timeout'"
op|','
nl|'\n'
DECL|variable|default
name|'default'
op|'='
number|'30'
op|','
nl|'\n'
name|'help'
op|'='
string|'"""\n               Number of seconds to wait for agent\'s reply to a request.\n\n               Nova configures/performs certain administrative actions on a\n               server with the help of an agent that\'s installed on the server.\n               The communication between Nova and the agent is achieved via\n               sharing messages, called records, over xenstore, a shared\n               storage across all the domains on a Xenserver host.\n               Operations performed by the agent on behalf of nova are:\n               \'version\',\' key_init\', \'password\',\'resetnetwork\',\'inject_file\',\n               and \'agentupdate\'.\n\n               To perform one of the above operations, the xapi \'agent\' plugin\n               writes the command and its associated parameters to a certain\n               location known to the domain and awaits response. On being\n               notified of the message, the agent performs appropriate actions\n               on the server and writes the result back to xenstore.\n               This result is then read by the xapi \'agent\' plugin to\n               determine the success/failure of the operation.\n\n               This config option determines how long the xapi \'agent\' plugin\n               shall wait to read the response off of xenstore for a given\n               request/command. If the agent on the instance fails to write\n               the result in this time period, the operation is considered to\n               have timed out.\n\n               Services which consume this:\n               * ``nova-compute``\n\n               Possible values:\n               * Any positive integer\n\n               Related options:\n               * ``agent_version_timeout``\n               * ``agent_resetnetwork_timeout``\n\n               """'
op|')'
op|','
nl|'\n'
name|'cfg'
op|'.'
name|'IntOpt'
op|'('
string|"'agent_version_timeout'"
op|','
nl|'\n'
DECL|variable|default
name|'default'
op|'='
number|'300'
op|','
nl|'\n'
name|'help'
op|'='
string|'"""\n               Number of seconds to wait for agent\'t reply to version request.\n\n               This indicates the amount of time xapi \'agent\' plugin waits\n               for the agent to respond to the \'version\' request specifically.\n               The generic timeout for agent communication ``agent_timeout``\n               is ignored in this case.\n\n               During the build process the \'version\' request is used to\n               determine if the agent is available/operational to perform\n               other requests such as \'resetnetwork\', \'password\', \'key_init\'\n               and \'inject_file\'. If the \'version\' call fails, the other\n               configuration is skipped. So, this configuration option can\n               also be interpreted as time in which agent is expected to be\n               fully operational.\n\n               Services which consume this:\n               * ``nova-compute``\n\n               Possible values:\n               * Any positive integer\n\n               Related options:\n               * None\n\n               """'
op|')'
op|','
nl|'\n'
name|'cfg'
op|'.'
name|'IntOpt'
op|'('
string|"'agent_resetnetwork_timeout'"
op|','
nl|'\n'
DECL|variable|default
name|'default'
op|'='
number|'60'
op|','
nl|'\n'
name|'help'
op|'='
string|'"""\n               Number of seconds to wait for agent\'s reply to resetnetwork\n               request.\n\n               This indicates the amount of time xapi \'agent\' plugin waits\n               for the agent to respond to the \'resetnetwork\' request\n               specifically. The generic timeout for agent communication\n               ``agent_timeout`` is ignored in this case.\n\n               Services which consume this:\n               * ``nova-compute``\n\n               Possible values:\n               * Any positive integer\n\n               Related options:\n               * None\n\n               """'
op|')'
op|','
nl|'\n'
name|'cfg'
op|'.'
name|'StrOpt'
op|'('
string|"'agent_path'"
op|','
nl|'\n'
DECL|variable|default
name|'default'
op|'='
string|"'usr/sbin/xe-update-networking'"
op|','
nl|'\n'
name|'help'
op|'='
string|'"""\n               Path to locate guest agent on the server.\n\n               Specifies the path in which the XenAPI guest agent should be\n               located. If the agent is present, network configuration is not\n               injected into the image.\n               Used if compute_driver=xenapi.XenAPIDriver and\n               flat_injected=True.\n\n               Services which consume this:\n               * ``nova-compute``\n\n               Possible values:\n               * A valid path\n\n               Related options:\n               * ``flat_injected``\n               * ``compute_driver``\n\n               """'
op|')'
op|','
nl|'\n'
name|'cfg'
op|'.'
name|'BoolOpt'
op|'('
string|"'disable_agent'"
op|','
nl|'\n'
DECL|variable|default
name|'default'
op|'='
name|'False'
op|','
nl|'\n'
name|'help'
op|'='
string|'"""\n                Disables the use of XenAPI agent.\n\n                This configuration option suggests whether the use of agent\n                should be enabled or not regardless of what image properties\n                are present. Image properties have an effect only when this\n                is set to ``True``. Read description of config option\n                ``use_agent_default`` for more information.\n\n                Services which consume this:\n                * ``nova-compute``\n\n                Possible values:\n                * True\n                * False\n\n                Related options:\n                * ``use_agent_default``\n\n                """'
op|')'
op|','
nl|'\n'
name|'cfg'
op|'.'
name|'BoolOpt'
op|'('
string|"'use_agent_default'"
op|','
nl|'\n'
DECL|variable|default
name|'default'
op|'='
name|'False'
op|','
nl|'\n'
name|'help'
op|'='
string|'"""\n                Whether or not to use the agent by default when its usage is\n                enabled but not indicated by the image.\n\n                The use of XenAPI agent can be disabled altogether using the\n                configuration option ``disable_agent``. However, if it is not\n                disabled, the use of an agent can still be controlled by the\n                image in use through one of its properties,\n                ``xenapi_use_agent``. If this property is either not present\n                or specified incorrectly on the image, the use of agent is\n                determined by this configuration option.\n\n                Note that if this configuration is set to ``True`` when the\n                agent is not present, the boot times will increase\n                significantly.\n\n                Services which consume this:\n                * ``nova-compute``\n\n                Possible values:\n                * True\n                * False\n\n                Related options:\n                * ``disable_agent``\n\n                """'
op|')'
op|','
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|variable|xenapi_session_opts
name|'xenapi_session_opts'
op|'='
op|'['
nl|'\n'
name|'cfg'
op|'.'
name|'IntOpt'
op|'('
string|"'login_timeout'"
op|','
nl|'\n'
DECL|variable|default
name|'default'
op|'='
number|'10'
op|','
nl|'\n'
DECL|variable|help
name|'help'
op|'='
string|"'Timeout in seconds for XenAPI login.'"
op|')'
op|','
nl|'\n'
name|'cfg'
op|'.'
name|'IntOpt'
op|'('
string|"'connection_concurrent'"
op|','
nl|'\n'
DECL|variable|default
name|'default'
op|'='
number|'5'
op|','
nl|'\n'
DECL|variable|help
name|'help'
op|'='
string|"'Maximum number of concurrent XenAPI connections. '"
nl|'\n'
string|"'Used only if compute_driver=xenapi.XenAPIDriver'"
op|')'
op|','
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|variable|ALL_XENSERVER_OPTS
name|'ALL_XENSERVER_OPTS'
op|'='
name|'itertools'
op|'.'
name|'chain'
op|'('
nl|'\n'
name|'xenapi_agent_opts'
op|','
nl|'\n'
name|'xenapi_session_opts'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|register_opts
name|'def'
name|'register_opts'
op|'('
name|'conf'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'conf'
op|'.'
name|'register_group'
op|'('
name|'xenserver_group'
op|')'
newline|'\n'
name|'conf'
op|'.'
name|'register_opts'
op|'('
name|'ALL_XENSERVER_OPTS'
op|','
name|'group'
op|'='
name|'xenserver_group'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|list_opts
dedent|''
name|'def'
name|'list_opts'
op|'('
op|')'
op|':'
newline|'\n'
indent|'    '
name|'return'
op|'{'
name|'xenserver_group'
op|'.'
name|'name'
op|':'
name|'ALL_XENSERVER_OPTS'
op|'}'
newline|'\n'
dedent|''
endmarker|''
end_unit
