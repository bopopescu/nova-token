begin_unit
comment|'# vim: tabstop=4 shiftwidth=4 softtabstop=4'
nl|'\n'
nl|'\n'
comment|'# Copyright 2011 Red Hat, Inc.'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#    Licensed under the Apache License, Version 2.0 (the "License"); you may'
nl|'\n'
comment|'#    not use this file except in compliance with the License. You may obtain'
nl|'\n'
comment|'#    a copy of the License at'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#         http://www.apache.org/licenses/LICENSE-2.0'
nl|'\n'
comment|'#'
nl|'\n'
comment|'#    Unless required by applicable law or agreed to in writing, software'
nl|'\n'
comment|'#    distributed under the License is distributed on an "AS IS" BASIS, WITHOUT'
nl|'\n'
comment|'#    WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the'
nl|'\n'
comment|'#    License for the specific language governing permissions and limitations'
nl|'\n'
comment|'#    under the License.'
nl|'\n'
nl|'\n'
string|'r"""\nConfiguration options which may be set on the command line or in config files.\n\nThe schema for each option is defined using the Opt sub-classes e.g.\n\n    common_opts = [\n        cfg.StrOpt(\'bind_host\',\n                   default=\'0.0.0.0\',\n                   help=\'IP address to listen on\'),\n        cfg.IntOpt(\'bind_port\',\n                   default=9292,\n                   help=\'Port number to listen on\')\n    ]\n\nOptions can be strings, integers, floats, booleans, lists or \'multi strings\':\n\n    enabled_apis_opt = \\\n        cfg.ListOpt(\'enabled_apis\',\n                    default=[\'ec2\', \'osapi\'],\n                    help=\'List of APIs to enable by default\')\n\n    DEFAULT_EXTENSIONS = [\n        \'nova.api.openstack.contrib.standard_extensions\'\n    ]\n    osapi_extension_opt = \\\n        cfg.MultiStrOpt(\'osapi_extension\',\n                        default=DEFAULT_EXTENSIONS)\n\nOption schemas are registered with with the config manager at runtime, but\nbefore the option is referenced:\n\n    class ExtensionManager(object):\n\n        enabled_apis_opt = cfg.ListOpt(...)\n\n        def __init__(self, conf):\n            self.conf = conf\n            self.conf.register_opt(enabled_apis_opt)\n            ...\n\n        def _load_extensions(self):\n            for ext_factory in self.conf.osapi_extension:\n                ....\n\nA common usage pattern is for each option schema to be defined in the module or\nclass which uses the option:\n\n    opts = ...\n\n    def add_common_opts(conf):\n        conf.register_opts(opts)\n\n    def get_bind_host(conf):\n        return conf.bind_host\n\n    def get_bind_port(conf):\n        return conf.bind_port\n\nAn option may optionally be made available via the command line. Such options\nmust registered with the config manager before the command line is parsed (for\nthe purposes of --help and CLI arg validation):\n\n    cli_opts = [\n        cfg.BoolOpt(\'verbose\',\n                    short=\'v\',\n                    default=False,\n                    help=\'Print more verbose output\'),\n        cfg.BoolOpt(\'debug\',\n                    short=\'d\',\n                    default=False,\n                    help=\'Print debugging output\'),\n    ]\n\n    def add_common_opts(conf):\n        conf.register_cli_opts(cli_opts)\n\nThe config manager has a single CLI option defined by default, --config-file:\n\n    class ConfigOpts(object):\n\n        config_file_opt = \\\n            MultiStrOpt(\'config-file\',\n                        ...\n\n        def __init__(self, ...):\n            ...\n            self.register_cli_opt(self.config_file_opt)\n\nOption values are parsed from any supplied config files using SafeConfigParser.\nIf none are specified, a default set is used e.g. glance-api.conf and\nglance-common.conf:\n\n    glance-api.conf:\n      [DEFAULT]\n      bind_port = 9292\n\n    glance-common.conf:\n      [DEFAULT]\n      bind_host = 0.0.0.0\n\nOption values in config files override those on the command line. Config files\nare parsed in order, with values in later files overriding those in earlier\nfiles.\n\nThe parsing of CLI args and config files is initiated by invoking the config\nmanager e.g.\n\n    conf = ConfigOpts()\n    conf.register_opt(BoolOpt(\'verbose\', ...))\n    conf(sys.argv[1:])\n    if conf.verbose:\n        ...\n\nOptions can be registered as belonging to a group:\n\n    rabbit_group = cfg.OptionGroup(name=\'rabbit\',\n                                   title=\'RabbitMQ options\')\n\n    rabbit_host_opt = \\\n        cfg.StrOpt(\'host\',\n                   group=\'rabbit\',\n                   default=\'localhost\',\n                   help=\'IP/hostname to listen on\'),\n    rabbit_port_opt = \\\n        cfg.IntOpt(\'port\',\n                   default=5672,\n                   help=\'Port number to listen on\')\n    rabbit_ssl_opt = \\\n        conf.BoolOpt(\'use_ssl\',\n                     default=False,\n                     help=\'Whether to support SSL connections\')\n\n    def register_rabbit_opts(conf):\n        conf.register_group(rabbit_group)\n        # options can be registered under a group in any of these ways:\n        conf.register_opt(rabbit_host_opt)\n        conf.register_opt(rabbit_port_opt, group=\'rabbit\')\n        conf.register_opt(rabbit_ssl_opt, group=rabbit_group)\n\nIf no group is specified, options belong to the \'DEFAULT\' section of config\nfiles:\n\n    glance-api.conf:\n      [DEFAULT]\n      bind_port = 9292\n      ...\n\n      [rabbit]\n      host = localhost\n      port = 5672\n      use_ssl = False\n      userid = guest\n      password = guest\n      virtual_host = /\n\nCommand-line options in a group are automatically prefixed with the group name:\n\n    --rabbit-host localhost --rabbit-use-ssl False\n\nOption values in the default group are referenced as attributes/properties on\nthe config manager; groups are also attributes on the config manager, with\nattributes for each of the options associated with the group:\n\n    server.start(app, conf.bind_port, conf.bind_host, conf)\n\n    self.connection = kombu.connection.BrokerConnection(\n        hostname=conf.rabbit.host,\n        port=conf.rabbit.port,\n        ...)\n\nOption values may reference other values using PEP 292 string substitution:\n\n    opts = [\n        cfg.StrOpt(\'state_path\',\n                   default=os.path.join(os.path.dirname(__file__), \'../\'),\n                   help=\'Top-level directory for maintaining nova state\'),\n        cfg.StrOpt(\'sqlite_db\',\n                   default=\'nova.sqlite\',\n                   help=\'file name for sqlite\'),\n        cfg.StrOpt(\'sql_connection\',\n                   default=\'sqlite:///$state_path/$sqlite_db\',\n                   help=\'connection string for sql database\'),\n    ]\n\nNote that interpolation can be avoided by using \'$$\'.\n"""'
newline|'\n'
nl|'\n'
name|'import'
name|'sys'
newline|'\n'
name|'import'
name|'ConfigParser'
newline|'\n'
name|'import'
name|'copy'
newline|'\n'
name|'import'
name|'optparse'
newline|'\n'
name|'import'
name|'os'
newline|'\n'
name|'import'
name|'string'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|Error
name|'class'
name|'Error'
op|'('
name|'Exception'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Base class for cfg exceptions."""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'msg'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'msg'
op|'='
name|'msg'
newline|'\n'
nl|'\n'
DECL|member|__str__
dedent|''
name|'def'
name|'__str__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'msg'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|ArgsAlreadyParsedError
dedent|''
dedent|''
name|'class'
name|'ArgsAlreadyParsedError'
op|'('
name|'Error'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Raised if a CLI opt is registered after parsing."""'
newline|'\n'
nl|'\n'
DECL|member|__str__
name|'def'
name|'__str__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'ret'
op|'='
string|'"arguments already parsed"'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'msg'
op|':'
newline|'\n'
indent|'            '
name|'ret'
op|'+='
string|'": "'
op|'+'
name|'self'
op|'.'
name|'msg'
newline|'\n'
dedent|''
name|'return'
name|'ret'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|NoSuchOptError
dedent|''
dedent|''
name|'class'
name|'NoSuchOptError'
op|'('
name|'Error'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Raised if an opt which doesn\'t exist is referenced."""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'opt_name'
op|','
name|'group'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'opt_name'
op|'='
name|'opt_name'
newline|'\n'
name|'self'
op|'.'
name|'group'
op|'='
name|'group'
newline|'\n'
nl|'\n'
DECL|member|__str__
dedent|''
name|'def'
name|'__str__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'group'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'return'
string|'"no such option: %s"'
op|'%'
name|'self'
op|'.'
name|'opt_name'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'return'
string|'"no such option in group %s: %s"'
op|'%'
op|'('
name|'self'
op|'.'
name|'group'
op|'.'
name|'name'
op|','
nl|'\n'
name|'self'
op|'.'
name|'opt_name'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|NoSuchGroupError
dedent|''
dedent|''
dedent|''
name|'class'
name|'NoSuchGroupError'
op|'('
name|'Error'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Raised if a group which doesn\'t exist is referenced."""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'group_name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'group_name'
op|'='
name|'group_name'
newline|'\n'
nl|'\n'
DECL|member|__str__
dedent|''
name|'def'
name|'__str__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
string|'"no such group: %s"'
op|'%'
name|'self'
op|'.'
name|'group_name'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|DuplicateOptError
dedent|''
dedent|''
name|'class'
name|'DuplicateOptError'
op|'('
name|'Error'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Raised if multiple opts with the same name are registered."""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'opt_name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'opt_name'
op|'='
name|'opt_name'
newline|'\n'
nl|'\n'
DECL|member|__str__
dedent|''
name|'def'
name|'__str__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
string|'"duplicate option: %s"'
op|'%'
name|'self'
op|'.'
name|'opt_name'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|TemplateSubstitutionError
dedent|''
dedent|''
name|'class'
name|'TemplateSubstitutionError'
op|'('
name|'Error'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Raised if an error occurs substituting a variable in an opt value."""'
newline|'\n'
nl|'\n'
DECL|member|__str__
name|'def'
name|'__str__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
string|'"template substitution error: %s"'
op|'%'
name|'self'
op|'.'
name|'msg'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|ConfigFilesNotFoundError
dedent|''
dedent|''
name|'class'
name|'ConfigFilesNotFoundError'
op|'('
name|'Error'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Raised if one or more config files are not found."""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'config_files'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'config_files'
op|'='
name|'config_files'
newline|'\n'
nl|'\n'
DECL|member|__str__
dedent|''
name|'def'
name|'__str__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
string|"'Failed to read some config files: %s'"
op|'%'
name|'string'
op|'.'
name|'join'
op|'('
name|'self'
op|'.'
name|'config_files'
op|','
string|"','"
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|ConfigFileParseError
dedent|''
dedent|''
name|'class'
name|'ConfigFileParseError'
op|'('
name|'Error'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Raised if there is an error parsing a config file."""'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'config_file'
op|','
name|'msg'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'config_file'
op|'='
name|'config_file'
newline|'\n'
name|'self'
op|'.'
name|'msg'
op|'='
name|'msg'
newline|'\n'
nl|'\n'
DECL|member|__str__
dedent|''
name|'def'
name|'__str__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
string|"'Failed to parse %s: %s'"
op|'%'
op|'('
name|'self'
op|'.'
name|'config_file'
op|','
name|'self'
op|'.'
name|'msg'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|ConfigFileValueError
dedent|''
dedent|''
name|'class'
name|'ConfigFileValueError'
op|'('
name|'Error'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Raised if a config file value does not match its opt type."""'
newline|'\n'
name|'pass'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|find_config_files
dedent|''
name|'def'
name|'find_config_files'
op|'('
name|'project'
op|'='
name|'None'
op|','
name|'prog'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Return a list of default configuration files.\n\n    We default to two config files: [${project}.conf, ${prog}.conf]\n\n    And we look for those config files in the following directories:\n\n      ~/.${project}/\n      ~/\n      /etc/${project}/\n      /etc/\n\n    We return an absolute path for (at most) one of each the default config\n    files, for the topmost directory it exists in.\n\n    For example, if project=foo, prog=bar and /etc/foo/foo.conf, /etc/bar.conf\n    and ~/.foo/bar.conf all exist, then we return [\'/etc/foo/foo.conf\',\n    \'~/.foo/bar.conf\']\n\n    If no project name is supplied, we only look for ${prog.conf}.\n\n    :param project: an optional project name\n    :param prog: the program name, defaulting to the basename of sys.argv[0]\n    """'
newline|'\n'
name|'if'
name|'prog'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'        '
name|'prog'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'basename'
op|'('
name|'sys'
op|'.'
name|'argv'
op|'['
number|'0'
op|']'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'fix_path'
op|'='
name|'lambda'
name|'p'
op|':'
name|'os'
op|'.'
name|'path'
op|'.'
name|'abspath'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'expanduser'
op|'('
name|'p'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'cfg_dirs'
op|'='
op|'['
nl|'\n'
name|'fix_path'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
string|"'~'"
op|','
string|"'.'"
op|'+'
name|'project'
op|')'
op|')'
name|'if'
name|'project'
name|'else'
name|'None'
op|','
nl|'\n'
name|'fix_path'
op|'('
string|"'~'"
op|')'
op|','
nl|'\n'
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
string|"'/etc'"
op|','
name|'project'
op|')'
name|'if'
name|'project'
name|'else'
name|'None'
op|','
nl|'\n'
string|"'/etc'"
nl|'\n'
op|']'
newline|'\n'
name|'cfg_dirs'
op|'='
name|'filter'
op|'('
name|'bool'
op|','
name|'cfg_dirs'
op|')'
newline|'\n'
nl|'\n'
DECL|function|search_dirs
name|'def'
name|'search_dirs'
op|'('
name|'dirs'
op|','
name|'basename'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'for'
name|'d'
name|'in'
name|'dirs'
op|':'
newline|'\n'
indent|'            '
name|'path'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'d'
op|','
name|'basename'
op|')'
newline|'\n'
name|'if'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'path'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'path'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
dedent|''
name|'config_files'
op|'='
op|'['
op|']'
newline|'\n'
name|'if'
name|'project'
op|':'
newline|'\n'
indent|'        '
name|'config_files'
op|'.'
name|'append'
op|'('
name|'search_dirs'
op|'('
name|'cfg_dirs'
op|','
string|"'%s.conf'"
op|'%'
name|'project'
op|')'
op|')'
newline|'\n'
dedent|''
name|'config_files'
op|'.'
name|'append'
op|'('
name|'search_dirs'
op|'('
name|'cfg_dirs'
op|','
string|"'%s.conf'"
op|'%'
name|'prog'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'return'
name|'filter'
op|'('
name|'bool'
op|','
name|'config_files'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|_is_opt_registered
dedent|''
name|'def'
name|'_is_opt_registered'
op|'('
name|'opts'
op|','
name|'opt'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Check whether an opt with the same name is already registered.\n\n    The same opt may be registered multiple times, with only the first\n    registration having any effect. However, it is an error to attempt\n    to register a different opt with the same name.\n\n    :param opts: the set of opts already registered\n    :param opt: the opt to be registered\n    :returns: True if the opt was previously registered, False otherwise\n    :raises: DuplicateOptError if a naming conflict is detected\n    """'
newline|'\n'
name|'if'
name|'opt'
op|'.'
name|'dest'
name|'in'
name|'opts'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'opts'
op|'['
name|'opt'
op|'.'
name|'dest'
op|']'
op|'['
string|"'opt'"
op|']'
name|'is'
name|'not'
name|'opt'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'DuplicateOptError'
op|'('
name|'opt'
op|'.'
name|'name'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'True'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'False'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|Opt
dedent|''
dedent|''
name|'class'
name|'Opt'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
nl|'\n'
indent|'    '
string|'"""Base class for all configuration options.\n\n    An Opt object has no public methods, but has a number of public string\n    properties:\n\n      name:\n        the name of the option, which may include hyphens\n      dest:\n        the (hyphen-less) ConfigOpts property which contains the option value\n      short:\n        a single character CLI option name\n      default:\n        the default value of the option\n      metavar:\n        the name shown as the argument to a CLI option in --help output\n      help:\n        an string explaining how the options value is used\n    """'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'name'
op|','
name|'dest'
op|'='
name|'None'
op|','
name|'short'
op|'='
name|'None'
op|','
nl|'\n'
name|'default'
op|'='
name|'None'
op|','
name|'metavar'
op|'='
name|'None'
op|','
name|'help'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Construct an Opt object.\n\n        The only required parameter is the option\'s name. However, it is\n        common to also supply a default and help string for all options.\n\n        :param name: the option\'s name\n        :param dest: the name of the corresponding ConfigOpts property\n        :param short: a single character CLI option name\n        :param default: the default value of the option\n        :param metavar: the option argument to show in --help\n        :param help: an explanation of how the option is used\n        """'
newline|'\n'
name|'self'
op|'.'
name|'name'
op|'='
name|'name'
newline|'\n'
name|'if'
name|'dest'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'dest'
op|'='
name|'self'
op|'.'
name|'name'
op|'.'
name|'replace'
op|'('
string|"'-'"
op|','
string|"'_'"
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'dest'
op|'='
name|'dest'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'short'
op|'='
name|'short'
newline|'\n'
name|'self'
op|'.'
name|'default'
op|'='
name|'default'
newline|'\n'
name|'self'
op|'.'
name|'metavar'
op|'='
name|'metavar'
newline|'\n'
name|'self'
op|'.'
name|'help'
op|'='
name|'help'
newline|'\n'
nl|'\n'
DECL|member|_get_from_config_parser
dedent|''
name|'def'
name|'_get_from_config_parser'
op|'('
name|'self'
op|','
name|'cparser'
op|','
name|'section'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Retrieves the option value from a ConfigParser object.\n\n        This is the method ConfigOpts uses to look up the option value from\n        config files. Most opt types override this method in order to perform\n        type appropriate conversion of the returned value.\n\n        :param cparser: a ConfigParser object\n        :param section: a section name\n        """'
newline|'\n'
name|'return'
name|'cparser'
op|'.'
name|'get'
op|'('
name|'section'
op|','
name|'self'
op|'.'
name|'dest'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_add_to_cli
dedent|''
name|'def'
name|'_add_to_cli'
op|'('
name|'self'
op|','
name|'parser'
op|','
name|'group'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Makes the option available in the command line interface.\n\n        This is the method ConfigOpts uses to add the opt to the CLI interface\n        as appropriate for the opt type. Some opt types may extend this method,\n        others may just extend the helper methods it uses.\n\n        :param parser: the CLI option parser\n        :param group: an optional OptGroup object\n        """'
newline|'\n'
name|'container'
op|'='
name|'self'
op|'.'
name|'_get_optparse_container'
op|'('
name|'parser'
op|','
name|'group'
op|')'
newline|'\n'
name|'kwargs'
op|'='
name|'self'
op|'.'
name|'_get_optparse_kwargs'
op|'('
name|'group'
op|')'
newline|'\n'
name|'prefix'
op|'='
name|'self'
op|'.'
name|'_get_optparse_prefix'
op|'('
string|"''"
op|','
name|'group'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_add_to_optparse'
op|'('
name|'container'
op|','
name|'self'
op|'.'
name|'name'
op|','
name|'self'
op|'.'
name|'short'
op|','
name|'kwargs'
op|','
name|'prefix'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_add_to_optparse
dedent|''
name|'def'
name|'_add_to_optparse'
op|'('
name|'self'
op|','
name|'container'
op|','
name|'name'
op|','
name|'short'
op|','
name|'kwargs'
op|','
name|'prefix'
op|'='
string|"''"
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Add an option to an optparse parser or group.\n\n        :param container: an optparse.OptionContainer object\n        :param name: the opt name\n        :param short: the short opt name\n        :param kwargs: the keyword arguments for add_option()\n        :param prefix: an optional prefix to prepend to the opt name\n        :raises: DuplicateOptError if a naming confict is detected\n        """'
newline|'\n'
name|'args'
op|'='
op|'['
string|"'--'"
op|'+'
name|'prefix'
op|'+'
name|'name'
op|']'
newline|'\n'
name|'if'
name|'short'
op|':'
newline|'\n'
indent|'            '
name|'args'
op|'+='
op|'['
string|"'-'"
op|'+'
name|'short'
op|']'
newline|'\n'
dedent|''
name|'for'
name|'a'
name|'in'
name|'args'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'container'
op|'.'
name|'has_option'
op|'('
name|'a'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'raise'
name|'DuplicateOptError'
op|'('
name|'a'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'container'
op|'.'
name|'add_option'
op|'('
op|'*'
name|'args'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_get_optparse_container
dedent|''
name|'def'
name|'_get_optparse_container'
op|'('
name|'self'
op|','
name|'parser'
op|','
name|'group'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Returns an optparse.OptionContainer.\n\n        :param parser: an optparse.OptionParser\n        :param group: an (optional) OptGroup object\n        :returns: an optparse.OptionGroup if a group is given, else the parser\n        """'
newline|'\n'
name|'if'
name|'group'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'group'
op|'.'
name|'_get_optparse_group'
op|'('
name|'parser'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'parser'
newline|'\n'
nl|'\n'
DECL|member|_get_optparse_kwargs
dedent|''
dedent|''
name|'def'
name|'_get_optparse_kwargs'
op|'('
name|'self'
op|','
name|'group'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Build a dict of keyword arguments for optparse\'s add_option().\n\n        Most opt types extend this method to customize the behaviour of the\n        options added to optparse.\n\n        :param group: an optional group\n        :param kwargs: optional keyword arguments to add to\n        :returns: a dict of keyword arguments\n        """'
newline|'\n'
name|'dest'
op|'='
name|'self'
op|'.'
name|'dest'
newline|'\n'
name|'if'
name|'group'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'dest'
op|'='
name|'group'
op|'.'
name|'name'
op|'+'
string|"'_'"
op|'+'
name|'dest'
newline|'\n'
dedent|''
name|'kwargs'
op|'.'
name|'update'
op|'('
op|'{'
nl|'\n'
string|"'dest'"
op|':'
name|'dest'
op|','
nl|'\n'
string|"'metavar'"
op|':'
name|'self'
op|'.'
name|'metavar'
op|','
nl|'\n'
string|"'help'"
op|':'
name|'self'
op|'.'
name|'help'
op|','
nl|'\n'
op|'}'
op|')'
newline|'\n'
name|'return'
name|'kwargs'
newline|'\n'
nl|'\n'
DECL|member|_get_optparse_prefix
dedent|''
name|'def'
name|'_get_optparse_prefix'
op|'('
name|'self'
op|','
name|'prefix'
op|','
name|'group'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Build a prefix for the CLI option name, if required.\n\n        CLI options in a group are prefixed with the group\'s name in order\n        to avoid conflicts between similarly named options in different\n        groups.\n\n        :param prefix: an existing prefix to append to (e.g. \'no\' or \'\')\n        :param group: an optional OptGroup object\n        :returns: a CLI option prefix including the group name, if appropriate\n        """'
newline|'\n'
name|'if'
name|'group'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'group'
op|'.'
name|'name'
op|'+'
string|"'-'"
op|'+'
name|'prefix'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'prefix'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|StrOpt
dedent|''
dedent|''
dedent|''
name|'class'
name|'StrOpt'
op|'('
name|'Opt'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""\n    String opts do not have their values transformed and are returned as\n    str objects.\n    """'
newline|'\n'
name|'pass'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|BoolOpt
dedent|''
name|'class'
name|'BoolOpt'
op|'('
name|'Opt'
op|')'
op|':'
newline|'\n'
nl|'\n'
indent|'    '
string|'"""\n    Bool opts are set to True or False on the command line using --optname or\n    --noopttname respectively.\n\n    In config files, boolean values are case insensitive and can be set using\n    1/0, yes/no, true/false or on/off.\n    """'
newline|'\n'
nl|'\n'
DECL|member|_get_from_config_parser
name|'def'
name|'_get_from_config_parser'
op|'('
name|'self'
op|','
name|'cparser'
op|','
name|'section'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Retrieve the opt value as a boolean from ConfigParser."""'
newline|'\n'
name|'return'
name|'cparser'
op|'.'
name|'getboolean'
op|'('
name|'section'
op|','
name|'self'
op|'.'
name|'dest'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_add_to_cli
dedent|''
name|'def'
name|'_add_to_cli'
op|'('
name|'self'
op|','
name|'parser'
op|','
name|'group'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Extends the base class method to add the --nooptname option."""'
newline|'\n'
name|'super'
op|'('
name|'BoolOpt'
op|','
name|'self'
op|')'
op|'.'
name|'_add_to_cli'
op|'('
name|'parser'
op|','
name|'group'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_add_inverse_to_optparse'
op|'('
name|'parser'
op|','
name|'group'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_add_inverse_to_optparse
dedent|''
name|'def'
name|'_add_inverse_to_optparse'
op|'('
name|'self'
op|','
name|'parser'
op|','
name|'group'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Add the --nooptname option to the option parser."""'
newline|'\n'
name|'container'
op|'='
name|'self'
op|'.'
name|'_get_optparse_container'
op|'('
name|'parser'
op|','
name|'group'
op|')'
newline|'\n'
name|'kwargs'
op|'='
name|'self'
op|'.'
name|'_get_optparse_kwargs'
op|'('
name|'group'
op|','
name|'action'
op|'='
string|"'store_false'"
op|')'
newline|'\n'
name|'prefix'
op|'='
name|'self'
op|'.'
name|'_get_optparse_prefix'
op|'('
string|"'no'"
op|','
name|'group'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_add_to_optparse'
op|'('
name|'container'
op|','
name|'self'
op|'.'
name|'name'
op|','
name|'None'
op|','
name|'kwargs'
op|','
name|'prefix'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_get_optparse_kwargs
dedent|''
name|'def'
name|'_get_optparse_kwargs'
op|'('
name|'self'
op|','
name|'group'
op|','
name|'action'
op|'='
string|"'store_true'"
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Extends the base optparse keyword dict for boolean options."""'
newline|'\n'
name|'return'
name|'super'
op|'('
name|'BoolOpt'
op|','
nl|'\n'
name|'self'
op|')'
op|'.'
name|'_get_optparse_kwargs'
op|'('
name|'group'
op|','
name|'action'
op|'='
name|'action'
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|IntOpt
dedent|''
dedent|''
name|'class'
name|'IntOpt'
op|'('
name|'Opt'
op|')'
op|':'
newline|'\n'
nl|'\n'
indent|'    '
string|'"""Int opt values are converted to integers using the int() builtin."""'
newline|'\n'
nl|'\n'
DECL|member|_get_from_config_parser
name|'def'
name|'_get_from_config_parser'
op|'('
name|'self'
op|','
name|'cparser'
op|','
name|'section'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Retrieve the opt value as a integer from ConfigParser."""'
newline|'\n'
name|'return'
name|'cparser'
op|'.'
name|'getint'
op|'('
name|'section'
op|','
name|'self'
op|'.'
name|'dest'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_get_optparse_kwargs
dedent|''
name|'def'
name|'_get_optparse_kwargs'
op|'('
name|'self'
op|','
name|'group'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Extends the base optparse keyword dict for integer options."""'
newline|'\n'
name|'return'
name|'super'
op|'('
name|'IntOpt'
op|','
nl|'\n'
name|'self'
op|')'
op|'.'
name|'_get_optparse_kwargs'
op|'('
name|'group'
op|','
name|'type'
op|'='
string|"'int'"
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|FloatOpt
dedent|''
dedent|''
name|'class'
name|'FloatOpt'
op|'('
name|'Opt'
op|')'
op|':'
newline|'\n'
nl|'\n'
indent|'    '
string|'"""Float opt values are converted to floats using the float() builtin."""'
newline|'\n'
nl|'\n'
DECL|member|_get_from_config_parser
name|'def'
name|'_get_from_config_parser'
op|'('
name|'self'
op|','
name|'cparser'
op|','
name|'section'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Retrieve the opt value as a float from ConfigParser."""'
newline|'\n'
name|'return'
name|'cparser'
op|'.'
name|'getfloat'
op|'('
name|'section'
op|','
name|'self'
op|'.'
name|'dest'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_get_optparse_kwargs
dedent|''
name|'def'
name|'_get_optparse_kwargs'
op|'('
name|'self'
op|','
name|'group'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Extends the base optparse keyword dict for float options."""'
newline|'\n'
name|'return'
name|'super'
op|'('
name|'FloatOpt'
op|','
nl|'\n'
name|'self'
op|')'
op|'.'
name|'_get_optparse_kwargs'
op|'('
name|'group'
op|','
name|'type'
op|'='
string|"'float'"
op|','
op|'**'
name|'kwargs'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|ListOpt
dedent|''
dedent|''
name|'class'
name|'ListOpt'
op|'('
name|'Opt'
op|')'
op|':'
newline|'\n'
nl|'\n'
indent|'    '
string|'"""\n    List opt values are simple string values separated by commas. The opt value\n    is a list containing these strings.\n    """'
newline|'\n'
nl|'\n'
DECL|member|_get_from_config_parser
name|'def'
name|'_get_from_config_parser'
op|'('
name|'self'
op|','
name|'cparser'
op|','
name|'section'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Retrieve the opt value as a list from ConfigParser."""'
newline|'\n'
name|'return'
name|'cparser'
op|'.'
name|'get'
op|'('
name|'section'
op|','
name|'self'
op|'.'
name|'dest'
op|')'
op|'.'
name|'split'
op|'('
string|"','"
op|')'
newline|'\n'
nl|'\n'
DECL|member|_get_optparse_kwargs
dedent|''
name|'def'
name|'_get_optparse_kwargs'
op|'('
name|'self'
op|','
name|'group'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Extends the base optparse keyword dict for list options."""'
newline|'\n'
name|'return'
name|'super'
op|'('
name|'ListOpt'
op|','
nl|'\n'
name|'self'
op|')'
op|'.'
name|'_get_optparse_kwargs'
op|'('
name|'group'
op|','
nl|'\n'
name|'type'
op|'='
string|"'string'"
op|','
nl|'\n'
name|'action'
op|'='
string|"'callback'"
op|','
nl|'\n'
name|'callback'
op|'='
name|'self'
op|'.'
name|'_parse_list'
op|','
nl|'\n'
op|'**'
name|'kwargs'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_parse_list
dedent|''
name|'def'
name|'_parse_list'
op|'('
name|'self'
op|','
name|'option'
op|','
name|'opt'
op|','
name|'value'
op|','
name|'parser'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""An optparse callback for parsing an option value into a list."""'
newline|'\n'
name|'setattr'
op|'('
name|'parser'
op|'.'
name|'values'
op|','
name|'self'
op|'.'
name|'dest'
op|','
name|'value'
op|'.'
name|'split'
op|'('
string|"','"
op|')'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|MultiStrOpt
dedent|''
dedent|''
name|'class'
name|'MultiStrOpt'
op|'('
name|'Opt'
op|')'
op|':'
newline|'\n'
nl|'\n'
indent|'    '
string|'"""\n    Multistr opt values are string opts which may be specified multiple times.\n    The opt value is a list containing all the string values specified.\n    """'
newline|'\n'
nl|'\n'
DECL|member|_get_from_config_parser
name|'def'
name|'_get_from_config_parser'
op|'('
name|'self'
op|','
name|'cparser'
op|','
name|'section'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Retrieve the opt value as a multistr from ConfigParser."""'
newline|'\n'
comment|'# FIXME(markmc): values spread across the CLI and multiple'
nl|'\n'
comment|'#                config files should be appended'
nl|'\n'
name|'value'
op|'='
name|'super'
op|'('
name|'MultiStrOpt'
op|','
name|'self'
op|')'
op|'.'
name|'_get_from_config_parser'
op|'('
name|'cparser'
op|','
name|'section'
op|')'
newline|'\n'
name|'return'
name|'value'
name|'if'
name|'value'
name|'is'
name|'None'
name|'else'
op|'['
name|'value'
op|']'
newline|'\n'
nl|'\n'
DECL|member|_get_optparse_kwargs
dedent|''
name|'def'
name|'_get_optparse_kwargs'
op|'('
name|'self'
op|','
name|'group'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Extends the base optparse keyword dict for multi str options."""'
newline|'\n'
name|'return'
name|'super'
op|'('
name|'MultiStrOpt'
op|','
nl|'\n'
name|'self'
op|')'
op|'.'
name|'_get_optparse_kwargs'
op|'('
name|'group'
op|','
name|'action'
op|'='
string|"'append'"
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|OptGroup
dedent|''
dedent|''
name|'class'
name|'OptGroup'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
nl|'\n'
indent|'    '
string|'"""\n    Represents a group of opts.\n\n    CLI opts in the group are automatically prefixed with the group name.\n\n    Each group corresponds to a section in config files.\n\n    An OptGroup object has no public methods, but has a number of public string\n    properties:\n\n      name:\n        the name of the group\n      title:\n        the group title as displayed in --help\n      help:\n        the group description as displayed in --help\n    """'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'name'
op|','
name|'title'
op|'='
name|'None'
op|','
name|'help'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Constructs an OptGroup object.\n\n        :param name: the group name\n        :param title: the group title for --help\n        :param help: the group description for --help\n        """'
newline|'\n'
name|'self'
op|'.'
name|'name'
op|'='
name|'name'
newline|'\n'
name|'if'
name|'title'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'title'
op|'='
string|'"%s options"'
op|'%'
name|'title'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'title'
op|'='
name|'title'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'help'
op|'='
name|'help'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'_opts'
op|'='
op|'{'
op|'}'
comment|'# dict of dicts of {opt:, override:, default:)'
newline|'\n'
name|'self'
op|'.'
name|'_optparse_group'
op|'='
name|'None'
newline|'\n'
nl|'\n'
DECL|member|_register_opt
dedent|''
name|'def'
name|'_register_opt'
op|'('
name|'self'
op|','
name|'opt'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Add an opt to this group.\n\n        :param opt: an Opt object\n        :returns: False if previously registered, True otherwise\n        :raises: DuplicateOptError if a naming conflict is detected\n        """'
newline|'\n'
name|'if'
name|'_is_opt_registered'
op|'('
name|'self'
op|'.'
name|'_opts'
op|','
name|'opt'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'False'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'_opts'
op|'['
name|'opt'
op|'.'
name|'dest'
op|']'
op|'='
op|'{'
string|"'opt'"
op|':'
name|'opt'
op|','
string|"'override'"
op|':'
name|'None'
op|','
string|"'default'"
op|':'
name|'None'
op|'}'
newline|'\n'
nl|'\n'
name|'return'
name|'True'
newline|'\n'
nl|'\n'
DECL|member|_get_optparse_group
dedent|''
name|'def'
name|'_get_optparse_group'
op|'('
name|'self'
op|','
name|'parser'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Build an optparse.OptionGroup for this group."""'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'_optparse_group'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'_optparse_group'
op|'='
name|'optparse'
op|'.'
name|'OptionGroup'
op|'('
name|'parser'
op|','
name|'self'
op|'.'
name|'title'
op|','
name|'self'
op|'.'
name|'help'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'self'
op|'.'
name|'_optparse_group'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|ConfigOpts
dedent|''
dedent|''
name|'class'
name|'ConfigOpts'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
nl|'\n'
indent|'    '
string|'"""\n    Config options which may be set on the command line or in config files.\n\n    ConfigOpts is a configuration option manager with APIs for registering\n    option schemas, grouping options, parsing option values and retrieving\n    the values of options.\n    """'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
nl|'\n'
name|'project'
op|'='
name|'None'
op|','
nl|'\n'
name|'prog'
op|'='
name|'None'
op|','
nl|'\n'
name|'version'
op|'='
name|'None'
op|','
nl|'\n'
name|'usage'
op|'='
name|'None'
op|','
nl|'\n'
name|'default_config_files'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Construct a ConfigOpts object.\n\n        Automatically registers the --config-file option with either a supplied\n        list of default config files, or a list from find_config_files().\n\n        :param project: the toplevel project name, used to locate config files\n        :param prog: the name of the program (defaults to sys.argv[0] basename)\n        :param version: the program version (for --version)\n        :param usage: a usage string (%prog will be expanded)\n        :param default_config_files: config files to use by default\n        """'
newline|'\n'
name|'if'
name|'prog'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'prog'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'basename'
op|'('
name|'sys'
op|'.'
name|'argv'
op|'['
number|'0'
op|']'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'default_config_files'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'default_config_files'
op|'='
name|'find_config_files'
op|'('
name|'project'
op|','
name|'prog'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'project'
op|'='
name|'project'
newline|'\n'
name|'self'
op|'.'
name|'prog'
op|'='
name|'prog'
newline|'\n'
name|'self'
op|'.'
name|'version'
op|'='
name|'version'
newline|'\n'
name|'self'
op|'.'
name|'usage'
op|'='
name|'usage'
newline|'\n'
name|'self'
op|'.'
name|'default_config_files'
op|'='
name|'default_config_files'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'_opts'
op|'='
op|'{'
op|'}'
comment|'# dict of dicts of (opt:, override:, default:)'
newline|'\n'
name|'self'
op|'.'
name|'_groups'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'_args'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'_cli_values'
op|'='
op|'{'
op|'}'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'_oparser'
op|'='
name|'optparse'
op|'.'
name|'OptionParser'
op|'('
name|'prog'
op|'='
name|'self'
op|'.'
name|'prog'
op|','
nl|'\n'
name|'version'
op|'='
name|'self'
op|'.'
name|'version'
op|','
nl|'\n'
name|'usage'
op|'='
name|'self'
op|'.'
name|'usage'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_cparser'
op|'='
name|'None'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'register_cli_opt'
op|'('
name|'MultiStrOpt'
op|'('
string|"'config-file'"
op|','
nl|'\n'
name|'default'
op|'='
name|'self'
op|'.'
name|'default_config_files'
op|','
nl|'\n'
name|'metavar'
op|'='
string|"'PATH'"
op|','
nl|'\n'
name|'help'
op|'='
string|"'Path to a config file to use. Multiple config '"
nl|'\n'
string|"'files can be specified, with values in later '"
nl|'\n'
string|"'files taking precedence. The default files used '"
nl|'\n'
string|"'are: %s'"
op|'%'
op|'('
name|'self'
op|'.'
name|'default_config_files'
op|','
op|')'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|__call__
dedent|''
name|'def'
name|'__call__'
op|'('
name|'self'
op|','
name|'args'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Parse command line arguments and config files.\n\n        Calling a ConfigOpts object causes the supplied command line arguments\n        and config files to be parsed, causing opt values to be made available\n        as attributes of the object.\n\n        The object may be called multiple times, each time causing the previous\n        set of values to be overwritten.\n\n        :params args: command line arguments (defaults to sys.argv[1:])\n        :returns: the list of arguments left over after parsing options\n        :raises: SystemExit, ConfigFilesNotFoundError, ConfigFileParseError\n        """'
newline|'\n'
name|'self'
op|'.'
name|'reset'
op|'('
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'_args'
op|'='
name|'args'
newline|'\n'
nl|'\n'
op|'('
name|'values'
op|','
name|'args'
op|')'
op|'='
name|'self'
op|'.'
name|'_oparser'
op|'.'
name|'parse_args'
op|'('
name|'self'
op|'.'
name|'_args'
op|')'
newline|'\n'
nl|'\n'
name|'self'
op|'.'
name|'_cli_values'
op|'='
name|'vars'
op|'('
name|'values'
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'self'
op|'.'
name|'config_file'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'_parse_config_files'
op|'('
name|'self'
op|'.'
name|'config_file'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'return'
name|'args'
newline|'\n'
nl|'\n'
DECL|member|__getattr__
dedent|''
name|'def'
name|'__getattr__'
op|'('
name|'self'
op|','
name|'name'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Look up an option value and perform string substitution.\n\n        :param name: the opt name (or \'dest\', more precisely)\n        :returns: the option value (after string subsititution) or a GroupAttr\n        :raises: NoSuchOptError,ConfigFileValueError,TemplateSubstitutionError\n        """'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'_substitute'
op|'('
name|'self'
op|'.'
name|'_get'
op|'('
name|'name'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|reset
dedent|''
name|'def'
name|'reset'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Reset the state of the object to before it was called."""'
newline|'\n'
name|'self'
op|'.'
name|'_args'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'_cli_values'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'_cparser'
op|'='
name|'None'
newline|'\n'
nl|'\n'
DECL|member|register_opt
dedent|''
name|'def'
name|'register_opt'
op|'('
name|'self'
op|','
name|'opt'
op|','
name|'group'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Register an option schema.\n\n        Registering an option schema makes any option value which is previously\n        or subsequently parsed from the command line or config files available\n        as an attribute of this object.\n\n        :param opt: an instance of an Opt sub-class\n        :param group: an optional OptGroup object or group name\n        :return: False if the opt was already register, True otherwise\n        :raises: DuplicateOptError\n        """'
newline|'\n'
name|'if'
name|'group'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_get_group'
op|'('
name|'group'
op|')'
op|'.'
name|'_register_opt'
op|'('
name|'opt'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'_is_opt_registered'
op|'('
name|'self'
op|'.'
name|'_opts'
op|','
name|'opt'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'False'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'_opts'
op|'['
name|'opt'
op|'.'
name|'dest'
op|']'
op|'='
op|'{'
string|"'opt'"
op|':'
name|'opt'
op|','
string|"'override'"
op|':'
name|'None'
op|','
string|"'default'"
op|':'
name|'None'
op|'}'
newline|'\n'
nl|'\n'
name|'return'
name|'True'
newline|'\n'
nl|'\n'
DECL|member|register_opts
dedent|''
name|'def'
name|'register_opts'
op|'('
name|'self'
op|','
name|'opts'
op|','
name|'group'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Register multiple option schemas at once."""'
newline|'\n'
name|'for'
name|'opt'
name|'in'
name|'opts'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'register_opt'
op|'('
name|'opt'
op|','
name|'group'
op|')'
newline|'\n'
nl|'\n'
DECL|member|register_cli_opt
dedent|''
dedent|''
name|'def'
name|'register_cli_opt'
op|'('
name|'self'
op|','
name|'opt'
op|','
name|'group'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Register a CLI option schema.\n\n        CLI option schemas must be registered before the command line and\n        config files are parsed. This is to ensure that all CLI options are\n        show in --help and option validation works as expected.\n\n        :param opt: an instance of an Opt sub-class\n        :param group: an optional OptGroup object or group name\n        :return: False if the opt was already register, True otherwise\n        :raises: DuplicateOptError, ArgsAlreadyParsedError\n        """'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'_args'
op|'!='
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'ArgsAlreadyParsedError'
op|'('
string|'"cannot register CLI option"'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'not'
name|'self'
op|'.'
name|'register_opt'
op|'('
name|'opt'
op|','
name|'group'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'False'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'group'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'group'
op|'='
name|'self'
op|'.'
name|'_get_group'
op|'('
name|'group'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'opt'
op|'.'
name|'_add_to_cli'
op|'('
name|'self'
op|'.'
name|'_oparser'
op|','
name|'group'
op|')'
newline|'\n'
nl|'\n'
name|'return'
name|'True'
newline|'\n'
nl|'\n'
DECL|member|register_cli_opts
dedent|''
name|'def'
name|'register_cli_opts'
op|'('
name|'self'
op|','
name|'opts'
op|','
name|'group'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Register multiple CLI option schemas at once."""'
newline|'\n'
name|'for'
name|'opt'
name|'in'
name|'opts'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'register_cli_opt'
op|'('
name|'opt'
op|','
name|'group'
op|')'
newline|'\n'
nl|'\n'
DECL|member|register_group
dedent|''
dedent|''
name|'def'
name|'register_group'
op|'('
name|'self'
op|','
name|'group'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Register an option group.\n\n        An option group must be registered before options can be registered\n        with the group.\n\n        :param group: an OptGroup object\n        """'
newline|'\n'
name|'if'
name|'group'
op|'.'
name|'name'
name|'in'
name|'self'
op|'.'
name|'_groups'
op|':'
newline|'\n'
indent|'            '
name|'return'
newline|'\n'
nl|'\n'
dedent|''
name|'self'
op|'.'
name|'_groups'
op|'['
name|'group'
op|'.'
name|'name'
op|']'
op|'='
name|'copy'
op|'.'
name|'copy'
op|'('
name|'group'
op|')'
newline|'\n'
nl|'\n'
DECL|member|set_override
dedent|''
name|'def'
name|'set_override'
op|'('
name|'self'
op|','
name|'name'
op|','
name|'override'
op|','
name|'group'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Override an opt value.\n\n        Override the command line, config file and default values of a\n        given option.\n\n        :param name: the name/dest of the opt\n        :param override: the override value\n        :param group: an option OptGroup object or group name\n        :raises: NoSuchOptError, NoSuchGroupError\n        """'
newline|'\n'
name|'opt_info'
op|'='
name|'self'
op|'.'
name|'_get_opt_info'
op|'('
name|'name'
op|','
name|'group'
op|')'
newline|'\n'
name|'opt_info'
op|'['
string|"'override'"
op|']'
op|'='
name|'override'
newline|'\n'
nl|'\n'
DECL|member|set_default
dedent|''
name|'def'
name|'set_default'
op|'('
name|'self'
op|','
name|'name'
op|','
name|'default'
op|','
name|'group'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Override an opt\'s default value.\n\n        Override the default value of given option. A command line or\n        config file value will still take precedence over this default.\n\n        :param name: the name/dest of the opt\n        :param default: the default value\n        :param group: an option OptGroup object or group name\n        :raises: NoSuchOptError, NoSuchGroupError\n        """'
newline|'\n'
name|'opt_info'
op|'='
name|'self'
op|'.'
name|'_get_opt_info'
op|'('
name|'name'
op|','
name|'group'
op|')'
newline|'\n'
name|'opt_info'
op|'['
string|"'default'"
op|']'
op|'='
name|'default'
newline|'\n'
nl|'\n'
DECL|member|log_opt_values
dedent|''
name|'def'
name|'log_opt_values'
op|'('
name|'self'
op|','
name|'logger'
op|','
name|'lvl'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Log the value of all registered opts.\n\n        It\'s often useful for an app to log its configuration to a log file at\n        startup for debugging. This method dumps to the entire config state to\n        the supplied logger at a given log level.\n\n        :param logger: a logging.Logger object\n        :param lvl: the log level (e.g. logging.DEBUG) arg to logger.log()\n        """'
newline|'\n'
name|'logger'
op|'.'
name|'log'
op|'('
name|'lvl'
op|','
string|'"*"'
op|'*'
number|'80'
op|')'
newline|'\n'
name|'logger'
op|'.'
name|'log'
op|'('
name|'lvl'
op|','
string|'"Configuration options gathered from:"'
op|')'
newline|'\n'
name|'logger'
op|'.'
name|'log'
op|'('
name|'lvl'
op|','
string|'"command line args: %s"'
op|','
name|'self'
op|'.'
name|'_args'
op|')'
newline|'\n'
name|'logger'
op|'.'
name|'log'
op|'('
name|'lvl'
op|','
string|'"config files: %s"'
op|','
name|'self'
op|'.'
name|'config_file'
op|')'
newline|'\n'
name|'logger'
op|'.'
name|'log'
op|'('
name|'lvl'
op|','
string|'"="'
op|'*'
number|'80'
op|')'
newline|'\n'
nl|'\n'
name|'for'
name|'opt_name'
name|'in'
name|'sorted'
op|'('
name|'self'
op|'.'
name|'_opts'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'logger'
op|'.'
name|'log'
op|'('
name|'lvl'
op|','
string|'"%-30s = %s"'
op|','
name|'opt_name'
op|','
name|'getattr'
op|'('
name|'self'
op|','
name|'opt_name'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'for'
name|'group_name'
name|'in'
name|'self'
op|'.'
name|'_groups'
op|':'
newline|'\n'
indent|'            '
name|'group_attr'
op|'='
name|'self'
op|'.'
name|'GroupAttr'
op|'('
name|'self'
op|','
name|'group_name'
op|')'
newline|'\n'
name|'for'
name|'opt_name'
name|'in'
name|'sorted'
op|'('
name|'self'
op|'.'
name|'_groups'
op|'['
name|'group_name'
op|']'
op|'.'
name|'_opts'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'logger'
op|'.'
name|'log'
op|'('
name|'lvl'
op|','
string|'"%-30s = %s"'
op|','
nl|'\n'
string|'"%s.%s"'
op|'%'
op|'('
name|'group_name'
op|','
name|'opt_name'
op|')'
op|','
nl|'\n'
name|'getattr'
op|'('
name|'group_attr'
op|','
name|'opt_name'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'logger'
op|'.'
name|'log'
op|'('
name|'lvl'
op|','
string|'"*"'
op|'*'
number|'80'
op|')'
newline|'\n'
nl|'\n'
DECL|member|print_usage
dedent|''
name|'def'
name|'print_usage'
op|'('
name|'self'
op|','
name|'file'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Print the usage message for the current program."""'
newline|'\n'
name|'self'
op|'.'
name|'_oparser'
op|'.'
name|'print_usage'
op|'('
name|'file'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_get
dedent|''
name|'def'
name|'_get'
op|'('
name|'self'
op|','
name|'name'
op|','
name|'group'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Look up an option value.\n\n        :param name: the opt name (or \'dest\', more precisely)\n        :param group: an option OptGroup\n        :returns: the option value, or a GroupAttr object\n        :raises: NoSuchOptError, NoSuchGroupError, ConfigFileValueError,\n                 TemplateSubstitutionError\n        """'
newline|'\n'
name|'if'
name|'group'
name|'is'
name|'None'
name|'and'
name|'name'
name|'in'
name|'self'
op|'.'
name|'_groups'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'GroupAttr'
op|'('
name|'self'
op|','
name|'name'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'group'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'group'
op|'='
name|'self'
op|'.'
name|'_get_group'
op|'('
name|'group'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'info'
op|'='
name|'self'
op|'.'
name|'_get_opt_info'
op|'('
name|'name'
op|','
name|'group'
op|')'
newline|'\n'
name|'default'
op|','
name|'opt'
op|','
name|'override'
op|'='
name|'map'
op|'('
name|'lambda'
name|'k'
op|':'
name|'info'
op|'['
name|'k'
op|']'
op|','
name|'sorted'
op|'('
name|'info'
op|'.'
name|'keys'
op|'('
op|')'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'override'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'override'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'_cparser'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'section'
op|'='
name|'group'
op|'.'
name|'name'
name|'if'
name|'group'
name|'is'
name|'not'
name|'None'
name|'else'
string|"'DEFAULT'"
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'opt'
op|'.'
name|'_get_from_config_parser'
op|'('
name|'self'
op|'.'
name|'_cparser'
op|','
name|'section'
op|')'
newline|'\n'
dedent|''
name|'except'
op|'('
name|'ConfigParser'
op|'.'
name|'NoOptionError'
op|','
nl|'\n'
name|'ConfigParser'
op|'.'
name|'NoSectionError'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'pass'
newline|'\n'
dedent|''
name|'except'
name|'ValueError'
op|','
name|'ve'
op|':'
newline|'\n'
indent|'                '
name|'raise'
name|'ConfigFileValueError'
op|'('
name|'str'
op|'('
name|'ve'
op|')'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'name'
op|'='
name|'name'
name|'if'
name|'group'
name|'is'
name|'None'
name|'else'
name|'group'
op|'.'
name|'name'
op|'+'
string|"'_'"
op|'+'
name|'name'
newline|'\n'
name|'value'
op|'='
name|'self'
op|'.'
name|'_cli_values'
op|'.'
name|'get'
op|'('
name|'name'
op|','
name|'None'
op|')'
newline|'\n'
name|'if'
name|'value'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'value'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'default'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'default'
newline|'\n'
nl|'\n'
dedent|''
name|'return'
name|'opt'
op|'.'
name|'default'
newline|'\n'
nl|'\n'
DECL|member|_substitute
dedent|''
name|'def'
name|'_substitute'
op|'('
name|'self'
op|','
name|'value'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Perform string template substitution.\n\n        Substititue any template variables (e.g. $foo, ${bar}) in the supplied\n        string value(s) with opt values.\n\n        :param value: the string value, or list of string values\n        :returns: the substituted string(s)\n        """'
newline|'\n'
name|'if'
name|'type'
op|'('
name|'value'
op|')'
name|'is'
name|'list'
op|':'
newline|'\n'
indent|'            '
name|'return'
op|'['
name|'self'
op|'.'
name|'_substitute'
op|'('
name|'i'
op|')'
name|'for'
name|'i'
name|'in'
name|'value'
op|']'
newline|'\n'
dedent|''
name|'elif'
name|'type'
op|'('
name|'value'
op|')'
name|'is'
name|'str'
op|':'
newline|'\n'
indent|'            '
name|'tmpl'
op|'='
name|'string'
op|'.'
name|'Template'
op|'('
name|'value'
op|')'
newline|'\n'
name|'return'
name|'tmpl'
op|'.'
name|'safe_substitute'
op|'('
name|'self'
op|'.'
name|'StrSubWrapper'
op|'('
name|'self'
op|')'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'value'
newline|'\n'
nl|'\n'
DECL|member|_get_group
dedent|''
dedent|''
name|'def'
name|'_get_group'
op|'('
name|'self'
op|','
name|'group_or_name'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Looks up a OptGroup object.\n\n        Helper function to return an OptGroup given a parameter which can\n        either be the group\'s name or an OptGroup object.\n\n        The OptGroup object returned is from the internal dict of OptGroup\n        objects, which will be a copy of any OptGroup object that users of\n        the API have access to.\n\n        :param group_or_name: the group\'s name or the OptGroup object itself\n        :raises: NoSuchGroupError\n        """'
newline|'\n'
name|'if'
name|'isinstance'
op|'('
name|'group_or_name'
op|','
name|'OptGroup'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'group_name'
op|'='
name|'group_or_name'
op|'.'
name|'name'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'group_name'
op|'='
name|'group_or_name'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'not'
name|'group_name'
name|'in'
name|'self'
op|'.'
name|'_groups'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'NoSuchGroupError'
op|'('
name|'group_name'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'return'
name|'self'
op|'.'
name|'_groups'
op|'['
name|'group_name'
op|']'
newline|'\n'
nl|'\n'
DECL|member|_get_opt_info
dedent|''
name|'def'
name|'_get_opt_info'
op|'('
name|'self'
op|','
name|'opt_name'
op|','
name|'group'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Return the (opt, override, default) dict for an opt.\n\n        :param opt_name: an opt name/dest\n        :param group: an optional group name or OptGroup object\n        :raises: NoSuchOptError, NoSuchGroupError\n        """'
newline|'\n'
name|'if'
name|'group'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'opts'
op|'='
name|'self'
op|'.'
name|'_opts'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'group'
op|'='
name|'self'
op|'.'
name|'_get_group'
op|'('
name|'group'
op|')'
newline|'\n'
name|'opts'
op|'='
name|'group'
op|'.'
name|'_opts'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'not'
name|'opt_name'
name|'in'
name|'opts'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'NoSuchOptError'
op|'('
name|'opt_name'
op|','
name|'group'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'return'
name|'opts'
op|'['
name|'opt_name'
op|']'
newline|'\n'
nl|'\n'
DECL|member|_parse_config_files
dedent|''
name|'def'
name|'_parse_config_files'
op|'('
name|'self'
op|','
name|'config_files'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Parse the supplied configuration files.\n\n        :raises: ConfigFilesNotFoundError, ConfigFileParseError\n        """'
newline|'\n'
name|'self'
op|'.'
name|'_cparser'
op|'='
name|'ConfigParser'
op|'.'
name|'SafeConfigParser'
op|'('
name|'allow_no_value'
op|'='
name|'True'
op|')'
newline|'\n'
nl|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'read_ok'
op|'='
name|'self'
op|'.'
name|'_cparser'
op|'.'
name|'read'
op|'('
name|'config_files'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'ConfigParser'
op|'.'
name|'ParsingError'
op|','
name|'cpe'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'ConfigFileParseError'
op|'('
name|'cpe'
op|'.'
name|'filename'
op|','
name|'cpe'
op|'.'
name|'message'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'read_ok'
op|'!='
name|'config_files'
op|':'
newline|'\n'
indent|'            '
name|'not_read_ok'
op|'='
name|'filter'
op|'('
name|'lambda'
name|'f'
op|':'
name|'f'
name|'not'
name|'in'
name|'read_ok'
op|','
name|'config_files'
op|')'
newline|'\n'
name|'raise'
name|'ConfigFilesNotFoundError'
op|'('
name|'not_read_ok'
op|')'
newline|'\n'
nl|'\n'
DECL|class|GroupAttr
dedent|''
dedent|''
name|'class'
name|'GroupAttr'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
nl|'\n'
indent|'        '
string|'"""\n        A helper class representing the option values of a group as attributes.\n        """'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'conf'
op|','
name|'group'
op|')'
op|':'
newline|'\n'
indent|'            '
string|'"""Construct a GroupAttr object.\n\n            :param conf: a ConfigOpts object\n            :param group: a group name or OptGroup object\n            """'
newline|'\n'
name|'self'
op|'.'
name|'conf'
op|'='
name|'conf'
newline|'\n'
name|'self'
op|'.'
name|'group'
op|'='
name|'group'
newline|'\n'
nl|'\n'
DECL|member|__getattr__
dedent|''
name|'def'
name|'__getattr__'
op|'('
name|'self'
op|','
name|'name'
op|')'
op|':'
newline|'\n'
indent|'            '
string|'"""Look up an option value and perform template substitution."""'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'conf'
op|'.'
name|'_substitute'
op|'('
name|'self'
op|'.'
name|'conf'
op|'.'
name|'_get'
op|'('
name|'name'
op|','
name|'self'
op|'.'
name|'group'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|class|StrSubWrapper
dedent|''
dedent|''
name|'class'
name|'StrSubWrapper'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
nl|'\n'
indent|'        '
string|'"""\n        A helper class exposing opt values as a dict for string substitution.\n        """'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'conf'
op|')'
op|':'
newline|'\n'
indent|'            '
string|'"""Construct a StrSubWrapper object.\n\n            :param conf: a ConfigOpts object\n            """'
newline|'\n'
name|'self'
op|'.'
name|'conf'
op|'='
name|'conf'
newline|'\n'
nl|'\n'
DECL|member|__getitem__
dedent|''
name|'def'
name|'__getitem__'
op|'('
name|'self'
op|','
name|'key'
op|')'
op|':'
newline|'\n'
indent|'            '
string|'"""Look up an opt value from the ConfigOpts object.\n\n            :param key: an opt name\n            :returns: an opt value\n            :raises: TemplateSubstitutionError if attribute is a group\n            """'
newline|'\n'
name|'value'
op|'='
name|'getattr'
op|'('
name|'self'
op|'.'
name|'conf'
op|','
name|'key'
op|')'
newline|'\n'
name|'if'
name|'isinstance'
op|'('
name|'value'
op|','
name|'self'
op|'.'
name|'conf'
op|'.'
name|'GroupAttr'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'raise'
name|'TemplateSubstitutionError'
op|'('
nl|'\n'
string|"'substituting group %s not supported'"
op|'%'
name|'key'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'value'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|CommonConfigOpts
dedent|''
dedent|''
dedent|''
name|'class'
name|'CommonConfigOpts'
op|'('
name|'ConfigOpts'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|variable|DEFAULT_LOG_FORMAT
indent|'    '
name|'DEFAULT_LOG_FORMAT'
op|'='
string|'"%(asctime)s %(levelname)8s [%(name)s] %(message)s"'
newline|'\n'
DECL|variable|DEFAULT_LOG_DATE_FORMAT
name|'DEFAULT_LOG_DATE_FORMAT'
op|'='
string|'"%Y-%m-%d %H:%M:%S"'
newline|'\n'
nl|'\n'
DECL|variable|common_cli_opts
name|'common_cli_opts'
op|'='
op|'['
nl|'\n'
name|'BoolOpt'
op|'('
string|"'debug'"
op|','
nl|'\n'
DECL|variable|short
name|'short'
op|'='
string|"'d'"
op|','
nl|'\n'
DECL|variable|default
name|'default'
op|'='
name|'False'
op|','
nl|'\n'
DECL|variable|help
name|'help'
op|'='
string|"'Print debugging output'"
op|')'
op|','
nl|'\n'
name|'BoolOpt'
op|'('
string|"'verbose'"
op|','
nl|'\n'
DECL|variable|short
name|'short'
op|'='
string|"'v'"
op|','
nl|'\n'
DECL|variable|default
name|'default'
op|'='
name|'False'
op|','
nl|'\n'
DECL|variable|help
name|'help'
op|'='
string|"'Print more verbose output'"
op|')'
op|','
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
DECL|variable|logging_cli_opts
name|'logging_cli_opts'
op|'='
op|'['
nl|'\n'
name|'StrOpt'
op|'('
string|"'log-config'"
op|','
nl|'\n'
DECL|variable|metavar
name|'metavar'
op|'='
string|"'PATH'"
op|','
nl|'\n'
DECL|variable|help
name|'help'
op|'='
string|"'If this option is specified, the logging configuration '"
nl|'\n'
string|"'file specified is used and overrides any other logging '"
nl|'\n'
string|"'options specified. Please see the Python logging module '"
nl|'\n'
string|"'documentation for details on logging configuration '"
nl|'\n'
string|"'files.'"
op|')'
op|','
nl|'\n'
name|'StrOpt'
op|'('
string|"'log-format'"
op|','
nl|'\n'
DECL|variable|default
name|'default'
op|'='
name|'DEFAULT_LOG_FORMAT'
op|','
nl|'\n'
DECL|variable|metavar
name|'metavar'
op|'='
string|"'FORMAT'"
op|','
nl|'\n'
DECL|variable|help
name|'help'
op|'='
string|"'A logging.Formatter log message format string which may '"
nl|'\n'
string|"'use any of the available logging.LogRecord attributes. '"
nl|'\n'
string|"'Default: %default'"
op|')'
op|','
nl|'\n'
name|'StrOpt'
op|'('
string|"'log-date-format'"
op|','
nl|'\n'
DECL|variable|default
name|'default'
op|'='
name|'DEFAULT_LOG_DATE_FORMAT'
op|','
nl|'\n'
DECL|variable|metavar
name|'metavar'
op|'='
string|"'DATE_FORMAT'"
op|','
nl|'\n'
DECL|variable|help
name|'help'
op|'='
string|"'Format string for %(asctime)s in log records. '"
nl|'\n'
string|"'Default: %default'"
op|')'
op|','
nl|'\n'
name|'StrOpt'
op|'('
string|"'log-file'"
op|','
nl|'\n'
DECL|variable|metavar
name|'metavar'
op|'='
string|"'PATH'"
op|','
nl|'\n'
DECL|variable|help
name|'help'
op|'='
string|"'(Optional) Name of log file to output to. '"
nl|'\n'
string|"'If not set, logging will go to stdout.'"
op|')'
op|','
nl|'\n'
name|'StrOpt'
op|'('
string|"'log-dir'"
op|','
nl|'\n'
DECL|variable|help
name|'help'
op|'='
string|"'(Optional) The directory to keep log files in '"
nl|'\n'
string|"'(will be prepended to --logfile)'"
op|')'
op|','
nl|'\n'
name|'BoolOpt'
op|'('
string|"'use-syslog'"
op|','
nl|'\n'
DECL|variable|default
name|'default'
op|'='
name|'False'
op|','
nl|'\n'
DECL|variable|help
name|'help'
op|'='
string|"'Use syslog for logging.'"
op|')'
op|','
nl|'\n'
op|']'
newline|'\n'
nl|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
op|'**'
name|'kwargs'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'super'
op|'('
name|'CommonConfigOpts'
op|','
name|'self'
op|')'
op|'.'
name|'__init__'
op|'('
op|'**'
name|'kwargs'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'register_cli_opts'
op|'('
name|'self'
op|'.'
name|'common_cli_opts'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'register_cli_opts'
op|'('
name|'self'
op|'.'
name|'logging_cli_opts'
op|')'
newline|'\n'
dedent|''
dedent|''
endmarker|''
end_unit
