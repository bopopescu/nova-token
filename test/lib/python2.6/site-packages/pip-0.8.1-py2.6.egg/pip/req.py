begin_unit
name|'import'
name|'sys'
newline|'\n'
name|'import'
name|'os'
newline|'\n'
name|'import'
name|'shutil'
newline|'\n'
name|'import'
name|'re'
newline|'\n'
name|'import'
name|'zipfile'
newline|'\n'
name|'import'
name|'pkg_resources'
newline|'\n'
name|'import'
name|'tempfile'
newline|'\n'
name|'import'
name|'urlparse'
newline|'\n'
name|'import'
name|'urllib2'
newline|'\n'
name|'import'
name|'urllib'
newline|'\n'
name|'import'
name|'ConfigParser'
newline|'\n'
name|'from'
name|'distutils'
op|'.'
name|'sysconfig'
name|'import'
name|'get_python_version'
newline|'\n'
name|'from'
name|'email'
op|'.'
name|'FeedParser'
name|'import'
name|'FeedParser'
newline|'\n'
name|'from'
name|'pip'
op|'.'
name|'locations'
name|'import'
name|'bin_py'
op|','
name|'running_under_virtualenv'
newline|'\n'
name|'from'
name|'pip'
op|'.'
name|'exceptions'
name|'import'
name|'InstallationError'
op|','
name|'UninstallationError'
newline|'\n'
name|'from'
name|'pip'
op|'.'
name|'vcs'
name|'import'
name|'vcs'
newline|'\n'
name|'from'
name|'pip'
op|'.'
name|'log'
name|'import'
name|'logger'
newline|'\n'
name|'from'
name|'pip'
op|'.'
name|'util'
name|'import'
name|'display_path'
op|','
name|'rmtree'
newline|'\n'
name|'from'
name|'pip'
op|'.'
name|'util'
name|'import'
name|'ask'
op|','
name|'backup_dir'
newline|'\n'
name|'from'
name|'pip'
op|'.'
name|'util'
name|'import'
name|'is_installable_dir'
op|','
name|'is_local'
op|','
name|'dist_is_local'
newline|'\n'
name|'from'
name|'pip'
op|'.'
name|'util'
name|'import'
name|'renames'
op|','
name|'normalize_path'
op|','
name|'egg_link_path'
newline|'\n'
name|'from'
name|'pip'
op|'.'
name|'util'
name|'import'
name|'make_path_relative'
newline|'\n'
name|'from'
name|'pip'
name|'import'
name|'call_subprocess'
newline|'\n'
name|'from'
name|'pip'
op|'.'
name|'backwardcompat'
name|'import'
name|'any'
op|','
name|'copytree'
newline|'\n'
name|'from'
name|'pip'
op|'.'
name|'index'
name|'import'
name|'Link'
newline|'\n'
name|'from'
name|'pip'
op|'.'
name|'locations'
name|'import'
name|'build_prefix'
newline|'\n'
name|'from'
name|'pip'
op|'.'
name|'download'
name|'import'
op|'('
name|'get_file_content'
op|','
name|'is_url'
op|','
name|'url_to_path'
op|','
nl|'\n'
name|'path_to_url'
op|','
name|'is_archive_file'
op|','
nl|'\n'
name|'unpack_vcs_link'
op|','
name|'is_vcs_url'
op|','
name|'is_file_url'
op|','
nl|'\n'
name|'unpack_file_url'
op|','
name|'unpack_http_url'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|variable|PIP_DELETE_MARKER_FILENAME
name|'PIP_DELETE_MARKER_FILENAME'
op|'='
string|"'pip-delete-this-directory.txt'"
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|InstallRequirement
name|'class'
name|'InstallRequirement'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'req'
op|','
name|'comes_from'
op|','
name|'source_dir'
op|'='
name|'None'
op|','
name|'editable'
op|'='
name|'False'
op|','
nl|'\n'
name|'url'
op|'='
name|'None'
op|','
name|'update'
op|'='
name|'True'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'isinstance'
op|'('
name|'req'
op|','
name|'basestring'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'req'
op|'='
name|'pkg_resources'
op|'.'
name|'Requirement'
op|'.'
name|'parse'
op|'('
name|'req'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'req'
op|'='
name|'req'
newline|'\n'
name|'self'
op|'.'
name|'comes_from'
op|'='
name|'comes_from'
newline|'\n'
name|'self'
op|'.'
name|'source_dir'
op|'='
name|'source_dir'
newline|'\n'
name|'self'
op|'.'
name|'editable'
op|'='
name|'editable'
newline|'\n'
name|'self'
op|'.'
name|'url'
op|'='
name|'url'
newline|'\n'
name|'self'
op|'.'
name|'_egg_info_path'
op|'='
name|'None'
newline|'\n'
comment|'# This holds the pkg_resources.Distribution object if this requirement'
nl|'\n'
comment|'# is already available:'
nl|'\n'
name|'self'
op|'.'
name|'satisfied_by'
op|'='
name|'None'
newline|'\n'
comment|'# This hold the pkg_resources.Distribution object if this requirement'
nl|'\n'
comment|'# conflicts with another installed distribution:'
nl|'\n'
name|'self'
op|'.'
name|'conflicts_with'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'_temp_build_dir'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'_is_bundle'
op|'='
name|'None'
newline|'\n'
comment|'# True if the editable should be updated:'
nl|'\n'
name|'self'
op|'.'
name|'update'
op|'='
name|'update'
newline|'\n'
comment|'# Set to True after successful installation'
nl|'\n'
name|'self'
op|'.'
name|'install_succeeded'
op|'='
name|'None'
newline|'\n'
comment|'# UninstallPathSet of uninstalled distribution (for possible rollback)'
nl|'\n'
name|'self'
op|'.'
name|'uninstalled'
op|'='
name|'None'
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'classmethod'
newline|'\n'
DECL|member|from_editable
name|'def'
name|'from_editable'
op|'('
name|'cls'
op|','
name|'editable_req'
op|','
name|'comes_from'
op|'='
name|'None'
op|','
name|'default_vcs'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'name'
op|','
name|'url'
op|'='
name|'parse_editable'
op|'('
name|'editable_req'
op|','
name|'default_vcs'
op|')'
newline|'\n'
name|'if'
name|'url'
op|'.'
name|'startswith'
op|'('
string|"'file:'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'source_dir'
op|'='
name|'url_to_path'
op|'('
name|'url'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'source_dir'
op|'='
name|'None'
newline|'\n'
dedent|''
name|'return'
name|'cls'
op|'('
name|'name'
op|','
name|'comes_from'
op|','
name|'source_dir'
op|'='
name|'source_dir'
op|','
name|'editable'
op|'='
name|'True'
op|','
name|'url'
op|'='
name|'url'
op|')'
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'classmethod'
newline|'\n'
DECL|member|from_line
name|'def'
name|'from_line'
op|'('
name|'cls'
op|','
name|'name'
op|','
name|'comes_from'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Creates an InstallRequirement from a name, which might be a\n        requirement, directory containing \'setup.py\', filename, or URL.\n        """'
newline|'\n'
name|'url'
op|'='
name|'None'
newline|'\n'
name|'name'
op|'='
name|'name'
op|'.'
name|'strip'
op|'('
op|')'
newline|'\n'
name|'req'
op|'='
name|'name'
newline|'\n'
name|'path'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'normpath'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'abspath'
op|'('
name|'name'
op|')'
op|')'
newline|'\n'
nl|'\n'
name|'if'
name|'is_url'
op|'('
name|'name'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'url'
op|'='
name|'name'
newline|'\n'
comment|'## FIXME: I think getting the requirement here is a bad idea:'
nl|'\n'
comment|'#req = get_requirement_from_url(url)'
nl|'\n'
name|'req'
op|'='
name|'None'
newline|'\n'
dedent|''
name|'elif'
name|'os'
op|'.'
name|'path'
op|'.'
name|'isdir'
op|'('
name|'path'
op|')'
name|'and'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'sep'
name|'in'
name|'name'
name|'or'
name|'name'
op|'.'
name|'startswith'
op|'('
string|"'.'"
op|')'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'not'
name|'is_installable_dir'
op|'('
name|'path'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'raise'
name|'InstallationError'
op|'('
string|'"Directory %r is not installable. File \'setup.py\' not found."'
nl|'\n'
op|'%'
name|'name'
op|')'
newline|'\n'
dedent|''
name|'url'
op|'='
name|'path_to_url'
op|'('
name|'name'
op|')'
newline|'\n'
comment|'#req = get_requirement_from_url(url)'
nl|'\n'
name|'req'
op|'='
name|'None'
newline|'\n'
dedent|''
name|'elif'
name|'is_archive_file'
op|'('
name|'path'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'not'
name|'os'
op|'.'
name|'path'
op|'.'
name|'isfile'
op|'('
name|'path'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'logger'
op|'.'
name|'warn'
op|'('
string|"'Requirement %r looks like a filename, but the file does not exist'"
nl|'\n'
op|'%'
name|'name'
op|')'
newline|'\n'
dedent|''
name|'url'
op|'='
name|'path_to_url'
op|'('
name|'name'
op|')'
newline|'\n'
comment|'#req = get_requirement_from_url(url)'
nl|'\n'
name|'req'
op|'='
name|'None'
newline|'\n'
dedent|''
name|'return'
name|'cls'
op|'('
name|'req'
op|','
name|'comes_from'
op|','
name|'url'
op|'='
name|'url'
op|')'
newline|'\n'
nl|'\n'
DECL|member|__str__
dedent|''
name|'def'
name|'__str__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'req'
op|':'
newline|'\n'
indent|'            '
name|'s'
op|'='
name|'str'
op|'('
name|'self'
op|'.'
name|'req'
op|')'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'url'
op|':'
newline|'\n'
indent|'                '
name|'s'
op|'+='
string|"' from %s'"
op|'%'
name|'self'
op|'.'
name|'url'
newline|'\n'
dedent|''
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'s'
op|'='
name|'self'
op|'.'
name|'url'
newline|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'satisfied_by'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'s'
op|'+='
string|"' in %s'"
op|'%'
name|'display_path'
op|'('
name|'self'
op|'.'
name|'satisfied_by'
op|'.'
name|'location'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'comes_from'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'isinstance'
op|'('
name|'self'
op|'.'
name|'comes_from'
op|','
name|'basestring'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'comes_from'
op|'='
name|'self'
op|'.'
name|'comes_from'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'comes_from'
op|'='
name|'self'
op|'.'
name|'comes_from'
op|'.'
name|'from_path'
op|'('
op|')'
newline|'\n'
dedent|''
name|'if'
name|'comes_from'
op|':'
newline|'\n'
indent|'                '
name|'s'
op|'+='
string|"' (from %s)'"
op|'%'
name|'comes_from'
newline|'\n'
dedent|''
dedent|''
name|'return'
name|'s'
newline|'\n'
nl|'\n'
DECL|member|from_path
dedent|''
name|'def'
name|'from_path'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'req'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'None'
newline|'\n'
dedent|''
name|'s'
op|'='
name|'str'
op|'('
name|'self'
op|'.'
name|'req'
op|')'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'comes_from'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'isinstance'
op|'('
name|'self'
op|'.'
name|'comes_from'
op|','
name|'basestring'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'comes_from'
op|'='
name|'self'
op|'.'
name|'comes_from'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'comes_from'
op|'='
name|'self'
op|'.'
name|'comes_from'
op|'.'
name|'from_path'
op|'('
op|')'
newline|'\n'
dedent|''
name|'if'
name|'comes_from'
op|':'
newline|'\n'
indent|'                '
name|'s'
op|'+='
string|"'->'"
op|'+'
name|'comes_from'
newline|'\n'
dedent|''
dedent|''
name|'return'
name|'s'
newline|'\n'
nl|'\n'
DECL|member|build_location
dedent|''
name|'def'
name|'build_location'
op|'('
name|'self'
op|','
name|'build_dir'
op|','
name|'unpack'
op|'='
name|'True'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'_temp_build_dir'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_temp_build_dir'
newline|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'req'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'_temp_build_dir'
op|'='
name|'tempfile'
op|'.'
name|'mkdtemp'
op|'('
string|"'-build'"
op|','
string|"'pip-'"
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_ideal_build_dir'
op|'='
name|'build_dir'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'_temp_build_dir'
newline|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'editable'
op|':'
newline|'\n'
indent|'            '
name|'name'
op|'='
name|'self'
op|'.'
name|'name'
op|'.'
name|'lower'
op|'('
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'name'
op|'='
name|'self'
op|'.'
name|'name'
newline|'\n'
comment|'# FIXME: Is there a better place to create the build_dir? (hg and bzr need this)'
nl|'\n'
dedent|''
name|'if'
name|'not'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'build_dir'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'_make_build_dir'
op|'('
name|'build_dir'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'build_dir'
op|','
name|'name'
op|')'
newline|'\n'
nl|'\n'
DECL|member|correct_build_location
dedent|''
name|'def'
name|'correct_build_location'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""If the build location was a temporary directory, this will move it\n        to a new more permanent location"""'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'source_dir'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'return'
newline|'\n'
dedent|''
name|'assert'
name|'self'
op|'.'
name|'req'
name|'is'
name|'not'
name|'None'
newline|'\n'
name|'assert'
name|'self'
op|'.'
name|'_temp_build_dir'
newline|'\n'
name|'old_location'
op|'='
name|'self'
op|'.'
name|'_temp_build_dir'
newline|'\n'
name|'new_build_dir'
op|'='
name|'self'
op|'.'
name|'_ideal_build_dir'
newline|'\n'
name|'del'
name|'self'
op|'.'
name|'_ideal_build_dir'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'editable'
op|':'
newline|'\n'
indent|'            '
name|'name'
op|'='
name|'self'
op|'.'
name|'name'
op|'.'
name|'lower'
op|'('
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'name'
op|'='
name|'self'
op|'.'
name|'name'
newline|'\n'
dedent|''
name|'new_location'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'new_build_dir'
op|','
name|'name'
op|')'
newline|'\n'
name|'if'
name|'not'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'new_build_dir'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'logger'
op|'.'
name|'debug'
op|'('
string|"'Creating directory %s'"
op|'%'
name|'new_build_dir'
op|')'
newline|'\n'
name|'_make_build_dir'
op|'('
name|'new_build_dir'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'new_location'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'InstallationError'
op|'('
nl|'\n'
string|"'A package already exists in %s; please remove it to continue'"
nl|'\n'
op|'%'
name|'display_path'
op|'('
name|'new_location'
op|')'
op|')'
newline|'\n'
dedent|''
name|'logger'
op|'.'
name|'debug'
op|'('
string|"'Moving package %s from %s to new location %s'"
nl|'\n'
op|'%'
op|'('
name|'self'
op|','
name|'display_path'
op|'('
name|'old_location'
op|')'
op|','
name|'display_path'
op|'('
name|'new_location'
op|')'
op|')'
op|')'
newline|'\n'
name|'shutil'
op|'.'
name|'move'
op|'('
name|'old_location'
op|','
name|'new_location'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_temp_build_dir'
op|'='
name|'new_location'
newline|'\n'
name|'self'
op|'.'
name|'source_dir'
op|'='
name|'new_location'
newline|'\n'
name|'self'
op|'.'
name|'_egg_info_path'
op|'='
name|'None'
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'property'
newline|'\n'
DECL|member|name
name|'def'
name|'name'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'req'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'None'
newline|'\n'
dedent|''
name|'return'
name|'self'
op|'.'
name|'req'
op|'.'
name|'project_name'
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'property'
newline|'\n'
DECL|member|url_name
name|'def'
name|'url_name'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'req'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'None'
newline|'\n'
dedent|''
name|'return'
name|'urllib'
op|'.'
name|'quote'
op|'('
name|'self'
op|'.'
name|'req'
op|'.'
name|'unsafe_name'
op|')'
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'property'
newline|'\n'
DECL|member|setup_py
name|'def'
name|'setup_py'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'self'
op|'.'
name|'source_dir'
op|','
string|"'setup.py'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|run_egg_info
dedent|''
name|'def'
name|'run_egg_info'
op|'('
name|'self'
op|','
name|'force_root_egg_info'
op|'='
name|'False'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'assert'
name|'self'
op|'.'
name|'source_dir'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'name'
op|':'
newline|'\n'
indent|'            '
name|'logger'
op|'.'
name|'notify'
op|'('
string|"'Running setup.py egg_info for package %s'"
op|'%'
name|'self'
op|'.'
name|'name'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'logger'
op|'.'
name|'notify'
op|'('
string|"'Running setup.py egg_info for package from %s'"
op|'%'
name|'self'
op|'.'
name|'url'
op|')'
newline|'\n'
dedent|''
name|'logger'
op|'.'
name|'indent'
op|'+='
number|'2'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'script'
op|'='
name|'self'
op|'.'
name|'_run_setup_py'
newline|'\n'
name|'script'
op|'='
name|'script'
op|'.'
name|'replace'
op|'('
string|"'__SETUP_PY__'"
op|','
name|'repr'
op|'('
name|'self'
op|'.'
name|'setup_py'
op|')'
op|')'
newline|'\n'
name|'script'
op|'='
name|'script'
op|'.'
name|'replace'
op|'('
string|"'__PKG_NAME__'"
op|','
name|'repr'
op|'('
name|'self'
op|'.'
name|'name'
op|')'
op|')'
newline|'\n'
comment|"# We can't put the .egg-info files at the root, because then the source code will be mistaken"
nl|'\n'
comment|'# for an installed egg, causing problems'
nl|'\n'
name|'if'
name|'self'
op|'.'
name|'editable'
name|'or'
name|'force_root_egg_info'
op|':'
newline|'\n'
indent|'                '
name|'egg_base_option'
op|'='
op|'['
op|']'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'egg_info_dir'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'self'
op|'.'
name|'source_dir'
op|','
string|"'pip-egg-info'"
op|')'
newline|'\n'
name|'if'
name|'not'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'egg_info_dir'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'os'
op|'.'
name|'makedirs'
op|'('
name|'egg_info_dir'
op|')'
newline|'\n'
dedent|''
name|'egg_base_option'
op|'='
op|'['
string|"'--egg-base'"
op|','
string|"'pip-egg-info'"
op|']'
newline|'\n'
dedent|''
name|'call_subprocess'
op|'('
nl|'\n'
op|'['
name|'sys'
op|'.'
name|'executable'
op|','
string|"'-c'"
op|','
name|'script'
op|','
string|"'egg_info'"
op|']'
op|'+'
name|'egg_base_option'
op|','
nl|'\n'
name|'cwd'
op|'='
name|'self'
op|'.'
name|'source_dir'
op|','
name|'filter_stdout'
op|'='
name|'self'
op|'.'
name|'_filter_install'
op|','
name|'show_stdout'
op|'='
name|'False'
op|','
nl|'\n'
name|'command_level'
op|'='
name|'logger'
op|'.'
name|'VERBOSE_DEBUG'
op|','
nl|'\n'
name|'command_desc'
op|'='
string|"'python setup.py egg_info'"
op|')'
newline|'\n'
dedent|''
name|'finally'
op|':'
newline|'\n'
indent|'            '
name|'logger'
op|'.'
name|'indent'
op|'-='
number|'2'
newline|'\n'
dedent|''
name|'if'
name|'not'
name|'self'
op|'.'
name|'req'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'req'
op|'='
name|'pkg_resources'
op|'.'
name|'Requirement'
op|'.'
name|'parse'
op|'('
name|'self'
op|'.'
name|'pkg_info'
op|'('
op|')'
op|'['
string|"'Name'"
op|']'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'correct_build_location'
op|'('
op|')'
newline|'\n'
nl|'\n'
comment|'## FIXME: This is a lame hack, entirely for PasteScript which has'
nl|'\n'
comment|'## a self-provided entry point that causes this awkwardness'
nl|'\n'
dedent|''
dedent|''
name|'_run_setup_py'
op|'='
string|'"""\n__file__ = __SETUP_PY__\nfrom setuptools.command import egg_info\ndef replacement_run(self):\n    self.mkpath(self.egg_info)\n    installer = self.distribution.fetch_build_egg\n    for ep in egg_info.iter_entry_points(\'egg_info.writers\'):\n        # require=False is the change we\'re making:\n        writer = ep.load(require=False)\n        if writer:\n            writer(self, ep.name, egg_info.os.path.join(self.egg_info,ep.name))\n    self.find_sources()\negg_info.egg_info.run = replacement_run\nexecfile(__file__)\n"""'
newline|'\n'
nl|'\n'
DECL|member|egg_info_data
name|'def'
name|'egg_info_data'
op|'('
name|'self'
op|','
name|'filename'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'satisfied_by'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'not'
name|'self'
op|'.'
name|'satisfied_by'
op|'.'
name|'has_metadata'
op|'('
name|'filename'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'None'
newline|'\n'
dedent|''
name|'return'
name|'self'
op|'.'
name|'satisfied_by'
op|'.'
name|'get_metadata'
op|'('
name|'filename'
op|')'
newline|'\n'
dedent|''
name|'assert'
name|'self'
op|'.'
name|'source_dir'
newline|'\n'
name|'filename'
op|'='
name|'self'
op|'.'
name|'egg_info_path'
op|'('
name|'filename'
op|')'
newline|'\n'
name|'if'
name|'not'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'filename'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'None'
newline|'\n'
dedent|''
name|'fp'
op|'='
name|'open'
op|'('
name|'filename'
op|','
string|"'r'"
op|')'
newline|'\n'
name|'data'
op|'='
name|'fp'
op|'.'
name|'read'
op|'('
op|')'
newline|'\n'
name|'fp'
op|'.'
name|'close'
op|'('
op|')'
newline|'\n'
name|'return'
name|'data'
newline|'\n'
nl|'\n'
DECL|member|egg_info_path
dedent|''
name|'def'
name|'egg_info_path'
op|'('
name|'self'
op|','
name|'filename'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'_egg_info_path'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'self'
op|'.'
name|'editable'
op|':'
newline|'\n'
indent|'                '
name|'base'
op|'='
name|'self'
op|'.'
name|'source_dir'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'base'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'self'
op|'.'
name|'source_dir'
op|','
string|"'pip-egg-info'"
op|')'
newline|'\n'
dedent|''
name|'filenames'
op|'='
name|'os'
op|'.'
name|'listdir'
op|'('
name|'base'
op|')'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'editable'
op|':'
newline|'\n'
indent|'                '
name|'filenames'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'root'
op|','
name|'dirs'
op|','
name|'files'
name|'in'
name|'os'
op|'.'
name|'walk'
op|'('
name|'base'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'for'
name|'dir'
name|'in'
name|'vcs'
op|'.'
name|'dirnames'
op|':'
newline|'\n'
indent|'                        '
name|'if'
name|'dir'
name|'in'
name|'dirs'
op|':'
newline|'\n'
indent|'                            '
name|'dirs'
op|'.'
name|'remove'
op|'('
name|'dir'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'for'
name|'dir'
name|'in'
name|'dirs'
op|':'
newline|'\n'
comment|"# Don't search in anything that looks like a virtualenv environment"
nl|'\n'
indent|'                        '
name|'if'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'root'
op|','
name|'dir'
op|','
string|"'bin'"
op|','
string|"'python'"
op|')'
op|')'
nl|'\n'
name|'or'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'root'
op|','
name|'dir'
op|','
string|"'Scripts'"
op|','
string|"'Python.exe'"
op|')'
op|')'
op|')'
op|':'
newline|'\n'
indent|'                            '
name|'dirs'
op|'.'
name|'remove'
op|'('
name|'dir'
op|')'
newline|'\n'
comment|"# Also don't search through tests"
nl|'\n'
dedent|''
name|'if'
name|'dir'
op|'=='
string|"'test'"
name|'or'
name|'dir'
op|'=='
string|"'tests'"
op|':'
newline|'\n'
indent|'                            '
name|'dirs'
op|'.'
name|'remove'
op|'('
name|'dir'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'filenames'
op|'.'
name|'extend'
op|'('
op|'['
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'root'
op|','
name|'dir'
op|')'
nl|'\n'
name|'for'
name|'dir'
name|'in'
name|'dirs'
op|']'
op|')'
newline|'\n'
dedent|''
name|'filenames'
op|'='
op|'['
name|'f'
name|'for'
name|'f'
name|'in'
name|'filenames'
name|'if'
name|'f'
op|'.'
name|'endswith'
op|'('
string|"'.egg-info'"
op|')'
op|']'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'not'
name|'filenames'
op|':'
newline|'\n'
indent|'                '
name|'raise'
name|'InstallationError'
op|'('
string|"'No files/directores in %s (from %s)'"
op|'%'
op|'('
name|'base'
op|','
name|'filename'
op|')'
op|')'
newline|'\n'
dedent|''
name|'assert'
name|'filenames'
op|','
string|'"No files/directories in %s (from %s)"'
op|'%'
op|'('
name|'base'
op|','
name|'filename'
op|')'
newline|'\n'
nl|'\n'
comment|'# if we have more than one match, we pick the toplevel one.  This can'
nl|'\n'
comment|'# easily be the case if there is a dist folder which contains an'
nl|'\n'
comment|'# extracted tarball for testing purposes.'
nl|'\n'
name|'if'
name|'len'
op|'('
name|'filenames'
op|')'
op|'>'
number|'1'
op|':'
newline|'\n'
indent|'                '
name|'filenames'
op|'.'
name|'sort'
op|'('
name|'key'
op|'='
name|'lambda'
name|'x'
op|':'
name|'x'
op|'.'
name|'count'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'sep'
op|')'
op|'+'
nl|'\n'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'altsep'
name|'and'
nl|'\n'
name|'x'
op|'.'
name|'count'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'altsep'
op|')'
name|'or'
number|'0'
op|')'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'_egg_info_path'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'base'
op|','
name|'filenames'
op|'['
number|'0'
op|']'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'self'
op|'.'
name|'_egg_info_path'
op|','
name|'filename'
op|')'
newline|'\n'
nl|'\n'
DECL|member|egg_info_lines
dedent|''
name|'def'
name|'egg_info_lines'
op|'('
name|'self'
op|','
name|'filename'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'data'
op|'='
name|'self'
op|'.'
name|'egg_info_data'
op|'('
name|'filename'
op|')'
newline|'\n'
name|'if'
name|'not'
name|'data'
op|':'
newline|'\n'
indent|'            '
name|'return'
op|'['
op|']'
newline|'\n'
dedent|''
name|'result'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'line'
name|'in'
name|'data'
op|'.'
name|'splitlines'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'line'
op|'='
name|'line'
op|'.'
name|'strip'
op|'('
op|')'
newline|'\n'
name|'if'
name|'not'
name|'line'
name|'or'
name|'line'
op|'.'
name|'startswith'
op|'('
string|"'#'"
op|')'
op|':'
newline|'\n'
indent|'                '
name|'continue'
newline|'\n'
dedent|''
name|'result'
op|'.'
name|'append'
op|'('
name|'line'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'result'
newline|'\n'
nl|'\n'
DECL|member|pkg_info
dedent|''
name|'def'
name|'pkg_info'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'p'
op|'='
name|'FeedParser'
op|'('
op|')'
newline|'\n'
name|'data'
op|'='
name|'self'
op|'.'
name|'egg_info_data'
op|'('
string|"'PKG-INFO'"
op|')'
newline|'\n'
name|'if'
name|'not'
name|'data'
op|':'
newline|'\n'
indent|'            '
name|'logger'
op|'.'
name|'warn'
op|'('
string|"'No PKG-INFO file found in %s'"
op|'%'
name|'display_path'
op|'('
name|'self'
op|'.'
name|'egg_info_path'
op|'('
string|"'PKG-INFO'"
op|')'
op|')'
op|')'
newline|'\n'
dedent|''
name|'p'
op|'.'
name|'feed'
op|'('
name|'data'
name|'or'
string|"''"
op|')'
newline|'\n'
name|'return'
name|'p'
op|'.'
name|'close'
op|'('
op|')'
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'property'
newline|'\n'
DECL|member|dependency_links
name|'def'
name|'dependency_links'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'egg_info_lines'
op|'('
string|"'dependency_links.txt'"
op|')'
newline|'\n'
nl|'\n'
DECL|variable|_requirements_section_re
dedent|''
name|'_requirements_section_re'
op|'='
name|'re'
op|'.'
name|'compile'
op|'('
string|"r'\\[(.*?)\\]'"
op|')'
newline|'\n'
nl|'\n'
DECL|member|requirements
name|'def'
name|'requirements'
op|'('
name|'self'
op|','
name|'extras'
op|'='
op|'('
op|')'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'in_extra'
op|'='
name|'None'
newline|'\n'
name|'for'
name|'line'
name|'in'
name|'self'
op|'.'
name|'egg_info_lines'
op|'('
string|"'requires.txt'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'match'
op|'='
name|'self'
op|'.'
name|'_requirements_section_re'
op|'.'
name|'match'
op|'('
name|'line'
op|')'
newline|'\n'
name|'if'
name|'match'
op|':'
newline|'\n'
indent|'                '
name|'in_extra'
op|'='
name|'match'
op|'.'
name|'group'
op|'('
number|'1'
op|')'
newline|'\n'
name|'continue'
newline|'\n'
dedent|''
name|'if'
name|'in_extra'
name|'and'
name|'in_extra'
name|'not'
name|'in'
name|'extras'
op|':'
newline|'\n'
comment|"# Skip requirement for an extra we aren't requiring"
nl|'\n'
indent|'                '
name|'continue'
newline|'\n'
dedent|''
name|'yield'
name|'line'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
op|'@'
name|'property'
newline|'\n'
DECL|member|absolute_versions
name|'def'
name|'absolute_versions'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'for'
name|'qualifier'
op|','
name|'version'
name|'in'
name|'self'
op|'.'
name|'req'
op|'.'
name|'specs'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'qualifier'
op|'=='
string|"'=='"
op|':'
newline|'\n'
indent|'                '
name|'yield'
name|'version'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
dedent|''
op|'@'
name|'property'
newline|'\n'
DECL|member|installed_version
name|'def'
name|'installed_version'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'pkg_info'
op|'('
op|')'
op|'['
string|"'version'"
op|']'
newline|'\n'
nl|'\n'
DECL|member|assert_source_matches_version
dedent|''
name|'def'
name|'assert_source_matches_version'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'assert'
name|'self'
op|'.'
name|'source_dir'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'comes_from'
name|'is'
name|'None'
op|':'
newline|'\n'
comment|"# We don't check the versions of things explicitly installed."
nl|'\n'
comment|'# This makes, e.g., "pip Package==dev" possible'
nl|'\n'
indent|'            '
name|'return'
newline|'\n'
dedent|''
name|'version'
op|'='
name|'self'
op|'.'
name|'installed_version'
newline|'\n'
name|'if'
name|'version'
name|'not'
name|'in'
name|'self'
op|'.'
name|'req'
op|':'
newline|'\n'
indent|'            '
name|'logger'
op|'.'
name|'fatal'
op|'('
nl|'\n'
string|"'Source in %s has the version %s, which does not match the requirement %s'"
nl|'\n'
op|'%'
op|'('
name|'display_path'
op|'('
name|'self'
op|'.'
name|'source_dir'
op|')'
op|','
name|'version'
op|','
name|'self'
op|')'
op|')'
newline|'\n'
name|'raise'
name|'InstallationError'
op|'('
nl|'\n'
string|"'Source in %s has version %s that conflicts with %s'"
nl|'\n'
op|'%'
op|'('
name|'display_path'
op|'('
name|'self'
op|'.'
name|'source_dir'
op|')'
op|','
name|'version'
op|','
name|'self'
op|')'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'logger'
op|'.'
name|'debug'
op|'('
string|"'Source in %s has version %s, which satisfies requirement %s'"
nl|'\n'
op|'%'
op|'('
name|'display_path'
op|'('
name|'self'
op|'.'
name|'source_dir'
op|')'
op|','
name|'version'
op|','
name|'self'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|update_editable
dedent|''
dedent|''
name|'def'
name|'update_editable'
op|'('
name|'self'
op|','
name|'obtain'
op|'='
name|'True'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'not'
name|'self'
op|'.'
name|'url'
op|':'
newline|'\n'
indent|'            '
name|'logger'
op|'.'
name|'info'
op|'('
string|'"Cannot update repository at %s; repository location is unknown"'
op|'%'
name|'self'
op|'.'
name|'source_dir'
op|')'
newline|'\n'
name|'return'
newline|'\n'
dedent|''
name|'assert'
name|'self'
op|'.'
name|'editable'
newline|'\n'
name|'assert'
name|'self'
op|'.'
name|'source_dir'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'url'
op|'.'
name|'startswith'
op|'('
string|"'file:'"
op|')'
op|':'
newline|'\n'
comment|"# Static paths don't get updated"
nl|'\n'
indent|'            '
name|'return'
newline|'\n'
dedent|''
name|'assert'
string|"'+'"
name|'in'
name|'self'
op|'.'
name|'url'
op|','
string|'"bad url: %r"'
op|'%'
name|'self'
op|'.'
name|'url'
newline|'\n'
name|'if'
name|'not'
name|'self'
op|'.'
name|'update'
op|':'
newline|'\n'
indent|'            '
name|'return'
newline|'\n'
dedent|''
name|'vc_type'
op|','
name|'url'
op|'='
name|'self'
op|'.'
name|'url'
op|'.'
name|'split'
op|'('
string|"'+'"
op|','
number|'1'
op|')'
newline|'\n'
name|'backend'
op|'='
name|'vcs'
op|'.'
name|'get_backend'
op|'('
name|'vc_type'
op|')'
newline|'\n'
name|'if'
name|'backend'
op|':'
newline|'\n'
indent|'            '
name|'vcs_backend'
op|'='
name|'backend'
op|'('
name|'self'
op|'.'
name|'url'
op|')'
newline|'\n'
name|'if'
name|'obtain'
op|':'
newline|'\n'
indent|'                '
name|'vcs_backend'
op|'.'
name|'obtain'
op|'('
name|'self'
op|'.'
name|'source_dir'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'vcs_backend'
op|'.'
name|'export'
op|'('
name|'self'
op|'.'
name|'source_dir'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'assert'
number|'0'
op|','
op|'('
nl|'\n'
string|"'Unexpected version control type (in %s): %s'"
nl|'\n'
op|'%'
op|'('
name|'self'
op|'.'
name|'url'
op|','
name|'vc_type'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|uninstall
dedent|''
dedent|''
name|'def'
name|'uninstall'
op|'('
name|'self'
op|','
name|'auto_confirm'
op|'='
name|'False'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        Uninstall the distribution currently satisfying this requirement.\n\n        Prompts before removing or modifying files unless\n        ``auto_confirm`` is True.\n\n        Refuses to delete or modify files outside of ``sys.prefix`` -\n        thus uninstallation within a virtual environment can only\n        modify that virtual environment, even if the virtualenv is\n        linked to global site-packages.\n\n        """'
newline|'\n'
name|'if'
name|'not'
name|'self'
op|'.'
name|'check_if_exists'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'UninstallationError'
op|'('
string|'"Cannot uninstall requirement %s, not installed"'
op|'%'
op|'('
name|'self'
op|'.'
name|'name'
op|','
op|')'
op|')'
newline|'\n'
dedent|''
name|'dist'
op|'='
name|'self'
op|'.'
name|'satisfied_by'
name|'or'
name|'self'
op|'.'
name|'conflicts_with'
newline|'\n'
nl|'\n'
name|'paths_to_remove'
op|'='
name|'UninstallPathSet'
op|'('
name|'dist'
op|')'
newline|'\n'
nl|'\n'
name|'pip_egg_info_path'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'dist'
op|'.'
name|'location'
op|','
nl|'\n'
name|'dist'
op|'.'
name|'egg_name'
op|'('
op|')'
op|')'
op|'+'
string|"'.egg-info'"
newline|'\n'
name|'easy_install_egg'
op|'='
name|'dist'
op|'.'
name|'egg_name'
op|'('
op|')'
op|'+'
string|"'.egg'"
newline|'\n'
name|'develop_egg_link'
op|'='
name|'egg_link_path'
op|'('
name|'dist'
op|')'
newline|'\n'
name|'if'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'pip_egg_info_path'
op|')'
op|':'
newline|'\n'
comment|'# package installed by pip'
nl|'\n'
indent|'            '
name|'paths_to_remove'
op|'.'
name|'add'
op|'('
name|'pip_egg_info_path'
op|')'
newline|'\n'
name|'if'
name|'dist'
op|'.'
name|'has_metadata'
op|'('
string|"'installed-files.txt'"
op|')'
op|':'
newline|'\n'
indent|'                '
name|'for'
name|'installed_file'
name|'in'
name|'dist'
op|'.'
name|'get_metadata'
op|'('
string|"'installed-files.txt'"
op|')'
op|'.'
name|'splitlines'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'path'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'normpath'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'pip_egg_info_path'
op|','
name|'installed_file'
op|')'
op|')'
newline|'\n'
name|'paths_to_remove'
op|'.'
name|'add'
op|'('
name|'path'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'if'
name|'dist'
op|'.'
name|'has_metadata'
op|'('
string|"'top_level.txt'"
op|')'
op|':'
newline|'\n'
indent|'                '
name|'if'
name|'dist'
op|'.'
name|'has_metadata'
op|'('
string|"'namespace_packages.txt'"
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'namespaces'
op|'='
name|'dist'
op|'.'
name|'get_metadata'
op|'('
string|"'namespace_packages.txt'"
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                    '
name|'namespaces'
op|'='
op|'['
op|']'
newline|'\n'
dedent|''
name|'for'
name|'top_level_pkg'
name|'in'
op|'['
name|'p'
name|'for'
name|'p'
nl|'\n'
name|'in'
name|'dist'
op|'.'
name|'get_metadata'
op|'('
string|"'top_level.txt'"
op|')'
op|'.'
name|'splitlines'
op|'('
op|')'
nl|'\n'
name|'if'
name|'p'
name|'and'
name|'p'
name|'not'
name|'in'
name|'namespaces'
op|']'
op|':'
newline|'\n'
indent|'                    '
name|'path'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'dist'
op|'.'
name|'location'
op|','
name|'top_level_pkg'
op|')'
newline|'\n'
name|'paths_to_remove'
op|'.'
name|'add'
op|'('
name|'path'
op|')'
newline|'\n'
name|'paths_to_remove'
op|'.'
name|'add'
op|'('
name|'path'
op|'+'
string|"'.py'"
op|')'
newline|'\n'
name|'paths_to_remove'
op|'.'
name|'add'
op|'('
name|'path'
op|'+'
string|"'.pyc'"
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
dedent|''
name|'elif'
name|'dist'
op|'.'
name|'location'
op|'.'
name|'endswith'
op|'('
name|'easy_install_egg'
op|')'
op|':'
newline|'\n'
comment|'# package installed by easy_install'
nl|'\n'
indent|'            '
name|'paths_to_remove'
op|'.'
name|'add'
op|'('
name|'dist'
op|'.'
name|'location'
op|')'
newline|'\n'
name|'easy_install_pth'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'dirname'
op|'('
name|'dist'
op|'.'
name|'location'
op|')'
op|','
nl|'\n'
string|"'easy-install.pth'"
op|')'
newline|'\n'
name|'paths_to_remove'
op|'.'
name|'add_pth'
op|'('
name|'easy_install_pth'
op|','
string|"'./'"
op|'+'
name|'easy_install_egg'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'elif'
name|'os'
op|'.'
name|'path'
op|'.'
name|'isfile'
op|'('
name|'develop_egg_link'
op|')'
op|':'
newline|'\n'
comment|'# develop egg'
nl|'\n'
indent|'            '
name|'fh'
op|'='
name|'open'
op|'('
name|'develop_egg_link'
op|','
string|"'r'"
op|')'
newline|'\n'
name|'link_pointer'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'normcase'
op|'('
name|'fh'
op|'.'
name|'readline'
op|'('
op|')'
op|'.'
name|'strip'
op|'('
op|')'
op|')'
newline|'\n'
name|'fh'
op|'.'
name|'close'
op|'('
op|')'
newline|'\n'
name|'assert'
op|'('
name|'link_pointer'
op|'=='
name|'dist'
op|'.'
name|'location'
op|')'
op|','
string|"'Egg-link %s does not match installed location of %s (at %s)'"
op|'%'
op|'('
name|'link_pointer'
op|','
name|'self'
op|'.'
name|'name'
op|','
name|'dist'
op|'.'
name|'location'
op|')'
newline|'\n'
name|'paths_to_remove'
op|'.'
name|'add'
op|'('
name|'develop_egg_link'
op|')'
newline|'\n'
name|'easy_install_pth'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'dirname'
op|'('
name|'develop_egg_link'
op|')'
op|','
nl|'\n'
string|"'easy-install.pth'"
op|')'
newline|'\n'
name|'paths_to_remove'
op|'.'
name|'add_pth'
op|'('
name|'easy_install_pth'
op|','
name|'dist'
op|'.'
name|'location'
op|')'
newline|'\n'
nl|'\n'
comment|'# find distutils scripts= scripts'
nl|'\n'
dedent|''
name|'if'
name|'dist'
op|'.'
name|'has_metadata'
op|'('
string|"'scripts'"
op|')'
name|'and'
name|'dist'
op|'.'
name|'metadata_isdir'
op|'('
string|"'scripts'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'script'
name|'in'
name|'dist'
op|'.'
name|'metadata_listdir'
op|'('
string|"'scripts'"
op|')'
op|':'
newline|'\n'
indent|'                '
name|'paths_to_remove'
op|'.'
name|'add'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'bin_py'
op|','
name|'script'
op|')'
op|')'
newline|'\n'
name|'if'
name|'sys'
op|'.'
name|'platform'
op|'=='
string|"'win32'"
op|':'
newline|'\n'
indent|'                    '
name|'paths_to_remove'
op|'.'
name|'add'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'bin_py'
op|','
name|'script'
op|')'
op|'+'
string|"'.bat'"
op|')'
newline|'\n'
nl|'\n'
comment|'# find console_scripts'
nl|'\n'
dedent|''
dedent|''
dedent|''
name|'if'
name|'dist'
op|'.'
name|'has_metadata'
op|'('
string|"'entry_points.txt'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'config'
op|'='
name|'ConfigParser'
op|'.'
name|'SafeConfigParser'
op|'('
op|')'
newline|'\n'
name|'config'
op|'.'
name|'readfp'
op|'('
name|'FakeFile'
op|'('
name|'dist'
op|'.'
name|'get_metadata_lines'
op|'('
string|"'entry_points.txt'"
op|')'
op|')'
op|')'
newline|'\n'
name|'if'
name|'config'
op|'.'
name|'has_section'
op|'('
string|"'console_scripts'"
op|')'
op|':'
newline|'\n'
indent|'                '
name|'for'
name|'name'
op|','
name|'value'
name|'in'
name|'config'
op|'.'
name|'items'
op|'('
string|"'console_scripts'"
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'paths_to_remove'
op|'.'
name|'add'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'bin_py'
op|','
name|'name'
op|')'
op|')'
newline|'\n'
name|'if'
name|'sys'
op|'.'
name|'platform'
op|'=='
string|"'win32'"
op|':'
newline|'\n'
indent|'                        '
name|'paths_to_remove'
op|'.'
name|'add'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'bin_py'
op|','
name|'name'
op|')'
op|'+'
string|"'.exe'"
op|')'
newline|'\n'
name|'paths_to_remove'
op|'.'
name|'add'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'bin_py'
op|','
name|'name'
op|')'
op|'+'
string|"'.exe.manifest'"
op|')'
newline|'\n'
name|'paths_to_remove'
op|'.'
name|'add'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'bin_py'
op|','
name|'name'
op|')'
op|'+'
string|"'-script.py'"
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
dedent|''
dedent|''
name|'paths_to_remove'
op|'.'
name|'remove'
op|'('
name|'auto_confirm'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'uninstalled'
op|'='
name|'paths_to_remove'
newline|'\n'
nl|'\n'
DECL|member|rollback_uninstall
dedent|''
name|'def'
name|'rollback_uninstall'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'uninstalled'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'uninstalled'
op|'.'
name|'rollback'
op|'('
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'logger'
op|'.'
name|'error'
op|'('
string|'"Can\'t rollback %s, nothing uninstalled."'
nl|'\n'
op|'%'
op|'('
name|'self'
op|'.'
name|'project_name'
op|','
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|commit_uninstall
dedent|''
dedent|''
name|'def'
name|'commit_uninstall'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'uninstalled'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'uninstalled'
op|'.'
name|'commit'
op|'('
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'logger'
op|'.'
name|'error'
op|'('
string|'"Can\'t commit %s, nothing uninstalled."'
nl|'\n'
op|'%'
op|'('
name|'self'
op|'.'
name|'project_name'
op|','
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|archive
dedent|''
dedent|''
name|'def'
name|'archive'
op|'('
name|'self'
op|','
name|'build_dir'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'assert'
name|'self'
op|'.'
name|'source_dir'
newline|'\n'
name|'create_archive'
op|'='
name|'True'
newline|'\n'
name|'archive_name'
op|'='
string|"'%s-%s.zip'"
op|'%'
op|'('
name|'self'
op|'.'
name|'name'
op|','
name|'self'
op|'.'
name|'installed_version'
op|')'
newline|'\n'
name|'archive_path'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'build_dir'
op|','
name|'archive_name'
op|')'
newline|'\n'
name|'if'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'archive_path'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'response'
op|'='
name|'ask'
op|'('
string|"'The file %s exists. (i)gnore, (w)ipe, (b)ackup '"
nl|'\n'
op|'%'
name|'display_path'
op|'('
name|'archive_path'
op|')'
op|','
op|'('
string|"'i'"
op|','
string|"'w'"
op|','
string|"'b'"
op|')'
op|')'
newline|'\n'
name|'if'
name|'response'
op|'=='
string|"'i'"
op|':'
newline|'\n'
indent|'                '
name|'create_archive'
op|'='
name|'False'
newline|'\n'
dedent|''
name|'elif'
name|'response'
op|'=='
string|"'w'"
op|':'
newline|'\n'
indent|'                '
name|'logger'
op|'.'
name|'warn'
op|'('
string|"'Deleting %s'"
op|'%'
name|'display_path'
op|'('
name|'archive_path'
op|')'
op|')'
newline|'\n'
name|'os'
op|'.'
name|'remove'
op|'('
name|'archive_path'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'response'
op|'=='
string|"'b'"
op|':'
newline|'\n'
indent|'                '
name|'dest_file'
op|'='
name|'backup_dir'
op|'('
name|'archive_path'
op|')'
newline|'\n'
name|'logger'
op|'.'
name|'warn'
op|'('
string|"'Backing up %s to %s'"
nl|'\n'
op|'%'
op|'('
name|'display_path'
op|'('
name|'archive_path'
op|')'
op|','
name|'display_path'
op|'('
name|'dest_file'
op|')'
op|')'
op|')'
newline|'\n'
name|'shutil'
op|'.'
name|'move'
op|'('
name|'archive_path'
op|','
name|'dest_file'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'if'
name|'create_archive'
op|':'
newline|'\n'
indent|'            '
name|'zip'
op|'='
name|'zipfile'
op|'.'
name|'ZipFile'
op|'('
name|'archive_path'
op|','
string|"'w'"
op|','
name|'zipfile'
op|'.'
name|'ZIP_DEFLATED'
op|')'
newline|'\n'
name|'dir'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'normcase'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'abspath'
op|'('
name|'self'
op|'.'
name|'source_dir'
op|')'
op|')'
newline|'\n'
name|'for'
name|'dirpath'
op|','
name|'dirnames'
op|','
name|'filenames'
name|'in'
name|'os'
op|'.'
name|'walk'
op|'('
name|'dir'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'if'
string|"'pip-egg-info'"
name|'in'
name|'dirnames'
op|':'
newline|'\n'
indent|'                    '
name|'dirnames'
op|'.'
name|'remove'
op|'('
string|"'pip-egg-info'"
op|')'
newline|'\n'
dedent|''
name|'for'
name|'dirname'
name|'in'
name|'dirnames'
op|':'
newline|'\n'
indent|'                    '
name|'dirname'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'dirpath'
op|','
name|'dirname'
op|')'
newline|'\n'
name|'name'
op|'='
name|'self'
op|'.'
name|'_clean_zip_name'
op|'('
name|'dirname'
op|','
name|'dir'
op|')'
newline|'\n'
name|'zipdir'
op|'='
name|'zipfile'
op|'.'
name|'ZipInfo'
op|'('
name|'self'
op|'.'
name|'name'
op|'+'
string|"'/'"
op|'+'
name|'name'
op|'+'
string|"'/'"
op|')'
newline|'\n'
name|'zipdir'
op|'.'
name|'external_attr'
op|'='
number|'0755'
op|'<<'
number|'16L'
newline|'\n'
name|'zip'
op|'.'
name|'writestr'
op|'('
name|'zipdir'
op|','
string|"''"
op|')'
newline|'\n'
dedent|''
name|'for'
name|'filename'
name|'in'
name|'filenames'
op|':'
newline|'\n'
indent|'                    '
name|'if'
name|'filename'
op|'=='
name|'PIP_DELETE_MARKER_FILENAME'
op|':'
newline|'\n'
indent|'                        '
name|'continue'
newline|'\n'
dedent|''
name|'filename'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'dirpath'
op|','
name|'filename'
op|')'
newline|'\n'
name|'name'
op|'='
name|'self'
op|'.'
name|'_clean_zip_name'
op|'('
name|'filename'
op|','
name|'dir'
op|')'
newline|'\n'
name|'zip'
op|'.'
name|'write'
op|'('
name|'filename'
op|','
name|'self'
op|'.'
name|'name'
op|'+'
string|"'/'"
op|'+'
name|'name'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'zip'
op|'.'
name|'close'
op|'('
op|')'
newline|'\n'
name|'logger'
op|'.'
name|'indent'
op|'-='
number|'2'
newline|'\n'
name|'logger'
op|'.'
name|'notify'
op|'('
string|"'Saved %s'"
op|'%'
name|'display_path'
op|'('
name|'archive_path'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_clean_zip_name
dedent|''
dedent|''
name|'def'
name|'_clean_zip_name'
op|'('
name|'self'
op|','
name|'name'
op|','
name|'prefix'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'assert'
name|'name'
op|'.'
name|'startswith'
op|'('
name|'prefix'
op|'+'
name|'os'
op|'.'
name|'path'
op|'.'
name|'sep'
op|')'
op|','
op|'('
nl|'\n'
string|'"name %r doesn\'t start with prefix %r"'
op|'%'
op|'('
name|'name'
op|','
name|'prefix'
op|')'
op|')'
newline|'\n'
name|'name'
op|'='
name|'name'
op|'['
name|'len'
op|'('
name|'prefix'
op|')'
op|'+'
number|'1'
op|':'
op|']'
newline|'\n'
name|'name'
op|'='
name|'name'
op|'.'
name|'replace'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'sep'
op|','
string|"'/'"
op|')'
newline|'\n'
name|'return'
name|'name'
newline|'\n'
nl|'\n'
DECL|member|install
dedent|''
name|'def'
name|'install'
op|'('
name|'self'
op|','
name|'install_options'
op|','
name|'global_options'
op|'='
op|'('
op|')'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'editable'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'install_editable'
op|'('
name|'install_options'
op|','
name|'global_options'
op|')'
newline|'\n'
name|'return'
newline|'\n'
dedent|''
name|'temp_location'
op|'='
name|'tempfile'
op|'.'
name|'mkdtemp'
op|'('
string|"'-record'"
op|','
string|"'pip-'"
op|')'
newline|'\n'
name|'record_filename'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'temp_location'
op|','
string|"'install-record.txt'"
op|')'
newline|'\n'
name|'try'
op|':'
newline|'\n'
nl|'\n'
indent|'            '
name|'install_args'
op|'='
op|'['
nl|'\n'
name|'sys'
op|'.'
name|'executable'
op|','
string|"'-c'"
op|','
nl|'\n'
string|'"import setuptools;__file__=%r;"'
string|'"execfile(__file__)"'
op|'%'
name|'self'
op|'.'
name|'setup_py'
op|']'
op|'+'
name|'list'
op|'('
name|'global_options'
op|')'
op|'+'
op|'['
nl|'\n'
string|"'install'"
op|','
nl|'\n'
string|"'--single-version-externally-managed'"
op|','
nl|'\n'
string|"'--record'"
op|','
name|'record_filename'
op|']'
newline|'\n'
nl|'\n'
name|'if'
name|'running_under_virtualenv'
op|'('
op|')'
op|':'
newline|'\n'
comment|"## FIXME: I'm not sure if this is a reasonable location; probably not"
nl|'\n'
comment|"## but we can't put it in the default location, as that is a virtualenv symlink that isn't writable"
nl|'\n'
indent|'                '
name|'install_args'
op|'+='
op|'['
string|"'--install-headers'"
op|','
nl|'\n'
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'sys'
op|'.'
name|'prefix'
op|','
string|"'include'"
op|','
string|"'site'"
op|','
nl|'\n'
string|"'python'"
op|'+'
name|'get_python_version'
op|'('
op|')'
op|')'
op|']'
newline|'\n'
dedent|''
name|'logger'
op|'.'
name|'notify'
op|'('
string|"'Running setup.py install for %s'"
op|'%'
name|'self'
op|'.'
name|'name'
op|')'
newline|'\n'
name|'logger'
op|'.'
name|'indent'
op|'+='
number|'2'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'                '
name|'call_subprocess'
op|'('
name|'install_args'
op|'+'
name|'install_options'
op|','
nl|'\n'
name|'cwd'
op|'='
name|'self'
op|'.'
name|'source_dir'
op|','
name|'filter_stdout'
op|'='
name|'self'
op|'.'
name|'_filter_install'
op|','
name|'show_stdout'
op|'='
name|'False'
op|')'
newline|'\n'
dedent|''
name|'finally'
op|':'
newline|'\n'
indent|'                '
name|'logger'
op|'.'
name|'indent'
op|'-='
number|'2'
newline|'\n'
dedent|''
name|'if'
name|'not'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'record_filename'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'logger'
op|'.'
name|'notify'
op|'('
string|"'Record file %s not found'"
op|'%'
name|'record_filename'
op|')'
newline|'\n'
name|'return'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'install_succeeded'
op|'='
name|'True'
newline|'\n'
name|'f'
op|'='
name|'open'
op|'('
name|'record_filename'
op|')'
newline|'\n'
name|'for'
name|'line'
name|'in'
name|'f'
op|':'
newline|'\n'
indent|'                '
name|'line'
op|'='
name|'line'
op|'.'
name|'strip'
op|'('
op|')'
newline|'\n'
name|'if'
name|'line'
op|'.'
name|'endswith'
op|'('
string|"'.egg-info'"
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'egg_info_dir'
op|'='
name|'line'
newline|'\n'
name|'break'
newline|'\n'
dedent|''
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'logger'
op|'.'
name|'warn'
op|'('
string|"'Could not find .egg-info directory in install record for %s'"
op|'%'
name|'self'
op|')'
newline|'\n'
comment|'## FIXME: put the record somewhere'
nl|'\n'
comment|'## FIXME: should this be an error?'
nl|'\n'
name|'return'
newline|'\n'
dedent|''
name|'f'
op|'.'
name|'close'
op|'('
op|')'
newline|'\n'
name|'new_lines'
op|'='
op|'['
op|']'
newline|'\n'
name|'f'
op|'='
name|'open'
op|'('
name|'record_filename'
op|')'
newline|'\n'
name|'for'
name|'line'
name|'in'
name|'f'
op|':'
newline|'\n'
indent|'                '
name|'filename'
op|'='
name|'line'
op|'.'
name|'strip'
op|'('
op|')'
newline|'\n'
name|'if'
name|'os'
op|'.'
name|'path'
op|'.'
name|'isdir'
op|'('
name|'filename'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'filename'
op|'+='
name|'os'
op|'.'
name|'path'
op|'.'
name|'sep'
newline|'\n'
dedent|''
name|'new_lines'
op|'.'
name|'append'
op|'('
name|'make_path_relative'
op|'('
name|'filename'
op|','
name|'egg_info_dir'
op|')'
op|')'
newline|'\n'
dedent|''
name|'f'
op|'.'
name|'close'
op|'('
op|')'
newline|'\n'
name|'f'
op|'='
name|'open'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'egg_info_dir'
op|','
string|"'installed-files.txt'"
op|')'
op|','
string|"'w'"
op|')'
newline|'\n'
name|'f'
op|'.'
name|'write'
op|'('
string|"'\\n'"
op|'.'
name|'join'
op|'('
name|'new_lines'
op|')'
op|'+'
string|"'\\n'"
op|')'
newline|'\n'
name|'f'
op|'.'
name|'close'
op|'('
op|')'
newline|'\n'
dedent|''
name|'finally'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'record_filename'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'os'
op|'.'
name|'remove'
op|'('
name|'record_filename'
op|')'
newline|'\n'
dedent|''
name|'os'
op|'.'
name|'rmdir'
op|'('
name|'temp_location'
op|')'
newline|'\n'
nl|'\n'
DECL|member|remove_temporary_source
dedent|''
dedent|''
name|'def'
name|'remove_temporary_source'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Remove the source files from this requirement, if they are marked\n        for deletion"""'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'is_bundle'
name|'or'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'self'
op|'.'
name|'delete_marker_filename'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'logger'
op|'.'
name|'info'
op|'('
string|"'Removing source in %s'"
op|'%'
name|'self'
op|'.'
name|'source_dir'
op|')'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'source_dir'
op|':'
newline|'\n'
indent|'                '
name|'rmtree'
op|'('
name|'self'
op|'.'
name|'source_dir'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'source_dir'
op|'='
name|'None'
newline|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'_temp_build_dir'
name|'and'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'self'
op|'.'
name|'_temp_build_dir'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'rmtree'
op|'('
name|'self'
op|'.'
name|'_temp_build_dir'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'_temp_build_dir'
op|'='
name|'None'
newline|'\n'
nl|'\n'
DECL|member|install_editable
dedent|''
name|'def'
name|'install_editable'
op|'('
name|'self'
op|','
name|'install_options'
op|','
name|'global_options'
op|'='
op|'('
op|')'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'logger'
op|'.'
name|'notify'
op|'('
string|"'Running setup.py develop for %s'"
op|'%'
name|'self'
op|'.'
name|'name'
op|')'
newline|'\n'
name|'logger'
op|'.'
name|'indent'
op|'+='
number|'2'
newline|'\n'
name|'try'
op|':'
newline|'\n'
comment|'## FIXME: should we do --install-headers here too?'
nl|'\n'
indent|'            '
name|'call_subprocess'
op|'('
nl|'\n'
op|'['
name|'sys'
op|'.'
name|'executable'
op|','
string|"'-c'"
op|','
nl|'\n'
string|'"import setuptools; __file__=%r; execfile(%r)"'
op|'%'
op|'('
name|'self'
op|'.'
name|'setup_py'
op|','
name|'self'
op|'.'
name|'setup_py'
op|')'
op|']'
nl|'\n'
op|'+'
name|'list'
op|'('
name|'global_options'
op|')'
op|'+'
op|'['
string|"'develop'"
op|','
string|"'--no-deps'"
op|']'
op|'+'
name|'list'
op|'('
name|'install_options'
op|')'
op|','
nl|'\n'
nl|'\n'
name|'cwd'
op|'='
name|'self'
op|'.'
name|'source_dir'
op|','
name|'filter_stdout'
op|'='
name|'self'
op|'.'
name|'_filter_install'
op|','
nl|'\n'
name|'show_stdout'
op|'='
name|'False'
op|')'
newline|'\n'
dedent|''
name|'finally'
op|':'
newline|'\n'
indent|'            '
name|'logger'
op|'.'
name|'indent'
op|'-='
number|'2'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'install_succeeded'
op|'='
name|'True'
newline|'\n'
nl|'\n'
DECL|member|_filter_install
dedent|''
name|'def'
name|'_filter_install'
op|'('
name|'self'
op|','
name|'line'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'level'
op|'='
name|'logger'
op|'.'
name|'NOTIFY'
newline|'\n'
name|'for'
name|'regex'
name|'in'
op|'['
string|"r'^running .*'"
op|','
string|"r'^writing .*'"
op|','
string|"'^creating .*'"
op|','
string|"'^[Cc]opying .*'"
op|','
nl|'\n'
string|"r'^reading .*'"
op|','
string|'r"^removing .*\\.egg-info\' \\(and everything under it\\)$"'
op|','
nl|'\n'
string|"r'^byte-compiling '"
op|','
nl|'\n'
comment|'# Not sure what this warning is, but it seems harmless:'
nl|'\n'
string|'r"^warning: manifest_maker: standard file \'-c\' not found$"'
op|']'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'re'
op|'.'
name|'search'
op|'('
name|'regex'
op|','
name|'line'
op|'.'
name|'strip'
op|'('
op|')'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'level'
op|'='
name|'logger'
op|'.'
name|'INFO'
newline|'\n'
name|'break'
newline|'\n'
dedent|''
dedent|''
name|'return'
op|'('
name|'level'
op|','
name|'line'
op|')'
newline|'\n'
nl|'\n'
DECL|member|check_if_exists
dedent|''
name|'def'
name|'check_if_exists'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Find an installed distribution that satisfies or conflicts\n        with this requirement, and set self.satisfied_by or\n        self.conflicts_with appropriately."""'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'req'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'False'
newline|'\n'
dedent|''
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'satisfied_by'
op|'='
name|'pkg_resources'
op|'.'
name|'get_distribution'
op|'('
name|'self'
op|'.'
name|'req'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'pkg_resources'
op|'.'
name|'DistributionNotFound'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'False'
newline|'\n'
dedent|''
name|'except'
name|'pkg_resources'
op|'.'
name|'VersionConflict'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'conflicts_with'
op|'='
name|'pkg_resources'
op|'.'
name|'get_distribution'
op|'('
name|'self'
op|'.'
name|'req'
op|'.'
name|'project_name'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'True'
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'property'
newline|'\n'
DECL|member|is_bundle
name|'def'
name|'is_bundle'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'_is_bundle'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_is_bundle'
newline|'\n'
dedent|''
name|'base'
op|'='
name|'self'
op|'.'
name|'_temp_build_dir'
newline|'\n'
name|'if'
name|'not'
name|'base'
op|':'
newline|'\n'
comment|"## FIXME: this doesn't seem right:"
nl|'\n'
indent|'            '
name|'return'
name|'False'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'_is_bundle'
op|'='
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'base'
op|','
string|"'pip-manifest.txt'"
op|')'
op|')'
nl|'\n'
name|'or'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'base'
op|','
string|"'pyinstall-manifest.txt'"
op|')'
op|')'
op|')'
newline|'\n'
name|'return'
name|'self'
op|'.'
name|'_is_bundle'
newline|'\n'
nl|'\n'
DECL|member|bundle_requirements
dedent|''
name|'def'
name|'bundle_requirements'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'for'
name|'dest_dir'
name|'in'
name|'self'
op|'.'
name|'_bundle_editable_dirs'
op|':'
newline|'\n'
indent|'            '
name|'package'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'basename'
op|'('
name|'dest_dir'
op|')'
newline|'\n'
comment|'## FIXME: svnism:'
nl|'\n'
name|'for'
name|'vcs_backend'
name|'in'
name|'vcs'
op|'.'
name|'backends'
op|':'
newline|'\n'
indent|'                '
name|'url'
op|'='
name|'rev'
op|'='
name|'None'
newline|'\n'
name|'vcs_bundle_file'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
nl|'\n'
name|'dest_dir'
op|','
name|'vcs_backend'
op|'.'
name|'bundle_file'
op|')'
newline|'\n'
name|'if'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'vcs_bundle_file'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'vc_type'
op|'='
name|'vcs_backend'
op|'.'
name|'name'
newline|'\n'
name|'fp'
op|'='
name|'open'
op|'('
name|'vcs_bundle_file'
op|')'
newline|'\n'
name|'content'
op|'='
name|'fp'
op|'.'
name|'read'
op|'('
op|')'
newline|'\n'
name|'fp'
op|'.'
name|'close'
op|'('
op|')'
newline|'\n'
name|'url'
op|','
name|'rev'
op|'='
name|'vcs_backend'
op|'('
op|')'
op|'.'
name|'parse_vcs_bundle_file'
op|'('
name|'content'
op|')'
newline|'\n'
name|'break'
newline|'\n'
dedent|''
dedent|''
name|'if'
name|'url'
op|':'
newline|'\n'
indent|'                '
name|'url'
op|'='
string|"'%s+%s@%s'"
op|'%'
op|'('
name|'vc_type'
op|','
name|'url'
op|','
name|'rev'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'url'
op|'='
name|'None'
newline|'\n'
dedent|''
name|'yield'
name|'InstallRequirement'
op|'('
nl|'\n'
name|'package'
op|','
name|'self'
op|','
name|'editable'
op|'='
name|'True'
op|','
name|'url'
op|'='
name|'url'
op|','
nl|'\n'
name|'update'
op|'='
name|'False'
op|','
name|'source_dir'
op|'='
name|'dest_dir'
op|')'
newline|'\n'
dedent|''
name|'for'
name|'dest_dir'
name|'in'
name|'self'
op|'.'
name|'_bundle_build_dirs'
op|':'
newline|'\n'
indent|'            '
name|'package'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'basename'
op|'('
name|'dest_dir'
op|')'
newline|'\n'
name|'yield'
name|'InstallRequirement'
op|'('
nl|'\n'
name|'package'
op|','
name|'self'
op|','
nl|'\n'
name|'source_dir'
op|'='
name|'dest_dir'
op|')'
newline|'\n'
nl|'\n'
DECL|member|move_bundle_files
dedent|''
dedent|''
name|'def'
name|'move_bundle_files'
op|'('
name|'self'
op|','
name|'dest_build_dir'
op|','
name|'dest_src_dir'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'base'
op|'='
name|'self'
op|'.'
name|'_temp_build_dir'
newline|'\n'
name|'assert'
name|'base'
newline|'\n'
name|'src_dir'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'base'
op|','
string|"'src'"
op|')'
newline|'\n'
name|'build_dir'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'base'
op|','
string|"'build'"
op|')'
newline|'\n'
name|'bundle_build_dirs'
op|'='
op|'['
op|']'
newline|'\n'
name|'bundle_editable_dirs'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'source_dir'
op|','
name|'dest_dir'
op|','
name|'dir_collection'
name|'in'
op|'['
nl|'\n'
op|'('
name|'src_dir'
op|','
name|'dest_src_dir'
op|','
name|'bundle_editable_dirs'
op|')'
op|','
nl|'\n'
op|'('
name|'build_dir'
op|','
name|'dest_build_dir'
op|','
name|'bundle_build_dirs'
op|')'
op|']'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'source_dir'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'for'
name|'dirname'
name|'in'
name|'os'
op|'.'
name|'listdir'
op|'('
name|'source_dir'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'dest'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'dest_dir'
op|','
name|'dirname'
op|')'
newline|'\n'
name|'dir_collection'
op|'.'
name|'append'
op|'('
name|'dest'
op|')'
newline|'\n'
name|'if'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'dest'
op|')'
op|':'
newline|'\n'
indent|'                        '
name|'logger'
op|'.'
name|'warn'
op|'('
string|"'The directory %s (containing package %s) already exists; cannot move source from bundle %s'"
nl|'\n'
op|'%'
op|'('
name|'dest'
op|','
name|'dirname'
op|','
name|'self'
op|')'
op|')'
newline|'\n'
name|'continue'
newline|'\n'
dedent|''
name|'if'
name|'not'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'dest_dir'
op|')'
op|':'
newline|'\n'
indent|'                        '
name|'logger'
op|'.'
name|'info'
op|'('
string|"'Creating directory %s'"
op|'%'
name|'dest_dir'
op|')'
newline|'\n'
name|'os'
op|'.'
name|'makedirs'
op|'('
name|'dest_dir'
op|')'
newline|'\n'
dedent|''
name|'shutil'
op|'.'
name|'move'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'source_dir'
op|','
name|'dirname'
op|')'
op|','
name|'dest'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'not'
name|'os'
op|'.'
name|'listdir'
op|'('
name|'source_dir'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'os'
op|'.'
name|'rmdir'
op|'('
name|'source_dir'
op|')'
newline|'\n'
dedent|''
dedent|''
dedent|''
name|'self'
op|'.'
name|'_temp_build_dir'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'_bundle_build_dirs'
op|'='
name|'bundle_build_dirs'
newline|'\n'
name|'self'
op|'.'
name|'_bundle_editable_dirs'
op|'='
name|'bundle_editable_dirs'
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'property'
newline|'\n'
DECL|member|delete_marker_filename
name|'def'
name|'delete_marker_filename'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'assert'
name|'self'
op|'.'
name|'source_dir'
newline|'\n'
name|'return'
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'self'
op|'.'
name|'source_dir'
op|','
name|'PIP_DELETE_MARKER_FILENAME'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
dedent|''
dedent|''
name|'DELETE_MARKER_MESSAGE'
op|'='
string|"'''\\\nThis file is placed here by pip to indicate the source was put\nhere by pip.\n\nOnce this package is successfully installed this source code will be\ndeleted (unless you remove this file).\n'''"
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|RequirementSet
name|'class'
name|'RequirementSet'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
nl|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'build_dir'
op|','
name|'src_dir'
op|','
name|'download_dir'
op|','
name|'download_cache'
op|'='
name|'None'
op|','
nl|'\n'
name|'upgrade'
op|'='
name|'False'
op|','
name|'ignore_installed'
op|'='
name|'False'
op|','
nl|'\n'
name|'ignore_dependencies'
op|'='
name|'False'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'build_dir'
op|'='
name|'build_dir'
newline|'\n'
name|'self'
op|'.'
name|'src_dir'
op|'='
name|'src_dir'
newline|'\n'
name|'self'
op|'.'
name|'download_dir'
op|'='
name|'download_dir'
newline|'\n'
name|'self'
op|'.'
name|'download_cache'
op|'='
name|'download_cache'
newline|'\n'
name|'self'
op|'.'
name|'upgrade'
op|'='
name|'upgrade'
newline|'\n'
name|'self'
op|'.'
name|'ignore_installed'
op|'='
name|'ignore_installed'
newline|'\n'
name|'self'
op|'.'
name|'requirements'
op|'='
op|'{'
op|'}'
newline|'\n'
comment|'# Mapping of alias: real_name'
nl|'\n'
name|'self'
op|'.'
name|'requirement_aliases'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'unnamed_requirements'
op|'='
op|'['
op|']'
newline|'\n'
name|'self'
op|'.'
name|'ignore_dependencies'
op|'='
name|'ignore_dependencies'
newline|'\n'
name|'self'
op|'.'
name|'successfully_downloaded'
op|'='
op|'['
op|']'
newline|'\n'
name|'self'
op|'.'
name|'successfully_installed'
op|'='
op|'['
op|']'
newline|'\n'
name|'self'
op|'.'
name|'reqs_to_cleanup'
op|'='
op|'['
op|']'
newline|'\n'
nl|'\n'
DECL|member|__str__
dedent|''
name|'def'
name|'__str__'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'reqs'
op|'='
op|'['
name|'req'
name|'for'
name|'req'
name|'in'
name|'self'
op|'.'
name|'requirements'
op|'.'
name|'values'
op|'('
op|')'
nl|'\n'
name|'if'
name|'not'
name|'req'
op|'.'
name|'comes_from'
op|']'
newline|'\n'
name|'reqs'
op|'.'
name|'sort'
op|'('
name|'key'
op|'='
name|'lambda'
name|'req'
op|':'
name|'req'
op|'.'
name|'name'
op|'.'
name|'lower'
op|'('
op|')'
op|')'
newline|'\n'
name|'return'
string|"' '"
op|'.'
name|'join'
op|'('
op|'['
name|'str'
op|'('
name|'req'
op|'.'
name|'req'
op|')'
name|'for'
name|'req'
name|'in'
name|'reqs'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|add_requirement
dedent|''
name|'def'
name|'add_requirement'
op|'('
name|'self'
op|','
name|'install_req'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'name'
op|'='
name|'install_req'
op|'.'
name|'name'
newline|'\n'
name|'if'
name|'not'
name|'name'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'unnamed_requirements'
op|'.'
name|'append'
op|'('
name|'install_req'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'self'
op|'.'
name|'has_requirement'
op|'('
name|'name'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'raise'
name|'InstallationError'
op|'('
nl|'\n'
string|"'Double requirement given: %s (aready in %s, name=%r)'"
nl|'\n'
op|'%'
op|'('
name|'install_req'
op|','
name|'self'
op|'.'
name|'get_requirement'
op|'('
name|'name'
op|')'
op|','
name|'name'
op|')'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'requirements'
op|'['
name|'name'
op|']'
op|'='
name|'install_req'
newline|'\n'
comment|'## FIXME: what about other normalizations?  E.g., _ vs. -?'
nl|'\n'
name|'if'
name|'name'
op|'.'
name|'lower'
op|'('
op|')'
op|'!='
name|'name'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'requirement_aliases'
op|'['
name|'name'
op|'.'
name|'lower'
op|'('
op|')'
op|']'
op|'='
name|'name'
newline|'\n'
nl|'\n'
DECL|member|has_requirement
dedent|''
dedent|''
dedent|''
name|'def'
name|'has_requirement'
op|'('
name|'self'
op|','
name|'project_name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'for'
name|'name'
name|'in'
name|'project_name'
op|','
name|'project_name'
op|'.'
name|'lower'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'name'
name|'in'
name|'self'
op|'.'
name|'requirements'
name|'or'
name|'name'
name|'in'
name|'self'
op|'.'
name|'requirement_aliases'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'True'
newline|'\n'
dedent|''
dedent|''
name|'return'
name|'False'
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'property'
newline|'\n'
DECL|member|has_requirements
name|'def'
name|'has_requirements'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'self'
op|'.'
name|'requirements'
op|'.'
name|'values'
op|'('
op|')'
name|'or'
name|'self'
op|'.'
name|'unnamed_requirements'
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'property'
newline|'\n'
DECL|member|has_editables
name|'def'
name|'has_editables'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'any'
op|'('
name|'req'
op|'.'
name|'editable'
name|'for'
name|'req'
name|'in'
name|'self'
op|'.'
name|'requirements'
op|'.'
name|'values'
op|'('
op|')'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'True'
newline|'\n'
dedent|''
name|'if'
name|'any'
op|'('
name|'req'
op|'.'
name|'editable'
name|'for'
name|'req'
name|'in'
name|'self'
op|'.'
name|'unnamed_requirements'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'True'
newline|'\n'
dedent|''
name|'return'
name|'False'
newline|'\n'
nl|'\n'
dedent|''
op|'@'
name|'property'
newline|'\n'
DECL|member|is_download
name|'def'
name|'is_download'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'download_dir'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'download_dir'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'expanduser'
op|'('
name|'self'
op|'.'
name|'download_dir'
op|')'
newline|'\n'
name|'if'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'self'
op|'.'
name|'download_dir'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'True'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'logger'
op|'.'
name|'fatal'
op|'('
string|"'Could not find download directory'"
op|')'
newline|'\n'
name|'raise'
name|'InstallationError'
op|'('
nl|'\n'
string|'"Could not find or access download directory \'%s\'"'
nl|'\n'
op|'%'
name|'display_path'
op|'('
name|'self'
op|'.'
name|'download_dir'
op|')'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'return'
name|'False'
newline|'\n'
nl|'\n'
DECL|member|get_requirement
dedent|''
name|'def'
name|'get_requirement'
op|'('
name|'self'
op|','
name|'project_name'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'for'
name|'name'
name|'in'
name|'project_name'
op|','
name|'project_name'
op|'.'
name|'lower'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'name'
name|'in'
name|'self'
op|'.'
name|'requirements'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'self'
op|'.'
name|'requirements'
op|'['
name|'name'
op|']'
newline|'\n'
dedent|''
name|'if'
name|'name'
name|'in'
name|'self'
op|'.'
name|'requirement_aliases'
op|':'
newline|'\n'
indent|'                '
name|'return'
name|'self'
op|'.'
name|'requirements'
op|'['
name|'self'
op|'.'
name|'requirement_aliases'
op|'['
name|'name'
op|']'
op|']'
newline|'\n'
dedent|''
dedent|''
name|'raise'
name|'KeyError'
op|'('
string|'"No project with the name %r"'
op|'%'
name|'project_name'
op|')'
newline|'\n'
nl|'\n'
DECL|member|uninstall
dedent|''
name|'def'
name|'uninstall'
op|'('
name|'self'
op|','
name|'auto_confirm'
op|'='
name|'False'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'for'
name|'req'
name|'in'
name|'self'
op|'.'
name|'requirements'
op|'.'
name|'values'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'req'
op|'.'
name|'uninstall'
op|'('
name|'auto_confirm'
op|'='
name|'auto_confirm'
op|')'
newline|'\n'
name|'req'
op|'.'
name|'commit_uninstall'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|locate_files
dedent|''
dedent|''
name|'def'
name|'locate_files'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
comment|'## FIXME: duplicates code from install_files; relevant code should'
nl|'\n'
comment|'##        probably be factored out into a separate method'
nl|'\n'
indent|'        '
name|'unnamed'
op|'='
name|'list'
op|'('
name|'self'
op|'.'
name|'unnamed_requirements'
op|')'
newline|'\n'
name|'reqs'
op|'='
name|'self'
op|'.'
name|'requirements'
op|'.'
name|'values'
op|'('
op|')'
newline|'\n'
name|'while'
name|'reqs'
name|'or'
name|'unnamed'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'unnamed'
op|':'
newline|'\n'
indent|'                '
name|'req_to_install'
op|'='
name|'unnamed'
op|'.'
name|'pop'
op|'('
number|'0'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'req_to_install'
op|'='
name|'reqs'
op|'.'
name|'pop'
op|'('
number|'0'
op|')'
newline|'\n'
dedent|''
name|'install_needed'
op|'='
name|'True'
newline|'\n'
name|'if'
name|'not'
name|'self'
op|'.'
name|'ignore_installed'
name|'and'
name|'not'
name|'req_to_install'
op|'.'
name|'editable'
op|':'
newline|'\n'
indent|'                '
name|'req_to_install'
op|'.'
name|'check_if_exists'
op|'('
op|')'
newline|'\n'
name|'if'
name|'req_to_install'
op|'.'
name|'satisfied_by'
op|':'
newline|'\n'
indent|'                    '
name|'if'
name|'self'
op|'.'
name|'upgrade'
op|':'
newline|'\n'
indent|'                        '
name|'req_to_install'
op|'.'
name|'conflicts_with'
op|'='
name|'req_to_install'
op|'.'
name|'satisfied_by'
newline|'\n'
name|'req_to_install'
op|'.'
name|'satisfied_by'
op|'='
name|'None'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                        '
name|'install_needed'
op|'='
name|'False'
newline|'\n'
dedent|''
dedent|''
name|'if'
name|'req_to_install'
op|'.'
name|'satisfied_by'
op|':'
newline|'\n'
indent|'                    '
name|'logger'
op|'.'
name|'notify'
op|'('
string|"'Requirement already satisfied '"
nl|'\n'
string|"'(use --upgrade to upgrade): %s'"
nl|'\n'
op|'%'
name|'req_to_install'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'if'
name|'req_to_install'
op|'.'
name|'editable'
op|':'
newline|'\n'
indent|'                '
name|'if'
name|'req_to_install'
op|'.'
name|'source_dir'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'                    '
name|'req_to_install'
op|'.'
name|'source_dir'
op|'='
name|'req_to_install'
op|'.'
name|'build_location'
op|'('
name|'self'
op|'.'
name|'src_dir'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'elif'
name|'install_needed'
op|':'
newline|'\n'
indent|'                '
name|'req_to_install'
op|'.'
name|'source_dir'
op|'='
name|'req_to_install'
op|'.'
name|'build_location'
op|'('
name|'self'
op|'.'
name|'build_dir'
op|','
name|'not'
name|'self'
op|'.'
name|'is_download'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'if'
name|'req_to_install'
op|'.'
name|'source_dir'
name|'is'
name|'not'
name|'None'
name|'and'
name|'not'
name|'os'
op|'.'
name|'path'
op|'.'
name|'isdir'
op|'('
name|'req_to_install'
op|'.'
name|'source_dir'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'raise'
name|'InstallationError'
op|'('
string|"'Could not install requirement %s '"
nl|'\n'
string|"'because source folder %s does not exist '"
nl|'\n'
string|"'(perhaps --no-download was used without first running '"
nl|'\n'
string|"'an equivalent install with --no-install?)'"
nl|'\n'
op|'%'
op|'('
name|'req_to_install'
op|','
name|'req_to_install'
op|'.'
name|'source_dir'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|prepare_files
dedent|''
dedent|''
dedent|''
name|'def'
name|'prepare_files'
op|'('
name|'self'
op|','
name|'finder'
op|','
name|'force_root_egg_info'
op|'='
name|'False'
op|','
name|'bundle'
op|'='
name|'False'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Prepare process. Create temp directories, download and/or unpack files."""'
newline|'\n'
name|'unnamed'
op|'='
name|'list'
op|'('
name|'self'
op|'.'
name|'unnamed_requirements'
op|')'
newline|'\n'
name|'reqs'
op|'='
name|'self'
op|'.'
name|'requirements'
op|'.'
name|'values'
op|'('
op|')'
newline|'\n'
name|'while'
name|'reqs'
name|'or'
name|'unnamed'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'unnamed'
op|':'
newline|'\n'
indent|'                '
name|'req_to_install'
op|'='
name|'unnamed'
op|'.'
name|'pop'
op|'('
number|'0'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'req_to_install'
op|'='
name|'reqs'
op|'.'
name|'pop'
op|'('
number|'0'
op|')'
newline|'\n'
dedent|''
name|'install'
op|'='
name|'True'
newline|'\n'
name|'if'
name|'not'
name|'self'
op|'.'
name|'ignore_installed'
name|'and'
name|'not'
name|'req_to_install'
op|'.'
name|'editable'
op|':'
newline|'\n'
indent|'                '
name|'req_to_install'
op|'.'
name|'check_if_exists'
op|'('
op|')'
newline|'\n'
name|'if'
name|'req_to_install'
op|'.'
name|'satisfied_by'
op|':'
newline|'\n'
indent|'                    '
name|'if'
name|'self'
op|'.'
name|'upgrade'
op|':'
newline|'\n'
indent|'                        '
name|'req_to_install'
op|'.'
name|'conflicts_with'
op|'='
name|'req_to_install'
op|'.'
name|'satisfied_by'
newline|'\n'
name|'req_to_install'
op|'.'
name|'satisfied_by'
op|'='
name|'None'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                        '
name|'install'
op|'='
name|'False'
newline|'\n'
dedent|''
dedent|''
name|'if'
name|'req_to_install'
op|'.'
name|'satisfied_by'
op|':'
newline|'\n'
indent|'                    '
name|'logger'
op|'.'
name|'notify'
op|'('
string|"'Requirement already satisfied '"
nl|'\n'
string|"'(use --upgrade to upgrade): %s'"
nl|'\n'
op|'%'
name|'req_to_install'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'if'
name|'req_to_install'
op|'.'
name|'editable'
op|':'
newline|'\n'
indent|'                '
name|'logger'
op|'.'
name|'notify'
op|'('
string|"'Obtaining %s'"
op|'%'
name|'req_to_install'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'install'
op|':'
newline|'\n'
indent|'                '
name|'if'
name|'req_to_install'
op|'.'
name|'url'
name|'and'
name|'req_to_install'
op|'.'
name|'url'
op|'.'
name|'lower'
op|'('
op|')'
op|'.'
name|'startswith'
op|'('
string|"'file:'"
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'logger'
op|'.'
name|'notify'
op|'('
string|"'Unpacking %s'"
op|'%'
name|'display_path'
op|'('
name|'url_to_path'
op|'('
name|'req_to_install'
op|'.'
name|'url'
op|')'
op|')'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                    '
name|'logger'
op|'.'
name|'notify'
op|'('
string|"'Downloading/unpacking %s'"
op|'%'
name|'req_to_install'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'logger'
op|'.'
name|'indent'
op|'+='
number|'2'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'                '
name|'is_bundle'
op|'='
name|'False'
newline|'\n'
name|'if'
name|'req_to_install'
op|'.'
name|'editable'
op|':'
newline|'\n'
indent|'                    '
name|'if'
name|'req_to_install'
op|'.'
name|'source_dir'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'                        '
name|'location'
op|'='
name|'req_to_install'
op|'.'
name|'build_location'
op|'('
name|'self'
op|'.'
name|'src_dir'
op|')'
newline|'\n'
name|'req_to_install'
op|'.'
name|'source_dir'
op|'='
name|'location'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                        '
name|'location'
op|'='
name|'req_to_install'
op|'.'
name|'source_dir'
newline|'\n'
dedent|''
name|'if'
name|'not'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'self'
op|'.'
name|'build_dir'
op|')'
op|':'
newline|'\n'
indent|'                        '
name|'_make_build_dir'
op|'('
name|'self'
op|'.'
name|'build_dir'
op|')'
newline|'\n'
dedent|''
name|'req_to_install'
op|'.'
name|'update_editable'
op|'('
name|'not'
name|'self'
op|'.'
name|'is_download'
op|')'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'is_download'
op|':'
newline|'\n'
indent|'                        '
name|'req_to_install'
op|'.'
name|'run_egg_info'
op|'('
op|')'
newline|'\n'
name|'req_to_install'
op|'.'
name|'archive'
op|'('
name|'self'
op|'.'
name|'download_dir'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                        '
name|'req_to_install'
op|'.'
name|'run_egg_info'
op|'('
op|')'
newline|'\n'
dedent|''
dedent|''
name|'elif'
name|'install'
op|':'
newline|'\n'
comment|'##@@ if filesystem packages are not marked'
nl|'\n'
comment|'##editable in a req, a non deterministic error'
nl|'\n'
comment|'##occurs when the script attempts to unpack the'
nl|'\n'
comment|'##build directory'
nl|'\n'
nl|'\n'
indent|'                    '
name|'location'
op|'='
name|'req_to_install'
op|'.'
name|'build_location'
op|'('
name|'self'
op|'.'
name|'build_dir'
op|','
name|'not'
name|'self'
op|'.'
name|'is_download'
op|')'
newline|'\n'
comment|"## FIXME: is the existance of the checkout good enough to use it?  I don't think so."
nl|'\n'
name|'unpack'
op|'='
name|'True'
newline|'\n'
name|'if'
name|'not'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'location'
op|','
string|"'setup.py'"
op|')'
op|')'
op|':'
newline|'\n'
comment|"## FIXME: this won't upgrade when there's an existing package unpacked in `location`"
nl|'\n'
indent|'                        '
name|'if'
name|'req_to_install'
op|'.'
name|'url'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'                            '
name|'url'
op|'='
name|'finder'
op|'.'
name|'find_requirement'
op|'('
name|'req_to_install'
op|','
name|'upgrade'
op|'='
name|'self'
op|'.'
name|'upgrade'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
comment|'## FIXME: should req_to_install.url already be a link?'
nl|'\n'
indent|'                            '
name|'url'
op|'='
name|'Link'
op|'('
name|'req_to_install'
op|'.'
name|'url'
op|')'
newline|'\n'
name|'assert'
name|'url'
newline|'\n'
dedent|''
name|'if'
name|'url'
op|':'
newline|'\n'
indent|'                            '
name|'try'
op|':'
newline|'\n'
indent|'                                '
name|'self'
op|'.'
name|'unpack_url'
op|'('
name|'url'
op|','
name|'location'
op|','
name|'self'
op|'.'
name|'is_download'
op|')'
newline|'\n'
dedent|''
name|'except'
name|'urllib2'
op|'.'
name|'HTTPError'
op|','
name|'e'
op|':'
newline|'\n'
indent|'                                '
name|'logger'
op|'.'
name|'fatal'
op|'('
string|"'Could not install requirement %s because of error %s'"
nl|'\n'
op|'%'
op|'('
name|'req_to_install'
op|','
name|'e'
op|')'
op|')'
newline|'\n'
name|'raise'
name|'InstallationError'
op|'('
nl|'\n'
string|"'Could not install requirement %s because of HTTP error %s for URL %s'"
nl|'\n'
op|'%'
op|'('
name|'req_to_install'
op|','
name|'e'
op|','
name|'url'
op|')'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                            '
name|'unpack'
op|'='
name|'False'
newline|'\n'
dedent|''
dedent|''
name|'if'
name|'unpack'
op|':'
newline|'\n'
indent|'                        '
name|'is_bundle'
op|'='
name|'req_to_install'
op|'.'
name|'is_bundle'
newline|'\n'
name|'url'
op|'='
name|'None'
newline|'\n'
name|'if'
name|'is_bundle'
op|':'
newline|'\n'
indent|'                            '
name|'req_to_install'
op|'.'
name|'move_bundle_files'
op|'('
name|'self'
op|'.'
name|'build_dir'
op|','
name|'self'
op|'.'
name|'src_dir'
op|')'
newline|'\n'
name|'for'
name|'subreq'
name|'in'
name|'req_to_install'
op|'.'
name|'bundle_requirements'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                                '
name|'reqs'
op|'.'
name|'append'
op|'('
name|'subreq'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'add_requirement'
op|'('
name|'subreq'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'elif'
name|'self'
op|'.'
name|'is_download'
op|':'
newline|'\n'
indent|'                            '
name|'req_to_install'
op|'.'
name|'source_dir'
op|'='
name|'location'
newline|'\n'
name|'if'
name|'url'
name|'and'
name|'url'
op|'.'
name|'scheme'
name|'in'
name|'vcs'
op|'.'
name|'all_schemes'
op|':'
newline|'\n'
indent|'                                '
name|'req_to_install'
op|'.'
name|'run_egg_info'
op|'('
op|')'
newline|'\n'
name|'req_to_install'
op|'.'
name|'archive'
op|'('
name|'self'
op|'.'
name|'download_dir'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                            '
name|'req_to_install'
op|'.'
name|'source_dir'
op|'='
name|'location'
newline|'\n'
name|'req_to_install'
op|'.'
name|'run_egg_info'
op|'('
op|')'
newline|'\n'
name|'if'
name|'force_root_egg_info'
op|':'
newline|'\n'
comment|'# We need to run this to make sure that the .egg-info/'
nl|'\n'
comment|'# directory is created for packing in the bundle'
nl|'\n'
indent|'                                '
name|'req_to_install'
op|'.'
name|'run_egg_info'
op|'('
name|'force_root_egg_info'
op|'='
name|'True'
op|')'
newline|'\n'
dedent|''
name|'req_to_install'
op|'.'
name|'assert_source_matches_version'
op|'('
op|')'
newline|'\n'
comment|'#@@ sketchy way of identifying packages not grabbed from an index'
nl|'\n'
name|'if'
name|'bundle'
name|'and'
name|'req_to_install'
op|'.'
name|'url'
op|':'
newline|'\n'
indent|'                                '
name|'self'
op|'.'
name|'copy_to_build_dir'
op|'('
name|'req_to_install'
op|')'
newline|'\n'
dedent|''
dedent|''
dedent|''
dedent|''
name|'if'
name|'not'
name|'is_bundle'
name|'and'
name|'not'
name|'self'
op|'.'
name|'is_download'
op|':'
newline|'\n'
comment|"## FIXME: shouldn't be globally added:"
nl|'\n'
indent|'                    '
name|'finder'
op|'.'
name|'add_dependency_links'
op|'('
name|'req_to_install'
op|'.'
name|'dependency_links'
op|')'
newline|'\n'
comment|'## FIXME: add extras in here:'
nl|'\n'
name|'if'
name|'not'
name|'self'
op|'.'
name|'ignore_dependencies'
op|':'
newline|'\n'
indent|'                        '
name|'for'
name|'req'
name|'in'
name|'req_to_install'
op|'.'
name|'requirements'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                            '
name|'try'
op|':'
newline|'\n'
indent|'                                '
name|'name'
op|'='
name|'pkg_resources'
op|'.'
name|'Requirement'
op|'.'
name|'parse'
op|'('
name|'req'
op|')'
op|'.'
name|'project_name'
newline|'\n'
dedent|''
name|'except'
name|'ValueError'
op|','
name|'e'
op|':'
newline|'\n'
comment|'## FIXME: proper warning'
nl|'\n'
indent|'                                '
name|'logger'
op|'.'
name|'error'
op|'('
string|"'Invalid requirement: %r (%s) in requirement %s'"
op|'%'
op|'('
name|'req'
op|','
name|'e'
op|','
name|'req_to_install'
op|')'
op|')'
newline|'\n'
name|'continue'
newline|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'has_requirement'
op|'('
name|'name'
op|')'
op|':'
newline|'\n'
comment|'## FIXME: check for conflict'
nl|'\n'
indent|'                                '
name|'continue'
newline|'\n'
dedent|''
name|'subreq'
op|'='
name|'InstallRequirement'
op|'('
name|'req'
op|','
name|'req_to_install'
op|')'
newline|'\n'
name|'reqs'
op|'.'
name|'append'
op|'('
name|'subreq'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'add_requirement'
op|'('
name|'subreq'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'if'
name|'req_to_install'
op|'.'
name|'name'
name|'not'
name|'in'
name|'self'
op|'.'
name|'requirements'
op|':'
newline|'\n'
indent|'                        '
name|'self'
op|'.'
name|'requirements'
op|'['
name|'req_to_install'
op|'.'
name|'name'
op|']'
op|'='
name|'req_to_install'
newline|'\n'
dedent|''
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                    '
name|'self'
op|'.'
name|'reqs_to_cleanup'
op|'.'
name|'append'
op|'('
name|'req_to_install'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'install'
op|':'
newline|'\n'
indent|'                    '
name|'self'
op|'.'
name|'successfully_downloaded'
op|'.'
name|'append'
op|'('
name|'req_to_install'
op|')'
newline|'\n'
name|'if'
name|'bundle'
name|'and'
op|'('
name|'req_to_install'
op|'.'
name|'url'
name|'and'
name|'req_to_install'
op|'.'
name|'url'
op|'.'
name|'startswith'
op|'('
string|"'file:///'"
op|')'
op|')'
op|':'
newline|'\n'
indent|'                        '
name|'self'
op|'.'
name|'copy_to_build_dir'
op|'('
name|'req_to_install'
op|')'
newline|'\n'
dedent|''
dedent|''
dedent|''
name|'finally'
op|':'
newline|'\n'
indent|'                '
name|'logger'
op|'.'
name|'indent'
op|'-='
number|'2'
newline|'\n'
nl|'\n'
DECL|member|cleanup_files
dedent|''
dedent|''
dedent|''
name|'def'
name|'cleanup_files'
op|'('
name|'self'
op|','
name|'bundle'
op|'='
name|'False'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Clean up files, remove builds."""'
newline|'\n'
name|'logger'
op|'.'
name|'notify'
op|'('
string|"'Cleaning up...'"
op|')'
newline|'\n'
name|'logger'
op|'.'
name|'indent'
op|'+='
number|'2'
newline|'\n'
name|'for'
name|'req'
name|'in'
name|'self'
op|'.'
name|'reqs_to_cleanup'
op|':'
newline|'\n'
indent|'            '
name|'req'
op|'.'
name|'remove_temporary_source'
op|'('
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'remove_dir'
op|'='
op|'['
op|']'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'_pip_has_created_build_dir'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'remove_dir'
op|'.'
name|'append'
op|'('
name|'self'
op|'.'
name|'build_dir'
op|')'
newline|'\n'
nl|'\n'
comment|'# The source dir of a bundle can always be removed.'
nl|'\n'
dedent|''
name|'if'
name|'bundle'
op|':'
newline|'\n'
indent|'            '
name|'remove_dir'
op|'.'
name|'append'
op|'('
name|'self'
op|'.'
name|'src_dir'
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'for'
name|'dir'
name|'in'
name|'remove_dir'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'dir'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'logger'
op|'.'
name|'info'
op|'('
string|"'Removing temporary dir %s...'"
op|'%'
name|'dir'
op|')'
newline|'\n'
name|'rmtree'
op|'('
name|'dir'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'logger'
op|'.'
name|'indent'
op|'-='
number|'2'
newline|'\n'
nl|'\n'
DECL|member|_pip_has_created_build_dir
dedent|''
name|'def'
name|'_pip_has_created_build_dir'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
op|'('
name|'self'
op|'.'
name|'build_dir'
op|'=='
name|'build_prefix'
name|'and'
nl|'\n'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'self'
op|'.'
name|'build_dir'
op|','
name|'PIP_DELETE_MARKER_FILENAME'
op|')'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|copy_to_build_dir
dedent|''
name|'def'
name|'copy_to_build_dir'
op|'('
name|'self'
op|','
name|'req_to_install'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'target_dir'
op|'='
name|'req_to_install'
op|'.'
name|'editable'
name|'and'
name|'self'
op|'.'
name|'src_dir'
name|'or'
name|'self'
op|'.'
name|'build_dir'
newline|'\n'
name|'logger'
op|'.'
name|'info'
op|'('
string|'"Copying %s to %s"'
op|'%'
op|'('
name|'req_to_install'
op|'.'
name|'name'
op|','
name|'target_dir'
op|')'
op|')'
newline|'\n'
name|'dest'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'target_dir'
op|','
name|'req_to_install'
op|'.'
name|'name'
op|')'
newline|'\n'
name|'copytree'
op|'('
name|'req_to_install'
op|'.'
name|'source_dir'
op|','
name|'dest'
op|')'
newline|'\n'
name|'call_subprocess'
op|'('
op|'['
string|'"python"'
op|','
string|'"%s/setup.py"'
op|'%'
name|'dest'
op|','
string|'"clean"'
op|']'
op|')'
newline|'\n'
nl|'\n'
DECL|member|unpack_url
dedent|''
name|'def'
name|'unpack_url'
op|'('
name|'self'
op|','
name|'link'
op|','
name|'location'
op|','
name|'only_download'
op|'='
name|'False'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'only_download'
op|':'
newline|'\n'
indent|'            '
name|'location'
op|'='
name|'self'
op|'.'
name|'download_dir'
newline|'\n'
dedent|''
name|'if'
name|'is_vcs_url'
op|'('
name|'link'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'unpack_vcs_link'
op|'('
name|'link'
op|','
name|'location'
op|','
name|'only_download'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'is_file_url'
op|'('
name|'link'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'unpack_file_url'
op|'('
name|'link'
op|','
name|'location'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'self'
op|'.'
name|'download_cache'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'download_cache'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'expanduser'
op|'('
name|'self'
op|'.'
name|'download_cache'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'unpack_http_url'
op|'('
name|'link'
op|','
name|'location'
op|','
name|'self'
op|'.'
name|'download_cache'
op|','
name|'only_download'
op|')'
newline|'\n'
nl|'\n'
DECL|member|install
dedent|''
dedent|''
name|'def'
name|'install'
op|'('
name|'self'
op|','
name|'install_options'
op|','
name|'global_options'
op|'='
op|'('
op|')'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Install everything in this set (after having downloaded and unpacked the packages)"""'
newline|'\n'
name|'to_install'
op|'='
name|'sorted'
op|'('
op|'['
name|'r'
name|'for'
name|'r'
name|'in'
name|'self'
op|'.'
name|'requirements'
op|'.'
name|'values'
op|'('
op|')'
nl|'\n'
name|'if'
name|'self'
op|'.'
name|'upgrade'
name|'or'
name|'not'
name|'r'
op|'.'
name|'satisfied_by'
op|']'
op|','
nl|'\n'
name|'key'
op|'='
name|'lambda'
name|'p'
op|':'
name|'p'
op|'.'
name|'name'
op|'.'
name|'lower'
op|'('
op|')'
op|')'
newline|'\n'
name|'if'
name|'to_install'
op|':'
newline|'\n'
indent|'            '
name|'logger'
op|'.'
name|'notify'
op|'('
string|"'Installing collected packages: %s'"
op|'%'
op|'('
string|"', '"
op|'.'
name|'join'
op|'('
op|'['
name|'req'
op|'.'
name|'name'
name|'for'
name|'req'
name|'in'
name|'to_install'
op|']'
op|')'
op|')'
op|')'
newline|'\n'
dedent|''
name|'logger'
op|'.'
name|'indent'
op|'+='
number|'2'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'requirement'
name|'in'
name|'to_install'
op|':'
newline|'\n'
indent|'                '
name|'if'
name|'requirement'
op|'.'
name|'conflicts_with'
op|':'
newline|'\n'
indent|'                    '
name|'logger'
op|'.'
name|'notify'
op|'('
string|"'Found existing installation: %s'"
nl|'\n'
op|'%'
name|'requirement'
op|'.'
name|'conflicts_with'
op|')'
newline|'\n'
name|'logger'
op|'.'
name|'indent'
op|'+='
number|'2'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'                        '
name|'requirement'
op|'.'
name|'uninstall'
op|'('
name|'auto_confirm'
op|'='
name|'True'
op|')'
newline|'\n'
dedent|''
name|'finally'
op|':'
newline|'\n'
indent|'                        '
name|'logger'
op|'.'
name|'indent'
op|'-='
number|'2'
newline|'\n'
dedent|''
dedent|''
name|'try'
op|':'
newline|'\n'
indent|'                    '
name|'requirement'
op|'.'
name|'install'
op|'('
name|'install_options'
op|','
name|'global_options'
op|')'
newline|'\n'
dedent|''
name|'except'
op|':'
newline|'\n'
comment|'# if install did not succeed, rollback previous uninstall'
nl|'\n'
indent|'                    '
name|'if'
name|'requirement'
op|'.'
name|'conflicts_with'
name|'and'
name|'not'
name|'requirement'
op|'.'
name|'install_succeeded'
op|':'
newline|'\n'
indent|'                        '
name|'requirement'
op|'.'
name|'rollback_uninstall'
op|'('
op|')'
newline|'\n'
dedent|''
name|'raise'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                    '
name|'if'
name|'requirement'
op|'.'
name|'conflicts_with'
name|'and'
name|'requirement'
op|'.'
name|'install_succeeded'
op|':'
newline|'\n'
indent|'                        '
name|'requirement'
op|'.'
name|'commit_uninstall'
op|'('
op|')'
newline|'\n'
dedent|''
dedent|''
name|'requirement'
op|'.'
name|'remove_temporary_source'
op|'('
op|')'
newline|'\n'
dedent|''
dedent|''
name|'finally'
op|':'
newline|'\n'
indent|'            '
name|'logger'
op|'.'
name|'indent'
op|'-='
number|'2'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'successfully_installed'
op|'='
name|'to_install'
newline|'\n'
nl|'\n'
DECL|member|create_bundle
dedent|''
name|'def'
name|'create_bundle'
op|'('
name|'self'
op|','
name|'bundle_filename'
op|')'
op|':'
newline|'\n'
comment|"## FIXME: can't decide which is better; zip is easier to read"
nl|'\n'
comment|'## random files from, but tar.bz2 is smaller and not as lame a'
nl|'\n'
comment|'## format.'
nl|'\n'
nl|'\n'
comment|'## FIXME: this file should really include a manifest of the'
nl|'\n'
comment|'## packages, maybe some other metadata files.  It would make'
nl|'\n'
comment|'## it easier to detect as well.'
nl|'\n'
indent|'        '
name|'zip'
op|'='
name|'zipfile'
op|'.'
name|'ZipFile'
op|'('
name|'bundle_filename'
op|','
string|"'w'"
op|','
name|'zipfile'
op|'.'
name|'ZIP_DEFLATED'
op|')'
newline|'\n'
name|'vcs_dirs'
op|'='
op|'['
op|']'
newline|'\n'
name|'for'
name|'dir'
op|','
name|'basename'
name|'in'
op|'('
name|'self'
op|'.'
name|'build_dir'
op|','
string|"'build'"
op|')'
op|','
op|'('
name|'self'
op|'.'
name|'src_dir'
op|','
string|"'src'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'dir'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'normcase'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'abspath'
op|'('
name|'dir'
op|')'
op|')'
newline|'\n'
name|'for'
name|'dirpath'
op|','
name|'dirnames'
op|','
name|'filenames'
name|'in'
name|'os'
op|'.'
name|'walk'
op|'('
name|'dir'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'for'
name|'backend'
name|'in'
name|'vcs'
op|'.'
name|'backends'
op|':'
newline|'\n'
indent|'                    '
name|'vcs_backend'
op|'='
name|'backend'
op|'('
op|')'
newline|'\n'
name|'vcs_url'
op|'='
name|'vcs_rev'
op|'='
name|'None'
newline|'\n'
name|'if'
name|'vcs_backend'
op|'.'
name|'dirname'
name|'in'
name|'dirnames'
op|':'
newline|'\n'
indent|'                        '
name|'for'
name|'vcs_dir'
name|'in'
name|'vcs_dirs'
op|':'
newline|'\n'
indent|'                            '
name|'if'
name|'dirpath'
op|'.'
name|'startswith'
op|'('
name|'vcs_dir'
op|')'
op|':'
newline|'\n'
comment|'# vcs bundle file already in parent directory'
nl|'\n'
indent|'                                '
name|'break'
newline|'\n'
dedent|''
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                            '
name|'vcs_url'
op|','
name|'vcs_rev'
op|'='
name|'vcs_backend'
op|'.'
name|'get_info'
op|'('
nl|'\n'
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'dir'
op|','
name|'dirpath'
op|')'
op|')'
newline|'\n'
name|'vcs_dirs'
op|'.'
name|'append'
op|'('
name|'dirpath'
op|')'
newline|'\n'
dedent|''
name|'vcs_bundle_file'
op|'='
name|'vcs_backend'
op|'.'
name|'bundle_file'
newline|'\n'
name|'vcs_guide'
op|'='
name|'vcs_backend'
op|'.'
name|'guide'
op|'%'
op|'{'
string|"'url'"
op|':'
name|'vcs_url'
op|','
nl|'\n'
string|"'rev'"
op|':'
name|'vcs_rev'
op|'}'
newline|'\n'
name|'dirnames'
op|'.'
name|'remove'
op|'('
name|'vcs_backend'
op|'.'
name|'dirname'
op|')'
newline|'\n'
name|'break'
newline|'\n'
dedent|''
dedent|''
name|'if'
string|"'pip-egg-info'"
name|'in'
name|'dirnames'
op|':'
newline|'\n'
indent|'                    '
name|'dirnames'
op|'.'
name|'remove'
op|'('
string|"'pip-egg-info'"
op|')'
newline|'\n'
dedent|''
name|'for'
name|'dirname'
name|'in'
name|'dirnames'
op|':'
newline|'\n'
indent|'                    '
name|'dirname'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'dirpath'
op|','
name|'dirname'
op|')'
newline|'\n'
name|'name'
op|'='
name|'self'
op|'.'
name|'_clean_zip_name'
op|'('
name|'dirname'
op|','
name|'dir'
op|')'
newline|'\n'
name|'zip'
op|'.'
name|'writestr'
op|'('
name|'basename'
op|'+'
string|"'/'"
op|'+'
name|'name'
op|'+'
string|"'/'"
op|','
string|"''"
op|')'
newline|'\n'
dedent|''
name|'for'
name|'filename'
name|'in'
name|'filenames'
op|':'
newline|'\n'
indent|'                    '
name|'if'
name|'filename'
op|'=='
name|'PIP_DELETE_MARKER_FILENAME'
op|':'
newline|'\n'
indent|'                        '
name|'continue'
newline|'\n'
dedent|''
name|'filename'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'dirpath'
op|','
name|'filename'
op|')'
newline|'\n'
name|'name'
op|'='
name|'self'
op|'.'
name|'_clean_zip_name'
op|'('
name|'filename'
op|','
name|'dir'
op|')'
newline|'\n'
name|'zip'
op|'.'
name|'write'
op|'('
name|'filename'
op|','
name|'basename'
op|'+'
string|"'/'"
op|'+'
name|'name'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'vcs_url'
op|':'
newline|'\n'
indent|'                    '
name|'name'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'dirpath'
op|','
name|'vcs_bundle_file'
op|')'
newline|'\n'
name|'name'
op|'='
name|'self'
op|'.'
name|'_clean_zip_name'
op|'('
name|'name'
op|','
name|'dir'
op|')'
newline|'\n'
name|'zip'
op|'.'
name|'writestr'
op|'('
name|'basename'
op|'+'
string|"'/'"
op|'+'
name|'name'
op|','
name|'vcs_guide'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
dedent|''
name|'zip'
op|'.'
name|'writestr'
op|'('
string|"'pip-manifest.txt'"
op|','
name|'self'
op|'.'
name|'bundle_requirements'
op|'('
op|')'
op|')'
newline|'\n'
name|'zip'
op|'.'
name|'close'
op|'('
op|')'
newline|'\n'
nl|'\n'
dedent|''
name|'BUNDLE_HEADER'
op|'='
string|"'''\\\n# This is a pip bundle file, that contains many source packages\n# that can be installed as a group.  You can install this like:\n#     pip this_file.zip\n# The rest of the file contains a list of all the packages included:\n'''"
newline|'\n'
nl|'\n'
DECL|member|bundle_requirements
name|'def'
name|'bundle_requirements'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'parts'
op|'='
op|'['
name|'self'
op|'.'
name|'BUNDLE_HEADER'
op|']'
newline|'\n'
name|'for'
name|'req'
name|'in'
name|'sorted'
op|'('
nl|'\n'
op|'['
name|'req'
name|'for'
name|'req'
name|'in'
name|'self'
op|'.'
name|'requirements'
op|'.'
name|'values'
op|'('
op|')'
nl|'\n'
name|'if'
name|'not'
name|'req'
op|'.'
name|'comes_from'
op|']'
op|','
nl|'\n'
name|'key'
op|'='
name|'lambda'
name|'x'
op|':'
name|'x'
op|'.'
name|'name'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'parts'
op|'.'
name|'append'
op|'('
string|"'%s==%s\\n'"
op|'%'
op|'('
name|'req'
op|'.'
name|'name'
op|','
name|'req'
op|'.'
name|'installed_version'
op|')'
op|')'
newline|'\n'
dedent|''
name|'parts'
op|'.'
name|'append'
op|'('
string|"'# These packages were installed to satisfy the above requirements:\\n'"
op|')'
newline|'\n'
name|'for'
name|'req'
name|'in'
name|'sorted'
op|'('
nl|'\n'
op|'['
name|'req'
name|'for'
name|'req'
name|'in'
name|'self'
op|'.'
name|'requirements'
op|'.'
name|'values'
op|'('
op|')'
nl|'\n'
name|'if'
name|'req'
op|'.'
name|'comes_from'
op|']'
op|','
nl|'\n'
name|'key'
op|'='
name|'lambda'
name|'x'
op|':'
name|'x'
op|'.'
name|'name'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'parts'
op|'.'
name|'append'
op|'('
string|"'%s==%s\\n'"
op|'%'
op|'('
name|'req'
op|'.'
name|'name'
op|','
name|'req'
op|'.'
name|'installed_version'
op|')'
op|')'
newline|'\n'
comment|'## FIXME: should we do something with self.unnamed_requirements?'
nl|'\n'
dedent|''
name|'return'
string|"''"
op|'.'
name|'join'
op|'('
name|'parts'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_clean_zip_name
dedent|''
name|'def'
name|'_clean_zip_name'
op|'('
name|'self'
op|','
name|'name'
op|','
name|'prefix'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'assert'
name|'name'
op|'.'
name|'startswith'
op|'('
name|'prefix'
op|'+'
name|'os'
op|'.'
name|'path'
op|'.'
name|'sep'
op|')'
op|','
op|'('
nl|'\n'
string|'"name %r doesn\'t start with prefix %r"'
op|'%'
op|'('
name|'name'
op|','
name|'prefix'
op|')'
op|')'
newline|'\n'
name|'name'
op|'='
name|'name'
op|'['
name|'len'
op|'('
name|'prefix'
op|')'
op|'+'
number|'1'
op|':'
op|']'
newline|'\n'
name|'name'
op|'='
name|'name'
op|'.'
name|'replace'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'sep'
op|','
string|"'/'"
op|')'
newline|'\n'
name|'return'
name|'name'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|_make_build_dir
dedent|''
dedent|''
name|'def'
name|'_make_build_dir'
op|'('
name|'build_dir'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'os'
op|'.'
name|'makedirs'
op|'('
name|'build_dir'
op|')'
newline|'\n'
name|'_write_delete_marker_message'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'build_dir'
op|','
name|'PIP_DELETE_MARKER_FILENAME'
op|')'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|_write_delete_marker_message
dedent|''
name|'def'
name|'_write_delete_marker_message'
op|'('
name|'filepath'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'marker_fp'
op|'='
name|'open'
op|'('
name|'filepath'
op|','
string|"'w'"
op|')'
newline|'\n'
name|'marker_fp'
op|'.'
name|'write'
op|'('
name|'DELETE_MARKER_MESSAGE'
op|')'
newline|'\n'
name|'marker_fp'
op|'.'
name|'close'
op|'('
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|variable|_scheme_re
dedent|''
name|'_scheme_re'
op|'='
name|'re'
op|'.'
name|'compile'
op|'('
string|"r'^(http|https|file):'"
op|','
name|'re'
op|'.'
name|'I'
op|')'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|parse_requirements
name|'def'
name|'parse_requirements'
op|'('
name|'filename'
op|','
name|'finder'
op|'='
name|'None'
op|','
name|'comes_from'
op|'='
name|'None'
op|','
name|'options'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'    '
name|'skip_match'
op|'='
name|'None'
newline|'\n'
name|'skip_regex'
op|'='
name|'options'
op|'.'
name|'skip_requirements_regex'
newline|'\n'
name|'if'
name|'skip_regex'
op|':'
newline|'\n'
indent|'        '
name|'skip_match'
op|'='
name|'re'
op|'.'
name|'compile'
op|'('
name|'skip_regex'
op|')'
newline|'\n'
dedent|''
name|'filename'
op|','
name|'content'
op|'='
name|'get_file_content'
op|'('
name|'filename'
op|','
name|'comes_from'
op|'='
name|'comes_from'
op|')'
newline|'\n'
name|'for'
name|'line_number'
op|','
name|'line'
name|'in'
name|'enumerate'
op|'('
name|'content'
op|'.'
name|'splitlines'
op|'('
op|')'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'line_number'
op|'+='
number|'1'
newline|'\n'
name|'line'
op|'='
name|'line'
op|'.'
name|'strip'
op|'('
op|')'
newline|'\n'
name|'if'
name|'not'
name|'line'
name|'or'
name|'line'
op|'.'
name|'startswith'
op|'('
string|"'#'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'continue'
newline|'\n'
dedent|''
name|'if'
name|'skip_match'
name|'and'
name|'skip_match'
op|'.'
name|'search'
op|'('
name|'line'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'continue'
newline|'\n'
dedent|''
name|'if'
name|'line'
op|'.'
name|'startswith'
op|'('
string|"'-r'"
op|')'
name|'or'
name|'line'
op|'.'
name|'startswith'
op|'('
string|"'--requirement'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'line'
op|'.'
name|'startswith'
op|'('
string|"'-r'"
op|')'
op|':'
newline|'\n'
indent|'                '
name|'req_url'
op|'='
name|'line'
op|'['
number|'2'
op|':'
op|']'
op|'.'
name|'strip'
op|'('
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'req_url'
op|'='
name|'line'
op|'['
name|'len'
op|'('
string|"'--requirement'"
op|')'
op|':'
op|']'
op|'.'
name|'strip'
op|'('
op|')'
op|'.'
name|'strip'
op|'('
string|"'='"
op|')'
newline|'\n'
dedent|''
name|'if'
name|'_scheme_re'
op|'.'
name|'search'
op|'('
name|'filename'
op|')'
op|':'
newline|'\n'
comment|'# Relative to a URL'
nl|'\n'
indent|'                '
name|'req_url'
op|'='
name|'urlparse'
op|'.'
name|'urljoin'
op|'('
name|'req_url'
op|','
name|'filename'
op|')'
newline|'\n'
dedent|''
name|'elif'
name|'not'
name|'_scheme_re'
op|'.'
name|'search'
op|'('
name|'req_url'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'req_url'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'dirname'
op|'('
name|'filename'
op|')'
op|','
name|'req_url'
op|')'
newline|'\n'
dedent|''
name|'for'
name|'item'
name|'in'
name|'parse_requirements'
op|'('
name|'req_url'
op|','
name|'finder'
op|','
name|'comes_from'
op|'='
name|'filename'
op|','
name|'options'
op|'='
name|'options'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'yield'
name|'item'
newline|'\n'
dedent|''
dedent|''
name|'elif'
name|'line'
op|'.'
name|'startswith'
op|'('
string|"'-Z'"
op|')'
name|'or'
name|'line'
op|'.'
name|'startswith'
op|'('
string|"'--always-unzip'"
op|')'
op|':'
newline|'\n'
comment|'# No longer used, but previously these were used in'
nl|'\n'
comment|"# requirement files, so we'll ignore."
nl|'\n'
indent|'            '
name|'pass'
newline|'\n'
dedent|''
name|'elif'
name|'line'
op|'.'
name|'startswith'
op|'('
string|"'-f'"
op|')'
name|'or'
name|'line'
op|'.'
name|'startswith'
op|'('
string|"'--find-links'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'line'
op|'.'
name|'startswith'
op|'('
string|"'-f'"
op|')'
op|':'
newline|'\n'
indent|'                '
name|'line'
op|'='
name|'line'
op|'['
number|'2'
op|':'
op|']'
op|'.'
name|'strip'
op|'('
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'line'
op|'='
name|'line'
op|'['
name|'len'
op|'('
string|"'--find-links'"
op|')'
op|':'
op|']'
op|'.'
name|'strip'
op|'('
op|')'
op|'.'
name|'lstrip'
op|'('
string|"'='"
op|')'
newline|'\n'
comment|'## FIXME: it would be nice to keep track of the source of'
nl|'\n'
comment|'## the find_links:'
nl|'\n'
dedent|''
name|'if'
name|'finder'
op|':'
newline|'\n'
indent|'                '
name|'finder'
op|'.'
name|'find_links'
op|'.'
name|'append'
op|'('
name|'line'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'elif'
name|'line'
op|'.'
name|'startswith'
op|'('
string|"'-i'"
op|')'
name|'or'
name|'line'
op|'.'
name|'startswith'
op|'('
string|"'--index-url'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'line'
op|'.'
name|'startswith'
op|'('
string|"'-i'"
op|')'
op|':'
newline|'\n'
indent|'                '
name|'line'
op|'='
name|'line'
op|'['
number|'2'
op|':'
op|']'
op|'.'
name|'strip'
op|'('
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'line'
op|'='
name|'line'
op|'['
name|'len'
op|'('
string|"'--index-url'"
op|')'
op|':'
op|']'
op|'.'
name|'strip'
op|'('
op|')'
op|'.'
name|'lstrip'
op|'('
string|"'='"
op|')'
newline|'\n'
dedent|''
name|'if'
name|'finder'
op|':'
newline|'\n'
indent|'                '
name|'finder'
op|'.'
name|'index_urls'
op|'='
op|'['
name|'line'
op|']'
newline|'\n'
dedent|''
dedent|''
name|'elif'
name|'line'
op|'.'
name|'startswith'
op|'('
string|"'--extra-index-url'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'line'
op|'='
name|'line'
op|'['
name|'len'
op|'('
string|"'--extra-index-url'"
op|')'
op|':'
op|']'
op|'.'
name|'strip'
op|'('
op|')'
op|'.'
name|'lstrip'
op|'('
string|"'='"
op|')'
newline|'\n'
name|'if'
name|'finder'
op|':'
newline|'\n'
indent|'                '
name|'finder'
op|'.'
name|'index_urls'
op|'.'
name|'append'
op|'('
name|'line'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'comes_from'
op|'='
string|"'-r %s (line %s)'"
op|'%'
op|'('
name|'filename'
op|','
name|'line_number'
op|')'
newline|'\n'
name|'if'
name|'line'
op|'.'
name|'startswith'
op|'('
string|"'-e'"
op|')'
name|'or'
name|'line'
op|'.'
name|'startswith'
op|'('
string|"'--editable'"
op|')'
op|':'
newline|'\n'
indent|'                '
name|'if'
name|'line'
op|'.'
name|'startswith'
op|'('
string|"'-e'"
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'line'
op|'='
name|'line'
op|'['
number|'2'
op|':'
op|']'
op|'.'
name|'strip'
op|'('
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                    '
name|'line'
op|'='
name|'line'
op|'['
name|'len'
op|'('
string|"'--editable'"
op|')'
op|':'
op|']'
op|'.'
name|'strip'
op|'('
op|')'
newline|'\n'
dedent|''
name|'req'
op|'='
name|'InstallRequirement'
op|'.'
name|'from_editable'
op|'('
nl|'\n'
name|'line'
op|','
name|'comes_from'
op|'='
name|'comes_from'
op|','
name|'default_vcs'
op|'='
name|'options'
op|'.'
name|'default_vcs'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'req'
op|'='
name|'InstallRequirement'
op|'.'
name|'from_line'
op|'('
name|'line'
op|','
name|'comes_from'
op|')'
newline|'\n'
dedent|''
name|'yield'
name|'req'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|function|parse_editable
dedent|''
dedent|''
dedent|''
name|'def'
name|'parse_editable'
op|'('
name|'editable_req'
op|','
name|'default_vcs'
op|'='
name|'None'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Parses svn+http://blahblah@rev#egg=Foobar into a requirement\n    (Foobar) and a URL"""'
newline|'\n'
name|'url'
op|'='
name|'editable_req'
newline|'\n'
name|'if'
name|'os'
op|'.'
name|'path'
op|'.'
name|'isdir'
op|'('
name|'url'
op|')'
name|'and'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
name|'url'
op|','
string|"'setup.py'"
op|')'
op|')'
op|':'
newline|'\n'
comment|'# Treating it as code that has already been checked out'
nl|'\n'
indent|'        '
name|'url'
op|'='
name|'path_to_url'
op|'('
name|'url'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'url'
op|'.'
name|'lower'
op|'('
op|')'
op|'.'
name|'startswith'
op|'('
string|"'file:'"
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'None'
op|','
name|'url'
newline|'\n'
dedent|''
name|'for'
name|'version_control'
name|'in'
name|'vcs'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'url'
op|'.'
name|'lower'
op|'('
op|')'
op|'.'
name|'startswith'
op|'('
string|"'%s:'"
op|'%'
name|'version_control'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'url'
op|'='
string|"'%s+%s'"
op|'%'
op|'('
name|'version_control'
op|','
name|'url'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'if'
string|"'+'"
name|'not'
name|'in'
name|'url'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'default_vcs'
op|':'
newline|'\n'
indent|'            '
name|'url'
op|'='
name|'default_vcs'
op|'+'
string|"'+'"
op|'+'
name|'url'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'InstallationError'
op|'('
nl|'\n'
string|"'--editable=%s should be formatted with svn+URL, git+URL, hg+URL or bzr+URL'"
op|'%'
name|'editable_req'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'vc_type'
op|'='
name|'url'
op|'.'
name|'split'
op|'('
string|"'+'"
op|','
number|'1'
op|')'
op|'['
number|'0'
op|']'
op|'.'
name|'lower'
op|'('
op|')'
newline|'\n'
name|'if'
name|'not'
name|'vcs'
op|'.'
name|'get_backend'
op|'('
name|'vc_type'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'raise'
name|'InstallationError'
op|'('
nl|'\n'
string|"'For --editable=%s only svn (svn+URL), Git (git+URL), Mercurial (hg+URL) and Bazaar (bzr+URL) is currently supported'"
op|'%'
name|'editable_req'
op|')'
newline|'\n'
dedent|''
name|'match'
op|'='
name|'re'
op|'.'
name|'search'
op|'('
string|"r'(?:#|#.*?&)egg=([^&]*)'"
op|','
name|'editable_req'
op|')'
newline|'\n'
name|'if'
op|'('
name|'not'
name|'match'
name|'or'
name|'not'
name|'match'
op|'.'
name|'group'
op|'('
number|'1'
op|')'
op|')'
name|'and'
name|'vcs'
op|'.'
name|'get_backend'
op|'('
name|'vc_type'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'parts'
op|'='
op|'['
name|'p'
name|'for'
name|'p'
name|'in'
name|'editable_req'
op|'.'
name|'split'
op|'('
string|"'#'"
op|','
number|'1'
op|')'
op|'['
number|'0'
op|']'
op|'.'
name|'split'
op|'('
string|"'/'"
op|')'
name|'if'
name|'p'
op|']'
newline|'\n'
name|'if'
name|'parts'
op|'['
op|'-'
number|'2'
op|']'
name|'in'
op|'('
string|"'tags'"
op|','
string|"'branches'"
op|','
string|"'tag'"
op|','
string|"'branch'"
op|')'
op|':'
newline|'\n'
indent|'            '
name|'req'
op|'='
name|'parts'
op|'['
op|'-'
number|'3'
op|']'
newline|'\n'
dedent|''
name|'elif'
name|'parts'
op|'['
op|'-'
number|'1'
op|']'
op|'=='
string|"'trunk'"
op|':'
newline|'\n'
indent|'            '
name|'req'
op|'='
name|'parts'
op|'['
op|'-'
number|'2'
op|']'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'InstallationError'
op|'('
nl|'\n'
string|"'--editable=%s is not the right format; it must have #egg=Package'"
nl|'\n'
op|'%'
name|'editable_req'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'        '
name|'req'
op|'='
name|'match'
op|'.'
name|'group'
op|'('
number|'1'
op|')'
newline|'\n'
comment|'## FIXME: use package_to_requirement?'
nl|'\n'
dedent|''
name|'match'
op|'='
name|'re'
op|'.'
name|'search'
op|'('
string|"r'^(.*?)(?:-dev|-\\d.*)'"
op|','
name|'req'
op|')'
newline|'\n'
name|'if'
name|'match'
op|':'
newline|'\n'
comment|'# Strip off -dev, -0.2, etc.'
nl|'\n'
indent|'        '
name|'req'
op|'='
name|'match'
op|'.'
name|'group'
op|'('
number|'1'
op|')'
newline|'\n'
dedent|''
name|'return'
name|'req'
op|','
name|'url'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|UninstallPathSet
dedent|''
name|'class'
name|'UninstallPathSet'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""A set of file paths to be removed in the uninstallation of a\n    requirement."""'
newline|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'dist'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'paths'
op|'='
name|'set'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_refuse'
op|'='
name|'set'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'pth'
op|'='
op|'{'
op|'}'
newline|'\n'
name|'self'
op|'.'
name|'dist'
op|'='
name|'dist'
newline|'\n'
name|'self'
op|'.'
name|'save_dir'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'_moved_paths'
op|'='
op|'['
op|']'
newline|'\n'
nl|'\n'
DECL|member|_permitted
dedent|''
name|'def'
name|'_permitted'
op|'('
name|'self'
op|','
name|'path'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""\n        Return True if the given path is one we are permitted to\n        remove/modify, False otherwise.\n\n        """'
newline|'\n'
name|'return'
name|'is_local'
op|'('
name|'path'
op|')'
newline|'\n'
nl|'\n'
DECL|member|_can_uninstall
dedent|''
name|'def'
name|'_can_uninstall'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'not'
name|'dist_is_local'
op|'('
name|'self'
op|'.'
name|'dist'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'logger'
op|'.'
name|'notify'
op|'('
string|'"Not uninstalling %s at %s, outside environment %s"'
nl|'\n'
op|'%'
op|'('
name|'self'
op|'.'
name|'dist'
op|'.'
name|'project_name'
op|','
name|'normalize_path'
op|'('
name|'self'
op|'.'
name|'dist'
op|'.'
name|'location'
op|')'
op|','
name|'sys'
op|'.'
name|'prefix'
op|')'
op|')'
newline|'\n'
name|'return'
name|'False'
newline|'\n'
dedent|''
name|'return'
name|'True'
newline|'\n'
nl|'\n'
DECL|member|add
dedent|''
name|'def'
name|'add'
op|'('
name|'self'
op|','
name|'path'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'path'
op|'='
name|'normalize_path'
op|'('
name|'path'
op|')'
newline|'\n'
name|'if'
name|'not'
name|'os'
op|'.'
name|'path'
op|'.'
name|'exists'
op|'('
name|'path'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
newline|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'_permitted'
op|'('
name|'path'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'paths'
op|'.'
name|'add'
op|'('
name|'path'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'_refuse'
op|'.'
name|'add'
op|'('
name|'path'
op|')'
newline|'\n'
nl|'\n'
DECL|member|add_pth
dedent|''
dedent|''
name|'def'
name|'add_pth'
op|'('
name|'self'
op|','
name|'pth_file'
op|','
name|'entry'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'pth_file'
op|'='
name|'normalize_path'
op|'('
name|'pth_file'
op|')'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'_permitted'
op|'('
name|'pth_file'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'pth_file'
name|'not'
name|'in'
name|'self'
op|'.'
name|'pth'
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'pth'
op|'['
name|'pth_file'
op|']'
op|'='
name|'UninstallPthEntries'
op|'('
name|'pth_file'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'pth'
op|'['
name|'pth_file'
op|']'
op|'.'
name|'add'
op|'('
name|'entry'
op|')'
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'            '
name|'self'
op|'.'
name|'_refuse'
op|'.'
name|'add'
op|'('
name|'pth_file'
op|')'
newline|'\n'
nl|'\n'
DECL|member|compact
dedent|''
dedent|''
name|'def'
name|'compact'
op|'('
name|'self'
op|','
name|'paths'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Compact a path set to contain the minimal number of paths\n        necessary to contain all paths in the set. If /a/path/ and\n        /a/path/to/a/file.txt are both in the set, leave only the\n        shorter path."""'
newline|'\n'
name|'short_paths'
op|'='
name|'set'
op|'('
op|')'
newline|'\n'
name|'for'
name|'path'
name|'in'
name|'sorted'
op|'('
name|'paths'
op|','
name|'key'
op|'='
name|'len'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'not'
name|'any'
op|'('
op|'['
op|'('
name|'path'
op|'.'
name|'startswith'
op|'('
name|'shortpath'
op|')'
name|'and'
nl|'\n'
name|'path'
op|'['
name|'len'
op|'('
name|'shortpath'
op|'.'
name|'rstrip'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'sep'
op|')'
op|')'
op|']'
op|'=='
name|'os'
op|'.'
name|'path'
op|'.'
name|'sep'
op|')'
nl|'\n'
name|'for'
name|'shortpath'
name|'in'
name|'short_paths'
op|']'
op|')'
op|':'
newline|'\n'
indent|'                '
name|'short_paths'
op|'.'
name|'add'
op|'('
name|'path'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'return'
name|'short_paths'
newline|'\n'
nl|'\n'
DECL|member|_stash
dedent|''
name|'def'
name|'_stash'
op|'('
name|'self'
op|','
name|'path'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'return'
name|'os'
op|'.'
name|'path'
op|'.'
name|'join'
op|'('
nl|'\n'
name|'self'
op|'.'
name|'save_dir'
op|','
name|'os'
op|'.'
name|'path'
op|'.'
name|'splitdrive'
op|'('
name|'path'
op|')'
op|'['
number|'1'
op|']'
op|'.'
name|'lstrip'
op|'('
name|'os'
op|'.'
name|'path'
op|'.'
name|'sep'
op|')'
op|')'
newline|'\n'
nl|'\n'
DECL|member|remove
dedent|''
name|'def'
name|'remove'
op|'('
name|'self'
op|','
name|'auto_confirm'
op|'='
name|'False'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Remove paths in ``self.paths`` with confirmation (unless\n        ``auto_confirm`` is True)."""'
newline|'\n'
name|'if'
name|'not'
name|'self'
op|'.'
name|'_can_uninstall'
op|'('
op|')'
op|':'
newline|'\n'
indent|'            '
name|'return'
newline|'\n'
dedent|''
name|'logger'
op|'.'
name|'notify'
op|'('
string|"'Uninstalling %s:'"
op|'%'
name|'self'
op|'.'
name|'dist'
op|'.'
name|'project_name'
op|')'
newline|'\n'
name|'logger'
op|'.'
name|'indent'
op|'+='
number|'2'
newline|'\n'
name|'paths'
op|'='
name|'sorted'
op|'('
name|'self'
op|'.'
name|'compact'
op|'('
name|'self'
op|'.'
name|'paths'
op|')'
op|')'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'if'
name|'auto_confirm'
op|':'
newline|'\n'
indent|'                '
name|'response'
op|'='
string|"'y'"
newline|'\n'
dedent|''
name|'else'
op|':'
newline|'\n'
indent|'                '
name|'for'
name|'path'
name|'in'
name|'paths'
op|':'
newline|'\n'
indent|'                    '
name|'logger'
op|'.'
name|'notify'
op|'('
name|'path'
op|')'
newline|'\n'
dedent|''
name|'response'
op|'='
name|'ask'
op|'('
string|"'Proceed (y/n)? '"
op|','
op|'('
string|"'y'"
op|','
string|"'n'"
op|')'
op|')'
newline|'\n'
dedent|''
name|'if'
name|'self'
op|'.'
name|'_refuse'
op|':'
newline|'\n'
indent|'                '
name|'logger'
op|'.'
name|'notify'
op|'('
string|"'Not removing or modifying (outside of prefix):'"
op|')'
newline|'\n'
name|'for'
name|'path'
name|'in'
name|'self'
op|'.'
name|'compact'
op|'('
name|'self'
op|'.'
name|'_refuse'
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'logger'
op|'.'
name|'notify'
op|'('
name|'path'
op|')'
newline|'\n'
dedent|''
dedent|''
name|'if'
name|'response'
op|'=='
string|"'y'"
op|':'
newline|'\n'
indent|'                '
name|'self'
op|'.'
name|'save_dir'
op|'='
name|'tempfile'
op|'.'
name|'mkdtemp'
op|'('
name|'suffix'
op|'='
string|"'-uninstall'"
op|','
nl|'\n'
name|'prefix'
op|'='
string|"'pip-'"
op|')'
newline|'\n'
name|'for'
name|'path'
name|'in'
name|'paths'
op|':'
newline|'\n'
indent|'                    '
name|'new_path'
op|'='
name|'self'
op|'.'
name|'_stash'
op|'('
name|'path'
op|')'
newline|'\n'
name|'logger'
op|'.'
name|'info'
op|'('
string|"'Removing file or directory %s'"
op|'%'
name|'path'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_moved_paths'
op|'.'
name|'append'
op|'('
name|'path'
op|')'
newline|'\n'
name|'renames'
op|'('
name|'path'
op|','
name|'new_path'
op|')'
newline|'\n'
dedent|''
name|'for'
name|'pth'
name|'in'
name|'self'
op|'.'
name|'pth'
op|'.'
name|'values'
op|'('
op|')'
op|':'
newline|'\n'
indent|'                    '
name|'pth'
op|'.'
name|'remove'
op|'('
op|')'
newline|'\n'
dedent|''
name|'logger'
op|'.'
name|'notify'
op|'('
string|"'Successfully uninstalled %s'"
op|'%'
name|'self'
op|'.'
name|'dist'
op|'.'
name|'project_name'
op|')'
newline|'\n'
nl|'\n'
dedent|''
dedent|''
name|'finally'
op|':'
newline|'\n'
indent|'            '
name|'logger'
op|'.'
name|'indent'
op|'-='
number|'2'
newline|'\n'
nl|'\n'
DECL|member|rollback
dedent|''
dedent|''
name|'def'
name|'rollback'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Rollback the changes previously made by remove()."""'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'save_dir'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'logger'
op|'.'
name|'error'
op|'('
string|'"Can\'t roll back %s; was not uninstalled"'
op|'%'
name|'self'
op|'.'
name|'dist'
op|'.'
name|'project_name'
op|')'
newline|'\n'
name|'return'
name|'False'
newline|'\n'
dedent|''
name|'logger'
op|'.'
name|'notify'
op|'('
string|"'Rolling back uninstall of %s'"
op|'%'
name|'self'
op|'.'
name|'dist'
op|'.'
name|'project_name'
op|')'
newline|'\n'
name|'for'
name|'path'
name|'in'
name|'self'
op|'.'
name|'_moved_paths'
op|':'
newline|'\n'
indent|'            '
name|'tmp_path'
op|'='
name|'self'
op|'.'
name|'_stash'
op|'('
name|'path'
op|')'
newline|'\n'
name|'logger'
op|'.'
name|'info'
op|'('
string|"'Replacing %s'"
op|'%'
name|'path'
op|')'
newline|'\n'
name|'renames'
op|'('
name|'tmp_path'
op|','
name|'path'
op|')'
newline|'\n'
dedent|''
name|'for'
name|'pth'
name|'in'
name|'self'
op|'.'
name|'pth'
op|':'
newline|'\n'
indent|'            '
name|'pth'
op|'.'
name|'rollback'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|commit
dedent|''
dedent|''
name|'def'
name|'commit'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
string|'"""Remove temporary save dir: rollback will no longer be possible."""'
newline|'\n'
name|'if'
name|'self'
op|'.'
name|'save_dir'
name|'is'
name|'not'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'shutil'
op|'.'
name|'rmtree'
op|'('
name|'self'
op|'.'
name|'save_dir'
op|')'
newline|'\n'
name|'self'
op|'.'
name|'save_dir'
op|'='
name|'None'
newline|'\n'
name|'self'
op|'.'
name|'_moved_paths'
op|'='
op|'['
op|']'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|UninstallPthEntries
dedent|''
dedent|''
dedent|''
name|'class'
name|'UninstallPthEntries'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
DECL|member|__init__
indent|'    '
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'pth_file'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'not'
name|'os'
op|'.'
name|'path'
op|'.'
name|'isfile'
op|'('
name|'pth_file'
op|')'
op|':'
newline|'\n'
indent|'            '
name|'raise'
name|'UninstallationError'
op|'('
string|'"Cannot remove entries from nonexistent file %s"'
op|'%'
name|'pth_file'
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'file'
op|'='
name|'pth_file'
newline|'\n'
name|'self'
op|'.'
name|'entries'
op|'='
name|'set'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_saved_lines'
op|'='
name|'None'
newline|'\n'
nl|'\n'
DECL|member|add
dedent|''
name|'def'
name|'add'
op|'('
name|'self'
op|','
name|'entry'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'entry'
op|'='
name|'os'
op|'.'
name|'path'
op|'.'
name|'normcase'
op|'('
name|'entry'
op|')'
newline|'\n'
comment|'# On Windows, os.path.normcase converts the entry to use'
nl|'\n'
comment|'# backslashes.  This is correct for entries that describe absolute'
nl|'\n'
comment|'# paths outside of site-packages, but all the others use forward'
nl|'\n'
comment|'# slashes.'
nl|'\n'
name|'if'
name|'sys'
op|'.'
name|'platform'
op|'=='
string|"'win32'"
name|'and'
name|'not'
name|'os'
op|'.'
name|'path'
op|'.'
name|'splitdrive'
op|'('
name|'entry'
op|')'
op|'['
number|'0'
op|']'
op|':'
newline|'\n'
indent|'            '
name|'entry'
op|'='
name|'entry'
op|'.'
name|'replace'
op|'('
string|"'\\\\'"
op|','
string|"'/'"
op|')'
newline|'\n'
dedent|''
name|'self'
op|'.'
name|'entries'
op|'.'
name|'add'
op|'('
name|'entry'
op|')'
newline|'\n'
nl|'\n'
DECL|member|remove
dedent|''
name|'def'
name|'remove'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'logger'
op|'.'
name|'info'
op|'('
string|"'Removing pth entries from %s:'"
op|'%'
name|'self'
op|'.'
name|'file'
op|')'
newline|'\n'
name|'fh'
op|'='
name|'open'
op|'('
name|'self'
op|'.'
name|'file'
op|','
string|"'r'"
op|')'
newline|'\n'
name|'lines'
op|'='
name|'fh'
op|'.'
name|'readlines'
op|'('
op|')'
newline|'\n'
name|'self'
op|'.'
name|'_saved_lines'
op|'='
name|'lines'
newline|'\n'
name|'fh'
op|'.'
name|'close'
op|'('
op|')'
newline|'\n'
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'for'
name|'entry'
name|'in'
name|'self'
op|'.'
name|'entries'
op|':'
newline|'\n'
indent|'                '
name|'logger'
op|'.'
name|'info'
op|'('
string|"'Removing entry: %s'"
op|'%'
name|'entry'
op|')'
newline|'\n'
dedent|''
name|'try'
op|':'
newline|'\n'
indent|'                '
name|'lines'
op|'.'
name|'remove'
op|'('
name|'entry'
op|'+'
string|"'\\n'"
op|')'
newline|'\n'
dedent|''
name|'except'
name|'ValueError'
op|':'
newline|'\n'
indent|'                '
name|'pass'
newline|'\n'
dedent|''
dedent|''
name|'finally'
op|':'
newline|'\n'
indent|'            '
name|'pass'
newline|'\n'
dedent|''
name|'fh'
op|'='
name|'open'
op|'('
name|'self'
op|'.'
name|'file'
op|','
string|"'wb'"
op|')'
newline|'\n'
name|'fh'
op|'.'
name|'writelines'
op|'('
name|'lines'
op|')'
newline|'\n'
name|'fh'
op|'.'
name|'close'
op|'('
op|')'
newline|'\n'
nl|'\n'
DECL|member|rollback
dedent|''
name|'def'
name|'rollback'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'if'
name|'self'
op|'.'
name|'_saved_lines'
name|'is'
name|'None'
op|':'
newline|'\n'
indent|'            '
name|'logger'
op|'.'
name|'error'
op|'('
string|"'Cannot roll back changes to %s, none were made'"
op|'%'
name|'self'
op|'.'
name|'file'
op|')'
newline|'\n'
name|'return'
name|'False'
newline|'\n'
dedent|''
name|'logger'
op|'.'
name|'info'
op|'('
string|"'Rolling %s back to previous state'"
op|'%'
name|'self'
op|'.'
name|'file'
op|')'
newline|'\n'
name|'fh'
op|'='
name|'open'
op|'('
name|'self'
op|'.'
name|'file'
op|','
string|"'wb'"
op|')'
newline|'\n'
name|'fh'
op|'.'
name|'writelines'
op|'('
name|'self'
op|'.'
name|'_saved_lines'
op|')'
newline|'\n'
name|'fh'
op|'.'
name|'close'
op|'('
op|')'
newline|'\n'
name|'return'
name|'True'
newline|'\n'
nl|'\n'
nl|'\n'
DECL|class|FakeFile
dedent|''
dedent|''
name|'class'
name|'FakeFile'
op|'('
name|'object'
op|')'
op|':'
newline|'\n'
indent|'    '
string|'"""Wrap a list of lines in an object with readline() to make\n    ConfigParser happy."""'
newline|'\n'
DECL|member|__init__
name|'def'
name|'__init__'
op|'('
name|'self'
op|','
name|'lines'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'self'
op|'.'
name|'_gen'
op|'='
op|'('
name|'l'
name|'for'
name|'l'
name|'in'
name|'lines'
op|')'
newline|'\n'
nl|'\n'
DECL|member|readline
dedent|''
name|'def'
name|'readline'
op|'('
name|'self'
op|')'
op|':'
newline|'\n'
indent|'        '
name|'try'
op|':'
newline|'\n'
indent|'            '
name|'return'
name|'self'
op|'.'
name|'_gen'
op|'.'
name|'next'
op|'('
op|')'
newline|'\n'
dedent|''
name|'except'
name|'StopIteration'
op|':'
newline|'\n'
indent|'            '
name|'return'
string|"''"
newline|'\n'
dedent|''
dedent|''
dedent|''
endmarker|''
end_unit
